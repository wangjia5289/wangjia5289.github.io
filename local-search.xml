<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>å·¥å…·ï¼šObsidian å›¾ç‰‡æ’åºä¸é‡å‘½å</title>
    <link href="/2025/12/16/%E5%B7%A5%E5%85%B7%EF%BC%9AObsidian%E5%9B%BE%E7%89%87%E6%8E%92%E5%BA%8F%E4%B8%8E%E9%87%8D%E5%91%BD%E5%90%8D/"/>
    <url>/2025/12/16/%E5%B7%A5%E5%85%B7%EF%BC%9AObsidian%E5%9B%BE%E7%89%87%E6%8E%92%E5%BA%8F%E4%B8%8E%E9%87%8D%E5%91%BD%E5%90%8D/</url>
    
    <content type="html"><![CDATA[<h2 id="1-Py-ä»£ç "><a href="#1-Py-ä»£ç " class="headerlink" title="1. Py ä»£ç "></a>1. Py ä»£ç </h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> tkinter <span class="hljs-keyword">as</span> tk<br><span class="hljs-keyword">from</span> tkinter <span class="hljs-keyword">import</span> filedialog, messagebox, ttk<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">import</span> uuid<br><span class="hljs-keyword">import</span> zipfile<br><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime<br><span class="hljs-keyword">from</span> urllib.parse <span class="hljs-keyword">import</span> unquote<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ModernRenamerApp</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, root</span>):<br>        <span class="hljs-variable language_">self</span>.root = root<br>        <span class="hljs-variable language_">self</span>.root.title(<span class="hljs-string">&quot;Obsidian å›¾ç‰‡æ’åºä¸é‡å‘½å&quot;</span>)<br>        <span class="hljs-variable language_">self</span>.root.geometry(<span class="hljs-string">&quot;780x750&quot;</span>)<br>        <br>        <span class="hljs-comment"># --- ç°ä»£ UI é…è‰²ä¸å­—ä½“é…ç½® ---</span><br>        <span class="hljs-variable language_">self</span>.colors = &#123;<br>            <span class="hljs-string">&quot;bg&quot;</span>: <span class="hljs-string">&quot;#f0f2f5&quot;</span>,          <span class="hljs-comment"># æ•´ä½“èƒŒæ™¯ç°</span><br>            <span class="hljs-string">&quot;card_bg&quot;</span>: <span class="hljs-string">&quot;#ffffff&quot;</span>,     <span class="hljs-comment"># å¡ç‰‡èƒŒæ™¯ç™½</span><br>            <span class="hljs-string">&quot;primary&quot;</span>: <span class="hljs-string">&quot;#1890ff&quot;</span>,     <span class="hljs-comment"># ä¸»è‰²è°ƒè“</span><br>            <span class="hljs-string">&quot;success&quot;</span>: <span class="hljs-string">&quot;#52c41a&quot;</span>,     <span class="hljs-comment"># æˆåŠŸè‰²ç»¿</span><br>            <span class="hljs-string">&quot;text&quot;</span>: <span class="hljs-string">&quot;#333333&quot;</span>,        <span class="hljs-comment">#ç”±äºæ–‡å­—</span><br>            <span class="hljs-string">&quot;gray_text&quot;</span>: <span class="hljs-string">&quot;#888888&quot;</span>    <span class="hljs-comment"># è¾…åŠ©æ–‡å­—</span><br>        &#125;<br>        <span class="hljs-variable language_">self</span>.root.configure(bg=<span class="hljs-variable language_">self</span>.colors[<span class="hljs-string">&quot;bg&quot;</span>])<br>        <br>        <span class="hljs-comment"># é…ç½®å…¨å±€æ ·å¼</span><br>        <span class="hljs-variable language_">self</span>.setup_styles()<br><br>        <span class="hljs-comment"># --- å˜é‡åˆå§‹åŒ– ---</span><br>        <span class="hljs-variable language_">self</span>.md_path = tk.StringVar()<br>        <span class="hljs-variable language_">self</span>.attachment_dir = tk.StringVar()<br>        <span class="hljs-variable language_">self</span>.enable_backup_var = tk.BooleanVar(value=<span class="hljs-literal">True</span>) <br>        <span class="hljs-variable language_">self</span>.backup_path_var = tk.StringVar()<br>        <span class="hljs-variable language_">self</span>.ext_var = tk.StringVar(value=<span class="hljs-string">&quot;png&quot;</span>)<br>        <span class="hljs-variable language_">self</span>.delete_unused_var = tk.BooleanVar(value=<span class="hljs-literal">False</span>)<br><br>        <span class="hljs-comment"># --- æ„å»ºç•Œé¢ ---</span><br>        <span class="hljs-variable language_">self</span>.create_widgets()<br>        <span class="hljs-variable language_">self</span>.toggle_backup_state()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">setup_styles</span>(<span class="hljs-params">self</span>):<br>        style = ttk.Style()<br>        style.theme_use(<span class="hljs-string">&#x27;clam&#x27;</span>)  <span class="hljs-comment"># ä½¿ç”¨ clam ä½œä¸ºåŸºç¡€æ¥è‡ªå®šä¹‰</span><br><br>        <span class="hljs-comment"># è‡ªå®šä¹‰ Frame èƒŒæ™¯ï¼ˆç”¨äºå¡ç‰‡æ•ˆæœï¼‰</span><br>        style.configure(<span class="hljs-string">&quot;Card.TLabelframe&quot;</span>, background=<span class="hljs-variable language_">self</span>.colors[<span class="hljs-string">&quot;card_bg&quot;</span>], relief=<span class="hljs-string">&quot;flat&quot;</span>, borderwidth=<span class="hljs-number">0</span>)<br>        style.configure(<span class="hljs-string">&quot;Card.TLabelframe.Label&quot;</span>, background=<span class="hljs-variable language_">self</span>.colors[<span class="hljs-string">&quot;card_bg&quot;</span>], foreground=<span class="hljs-variable language_">self</span>.colors[<span class="hljs-string">&quot;primary&quot;</span>], font=(<span class="hljs-string">&quot;å¾®è½¯é›…é»‘&quot;</span>, <span class="hljs-number">11</span>, <span class="hljs-string">&quot;bold&quot;</span>))<br>        style.configure(<span class="hljs-string">&quot;Card.TFrame&quot;</span>, background=<span class="hljs-variable language_">self</span>.colors[<span class="hljs-string">&quot;card_bg&quot;</span>])<br>        <br>        <span class="hljs-comment"># æ™®é€šæŒ‰é’®</span><br>        style.configure(<span class="hljs-string">&quot;TButton&quot;</span>, padding=<span class="hljs-number">6</span>, relief=<span class="hljs-string">&quot;flat&quot;</span>, background=<span class="hljs-string">&quot;#e6e6e6&quot;</span>, foreground=<span class="hljs-string">&quot;#333&quot;</span>)<br>        style.<span class="hljs-built_in">map</span>(<span class="hljs-string">&quot;TButton&quot;</span>, background=[(<span class="hljs-string">&quot;active&quot;</span>, <span class="hljs-string">&quot;#d9d9d9&quot;</span>)])<br><br>        <span class="hljs-comment"># å¼ºè°ƒæŒ‰é’® (Action Button)</span><br>        style.configure(<span class="hljs-string">&quot;Accent.TButton&quot;</span>, font=(<span class="hljs-string">&quot;å¾®è½¯é›…é»‘&quot;</span>, <span class="hljs-number">12</span>, <span class="hljs-string">&quot;bold&quot;</span>), background=<span class="hljs-variable language_">self</span>.colors[<span class="hljs-string">&quot;primary&quot;</span>], foreground=<span class="hljs-string">&quot;white&quot;</span>, borderwidth=<span class="hljs-number">0</span>)<br>        style.<span class="hljs-built_in">map</span>(<span class="hljs-string">&quot;Accent.TButton&quot;</span>, background=[(<span class="hljs-string">&quot;active&quot;</span>, <span class="hljs-string">&quot;#40a9ff&quot;</span>)]) <span class="hljs-comment"># æ‚¬åœå˜äº®</span><br><br>        <span class="hljs-comment"># å‹¾é€‰æ¡†å’Œæ ‡ç­¾</span><br>        style.configure(<span class="hljs-string">&quot;TCheckbutton&quot;</span>, background=<span class="hljs-variable language_">self</span>.colors[<span class="hljs-string">&quot;card_bg&quot;</span>], font=(<span class="hljs-string">&quot;å¾®è½¯é›…é»‘&quot;</span>, <span class="hljs-number">10</span>))<br>        style.configure(<span class="hljs-string">&quot;TLabel&quot;</span>, background=<span class="hljs-variable language_">self</span>.colors[<span class="hljs-string">&quot;card_bg&quot;</span>], font=(<span class="hljs-string">&quot;å¾®è½¯é›…é»‘&quot;</span>, <span class="hljs-number">10</span>), foreground=<span class="hljs-variable language_">self</span>.colors[<span class="hljs-string">&quot;text&quot;</span>])<br>        style.configure(<span class="hljs-string">&quot;Gray.TLabel&quot;</span>, background=<span class="hljs-variable language_">self</span>.colors[<span class="hljs-string">&quot;card_bg&quot;</span>], font=(<span class="hljs-string">&quot;å¾®è½¯é›…é»‘&quot;</span>, <span class="hljs-number">9</span>), foreground=<span class="hljs-variable language_">self</span>.colors[<span class="hljs-string">&quot;gray_text&quot;</span>])<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">create_widgets</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-comment"># ä¸»å®¹å™¨ (å¸¦å†…è¾¹è·)</span><br>        main_container = tk.Frame(<span class="hljs-variable language_">self</span>.root, bg=<span class="hljs-variable language_">self</span>.colors[<span class="hljs-string">&quot;bg&quot;</span>])<br>        main_container.pack(fill=<span class="hljs-string">&quot;both&quot;</span>, expand=<span class="hljs-literal">True</span>, padx=<span class="hljs-number">20</span>, pady=<span class="hljs-number">20</span>)<br><br>        <span class="hljs-comment"># === å¡ç‰‡ 1ï¼šèµ„æºé€‰æ‹© ===</span><br>        <span class="hljs-variable language_">self</span>.create_card(main_container, <span class="hljs-string">&quot;1. èµ„æºé€‰æ‹©&quot;</span>, <span class="hljs-variable language_">self</span>.build_resource_section)<br><br>        <span class="hljs-comment"># === å¡ç‰‡ 2ï¼šå¤‡ä»½è®¾ç½® ===</span><br>        <span class="hljs-variable language_">self</span>.create_card(main_container, <span class="hljs-string">&quot;2. å®‰å…¨å¤‡ä»½&quot;</span>, <span class="hljs-variable language_">self</span>.build_backup_section)<br><br>        <span class="hljs-comment"># === å¡ç‰‡ 3ï¼šè§„åˆ™ä¸æ‰§è¡Œ ===</span><br>        <span class="hljs-variable language_">self</span>.create_card(main_container, <span class="hljs-string">&quot;3. æ‰§è¡Œé…ç½®&quot;</span>, <span class="hljs-variable language_">self</span>.build_action_section)<br><br>        <span class="hljs-comment"># === æ—¥å¿—åŒºåŸŸ (ä¸å¸¦å¡ç‰‡æ ‡é¢˜ï¼Œæ˜¾å¾—æ›´åƒæ§åˆ¶å°) ===</span><br>        log_frame = tk.Frame(main_container, bg=<span class="hljs-variable language_">self</span>.colors[<span class="hljs-string">&quot;bg&quot;</span>])<br>        log_frame.pack(fill=<span class="hljs-string">&quot;both&quot;</span>, expand=<span class="hljs-literal">True</span>, pady=(<span class="hljs-number">10</span>, <span class="hljs-number">0</span>))<br>        <br>        tk.Label(log_frame, text=<span class="hljs-string">&quot;è¿è¡Œæ—¥å¿—&quot;</span>, bg=<span class="hljs-variable language_">self</span>.colors[<span class="hljs-string">&quot;bg&quot;</span>], fg=<span class="hljs-variable language_">self</span>.colors[<span class="hljs-string">&quot;gray_text&quot;</span>], font=(<span class="hljs-string">&quot;å¾®è½¯é›…é»‘&quot;</span>, <span class="hljs-number">9</span>)).pack(anchor=<span class="hljs-string">&quot;w&quot;</span>, pady=(<span class="hljs-number">0</span>, <span class="hljs-number">5</span>))<br>        <br>        <span class="hljs-variable language_">self</span>.log_text = tk.Text(log_frame, height=<span class="hljs-number">10</span>, font=(<span class="hljs-string">&quot;Consolas&quot;</span>, <span class="hljs-number">10</span>), relief=<span class="hljs-string">&quot;flat&quot;</span>, padx=<span class="hljs-number">10</span>, pady=<span class="hljs-number">10</span>, borderwidth=<span class="hljs-number">0</span>)<br>        <span class="hljs-variable language_">self</span>.log_text.pack(fill=<span class="hljs-string">&quot;both&quot;</span>, expand=<span class="hljs-literal">True</span>)<br>        <br>        <span class="hljs-comment"># ç»™æ—¥å¿—åŠ ä¸ªç®€å•çš„è¾¹æ¡†æ•ˆæœ</span><br>        <span class="hljs-variable language_">self</span>.log_text.config(highlightbackground=<span class="hljs-string">&quot;#d9d9d9&quot;</span>, highlightthickness=<span class="hljs-number">1</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">create_card</span>(<span class="hljs-params">self, parent, title, build_func</span>):<br>        <span class="hljs-string">&quot;&quot;&quot;è¾…åŠ©å‡½æ•°ï¼šå¿«é€Ÿåˆ›å»ºç™½è‰²å¡ç‰‡é£æ ¼çš„åŒºåŸŸ&quot;&quot;&quot;</span><br>        card = ttk.LabelFrame(parent, text=<span class="hljs-string">f&quot; <span class="hljs-subst">&#123;title&#125;</span> &quot;</span>, style=<span class="hljs-string">&quot;Card.TLabelframe&quot;</span>, padding=<span class="hljs-number">15</span>)<br>        card.pack(fill=<span class="hljs-string">&quot;x&quot;</span>, pady=(<span class="hljs-number">0</span>, <span class="hljs-number">15</span>))<br>        build_func(card)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">build_resource_section</span>(<span class="hljs-params">self, parent</span>):<br>        <span class="hljs-comment"># ä½¿ç”¨ Grid å¸ƒå±€è®©è¾“å…¥æ¡†å¯¹å…¶</span><br>        parent.columnconfigure(<span class="hljs-number">1</span>, weight=<span class="hljs-number">1</span>) <span class="hljs-comment"># è®©ä¸­é—´åˆ—è‡ªåŠ¨æ‹‰ä¼¸</span><br><br>        ttk.Label(parent, text=<span class="hljs-string">&quot;MD æ–‡ä»¶:&quot;</span>).grid(row=<span class="hljs-number">0</span>, column=<span class="hljs-number">0</span>, sticky=<span class="hljs-string">&quot;w&quot;</span>, pady=<span class="hljs-number">5</span>)<br>        ttk.Entry(parent, textvariable=<span class="hljs-variable language_">self</span>.md_path).grid(row=<span class="hljs-number">0</span>, column=<span class="hljs-number">1</span>, sticky=<span class="hljs-string">&quot;ew&quot;</span>, padx=<span class="hljs-number">10</span>, pady=<span class="hljs-number">5</span>)<br>        ttk.Button(parent, text=<span class="hljs-string">&quot;ğŸ“‚ æµè§ˆ&quot;</span>, command=<span class="hljs-variable language_">self</span>.select_md, width=<span class="hljs-number">8</span>).grid(row=<span class="hljs-number">0</span>, column=<span class="hljs-number">2</span>, pady=<span class="hljs-number">5</span>)<br><br>        ttk.Label(parent, text=<span class="hljs-string">&quot;é™„ä»¶æ–‡ä»¶å¤¹:&quot;</span>).grid(row=<span class="hljs-number">1</span>, column=<span class="hljs-number">0</span>, sticky=<span class="hljs-string">&quot;w&quot;</span>, pady=<span class="hljs-number">5</span>)<br>        ttk.Entry(parent, textvariable=<span class="hljs-variable language_">self</span>.attachment_dir).grid(row=<span class="hljs-number">1</span>, column=<span class="hljs-number">1</span>, sticky=<span class="hljs-string">&quot;ew&quot;</span>, padx=<span class="hljs-number">10</span>, pady=<span class="hljs-number">5</span>)<br>        ttk.Button(parent, text=<span class="hljs-string">&quot;ğŸ“‚ æµè§ˆ&quot;</span>, command=<span class="hljs-variable language_">self</span>.select_dir, width=<span class="hljs-number">8</span>).grid(row=<span class="hljs-number">1</span>, column=<span class="hljs-number">2</span>, pady=<span class="hljs-number">5</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">build_backup_section</span>(<span class="hljs-params">self, parent</span>):<br>        parent.columnconfigure(<span class="hljs-number">1</span>, weight=<span class="hljs-number">1</span>)<br><br>        <span class="hljs-comment"># ç¬¬ä¸€è¡Œï¼šå¼€å…³</span><br>        ttk.Checkbutton(parent, text=<span class="hljs-string">&quot;å¯ç”¨è‡ªåŠ¨å¤‡ä»½ (å¼ºçƒˆæ¨è)&quot;</span>, variable=<span class="hljs-variable language_">self</span>.enable_backup_var, <br>                        command=<span class="hljs-variable language_">self</span>.toggle_backup_state).grid(row=<span class="hljs-number">0</span>, column=<span class="hljs-number">0</span>, columnspan=<span class="hljs-number">3</span>, sticky=<span class="hljs-string">&quot;w&quot;</span>)<br>        <br>        <span class="hljs-comment"># ç¬¬äºŒè¡Œï¼šè·¯å¾„é€‰æ‹©</span><br>        ttk.Label(parent, text=<span class="hljs-string">&quot;å¤‡ä»½ä¿å­˜ä½ç½®:&quot;</span>).grid(row=<span class="hljs-number">1</span>, column=<span class="hljs-number">0</span>, sticky=<span class="hljs-string">&quot;w&quot;</span>, pady=(<span class="hljs-number">10</span>, <span class="hljs-number">5</span>))<br>        <span class="hljs-variable language_">self</span>.entry_backup = ttk.Entry(parent, textvariable=<span class="hljs-variable language_">self</span>.backup_path_var)<br>        <span class="hljs-variable language_">self</span>.entry_backup.grid(row=<span class="hljs-number">1</span>, column=<span class="hljs-number">1</span>, sticky=<span class="hljs-string">&quot;ew&quot;</span>, padx=<span class="hljs-number">10</span>, pady=(<span class="hljs-number">10</span>, <span class="hljs-number">5</span>))<br>        <span class="hljs-variable language_">self</span>.btn_backup = ttk.Button(parent, text=<span class="hljs-string">&quot;ğŸ“‚ é€‰æ‹©&quot;</span>, command=<span class="hljs-variable language_">self</span>.select_backup_dir, width=<span class="hljs-number">8</span>)<br>        <span class="hljs-variable language_">self</span>.btn_backup.grid(row=<span class="hljs-number">1</span>, column=<span class="hljs-number">2</span>, pady=(<span class="hljs-number">10</span>, <span class="hljs-number">5</span>))<br><br>        <span class="hljs-comment"># æç¤ºæ–‡å­—</span><br>        ttk.Label(parent, text=<span class="hljs-string">&quot;å‘½åæ ¼å¼: ç¬”è®°å_backup_YYYY-MM-DDTHH-mm.zip&quot;</span>, style=<span class="hljs-string">&quot;Gray.TLabel&quot;</span>).grid(row=<span class="hljs-number">2</span>, column=<span class="hljs-number">1</span>, sticky=<span class="hljs-string">&quot;w&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">build_action_section</span>(<span class="hljs-params">self, parent</span>):<br>        <span class="hljs-comment"># é€‰é¡¹è¡Œ</span><br>        opt_frame = ttk.Frame(parent, style=<span class="hljs-string">&quot;Card.TFrame&quot;</span>)<br>        opt_frame.pack(fill=<span class="hljs-string">&quot;x&quot;</span>, pady=(<span class="hljs-number">0</span>, <span class="hljs-number">15</span>))<br>        <br>        ttk.Label(opt_frame, text=<span class="hljs-string">&quot;å¤„ç†å›¾ç‰‡åç¼€:&quot;</span>).pack(side=<span class="hljs-string">&quot;left&quot;</span>)<br>        ttk.Combobox(opt_frame, textvariable=<span class="hljs-variable language_">self</span>.ext_var, values=[<span class="hljs-string">&quot;png&quot;</span>, <span class="hljs-string">&quot;jpg&quot;</span>, <span class="hljs-string">&quot;jpeg&quot;</span>], width=<span class="hljs-number">8</span>, state=<span class="hljs-string">&quot;readonly&quot;</span>).pack(side=<span class="hljs-string">&quot;left&quot;</span>, padx=<span class="hljs-number">10</span>)<br>        <br>        ttk.Separator(opt_frame, orient=<span class="hljs-string">&quot;vertical&quot;</span>).pack(side=<span class="hljs-string">&quot;left&quot;</span>, fill=<span class="hljs-string">&quot;y&quot;</span>, padx=<span class="hljs-number">15</span>)<br>        <br>        ttk.Checkbutton(opt_frame, text=<span class="hljs-string">&quot;åˆ é™¤æœªå¼•ç”¨çš„å†—ä½™å›¾ç‰‡ (æ…ç”¨)&quot;</span>, variable=<span class="hljs-variable language_">self</span>.delete_unused_var).pack(side=<span class="hljs-string">&quot;left&quot;</span>)<br><br>        <span class="hljs-comment"># å¤§æŒ‰é’®</span><br>        <span class="hljs-variable language_">self</span>.run_btn = ttk.Button(parent, text=<span class="hljs-string">&quot;ğŸš€ ç«‹å³å¤‡ä»½å¹¶å¤„ç†&quot;</span>, style=<span class="hljs-string">&quot;Accent.TButton&quot;</span>, command=<span class="hljs-variable language_">self</span>.start_process)<br>        <span class="hljs-variable language_">self</span>.run_btn.pack(fill=<span class="hljs-string">&quot;x&quot;</span>, ipady=<span class="hljs-number">5</span>) <span class="hljs-comment"># ipady å¢åŠ æŒ‰é’®é«˜åº¦</span><br><br>    <span class="hljs-comment"># --- é€»è¾‘åŠŸèƒ½ä¿æŒä¸å˜ (V4.3çš„æ ¸å¿ƒé€»è¾‘) ---</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">log</span>(<span class="hljs-params">self, msg</span>):<br>        <span class="hljs-variable language_">self</span>.log_text.insert(<span class="hljs-string">&quot;end&quot;</span>, <span class="hljs-string">f&quot;[<span class="hljs-subst">&#123;datetime.now().strftime(<span class="hljs-string">&#x27;%H:%M:%S&#x27;</span>)&#125;</span>] <span class="hljs-subst">&#123;msg&#125;</span>\n&quot;</span>)<br>        <span class="hljs-variable language_">self</span>.log_text.see(<span class="hljs-string">&quot;end&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">toggle_backup_state</span>(<span class="hljs-params">self</span>):<br>        state = <span class="hljs-string">&quot;normal&quot;</span> <span class="hljs-keyword">if</span> <span class="hljs-variable language_">self</span>.enable_backup_var.get() <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;disabled&quot;</span><br>        <span class="hljs-variable language_">self</span>.entry_backup.config(state=state)<br>        <span class="hljs-variable language_">self</span>.btn_backup.config(state=state)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">select_md</span>(<span class="hljs-params">self</span>):<br>        f = filedialog.askopenfilename(filetypes=[(<span class="hljs-string">&quot;Markdown&quot;</span>, <span class="hljs-string">&quot;*.md&quot;</span>)])<br>        <span class="hljs-keyword">if</span> f: <span class="hljs-variable language_">self</span>.md_path.<span class="hljs-built_in">set</span>(f)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">select_dir</span>(<span class="hljs-params">self</span>):<br>        d = filedialog.askdirectory()<br>        <span class="hljs-keyword">if</span> d: <span class="hljs-variable language_">self</span>.attachment_dir.<span class="hljs-built_in">set</span>(d)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">select_backup_dir</span>(<span class="hljs-params">self</span>):<br>        d = filedialog.askdirectory()<br>        <span class="hljs-keyword">if</span> d: <span class="hljs-variable language_">self</span>.backup_path_var.<span class="hljs-built_in">set</span>(d)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">start_process</span>(<span class="hljs-params">self</span>):<br>        md_file = <span class="hljs-variable language_">self</span>.md_path.get()<br>        att_dir = <span class="hljs-variable language_">self</span>.attachment_dir.get()<br>        <br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> md_file <span class="hljs-keyword">or</span> <span class="hljs-keyword">not</span> att_dir:<br>            <span class="hljs-keyword">return</span> messagebox.showwarning(<span class="hljs-string">&quot;æç¤º&quot;</span>, <span class="hljs-string">&quot;è¯·å…ˆé€‰æ‹© [Markdownç¬”è®°] å’Œ [é™„ä»¶ç›®å½•]&quot;</span>)<br><br>        <span class="hljs-comment"># 1. å¤‡ä»½æµç¨‹</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-variable language_">self</span>.enable_backup_var.get():<br>            backup_dest = <span class="hljs-variable language_">self</span>.backup_path_var.get()<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> backup_dest:<br>                <span class="hljs-keyword">return</span> messagebox.showwarning(<span class="hljs-string">&quot;æç¤º&quot;</span>, <span class="hljs-string">&quot;è¯·é€‰æ‹©å¤‡ä»½ä¿å­˜çš„æ–‡ä»¶å¤¹ï¼&quot;</span>)<br>            <br>            success = <span class="hljs-variable language_">self</span>.perform_backup(md_file, att_dir, backup_dest)<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> success:<br>                <span class="hljs-keyword">return</span> <br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-variable language_">self</span>.log(<span class="hljs-string">&quot;ç”¨æˆ·è·³è¿‡å¤‡ä»½æ­¥éª¤ã€‚&quot;</span>)<br><br>        <span class="hljs-comment"># 2. é‡å‘½åæµç¨‹</span><br>        <span class="hljs-variable language_">self</span>.process_renaming_logic(md_file, att_dir)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">perform_backup</span>(<span class="hljs-params">self, md_file, att_dir, backup_dest</span>):<br>        <span class="hljs-keyword">try</span>:<br>            note_name = os.path.splitext(os.path.basename(md_file))[<span class="hljs-number">0</span>]<br>            <span class="hljs-comment"># æ ¼å¼ï¼š_backup_YYYY-MM-DDTHH-mm</span><br>            timestamp = datetime.now().strftime(<span class="hljs-string">&quot;%Y-%m-%dT%H-%M&quot;</span>)<br>            zip_name = <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;note_name&#125;</span>_backup_<span class="hljs-subst">&#123;timestamp&#125;</span>.zip&quot;</span><br>            zip_path = os.path.join(backup_dest, zip_name)<br><br>            <span class="hljs-variable language_">self</span>.log(<span class="hljs-string">f&quot;æ­£åœ¨åˆ›å»ºå¤‡ä»½: <span class="hljs-subst">&#123;zip_name&#125;</span> ...&quot;</span>)<br><br>            <span class="hljs-keyword">with</span> zipfile.ZipFile(zip_path, <span class="hljs-string">&#x27;w&#x27;</span>, zipfile.ZIP_DEFLATED) <span class="hljs-keyword">as</span> zf:<br>                zf.write(md_file, arcname=os.path.basename(md_file))<br>                <span class="hljs-keyword">for</span> root, dirs, files <span class="hljs-keyword">in</span> os.walk(att_dir):<br>                    <span class="hljs-keyword">for</span> file <span class="hljs-keyword">in</span> files:<br>                        full_path = os.path.join(root, file)<br>                        rel_path = os.path.relpath(full_path, os.path.dirname(att_dir))<br>                        zf.write(full_path, arcname=rel_path)<br>            <br>            <span class="hljs-variable language_">self</span>.log(<span class="hljs-string">f&quot;âœ… å¤‡ä»½æˆåŠŸï¼&quot;</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>            <span class="hljs-variable language_">self</span>.log(<span class="hljs-string">f&quot;âŒ å¤‡ä»½å¤±è´¥: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br>            messagebox.showerror(<span class="hljs-string">&quot;å¤‡ä»½å¤±è´¥&quot;</span>, <span class="hljs-string">f&quot;å¤‡ä»½æ“ä½œå‡ºé”™ï¼Œå·²ç»ˆæ­¢ã€‚\né”™è¯¯ä¿¡æ¯: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">process_renaming_logic</span>(<span class="hljs-params">self, md_file, att_dir</span>):<br>        ext = <span class="hljs-variable language_">self</span>.ext_var.get().lower()<br>        note_name = os.path.splitext(os.path.basename(md_file))[<span class="hljs-number">0</span>]<br>        note_name = re.sub(<span class="hljs-string">r&#x27;[\\/*?:&quot;&lt;&gt;|]&#x27;</span>, <span class="hljs-string">&quot;_&quot;</span>, note_name)<br><br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(md_file, <span class="hljs-string">&#x27;r&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>                content = f.read()<br><br>            pattern = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">r&#x27;!\[(.*?)\]\((.*?)\)&#x27;</span>)<br>            matches = <span class="hljs-built_in">list</span>(pattern.finditer(content))<br>            <br>            <span class="hljs-variable language_">self</span>.log(<span class="hljs-string">f&quot;--- å¼€å§‹åˆ†æç¬”è®°å†…å®¹ ---&quot;</span>)<br>            <br>            rename_map = &#123;&#125; <br>            new_files_generated = <span class="hljs-built_in">set</span>()<br>            count = <span class="hljs-number">1</span><br>            <br>            <span class="hljs-keyword">for</span> <span class="hljs-keyword">match</span> <span class="hljs-keyword">in</span> matches:<br>                rel_path = unquote(<span class="hljs-keyword">match</span>.group(<span class="hljs-number">2</span>))<br>                img_name = os.path.basename(rel_path)<br>                <br>                <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> img_name.lower().endswith(<span class="hljs-string">f&quot;.<span class="hljs-subst">&#123;ext&#125;</span>&quot;</span>): <span class="hljs-keyword">continue</span><br>                <span class="hljs-keyword">if</span> img_name <span class="hljs-keyword">in</span> rename_map: <span class="hljs-keyword">continue</span><br><br>                full_old_path = os.path.join(att_dir, img_name)<br>                <br>                <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(full_old_path):<br>                    <span class="hljs-variable language_">self</span>.log(<span class="hljs-string">f&quot;âš  æ‰¾ä¸åˆ°é™„ä»¶: <span class="hljs-subst">&#123;img_name&#125;</span>&quot;</span>)<br>                    <span class="hljs-keyword">continue</span><br>                <br>                <span class="hljs-keyword">if</span> count == <span class="hljs-number">1</span>:<br>                    new_name = <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;note_name&#125;</span>.<span class="hljs-subst">&#123;ext&#125;</span>&quot;</span><br>                <span class="hljs-keyword">else</span>:<br>                    new_name = <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;note_name&#125;</span>-<span class="hljs-subst">&#123;count - <span class="hljs-number">1</span>&#125;</span>.<span class="hljs-subst">&#123;ext&#125;</span>&quot;</span><br>                <br>                new_files_generated.add(new_name)<br>                temp_name = <span class="hljs-string">f&quot;TEMP_<span class="hljs-subst">&#123;uuid.uuid4().<span class="hljs-built_in">hex</span>&#125;</span>.<span class="hljs-subst">&#123;ext&#125;</span>&quot;</span><br>                <br>                rename_map[img_name] = &#123;<br>                    <span class="hljs-string">&quot;temp&quot;</span>: temp_name, <span class="hljs-string">&quot;final&quot;</span>: new_name,<br>                    <span class="hljs-string">&quot;old_path&quot;</span>: full_old_path,<br>                    <span class="hljs-string">&quot;temp_path&quot;</span>: os.path.join(att_dir, temp_name),<br>                    <span class="hljs-string">&quot;final_path&quot;</span>: os.path.join(att_dir, new_name)<br>                &#125;<br>                count += <span class="hljs-number">1</span><br><br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> rename_map:<br>                <span class="hljs-variable language_">self</span>.log(<span class="hljs-string">&quot;æ²¡æœ‰å‘ç°éœ€è¦é‡å‘½åçš„å›¾ç‰‡ã€‚&quot;</span>)<br>                <span class="hljs-keyword">return</span><br><br>            <span class="hljs-variable language_">self</span>.log(<span class="hljs-string">f&quot;è®¡åˆ’é‡å‘½å <span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(rename_map)&#125;</span> ä¸ªæ–‡ä»¶...&quot;</span>)<br><br>            <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> rename_map.items():<br>                <span class="hljs-keyword">try</span>: os.rename(v[<span class="hljs-string">&quot;old_path&quot;</span>], v[<span class="hljs-string">&quot;temp_path&quot;</span>])<br>                <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e: <span class="hljs-variable language_">self</span>.log(<span class="hljs-string">f&quot;Error (Temp): <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br><br>            <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> rename_map.items():<br>                <span class="hljs-keyword">try</span>:<br>                    <span class="hljs-keyword">if</span> os.path.exists(v[<span class="hljs-string">&quot;final_path&quot;</span>]): os.remove(v[<span class="hljs-string">&quot;final_path&quot;</span>])<br>                    os.rename(v[<span class="hljs-string">&quot;temp_path&quot;</span>], v[<span class="hljs-string">&quot;final_path&quot;</span>])<br>                    <span class="hljs-variable language_">self</span>.log(<span class="hljs-string">f&quot;é‡å‘½å: <span class="hljs-subst">&#123;k&#125;</span> -&gt; <span class="hljs-subst">&#123;v[<span class="hljs-string">&#x27;final&#x27;</span>]&#125;</span>&quot;</span>)<br>                <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e: <span class="hljs-variable language_">self</span>.log(<span class="hljs-string">f&quot;Error (Final): <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br><br>            <span class="hljs-keyword">def</span> <span class="hljs-title function_">replace_link</span>(<span class="hljs-params">m</span>):<br>                path_decoded = unquote(m.group(<span class="hljs-number">2</span>))<br>                name = os.path.basename(path_decoded)<br>                <span class="hljs-keyword">if</span> name <span class="hljs-keyword">in</span> rename_map:<br>                    <span class="hljs-keyword">return</span> <span class="hljs-string">f&quot;![<span class="hljs-subst">&#123;m.group(<span class="hljs-number">1</span>)&#125;</span>](<span class="hljs-subst">&#123;rename_map[name][<span class="hljs-string">&#x27;final&#x27;</span>]&#125;</span>)&quot;</span><br>                <span class="hljs-keyword">return</span> m.group(<span class="hljs-number">0</span>)<br><br>            new_content = pattern.sub(replace_link, content)<br>            <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(md_file, <span class="hljs-string">&#x27;w&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>                f.write(new_content)<br><br>            deleted = <span class="hljs-number">0</span><br>            <span class="hljs-keyword">if</span> <span class="hljs-variable language_">self</span>.delete_unused_var.get():<br>                <span class="hljs-keyword">for</span> f <span class="hljs-keyword">in</span> os.listdir(att_dir):<br>                    <span class="hljs-keyword">if</span> f.lower().endswith(<span class="hljs-string">f&quot;.<span class="hljs-subst">&#123;ext&#125;</span>&quot;</span>) <span class="hljs-keyword">and</span> f <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> new_files_generated:<br>                        <span class="hljs-keyword">try</span>:<br>                            os.remove(os.path.join(att_dir, f))<br>                            deleted += <span class="hljs-number">1</span><br>                            <span class="hljs-variable language_">self</span>.log(<span class="hljs-string">f&quot;å·²åˆ é™¤å†—ä½™: <span class="hljs-subst">&#123;f&#125;</span>&quot;</span>)<br>                        <span class="hljs-keyword">except</span>: <span class="hljs-keyword">pass</span><br>            <br>            msg = <span class="hljs-string">f&quot;å¤„ç†å®Œæˆï¼\nå…±é‡å‘½å <span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(rename_map)&#125;</span> å¼ å›¾ç‰‡ã€‚&quot;</span><br>            <span class="hljs-keyword">if</span> deleted &gt; <span class="hljs-number">0</span>: msg += <span class="hljs-string">f&quot;\nå·²æ¸…ç† <span class="hljs-subst">&#123;deleted&#125;</span> å¼ åºŸå¼ƒå›¾ç‰‡ã€‚&quot;</span><br>            messagebox.showinfo(<span class="hljs-string">&quot;æˆåŠŸ&quot;</span>, msg)<br><br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>            <span class="hljs-variable language_">self</span>.log(<span class="hljs-string">f&quot;âŒ è¿è¡Œé”™è¯¯: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br>            messagebox.showerror(<span class="hljs-string">&quot;Error&quot;</span>, <span class="hljs-built_in">str</span>(e))<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    root = tk.Tk()<br>    app = ModernRenamerApp(root)<br>    root.mainloop()<br></code></pre></td></tr></table></figure><hr><h2 id="2-æ‰“åŒ…æˆ-exe-æ–‡ä»¶"><a href="#2-æ‰“åŒ…æˆ-exe-æ–‡ä»¶" class="headerlink" title="2. æ‰“åŒ…æˆ exe æ–‡ä»¶"></a>2. æ‰“åŒ…æˆ exe æ–‡ä»¶</h2><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs nix"><span class="hljs-comment"># 1. å®‰è£…æ‰“åŒ…å·¥å…·</span><br>pip install pyinstaller<br><br><br><span class="hljs-comment"># 2. æ‰“åŒ…æˆ exe æ–‡ä»¶</span><br>pyinstaller <span class="hljs-operator">-</span>-onefile <span class="hljs-operator">-</span>-windowed <span class="hljs-operator">-</span>-icon<span class="hljs-operator">=</span><span class="hljs-string">&quot;D:<span class="hljs-char escape_">\æ–‡</span>ä»¶é›†åˆ<span class="hljs-char escape_">\I</span>CO<span class="hljs-char escape_">\O</span>bsidian å›¾ç‰‡æ’åºä¸é‡å‘½å.ico&quot;</span> <span class="hljs-operator">-</span>-distpath <span class="hljs-string">&quot;D:<span class="hljs-char escape_">\æ–‡</span>ä»¶é›†åˆ&quot;</span> <span class="hljs-string">&quot;D:<span class="hljs-char escape_">\æ–‡</span>ä»¶é›†åˆ<span class="hljs-char escape_">\O</span>bsidian å›¾ç‰‡æ’åºä¸é‡å‘½å.py&quot;</span><br><span class="hljs-string">&quot;&quot;</span><span class="hljs-string">&quot;</span><br><span class="hljs-string">1. --onefile</span><br><span class="hljs-string">1. æ‰“åŒ…ä¸ºå•ä¸ª .exe æ–‡ä»¶ã€‚</span><br><span class="hljs-string">2. --windowed</span><br><span class="hljs-string">1. ç¡®ä¿ GUI ç¨‹åºæ— æ§åˆ¶å°çª—å£</span><br><span class="hljs-string">3. --distpath &quot;</span>D:\æ–‡ä»¶é›†åˆ\<span class="hljs-string">&quot;  &quot;</span>D:\æ–‡ä»¶é›†åˆ\Obsidian å›¾ç‰‡æ’åºä¸é‡å‘½å.py<span class="hljs-string">&quot;</span><br><span class="hljs-string">1. D:<span class="hljs-char escape_">\æ–‡</span>ä»¶é›†åˆ<span class="hljs-char escape_">\ </span>æ˜¯è¾“å‡ºä½ç½®</span><br><span class="hljs-string">2. D:<span class="hljs-char escape_">\æ–‡</span>ä»¶é›†åˆ<span class="hljs-char escape_">\O</span>bsidian å›¾ç‰‡æ’åºä¸é‡å‘½å.py æ˜¯è¾“å…¥ä½ç½®</span><br><span class="hljs-string">&quot;</span><span class="hljs-string">&quot;&quot;</span><br></code></pre></td></tr></table></figure><hr>]]></content>
    
    
    <categories>
      
      <category>å·¥å…·</category>
      
      <category>Obsidian å›¾ç‰‡æ’åºä¸é‡å‘½å</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>ç¬”è®°ï¼šJava å¼‚å¸¸</title>
    <link href="/2025/12/14/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E5%BC%82%E5%B8%B8/"/>
    <url>/2025/12/14/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E5%BC%82%E5%B8%B8/</url>
    
    <content type="html"><![CDATA[<h1 id="ä¸€ã€TODO"><a href="#ä¸€ã€TODO" class="headerlink" title="ä¸€ã€TODO"></a>ä¸€ã€TODO</h1><hr><h1 id="äºŒã€è„‘å›¾"><a href="#äºŒã€è„‘å›¾" class="headerlink" title="äºŒã€è„‘å›¾"></a>äºŒã€è„‘å›¾</h1><ol><li><p>Xmind</p></li><li><p>Edraw<br><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E5%BC%82%E5%B8%B8/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E5%BC%82%E5%B8%B8.eddx"></p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/12/14/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E5%BC%82%E5%B8%B8/">http://blog.wangjia.ink/2025/12/14/ç¬”è®°ï¼šJavaå¼‚å¸¸/</a></p></li><li><p>ä»£ç æ´ªè’ï¼ˆé¢è¯•å®å…¸ï¼‰<br>ğŸ‘‰ <a href="https://www.notion.so/Java-2c9974fbda5e809ea776fbd12f9718e8?source=copy_link">https://www.notion.so/Java-2c9974fbda5e809ea776fbd12f9718e8?source=copy_link</a></p></li></ol><hr><h1 id="ä¸‰ã€Java-å¼‚å¸¸åŸºç¡€"><a href="#ä¸‰ã€Java-å¼‚å¸¸åŸºç¡€" class="headerlink" title="ä¸‰ã€Java å¼‚å¸¸åŸºç¡€"></a>ä¸‰ã€Java å¼‚å¸¸åŸºç¡€</h1><h2 id="1-Java-å¼‚å¸¸åŸºç¡€ä½“ç³»"><a href="#1-Java-å¼‚å¸¸åŸºç¡€ä½“ç³»" class="headerlink" title="1. Java å¼‚å¸¸åŸºç¡€ä½“ç³»"></a>1. Java å¼‚å¸¸åŸºç¡€ä½“ç³»</h2><p><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E5%BC%82%E5%B8%B8/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E5%BC%82%E5%B8%B8.png"></p><hr><h2 id="2-Java-å¼‚å¸¸ç›¸å…³åˆ†ç±»"><a href="#2-Java-å¼‚å¸¸ç›¸å…³åˆ†ç±»" class="headerlink" title="2. Java å¼‚å¸¸ç›¸å…³åˆ†ç±»"></a>2. Java å¼‚å¸¸ç›¸å…³åˆ†ç±»</h2><ol><li>é”™è¯¯</li><li>å¼‚å¸¸<ol><li>å—æ£€å¼‚å¸¸</li><li>éå—æ£€å¼‚å¸¸</li></ol></li></ol><h3 id="2-1-é”™è¯¯"><a href="#2-1-é”™è¯¯" class="headerlink" title="2.1. é”™è¯¯"></a>2.1. é”™è¯¯</h3><p>é”™è¯¯æ˜¯æŒ‡ï¼š<code>Error</code> æ™®é€šç±»åŠå…¶å­ç±»ã€‚é”™è¯¯è¡¨ç¤ºä¸¥é‡çš„ã€é€šå¸¸æ˜¯ä¸å¯æ¢å¤çš„ç³»ç»Ÿçº§é—®é¢˜ï¼Œè¿™äº›é—®é¢˜é€šå¸¸å‘ç”Ÿåœ¨ <code>JVM</code> å†…éƒ¨ï¼Œåº”ç”¨ç¨‹åºé€šå¸¸æ— æ³•è‡ªè¡Œæ¢å¤</p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>æˆ‘ä»¬ä¸åº”è¯¥åœ¨æ–¹æ³•ä¸­æŠ›å‡ºæŸé”™è¯¯æˆ–æ•è·å¹¶å¤„ç†æŸé”™è¯¯</li></ol></blockquote><hr><h3 id="2-2-å¼‚å¸¸"><a href="#2-2-å¼‚å¸¸" class="headerlink" title="2.2. å¼‚å¸¸"></a>2.2. å¼‚å¸¸</h3><h4 id="2-2-1-å¼‚å¸¸ç›¸å…³åˆ†ç±»"><a href="#2-2-1-å¼‚å¸¸ç›¸å…³åˆ†ç±»" class="headerlink" title="2.2.1. å¼‚å¸¸ç›¸å…³åˆ†ç±»"></a>2.2.1. å¼‚å¸¸ç›¸å…³åˆ†ç±»</h4><ol><li>å—æ£€å¼‚å¸¸</li><li>éå—æ£€å¼‚å¸¸</li></ol><hr><h4 id="2-2-2-å—æ£€å¼‚å¸¸"><a href="#2-2-2-å—æ£€å¼‚å¸¸" class="headerlink" title="2.2.2. å—æ£€å¼‚å¸¸"></a>2.2.2. å—æ£€å¼‚å¸¸</h4><h5 id="2-2-2-1-å—æ£€å¼‚å¸¸æ¦‚è¿°"><a href="#2-2-2-1-å—æ£€å¼‚å¸¸æ¦‚è¿°" class="headerlink" title="2.2.2.1. å—æ£€å¼‚å¸¸æ¦‚è¿°"></a>2.2.2.1. å—æ£€å¼‚å¸¸æ¦‚è¿°</h5><p>å—æ£€å¼‚å¸¸æ˜¯æŒ‡ï¼š<code>Exception</code> æ™®é€šç±»åŠå…¶å­ç±»ï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼šä¸èƒ½æ˜¯ <code>RuntimeException</code> æ™®é€šç±»åŠå…¶å­ç±»ï¼‰ã€‚å—æ£€å¼‚å¸¸è¡¨ç¤ºå¯æ¢å¤çš„ã€å¤–éƒ¨çš„é—®é¢˜ï¼ˆä¾‹å¦‚æ–‡ä»¶è¯»å†™é—®é¢˜ã€æ•°æ®åº“é—®é¢˜ç­‰ï¼‰</p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>å¦‚æœåœ¨æŸæ–¹æ³•ä¸­æŠ›å‡ºæŸå—æ£€å¼‚å¸¸ï¼Œç¼–è¯‘å™¨ä¼šå¼ºåˆ¶æˆ‘ä»¬å¿…é¡»å¤„ç†è¿™ä¸ªå¼‚å¸¸</li></ol></blockquote><hr><h5 id="2-2-2-2-å—æ£€å¼‚å¸¸å¤„ç†æ–¹å¼"><a href="#2-2-2-2-å—æ£€å¼‚å¸¸å¤„ç†æ–¹å¼" class="headerlink" title="2.2.2.2. å—æ£€å¼‚å¸¸å¤„ç†æ–¹å¼"></a>2.2.2.2. å—æ£€å¼‚å¸¸å¤„ç†æ–¹å¼</h5><p>å¦‚æœåœ¨æŸæ–¹æ³•ä¸­æŠ›å‡ºæŸå—æ£€å¼‚å¸¸ï¼Œç¼–è¯‘å™¨ä¼šå¼ºåˆ¶æˆ‘ä»¬å¿…é¡»å¤„ç†è¿™ä¸ªå¼‚å¸¸ã€‚å¤„ç†çš„æ–¹å¼åŒ…æ‹¬ï¼š</p><ol><li>å£°æ˜æŠ›å‡ºå¼‚å¸¸</li><li>æ•è·å¹¶å¤„ç†å¼‚å¸¸</li></ol><h6 id="2-2-2-2-1-å£°æ˜æŠ›å‡ºå¼‚å¸¸"><a href="#2-2-2-2-1-å£°æ˜æŠ›å‡ºå¼‚å¸¸" class="headerlink" title="2.2.2.2.1. å£°æ˜æŠ›å‡ºå¼‚å¸¸"></a>2.2.2.2.1. å£°æ˜æŠ›å‡ºå¼‚å¸¸</h6><p>å£°æ˜æŠ›å‡ºå¼‚å¸¸æ˜¯æŒ‡ï¼šåœ¨æ–¹æ³•ä¸­å¹¶ä¸ä¼šæ•è·å¹¶å¤„ç†è¯¥å¼‚å¸¸ï¼Œè€Œæ˜¯ç»§ç»­å‘ä¸ŠæŠ›å‡ºå¼‚å¸¸ï¼Œè®©è°ƒç”¨è¯¥æ–¹æ³•çš„æ–¹æ³•ï¼ˆæœ¯è¯­æ˜¯ï¼šè°ƒç”¨æ–¹ï¼‰å»å¤„ç†è¿™ä¸ªå—æ£€å¼‚å¸¸ã€‚è°ƒç”¨æ–¹åœ¨å¤„ç†è¿™ä¸ªå—æ£€å¼‚å¸¸æ—¶ï¼Œæ—¢å¯ä»¥å£°æ˜æŠ›å‡ºå¼‚å¸¸ï¼Œåˆå¯ä»¥æ•è·å¹¶å¤„ç†å¼‚å¸¸</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IOException</span>(<span class="hljs-string">&quot;...&quot;</span>);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li><code>throws</code> ç”¨äºå£°æ˜è¯¥æ–¹æ³•å¯èƒ½æŠ›å‡ºçš„å¼‚å¸¸ï¼Œå‘ŠçŸ¥è°ƒç”¨æ–¹éœ€è¦å¤„ç†è¿™äº›å¼‚å¸¸ï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼š<code>throws</code> å¯ä»¥ç”¨äºå£°æ˜è¯¥æ–¹æ³•å¯èƒ½æŠ›å‡ºçš„éå—æ£€å¼‚å¸¸ï¼Œä½†æ˜¯æ²¡å¿…è¦ï¼‰</li><li><code>Java</code> æœ‰ä¸€ä¸ªè§„å®šï¼šå½“ä½ é‡å†™æŸæ–¹æ³•æ—¶ï¼Œä½ ä¸èƒ½åœ¨æ–¹æ³•ä¸­æŠ›å‡ºåŸæ–¹æ³•æœªå£°æ˜æŠ›å‡ºçš„å—æ£€å¼‚å¸¸<ol><li>éœ€è¦æ³¨æ„çš„æ˜¯ï¼š<ol><li>è¿™ä¸ªè§„å®šåªé’ˆå¯¹å—æ£€å¼‚å¸¸ï¼Œä¸é’ˆå¯¹éå—æ£€å¼‚å¸¸</li><li>ä½ é‡å†™æ¥å£ä¸­çš„æ¥å£æ–¹æ³•ï¼Œä¹Ÿæ˜¯åœ¨é‡å†™æŸæ–¹æ³•</li><li>è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆ <code>Runnable</code> ä»»åŠ¡ä¸èƒ½æŠ›å‡ºå—æ£€å¼‚å¸¸çš„åŸå› </li></ol></li></ol></li></ol></blockquote><hr><h6 id="2-2-2-2-2-æ•è·å¹¶å¤„ç†å¼‚å¸¸"><a href="#2-2-2-2-2-æ•è·å¹¶å¤„ç†å¼‚å¸¸" class="headerlink" title="2.2.2.2.2. æ•è·å¹¶å¤„ç†å¼‚å¸¸"></a>2.2.2.2.2. æ•è·å¹¶å¤„ç†å¼‚å¸¸</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IOException</span>(<span class="hljs-string">&quot;...&quot;</span>);<br>        &#125;<span class="hljs-keyword">catch</span> (IOException e) &#123;<br>            System.out.println(<span class="hljs-string">&quot;...&quot;</span>);<br>        &#125;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œæˆ‘ä»¬åœ¨ <code>catch</code> å—ä¸­ç¼–å†™çš„å¤„ç†å¼‚å¸¸çš„ <code>Java</code> ä»£ç ï¼Œå…¶å®æ˜¯ä¸€ç§ â€œåå™¬å¼‚å¸¸â€ çš„è¡Œä¸ºï¼Œæ˜¯éå¸¸åçš„ä¹ æƒ¯ï¼Œå› ä¸ºæˆ‘ä»¬å¯èƒ½æ°¸è¿œæ— æ³•çŸ¥é“è¿™ä¸ªå¼‚å¸¸çš„å­˜åœ¨ã€‚æ­£ç¡®çš„åšæ³•æ˜¯å°†å…¶æ”¶é›†åˆ°æ—¥å¿—ç³»ç»Ÿï¼Œå¯åŠ¨å‘Šè­¦æœºåˆ¶ï¼Œå¼€å‘äººå‘˜å‘ç°ååŠæ—¶ä¿®å¤</li></ol></blockquote><hr><h4 id="2-2-3-éå—æ£€å¼‚å¸¸"><a href="#2-2-3-éå—æ£€å¼‚å¸¸" class="headerlink" title="2.2.3. éå—æ£€å¼‚å¸¸"></a>2.2.3. éå—æ£€å¼‚å¸¸</h4><h5 id="2-2-3-1-éå—æ£€å¼‚å¸¸æ¦‚è¿°"><a href="#2-2-3-1-éå—æ£€å¼‚å¸¸æ¦‚è¿°" class="headerlink" title="2.2.3.1. éå—æ£€å¼‚å¸¸æ¦‚è¿°"></a>2.2.3.1. éå—æ£€å¼‚å¸¸æ¦‚è¿°</h5><p>éå—æ£€å¼‚å¸¸ï¼ˆè¿è¡Œæ—¶å¼‚å¸¸ï¼‰æ˜¯æŒ‡ï¼š<code>RuntimeException</code> æ™®é€šç±»åŠå…¶å­ç±»çš„ç±»ã€‚éå—æ£€å¼‚å¸¸è¡¨ç¤ºç¨‹åºå†…éƒ¨çš„é€»è¾‘é”™è¯¯ï¼ˆå³ <code>Bug</code>ï¼‰</p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>å¦‚æœåœ¨æŸæ–¹æ³•ä¸­æŠ›å‡ºéå—æ£€å¼‚å¸¸ï¼Œç¼–è¯‘å™¨å¹¶ä¸ä¼šå¼ºåˆ¶æˆ‘ä»¬å¿…é¡»å¤„ç†è¿™ä¸ªå¼‚å¸¸</li><li>ä¸€äº›å†…ç½®çš„éå—æ£€å¼‚å¸¸ï¼Œå³ä¾¿æˆ‘ä»¬å¹¶æ²¡æœ‰åœ¨æ–¹æ³•ä¸­æŠ›å‡ºå®ƒä»¬ï¼Œä½†æ˜¯ä¹Ÿæœ‰å¯èƒ½æŠ›å‡ºè¿™ä¸ªå¼‚å¸¸ï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼šå—æ£€å¼‚å¸¸å¹¶ä¸ä¼šè¿™æ ·ï¼‰</li></ol></blockquote><hr><h2 id="3-Java-å¼‚å¸¸ç»„æˆéƒ¨åˆ†"><a href="#3-Java-å¼‚å¸¸ç»„æˆéƒ¨åˆ†" class="headerlink" title="3. Java å¼‚å¸¸ç»„æˆéƒ¨åˆ†"></a>3. Java å¼‚å¸¸ç»„æˆéƒ¨åˆ†</h2><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <br>  <span class="hljs-comment">// Throwable-&gt;detailMessage</span><br>  <span class="hljs-attr">&quot;detailMessage&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;å¼‚å¸¸ä¿¡æ¯...&quot;</span><span class="hljs-punctuation">,</span>   <br>  <br>  <span class="hljs-comment">// Throwable-&gt;StackTrace</span><br>  <span class="hljs-attr">&quot;stackTrace&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span> <br>    <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;declaringClass&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;com.example.Service&quot;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;methodName&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;myServiceMethod&quot;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;fileName&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Service.java&quot;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;lineNumber&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">15</span><br>    <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;declaringClass&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;com.example.Controller&quot;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;methodName&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;myControllerMethod&quot;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;fileName&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Controller.java&quot;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;lineNumber&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">30</span><br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>  <br>  <span class="hljs-comment">// Throwable-&gt;cause</span><br>  <span class="hljs-attr">&quot;cause&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span> <br>     <span class="hljs-attr">&quot;detailMessage&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;åŸå§‹å¼‚å¸¸çš„å¼‚å¸¸ä¿¡æ¯...&quot;</span><span class="hljs-punctuation">,</span><br>     <span class="hljs-attr">&quot;stackTrace&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>        <span class="hljs-punctuation">&#123;</span><br>           <span class="hljs-attr">&quot;declaringClass&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;com.example.Dao&quot;</span><span class="hljs-punctuation">,</span><br>           <span class="hljs-attr">&quot;methodName&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;myDaoMethod&quot;</span><span class="hljs-punctuation">,</span><br>           <span class="hljs-attr">&quot;fileName&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Dao.java&quot;</span><span class="hljs-punctuation">,</span><br>           <span class="hljs-attr">&quot;lineNumber&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">88</span><br>        <span class="hljs-punctuation">&#125;</span><br>     <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>     <span class="hljs-attr">&quot;suppressedExceptions&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">]</span><br>  <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>  <br>  <span class="hljs-comment">// Throwable-&gt;suppressedExceptions</span><br>  <span class="hljs-comment">//</span><br>  <span class="hljs-comment">// åœ¨æ•è·å¹¶å¤„ç†è¯¥å¼‚å¸¸æ—¶ï¼Œå¦‚æœåˆæŠ›å‡ºäº†å…¶ä»–å¼‚å¸¸ï¼Œè¿™äº›å¼‚å¸¸å°±ä¼šè¢« â€œå¢â€ åˆ°è¿™é‡Œï¼Œé˜²æ­¢ä¸¢å¤±ï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼šé€šå¸¸åœ¨ä½¿ç”¨ try-with-resources è¯­æ³•ç³–æ—¶æ‰ä¼šå‡ºç°è¿™ç§æƒ…å†µï¼‰</span><br>  <span class="hljs-attr">&quot;suppressedExceptions&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">]</span><br>  <br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><hr><h2 id="4-Java-å¼‚å¸¸é“¾"><a href="#4-Java-å¼‚å¸¸é“¾" class="headerlink" title="4. Java å¼‚å¸¸é“¾"></a>4. Java å¼‚å¸¸é“¾</h2><p><code>Java</code> å¼‚å¸¸é“¾æ˜¯æŒ‡ï¼šå½“æ•è·å¹¶å¤„ç†ä¸€ä¸ªå¼‚å¸¸æ—¶ï¼Œä¼šæŠ›å‡ºä¸€ä¸ªæ–°å¼‚å¸¸ï¼Œå¹¶å°†è¢«å¤„ç†çš„å¼‚å¸¸ï¼ˆæœ¯è¯­æ˜¯ï¼šåŸå§‹å¼‚å¸¸ï¼‰ä½œä¸ºæ–°å¼‚å¸¸çš„æ„é€ æ–¹æ³•å‚æ•°ï¼ˆå³ä½œä¸ºæ–°å¼‚å¸¸çš„ <code>Throwable-&gt;cause</code>ï¼‰ä¼ é€’è¿›å»</p><p>åœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šåœ¨æ•è·å¹¶å¤„ç†ä¸€ä¸ªä½å±‚å¼‚å¸¸æ—¶ï¼ŒæŠ›å‡ºä¸€ä¸ªé«˜å±‚ä¸”è´´è¿‘ä¸šåŠ¡çš„å¼‚å¸¸ï¼ˆä¾‹å¦‚åœ¨ä¸‰å±‚æ¶æ„ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ <code>DAO</code> å±‚æŠ›å‡ºä¸€ä¸ªä½å±‚å¼‚å¸¸ï¼Œåœ¨ <code>Serivice</code> å±‚æ•è·å¹¶å¤„ç†è¿™ä¸ªä½å±‚å¼‚å¸¸ï¼ŒæŠ›å‡ºä¸€ä¸ªé«˜å±‚ä¸”è´´è¿‘ä¸šåŠ¡çš„å¼‚å¸¸ï¼Œåœ¨ <code>Controller</code> å±‚æ•è·å¹¶å¤„ç†è¿™ä¸ªé«˜å±‚ä¸”è´´è¿‘ä¸šåŠ¡çš„å¼‚å¸¸ï¼Œå¹¶æŠŠè¯¥å¼‚å¸¸çš„å¼‚å¸¸ä¿¡æ¯è¿”å›ç»™å®¢æˆ·ç«¯ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// DAO å±‚</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserDao</span> &#123;<br>    <br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">findUserById</span><span class="hljs-params">(<span class="hljs-type">long</span> id)</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IOException</span>(<span class="hljs-string">&quot;...&quot;</span>);<br>    &#125;<br>    <br>&#125;<br><br><span class="hljs-comment">// Service å±‚</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserService</span> &#123;<br>    <br>    <span class="hljs-keyword">private</span> <span class="hljs-type">UserDao</span> <span class="hljs-variable">userDao</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserDao</span>();<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getUserName</span><span class="hljs-params">(<span class="hljs-type">long</span> id)</span> &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-keyword">return</span> userDao.findUserById(id);<br>        &#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserQueryException</span>(<span class="hljs-string">&quot;...&quot;</span>, e);<br>        &#125;<br>    &#125;<br>    <br>&#125;<br><br><span class="hljs-comment">// Controller å±‚</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserController</span> &#123;<br>    <br>    <span class="hljs-keyword">private</span> <span class="hljs-type">UserService</span> <span class="hljs-variable">userService</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserService</span>();<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">getUserProfile</span><span class="hljs-params">(<span class="hljs-type">long</span> id)</span> &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-type">String</span> <span class="hljs-variable">userName</span> <span class="hljs-operator">=</span> userService.getUserName(id);<br>            System.out.println(<span class="hljs-string">&quot;...&quot;</span>);<br>        &#125; <span class="hljs-keyword">catch</span> (UserQueryException e) &#123;<br>        <span class="hljs-comment">// ...</span><br>        &#125;<br>    &#125;<br>    <br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>æˆ‘ä»¬åœ¨ä½¿ç”¨ <code>Java</code> å¼‚å¸¸é“¾æ—¶ï¼Œä¸€å®šè¦ä¿ç•™åŸå§‹å¼‚å¸¸ï¼ˆå³è¢«å¤„ç†çš„å¼‚å¸¸ï¼‰ï¼Œæ–¹ä¾¿åç»­æ’æŸ¥ï¼ˆå› ä¸ºæˆ‘ä»¬éœ€è¦é€šè¿‡åŸå§‹å¼‚å¸¸çš„å †æ ˆä¿¡æ¯æ¥è¿½æº¯å¼‚å¸¸é“¾å‡ºç°çš„æ ¹æœ¬åŸå› ï¼‰</li></ol></blockquote><hr><h2 id="5-try-catch-finally-è¯­å¥"><a href="#5-try-catch-finally-è¯­å¥" class="headerlink" title="5. try-catch-finally è¯­å¥"></a>5. try-catch-finally è¯­å¥</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">try</span>() &#123;<br>log.info(<span class="hljs-string">&quot;...&quot;</span>);<br>&#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>log.info(<span class="hljs-string">&quot;...&quot;</span>);<br>&#125; <span class="hljs-keyword">finally</span> &#123;<br>log.info(<span class="hljs-string">&quot;...&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>çŒ´å“¥çš„çƒ¦æ¼ç®± <code>(ï½¡â€¢Ìï¸¿â€¢Ì€ï½¡)</code>ï¼š<ol><li>åœ¨ <code>try-catch-finally</code> è¯­å¥ä¸­ï¼Œå¦‚æœçº¿ç¨‹åœ¨æ‰§è¡Œ <code>catch</code> å—æ—¶ <code>return</code> äº†ï¼Œé‚£ä¹ˆçº¿ç¨‹è¿˜ä¼šæ‰§è¡Œ <code>finally</code> å—å—ï¼Ÿ<ol><li>ä¼šæ‰§è¡Œ</li></ol></li><li>åœ¨ <code>try-catch-finally</code> è¯­å¥ä¸­ï¼Œå¦‚æœåœ¨ <code>finally</code> å—ä¸­ä¹Ÿæœ‰ <code>return</code>ï¼Œé‚£ä¹ˆ <code>try-catch-finally</code> è¯­å¥ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ<ol><li><code>finally</code> å—ä¸­çš„ <code>return</code> ä¼šè¦†ç›– <code>try</code> å—å’Œ <code>catch</code> å—ä¸­çš„ <code>return</code></li></ol></li></ol></li></ol></blockquote><hr><h2 id="6-try-with-resources-è¯­æ³•ç³–"><a href="#6-try-with-resources-è¯­æ³•ç³–" class="headerlink" title="6. try-with-resources è¯­æ³•ç³–"></a>6. try-with-resources è¯­æ³•ç³–</h2><p>è¯¦è§æºç ï¼š<code>AutoCloseable</code></p><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.AutoCloseable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.lang.AutoCloseableæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/10/10/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.AutoCloseable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/10/10/æºç ï¼šjava.lang.AutoCloseableæºç è§£æ/</a></li></ol></li></ol><hr>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
      <category>Java å¼‚å¸¸</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>å½±è§†</title>
    <link href="/2025/12/13/%E5%BD%B1%E8%A7%86/"/>
    <url>/2025/12/13/%E5%BD%B1%E8%A7%86/</url>
    
    <content type="html"><![CDATA[<h2 id="ç”µè§†å‰§"><a href="#ç”µè§†å‰§" class="headerlink" title="ç”µè§†å‰§"></a>ç”µè§†å‰§</h2><ol><li>äº®å‰‘</li><li>è€ä¹é—¨</li><li>ç‰¹è­¦åŠ›é‡</li><li>æ­¦æ—å¤–ä¼ </li><li>æ— å¿ƒæ³•å¸ˆ</li><li>è·¯ä»ä»Šå¤œç™½</li><li>å°ç¥è‹±é›„ä¼ </li></ol>]]></content>
    
    
    <categories>
      
      <category>å½±è§†</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>åè¨€</title>
    <link href="/2025/12/11/%E5%90%8D%E8%A8%80/"/>
    <url>/2025/12/11/%E5%90%8D%E8%A8%80/</url>
    
    <content type="html"><![CDATA[<ol><li>è™½ä¸ä¸­äº¦ä¸è¿œçŸ£</li><li>æŠŠä¹¦è¯»åšäº†ï¼Œå†æŠŠä¹¦è¯»è–„äº†</li><li>å¤©ä¸‹è´¤æ‰å°½æ•°ä¼šäºéº¾ä¸‹</li><li>å¤©ä¸‹è´¤æ‰å°½æ•°å¬ä»¤è€ŒåŠ¨</li></ol>]]></content>
    
    
    <categories>
      
      <category>åè¨€</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>å·¥å…·ï¼šå¿«æ·è¯­æ–™ç®¡ç†</title>
    <link href="/2025/12/11/%E5%B7%A5%E5%85%B7%EF%BC%9A%E5%BF%AB%E6%8D%B7%E8%AF%AD%E6%96%99%E7%AE%A1%E7%90%86/"/>
    <url>/2025/12/11/%E5%B7%A5%E5%85%B7%EF%BC%9A%E5%BF%AB%E6%8D%B7%E8%AF%AD%E6%96%99%E7%AE%A1%E7%90%86/</url>
    
    <content type="html"><![CDATA[<h2 id="1-Py-ä»£ç "><a href="#1-Py-ä»£ç " class="headerlink" title="1. Py ä»£ç "></a>1. Py ä»£ç </h2><p><font color="#92d050">1. å®‰è£…ç›¸å…³ä¾èµ–</font></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">pip install keyboard  pyperclip pyautogui PyQt6 -<span class="hljs-selector-tag">i</span> https:<span class="hljs-comment">//pypi.tuna.tsinghua.edu.cn/simple</span><br></code></pre></td></tr></table></figure><p><font color="#92d050">2. ç¼–å†™ Py ä»£ç </font></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> keyboard<br><span class="hljs-keyword">import</span> pyperclip<br><span class="hljs-keyword">import</span> pyautogui<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> PyQt6.QtWidgets <span class="hljs-keyword">import</span> (QApplication, QMainWindow, QWidget, QVBoxLayout,<br>                             QHBoxLayout, QListWidget, QPushButton, QLabel,<br>                             QDialog, QMessageBox, QInputDialog, QGridLayout,<br>                             QFrame, QSizePolicy, QGraphicsDropShadowEffect, QLineEdit, QTextEdit,<br>                             QAbstractItemView)<br><span class="hljs-keyword">from</span> PyQt6.QtCore <span class="hljs-keyword">import</span> Qt, pyqtSignal, QObject<br><span class="hljs-keyword">from</span> PyQt6.QtGui <span class="hljs-keyword">import</span> QColor, QFont, QCursor, QScreen<br><span class="hljs-comment"># --- æ•°æ®å­˜å‚¨ ---</span><br>DEFAULT_DATA_FILE = <span class="hljs-string">r&quot;D:\æ–‡ä»¶é›†åˆ\å¿«æ·è¯­æ–™ç®¡ç†.json&quot;</span><br>DATA_FILE = DEFAULT_DATA_FILE  <span class="hljs-comment"># å¯ä»¥è‡ªå®šä¹‰ä¿®æ”¹æ­¤å˜é‡</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">load_data</span>():<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(DATA_FILE):<br>        <span class="hljs-comment"># å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ›å»ºé»˜è®¤æ•°æ®</span><br>        default_data = &#123;<span class="hljs-string">&quot;å¸¸ç”¨å›å¤&quot;</span>: [<span class="hljs-string">&quot;ä½ å¥½ï¼Œè¯·é—®æœ‰ä»€ä¹ˆå¯ä»¥å¸®æ‚¨ï¼Ÿ&quot;</span>, <span class="hljs-string">&quot;å½“å‰è¿›åº¦ï¼š&#123;0% | 50% | 100%&#125;&quot;</span>],<br>                        <span class="hljs-string">&quot;ä»£ç ç‰‡æ®µ&quot;</span>: [<span class="hljs-string">&quot;print(f&#x27;ç»“æœæ˜¯: &#123;result&#125;&#x27;)&quot;</span>, <span class="hljs-string">&quot;SELECT * FROM &#123;table&#125; WHERE id = &#123;id&#125;&quot;</span>]&#125;<br>        save_data(default_data)<br>        <span class="hljs-keyword">return</span> default_data<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(DATA_FILE, <span class="hljs-string">&quot;r&quot;</span>, encoding=<span class="hljs-string">&quot;utf-8&quot;</span>) <span class="hljs-keyword">as</span> f:<br>            <span class="hljs-keyword">return</span> json.load(f)<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;åŠ è½½æ•°æ®å¤±è´¥: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">return</span> &#123;<span class="hljs-string">&quot;å¸¸ç”¨å›å¤&quot;</span>: [], <span class="hljs-string">&quot;ä»£ç ç‰‡æ®µ&quot;</span>: []&#125;<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">save_data</span>(<span class="hljs-params">data</span>):<br>    <span class="hljs-keyword">try</span>:<br>        os.makedirs(os.path.dirname(DATA_FILE), exist_ok=<span class="hljs-literal">True</span>)<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(DATA_FILE, <span class="hljs-string">&quot;w&quot;</span>, encoding=<span class="hljs-string">&quot;utf-8&quot;</span>) <span class="hljs-keyword">as</span> f:<br>            json.dump(data, f, ensure_ascii=<span class="hljs-literal">False</span>, indent=<span class="hljs-number">4</span>)<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;ä¿å­˜æ•°æ®å¤±è´¥: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br><span class="hljs-comment"># --- å…¨å±€æ ·å¼è¡¨ (QSS) ---</span><br><span class="hljs-comment"># è¿™æ˜¯ä¸€ä¸ªç°ä»£æ·±è‰²ä¸»é¢˜çš„ CSS é…ç½®</span><br>STYLESHEET = <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">QMainWindow, QDialog &#123;</span><br><span class="hljs-string">    background-color: #1e1e1e;</span><br><span class="hljs-string">    color: #e0e0e0;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">/* åˆ—è¡¨æ§ä»¶æ ·å¼ */</span><br><span class="hljs-string">QListWidget &#123;</span><br><span class="hljs-string">    background-color: #252526;</span><br><span class="hljs-string">    border: 1px solid #3e3e42;</span><br><span class="hljs-string">    border-radius: 6px;</span><br><span class="hljs-string">    padding: 5px;</span><br><span class="hljs-string">    outline: none;</span><br><span class="hljs-string">    font-size: 14px;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">QListWidget::item &#123;</span><br><span class="hljs-string">    padding: 8px;</span><br><span class="hljs-string">    border-radius: 4px;</span><br><span class="hljs-string">    color: #cccccc;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">QListWidget::item:selected &#123;</span><br><span class="hljs-string">    background-color: #37373d;</span><br><span class="hljs-string">    color: #ffffff;</span><br><span class="hljs-string">    border-left: 3px solid #007acc; /* é€‰ä¸­æ—¶å·¦ä¾§è“è‰²æ¡ */</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">QListWidget::item:hover &#123;</span><br><span class="hljs-string">    background-color: #2a2d2e;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">/* æŒ‰é’®é€šç”¨æ ·å¼ */</span><br><span class="hljs-string">QPushButton &#123;</span><br><span class="hljs-string">    background-color: #333333;</span><br><span class="hljs-string">    color: #ffffff;</span><br><span class="hljs-string">    border: 1px solid #454545;</span><br><span class="hljs-string">    padding: 6px 12px;</span><br><span class="hljs-string">    border-radius: 4px;</span><br><span class="hljs-string">    font-size: 13px;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">QPushButton:hover &#123;</span><br><span class="hljs-string">    background-color: #3e3e42;</span><br><span class="hljs-string">    border-color: #555;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">QPushButton:pressed &#123;</span><br><span class="hljs-string">    background-color: #2d2d30;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">/* è“è‰²å¼ºè°ƒæŒ‰é’® (ç”¨äºä¸»è¦æ“ä½œ) */</span><br><span class="hljs-string">QPushButton.primary &#123;</span><br><span class="hljs-string">    background-color: #007acc;</span><br><span class="hljs-string">    border: 1px solid #007acc;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">QPushButton.primary:hover &#123;</span><br><span class="hljs-string">    background-color: #0062a3;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">/* æ ‡ç­¾æ ·å¼ */</span><br><span class="hljs-string">QLabel &#123;</span><br><span class="hljs-string">    color: #cccccc;</span><br><span class="hljs-string">    font-family: &quot;Segoe UI&quot;, &quot;Microsoft YaHei&quot;, sans-serif;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">QLabel.header &#123;</span><br><span class="hljs-string">    font-size: 16px;</span><br><span class="hljs-string">    font-weight: bold;</span><br><span class="hljs-string">    color: #ffffff;</span><br><span class="hljs-string">    margin-bottom: 5px;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">QLabel.hint &#123;</span><br><span class="hljs-string">    color: #888888;</span><br><span class="hljs-string">    font-size: 12px;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">/* å¿«æ·çª—å£è¾“å…¥æ¡†é£æ ¼ */</span><br><span class="hljs-string">QDialog#QuickSelector &#123;</span><br><span class="hljs-string">    border: 1px solid #454545;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">QLineEdit &#123;</span><br><span class="hljs-string">    background-color: #252526;</span><br><span class="hljs-string">    border: 1px solid #3e3e42;</span><br><span class="hljs-string">    border-radius: 4px;</span><br><span class="hljs-string">    padding: 6px;</span><br><span class="hljs-string">    color: #e0e0e0;</span><br><span class="hljs-string">    font-size: 14px;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">QLineEdit:focus &#123;</span><br><span class="hljs-string">    border-color: #007acc;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">QTextEdit &#123;</span><br><span class="hljs-string">    background-color: #252526;</span><br><span class="hljs-string">    border: 1px solid #3e3e42;</span><br><span class="hljs-string">    border-radius: 4px;</span><br><span class="hljs-string">    padding: 6px;</span><br><span class="hljs-string">    color: #e0e0e0;</span><br><span class="hljs-string">    font-size: 14px;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">QTextEdit:focus &#123;</span><br><span class="hljs-string">    border-color: #007acc;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-comment"># --- ä¿¡å·å¤„ç† ---</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">HotkeySignal</span>(<span class="hljs-title class_ inherited__">QObject</span>):<br>    trigger = pyqtSignal()<br><span class="hljs-comment"># --- è‡ªå®šä¹‰è¾“å…¥å¯¹è¯æ¡† (ç”¨äºæ‹‰é•¿æ–°å»ºè¯­å¥å¯¹è¯æ¡†) ---</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomInputDialog</span>(<span class="hljs-title class_ inherited__">QDialog</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, title, label, initial_text=<span class="hljs-string">&quot;&quot;</span>, parent=<span class="hljs-literal">None</span></span>):<br>        <span class="hljs-built_in">super</span>().__init__(parent)<br>        <span class="hljs-variable language_">self</span>.setWindowTitle(title)<br>        <span class="hljs-variable language_">self</span>.setMinimumWidth(<span class="hljs-number">600</span>)  <span class="hljs-comment"># æ‹‰é•¿å¯¹è¯æ¡†</span><br>        layout = QVBoxLayout(<span class="hljs-variable language_">self</span>)<br>        lbl = QLabel(label)<br>        layout.addWidget(lbl)<br>        <span class="hljs-variable language_">self</span>.text_edit = QTextEdit()<br>        <span class="hljs-variable language_">self</span>.text_edit.setPlainText(initial_text)<br>        <span class="hljs-variable language_">self</span>.text_edit.setMinimumHeight(<span class="hljs-number">100</span>)  <span class="hljs-comment"># å¢åŠ é«˜åº¦</span><br>        layout.addWidget(<span class="hljs-variable language_">self</span>.text_edit)<br>        buttons = QHBoxLayout()<br>        ok_btn = QPushButton(<span class="hljs-string">&quot;ç¡®å®š&quot;</span>)<br>        ok_btn.clicked.connect(<span class="hljs-variable language_">self</span>.accept)<br>        cancel_btn = QPushButton(<span class="hljs-string">&quot;å–æ¶ˆ&quot;</span>)<br>        cancel_btn.clicked.connect(<span class="hljs-variable language_">self</span>.reject)<br>        buttons.addWidget(ok_btn)<br>        buttons.addWidget(cancel_btn)<br>        layout.addLayout(buttons)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">getText</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>.text_edit.toPlainText()<br><span class="hljs-comment"># --- å¿«æ·é€‰æ‹©çª—å£ (ç±»ä¼¼ Alfred/Spotlight é£æ ¼) ---</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">QuickSelector</span>(<span class="hljs-title class_ inherited__">QDialog</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, data, parent=<span class="hljs-literal">None</span></span>):<br>        <span class="hljs-built_in">super</span>().__init__(parent)<br>        <span class="hljs-variable language_">self</span>.setObjectName(<span class="hljs-string">&quot;QuickSelector&quot;</span>) <span class="hljs-comment"># ç”¨äºQSSå®šä½</span><br>        <span class="hljs-variable language_">self</span>.data = data<br>        <span class="hljs-variable language_">self</span>.current_text = <span class="hljs-string">&quot;&quot;</span><br>        <span class="hljs-variable language_">self</span>.drag_position = <span class="hljs-literal">None</span>  <span class="hljs-comment"># ç”¨äºæ‹–æ‹½</span><br>        <span class="hljs-variable language_">self</span>.option_buttons = []  <span class="hljs-comment"># å­˜å‚¨é€‰é¡¹æŒ‰é’®</span><br>        <br>        <span class="hljs-comment"># çª—å£è®¾ç½®</span><br>        <span class="hljs-variable language_">self</span>.setWindowFlags(Qt.WindowType.FramelessWindowHint | Qt.WindowType.WindowStaysOnTopHint | Qt.WindowType.Tool)<br>        <span class="hljs-variable language_">self</span>.setAttribute(Qt.WidgetAttribute.WA_TranslucentBackground) <span class="hljs-comment"># å…è®¸åœ†è§’é€æ˜</span><br>        <span class="hljs-variable language_">self</span>.resize(<span class="hljs-number">500</span>, <span class="hljs-number">400</span>)  <span class="hljs-comment"># ç•¥å¾®å¢åŠ é«˜åº¦ä»¥å®¹çº³æœç´¢æ¡†</span><br>        <br>        <span class="hljs-comment"># ä¸»å¸ƒå±€å®¹å™¨ (ç”¨äºç»˜åˆ¶èƒŒæ™¯å’Œåœ†è§’)</span><br>        <span class="hljs-variable language_">self</span>.container = QFrame(<span class="hljs-variable language_">self</span>)<br>        <span class="hljs-variable language_">self</span>.container.setGeometry(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">500</span>, <span class="hljs-number">400</span>)<br>        <span class="hljs-variable language_">self</span>.container.setStyleSheet(<span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">            QFrame &#123;</span><br><span class="hljs-string">                background-color: #1e1e1e;</span><br><span class="hljs-string">                border: 1px solid #454545;</span><br><span class="hljs-string">                border-radius: 10px;</span><br><span class="hljs-string">            &#125;</span><br><span class="hljs-string">        &quot;&quot;&quot;</span>)<br>        <br>        <span class="hljs-comment"># æ·»åŠ é˜´å½±æ•ˆæœ</span><br>        shadow = QGraphicsDropShadowEffect(<span class="hljs-variable language_">self</span>)<br>        shadow.setBlurRadius(<span class="hljs-number">20</span>)<br>        shadow.setColor(QColor(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">150</span>))<br>        shadow.setOffset(<span class="hljs-number">0</span>, <span class="hljs-number">5</span>)<br>        <span class="hljs-variable language_">self</span>.container.setGraphicsEffect(shadow)<br>        <span class="hljs-variable language_">self</span>.layout = QVBoxLayout(<span class="hljs-variable language_">self</span>.container)<br>        <span class="hljs-variable language_">self</span>.layout.setContentsMargins(<span class="hljs-number">20</span>, <span class="hljs-number">20</span>, <span class="hljs-number">20</span>, <span class="hljs-number">20</span>)<br>        <br>        <span class="hljs-comment"># é¡¶éƒ¨æç¤ºåŒº</span><br>        <span class="hljs-variable language_">self</span>.info_label = QLabel(<span class="hljs-string">&quot;é€‰æ‹©æ¨¡å—&quot;</span>)<br>        <span class="hljs-variable language_">self</span>.info_label.setStyleSheet(<span class="hljs-string">&quot;font-size: 18px; font-weight: bold; color: #fff; border: none;&quot;</span>)<br>        <span class="hljs-variable language_">self</span>.info_label.setAlignment(Qt.AlignmentFlag.AlignCenter)<br>        <span class="hljs-variable language_">self</span>.layout.addWidget(<span class="hljs-variable language_">self</span>.info_label)<br>        <span class="hljs-comment"># åˆ†å‰²çº¿</span><br>        line = QFrame()<br>        line.setFrameShape(QFrame.Shape.HLine)<br>        line.setStyleSheet(<span class="hljs-string">&quot;background-color: #333; border: none; max-height: 1px;&quot;</span>)<br>        <span class="hljs-variable language_">self</span>.layout.addWidget(line)<br>        <br>        <span class="hljs-comment"># æœç´¢æ¡†</span><br>        <span class="hljs-variable language_">self</span>.search_edit = QLineEdit()<br>        <span class="hljs-variable language_">self</span>.search_edit.setPlaceholderText(<span class="hljs-string">&quot;æœç´¢...&quot;</span>)<br>        <span class="hljs-variable language_">self</span>.search_edit.textChanged.connect(<span class="hljs-variable language_">self</span>.filter_list)<br>        <span class="hljs-variable language_">self</span>.layout.addWidget(<span class="hljs-variable language_">self</span>.search_edit)<br>        <br>        <span class="hljs-comment"># åˆ—è¡¨æ§ä»¶</span><br>        <span class="hljs-variable language_">self</span>.list_widget = QListWidget()<br>        <span class="hljs-variable language_">self</span>.list_widget.setStyleSheet(<span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">            QListWidget &#123; border: none; background: transparent; &#125;</span><br><span class="hljs-string">            QListWidget::item &#123; padding: 10px; font-size: 15px; &#125;</span><br><span class="hljs-string">            QListWidget::item:selected &#123; background-color: #2d2d30; color: #4fc1ff; border: none; border-radius: 6px; &#125;</span><br><span class="hljs-string">        &quot;&quot;&quot;</span>)<br>        <span class="hljs-variable language_">self</span>.list_widget.itemActivated.connect(<span class="hljs-variable language_">self</span>.on_item_clicked)  <span class="hljs-comment"># Enter é”®è§¦å‘</span><br>        <span class="hljs-variable language_">self</span>.list_widget.itemClicked.connect(<span class="hljs-variable language_">self</span>.on_item_clicked)<br>        <span class="hljs-variable language_">self</span>.layout.addWidget(<span class="hljs-variable language_">self</span>.list_widget)<br>        <br>        <span class="hljs-comment"># é€‰é¡¹æŒ‰é’®åŒºåŸŸ</span><br>        <span class="hljs-variable language_">self</span>.options_container = QWidget()<br>        <span class="hljs-variable language_">self</span>.options_container.setStyleSheet(<span class="hljs-string">&quot;background: transparent; border: none;&quot;</span>)<br>        <span class="hljs-variable language_">self</span>.options_layout = QGridLayout()<br>        <span class="hljs-variable language_">self</span>.options_layout.setSpacing(<span class="hljs-number">10</span>) <span class="hljs-comment"># æŒ‰é’®é—´è·</span><br>        <span class="hljs-variable language_">self</span>.options_container.setLayout(<span class="hljs-variable language_">self</span>.options_layout)<br>        <span class="hljs-variable language_">self</span>.options_container.hide()<br>        <span class="hljs-variable language_">self</span>.layout.addWidget(<span class="hljs-variable language_">self</span>.options_container)<br>        <span class="hljs-comment"># åº•éƒ¨æç¤º</span><br>        <span class="hljs-variable language_">self</span>.hint_label = QLabel(<span class="hljs-string">&quot;Esc é€€å‡º | â†‘â†“Enter é€‰æ‹© | é¼ æ ‡ç‚¹å‡»/æ‹–æ‹½&quot;</span>)<br>        <span class="hljs-variable language_">self</span>.hint_label.setStyleSheet(<span class="hljs-string">&quot;color: #666; font-size: 11px; border: none;&quot;</span>)<br>        <span class="hljs-variable language_">self</span>.hint_label.setAlignment(Qt.AlignmentFlag.AlignRight)<br>        <span class="hljs-variable language_">self</span>.layout.addWidget(<span class="hljs-variable language_">self</span>.hint_label)<br>        <span class="hljs-variable language_">self</span>.step = <span class="hljs-string">&quot;MODULE&quot;</span><br>        <span class="hljs-variable language_">self</span>.all_items = []  <span class="hljs-comment"># ç”¨äºæœç´¢è¿‡æ»¤</span><br>        <span class="hljs-variable language_">self</span>.load_modules()<br>        <span class="hljs-variable language_">self</span>.search_edit.setFocus()  <span class="hljs-comment"># é»˜è®¤ç„¦ç‚¹åœ¨æœç´¢æ¡†</span><br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">load_modules</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-variable language_">self</span>.step = <span class="hljs-string">&quot;MODULE&quot;</span><br>        <span class="hljs-variable language_">self</span>.info_label.setText(<span class="hljs-string">&quot;ğŸ“¦ é€‰æ‹©æ¨¡å—&quot;</span>)<br>        <span class="hljs-variable language_">self</span>.list_widget.clear()<br>        <span class="hljs-variable language_">self</span>.list_widget.show()<br>        <span class="hljs-variable language_">self</span>.options_container.hide()<br>        <span class="hljs-variable language_">self</span>.all_items = <span class="hljs-built_in">list</span>(<span class="hljs-variable language_">self</span>.data.keys())<br>        <span class="hljs-variable language_">self</span>.list_widget.addItems(<span class="hljs-variable language_">self</span>.all_items)<br>        <span class="hljs-keyword">if</span> <span class="hljs-variable language_">self</span>.list_widget.count() &gt; <span class="hljs-number">0</span>:<br>            <span class="hljs-variable language_">self</span>.list_widget.setCurrentRow(<span class="hljs-number">0</span>) <span class="hljs-comment"># é»˜è®¤é€‰ä¸­ç¬¬ä¸€ä¸ª</span><br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">load_sentences</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-variable language_">self</span>.step = <span class="hljs-string">&quot;SENTENCE&quot;</span><br>        <span class="hljs-variable language_">self</span>.info_label.setText(<span class="hljs-string">f&quot;ğŸ“„ [<span class="hljs-subst">&#123;self.selected_module&#125;</span>] é€‰æ‹©å†…å®¹&quot;</span>)<br>        <span class="hljs-variable language_">self</span>.list_widget.clear()<br>        sentences = <span class="hljs-variable language_">self</span>.data.get(<span class="hljs-variable language_">self</span>.selected_module, [])<br>        <span class="hljs-variable language_">self</span>.all_items = sentences[:]<br>        <span class="hljs-variable language_">self</span>.list_widget.addItems(<span class="hljs-variable language_">self</span>.all_items)<br>        <span class="hljs-keyword">if</span> <span class="hljs-variable language_">self</span>.list_widget.count() &gt; <span class="hljs-number">0</span>:<br>            <span class="hljs-variable language_">self</span>.list_widget.setCurrentRow(<span class="hljs-number">0</span>)<br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">filter_list</span>(<span class="hljs-params">self, text</span>):<br>        <span class="hljs-variable language_">self</span>.list_widget.clear()<br>        filtered = [item <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> <span class="hljs-variable language_">self</span>.all_items <span class="hljs-keyword">if</span> text.lower() <span class="hljs-keyword">in</span> item.lower()]<br>        <span class="hljs-variable language_">self</span>.list_widget.addItems(filtered)<br>        <span class="hljs-keyword">if</span> <span class="hljs-variable language_">self</span>.list_widget.count() &gt; <span class="hljs-number">0</span>:<br>            <span class="hljs-variable language_">self</span>.list_widget.setCurrentRow(<span class="hljs-number">0</span>)<br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">on_item_clicked</span>(<span class="hljs-params">self, item</span>):<br>        <span class="hljs-keyword">if</span> <span class="hljs-variable language_">self</span>.step == <span class="hljs-string">&quot;MODULE&quot;</span>:<br>            <span class="hljs-variable language_">self</span>.selected_module = item.text()<br>            <span class="hljs-variable language_">self</span>.search_edit.clear()  <span class="hljs-comment"># æ¸…ç©ºæœç´¢</span><br>            <span class="hljs-variable language_">self</span>.load_sentences()<br>        <span class="hljs-keyword">elif</span> <span class="hljs-variable language_">self</span>.step == <span class="hljs-string">&quot;SENTENCE&quot;</span>:<br>            <span class="hljs-variable language_">self</span>.current_text = item.text()<br>            <span class="hljs-variable language_">self</span>.start_resolving()<br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">start_resolving</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-variable language_">self</span>.step = <span class="hljs-string">&quot;RESOLVING&quot;</span><br>        <span class="hljs-variable language_">self</span>.search_edit.hide()  <span class="hljs-comment"># éšè—æœç´¢æ¡†</span><br>        <span class="hljs-variable language_">self</span>.list_widget.hide()<br>        <span class="hljs-variable language_">self</span>.options_container.show()<br>        <span class="hljs-variable language_">self</span>.hint_label.setText(<span class="hljs-string">&quot;Esc é€€å‡º | â†â†’Enter é€‰æ‹© | é¼ æ ‡ç‚¹å‡»&quot;</span>)<br>        <span class="hljs-variable language_">self</span>.resolve_next_variable()<br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">resolve_next_variable</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">match</span> = re.search(<span class="hljs-string">r&#x27;\&#123;([^&#123;&#125;]+?)\&#125;&#x27;</span>, <span class="hljs-variable language_">self</span>.current_text)<br>        <br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">match</span>:<br>            full_match = <span class="hljs-keyword">match</span>.group(<span class="hljs-number">0</span>)<br>            content = <span class="hljs-keyword">match</span>.group(<span class="hljs-number">1</span>)<br>            options = [opt.strip() <span class="hljs-keyword">for</span> opt <span class="hljs-keyword">in</span> content.split(<span class="hljs-string">&#x27;|&#x27;</span>)]<br>            options.append(<span class="hljs-string">&quot;Null&quot;</span>)  <span class="hljs-comment"># æ·»åŠ  Null é€‰é¡¹</span><br>            <br>            <span class="hljs-comment"># è®¡ç®—è°ƒæ•´åçš„èµ·å§‹å’Œç»“æŸä½ç½®</span><br>            start = <span class="hljs-keyword">match</span>.start()<br>            end = <span class="hljs-keyword">match</span>.end()<br>            adj_start = start - <span class="hljs-number">1</span> <span class="hljs-keyword">if</span> start &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> <span class="hljs-variable language_">self</span>.current_text[start - <span class="hljs-number">1</span>] == <span class="hljs-string">&#x27; &#x27;</span> <span class="hljs-keyword">else</span> start<br>            adj_end = end + <span class="hljs-number">1</span> <span class="hljs-keyword">if</span> end &lt; <span class="hljs-built_in">len</span>(<span class="hljs-variable language_">self</span>.current_text) <span class="hljs-keyword">and</span> <span class="hljs-variable language_">self</span>.current_text[end] == <span class="hljs-string">&#x27; &#x27;</span> <span class="hljs-keyword">else</span> end<br>            <br>            <span class="hljs-comment"># é«˜äº®æ˜¾ç¤ºå½“å‰è¦å¡«ç©ºçš„éƒ¨åˆ†</span><br>            display_text = <span class="hljs-variable language_">self</span>.current_text.replace(full_match, <span class="hljs-string">f&quot;&lt;span style=&#x27;color: #4fc1ff;&#x27;&gt;[ ??? ]&lt;/span&gt;&quot;</span>, <span class="hljs-number">1</span>)<br>            <br>            <span class="hljs-variable language_">self</span>.info_label.setText(<span class="hljs-string">f&quot;âœï¸ å¡«ç©ºæ¨¡å¼&quot;</span>)<br>            <span class="hljs-variable language_">self</span>.info_label.setTextFormat(Qt.TextFormat.RichText) <span class="hljs-comment"># å…è®¸HTML</span><br>            <br>            <span class="hljs-comment"># æ˜¾ç¤ºä¸Šä¸‹æ–‡é¢„è§ˆ</span><br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">hasattr</span>(<span class="hljs-variable language_">self</span>, <span class="hljs-string">&#x27;preview_label&#x27;</span>):<br>                <span class="hljs-variable language_">self</span>.preview_label = QLabel(display_text)<br>                <span class="hljs-variable language_">self</span>.preview_label.setStyleSheet(<span class="hljs-string">&quot;color: #bbb; font-size: 14px; padding: 10px; background: #252526; border-radius: 5px;&quot;</span>)<br>                <span class="hljs-variable language_">self</span>.preview_label.setWordWrap(<span class="hljs-literal">True</span>)<br>                <span class="hljs-comment"># æ’å…¥åˆ° layout ä¸­é—´</span><br>                <span class="hljs-variable language_">self</span>.layout.insertWidget(<span class="hljs-number">3</span>, <span class="hljs-variable language_">self</span>.preview_label)  <span class="hljs-comment"># è°ƒæ•´æ’å…¥ä½ç½®ï¼Œå› ä¸ºæ·»åŠ äº†æœç´¢æ¡†</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-variable language_">self</span>.preview_label.setText(display_text)<br>                <span class="hljs-variable language_">self</span>.preview_label.show()<br>            <span class="hljs-comment"># æ¸…é™¤æ—§æŒ‰é’®</span><br>            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">reversed</span>(<span class="hljs-built_in">range</span>(<span class="hljs-variable language_">self</span>.options_layout.count())):<br>                <span class="hljs-variable language_">self</span>.options_layout.itemAt(i).widget().setParent(<span class="hljs-literal">None</span>)<br>            <br>            <span class="hljs-variable language_">self</span>.option_buttons = []<br>            <span class="hljs-comment"># ç”Ÿæˆå¤§å·å¡ç‰‡å¼æŒ‰é’®</span><br>            <span class="hljs-keyword">for</span> idx, opt <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(options):<br>                btn = QPushButton(opt <span class="hljs-keyword">if</span> opt != <span class="hljs-string">&quot;Null&quot;</span> <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;Null (ç©º)&quot;</span>)<br>                btn.setCursor(QCursor(Qt.CursorShape.PointingHandCursor))<br>                btn.setFocusPolicy(Qt.FocusPolicy.StrongFocus)  <span class="hljs-comment"># å…è®¸é”®ç›˜ç„¦ç‚¹</span><br>                <span class="hljs-comment"># é’ˆå¯¹é€‰é¡¹æŒ‰é’®çš„ç‰¹æ®Šæ ·å¼</span><br>                btn.setStyleSheet(<span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">                    QPushButton &#123;</span><br><span class="hljs-string">                        background-color: #2d2d30;</span><br><span class="hljs-string">                        border: 1px solid #3e3e42;</span><br><span class="hljs-string">                        font-size: 16px;</span><br><span class="hljs-string">                        padding: 15px;</span><br><span class="hljs-string">                        text-align: left;</span><br><span class="hljs-string">                    &#125;</span><br><span class="hljs-string">                    QPushButton:hover &#123;</span><br><span class="hljs-string">                        background-color: #37373d;</span><br><span class="hljs-string">                        border-left: 4px solid #007acc;</span><br><span class="hljs-string">                    &#125;</span><br><span class="hljs-string">                    QPushButton:focus &#123;</span><br><span class="hljs-string">                        border: 2px solid #007acc;</span><br><span class="hljs-string">                    &#125;</span><br><span class="hljs-string">                &quot;&quot;&quot;</span>)<br>                btn.clicked.connect(<span class="hljs-keyword">lambda</span> checked, o=opt, s=adj_start, e=adj_end: <span class="hljs-variable language_">self</span>.choice_made(o, s, e))<br>                <span class="hljs-variable language_">self</span>.options_layout.addWidget(btn, idx // <span class="hljs-number">2</span>, idx % <span class="hljs-number">2</span>)<br>                <span class="hljs-variable language_">self</span>.option_buttons.append(btn)<br>            <br>            <span class="hljs-comment"># è®¾ç½®ç„¦ç‚¹åˆ°ç¬¬ä¸€ä¸ªæŒ‰é’®</span><br>            <span class="hljs-keyword">if</span> <span class="hljs-variable language_">self</span>.option_buttons:<br>                <span class="hljs-variable language_">self</span>.option_buttons[<span class="hljs-number">0</span>].setFocus()<br>                <br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">hasattr</span>(<span class="hljs-variable language_">self</span>, <span class="hljs-string">&#x27;preview_label&#x27;</span>): <span class="hljs-variable language_">self</span>.preview_label.hide()<br>            <span class="hljs-variable language_">self</span>.finish_and_paste()<br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">choice_made</span>(<span class="hljs-params">self, option, adj_start, adj_end</span>):<br>        replace_with = <span class="hljs-string">&quot;&quot;</span> <span class="hljs-keyword">if</span> option == <span class="hljs-string">&quot;Null&quot;</span> <span class="hljs-keyword">else</span> option<br>        <span class="hljs-variable language_">self</span>.current_text = <span class="hljs-variable language_">self</span>.current_text[:adj_start] + replace_with + <span class="hljs-variable language_">self</span>.current_text[adj_end:]<br>        <span class="hljs-variable language_">self</span>.resolve_next_variable()<br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">finish_and_paste</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-variable language_">self</span>.hide()<br>        time.sleep(<span class="hljs-number">0.1</span>)<br>        pyperclip.copy(<span class="hljs-variable language_">self</span>.current_text)<br>        ctrl_key = <span class="hljs-string">&quot;command&quot;</span> <span class="hljs-keyword">if</span> sys.platform == <span class="hljs-string">&quot;darwin&quot;</span> <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;ctrl&quot;</span><br>        pyautogui.hotkey(ctrl_key, <span class="hljs-string">&#x27;v&#x27;</span>)<br>        <span class="hljs-variable language_">self</span>.close()<br>    <br>    <span class="hljs-comment"># å®ç°æ‹–æ‹½</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">mousePressEvent</span>(<span class="hljs-params">self, event</span>):<br>        <span class="hljs-keyword">if</span> event.button() == Qt.MouseButton.LeftButton:<br>            <span class="hljs-variable language_">self</span>.drag_position = event.globalPosition().toPoint() - <span class="hljs-variable language_">self</span>.frameGeometry().topLeft()<br>            event.accept()<br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">mouseMoveEvent</span>(<span class="hljs-params">self, event</span>):<br>        <span class="hljs-keyword">if</span> event.buttons() == Qt.MouseButton.LeftButton <span class="hljs-keyword">and</span> <span class="hljs-variable language_">self</span>.drag_position <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>            <span class="hljs-variable language_">self</span>.move(event.globalPosition().toPoint() - <span class="hljs-variable language_">self</span>.drag_position)<br>            event.accept()<br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">mouseReleaseEvent</span>(<span class="hljs-params">self, event</span>):<br>        <span class="hljs-variable language_">self</span>.drag_position = <span class="hljs-literal">None</span><br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">keyPressEvent</span>(<span class="hljs-params">self, event</span>):<br>        <span class="hljs-keyword">if</span> event.key() == Qt.Key.Key_Escape:<br>            <span class="hljs-variable language_">self</span>.close()<br>        <span class="hljs-keyword">elif</span> <span class="hljs-variable language_">self</span>.step == <span class="hljs-string">&quot;RESOLVING&quot;</span>:<br>            <span class="hljs-keyword">if</span> event.key() <span class="hljs-keyword">in</span> (Qt.Key.Key_Left, Qt.Key.Key_Right, Qt.Key.Key_Up, Qt.Key.Key_Down):<br>                current_focus = <span class="hljs-variable language_">self</span>.focusWidget()<br>                <span class="hljs-keyword">if</span> current_focus <span class="hljs-keyword">in</span> <span class="hljs-variable language_">self</span>.option_buttons:<br>                    idx = <span class="hljs-variable language_">self</span>.option_buttons.index(current_focus)<br>                    rows, cols = <span class="hljs-variable language_">self</span>.options_layout.rowCount(), <span class="hljs-variable language_">self</span>.options_layout.columnCount()<br>                    row, col = <span class="hljs-built_in">divmod</span>(idx, cols)<br>                    <span class="hljs-keyword">if</span> event.key() == Qt.Key.Key_Left:<br>                        col = (col - <span class="hljs-number">1</span>) % cols<br>                    <span class="hljs-keyword">elif</span> event.key() == Qt.Key.Key_Right:<br>                        col = (col + <span class="hljs-number">1</span>) % cols<br>                    <span class="hljs-keyword">elif</span> event.key() == Qt.Key.Key_Up:<br>                        row = (row - <span class="hljs-number">1</span>) % rows<br>                    <span class="hljs-keyword">elif</span> event.key() == Qt.Key.Key_Down:<br>                        row = (row + <span class="hljs-number">1</span>) % rows<br>                    new_idx = row * cols + col<br>                    <span class="hljs-keyword">if</span> new_idx &lt; <span class="hljs-built_in">len</span>(<span class="hljs-variable language_">self</span>.option_buttons):<br>                        <span class="hljs-variable language_">self</span>.option_buttons[new_idx].setFocus()<br>            <span class="hljs-keyword">elif</span> event.key() == Qt.Key.Key_Return <span class="hljs-keyword">or</span> event.key() == Qt.Key.Key_Enter:<br>                current_focus = <span class="hljs-variable language_">self</span>.focusWidget()<br>                <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(current_focus, QPushButton):<br>                    current_focus.click()<br>        <span class="hljs-keyword">elif</span> <span class="hljs-variable language_">self</span>.search_edit.hasFocus():<br>            <span class="hljs-keyword">if</span> event.key() == Qt.Key.Key_Down:<br>                <span class="hljs-keyword">if</span> <span class="hljs-variable language_">self</span>.list_widget.count() &gt; <span class="hljs-number">0</span>:<br>                    <span class="hljs-variable language_">self</span>.list_widget.setFocus()<br>                    <span class="hljs-variable language_">self</span>.list_widget.setCurrentRow(<span class="hljs-number">0</span>)<br>            <span class="hljs-keyword">elif</span> event.key() == Qt.Key.Key_Up:<br>                <span class="hljs-keyword">if</span> <span class="hljs-variable language_">self</span>.list_widget.count() &gt; <span class="hljs-number">0</span>:<br>                    <span class="hljs-variable language_">self</span>.list_widget.setFocus()<br>                    <span class="hljs-variable language_">self</span>.list_widget.setCurrentRow(<span class="hljs-variable language_">self</span>.list_widget.count() - <span class="hljs-number">1</span>)<br>        <span class="hljs-keyword">elif</span> <span class="hljs-variable language_">self</span>.list_widget.hasFocus():<br>            <span class="hljs-keyword">if</span> event.key() == Qt.Key.Key_Up <span class="hljs-keyword">and</span> <span class="hljs-variable language_">self</span>.list_widget.currentRow() == <span class="hljs-number">0</span>:<br>                <span class="hljs-variable language_">self</span>.search_edit.setFocus()<br>            <span class="hljs-keyword">elif</span> event.key() == Qt.Key.Key_Down <span class="hljs-keyword">and</span> <span class="hljs-variable language_">self</span>.list_widget.currentRow() == <span class="hljs-variable language_">self</span>.list_widget.count() - <span class="hljs-number">1</span>:<br>                <span class="hljs-variable language_">self</span>.search_edit.setFocus()<br>        <span class="hljs-built_in">super</span>().keyPressEvent(event)<br><span class="hljs-comment"># --- ä¸»ç®¡ç†ç•Œé¢ (VS Code é£æ ¼) ---</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ManagerWindow</span>(<span class="hljs-title class_ inherited__">QMainWindow</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">super</span>().__init__()<br>        <span class="hljs-variable language_">self</span>.setWindowTitle(<span class="hljs-string">&quot;å¿«æ·è¯­æ–™ç®¡ç†&quot;</span>)<br>        <span class="hljs-variable language_">self</span>.resize(<span class="hljs-number">900</span>, <span class="hljs-number">600</span>)<br>        <span class="hljs-variable language_">self</span>.data = load_data()<br>        <span class="hljs-variable language_">self</span>.init_ui()<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">init_ui</span>(<span class="hljs-params">self</span>):<br>        central_widget = QWidget()<br>        <span class="hljs-variable language_">self</span>.setCentralWidget(central_widget)<br>        main_layout = QHBoxLayout(central_widget)<br>        main_layout.setSpacing(<span class="hljs-number">0</span>)<br>        main_layout.setContentsMargins(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>)<br>        <span class="hljs-comment"># --- å·¦ä¾§æ  (æ¨¡å—) ---</span><br>        left_panel = QWidget()<br>        left_panel.setStyleSheet(<span class="hljs-string">&quot;background-color: #252526; border-right: 1px solid #1e1e1e;&quot;</span>)<br>        left_layout = QVBoxLayout(left_panel)<br>        left_layout.setContentsMargins(<span class="hljs-number">10</span>, <span class="hljs-number">15</span>, <span class="hljs-number">10</span>, <span class="hljs-number">15</span>)<br>        lbl_mod = QLabel(<span class="hljs-string">&quot;ğŸ“‚ æ¨¡å—åˆ—è¡¨&quot;</span>)<br>        lbl_mod.setProperty(<span class="hljs-string">&quot;class&quot;</span>, <span class="hljs-string">&quot;header&quot;</span>) <span class="hljs-comment"># ä½¿ç”¨ QSS ç±»é€‰æ‹©å™¨</span><br>        left_layout.addWidget(lbl_mod)<br>        <span class="hljs-variable language_">self</span>.module_list = QListWidget()<br>        <span class="hljs-variable language_">self</span>.module_list.setStyleSheet(<span class="hljs-string">&quot;border: none; background-color: transparent;&quot;</span>) <span class="hljs-comment"># è®©åˆ—è¡¨èå…¥èƒŒæ™¯</span><br>        <span class="hljs-variable language_">self</span>.module_list.setDragDropMode(QAbstractItemView.DragDropMode.InternalMove)<br>        <span class="hljs-variable language_">self</span>.module_list.model().rowsMoved.connect(<span class="hljs-variable language_">self</span>.on_module_reordered)<br>        <span class="hljs-variable language_">self</span>.module_list.itemClicked.connect(<span class="hljs-variable language_">self</span>.refresh_sentences)<br>        left_layout.addWidget(<span class="hljs-variable language_">self</span>.module_list)<br>        <span class="hljs-comment"># å·¦ä¾§æŒ‰é’®ç»„</span><br>        btn_layout_l = QHBoxLayout()<br>        btn_add_mod = QPushButton(<span class="hljs-string">&quot;+&quot;</span>)<br>        btn_add_mod.setToolTip(<span class="hljs-string">&quot;æ·»åŠ æ¨¡å—&quot;</span>)<br>        btn_add_mod.clicked.connect(<span class="hljs-variable language_">self</span>.add_module)<br>        btn_del_mod = QPushButton(<span class="hljs-string">&quot;-&quot;</span>)<br>        btn_del_mod.setToolTip(<span class="hljs-string">&quot;åˆ é™¤æ¨¡å—&quot;</span>)<br>        btn_del_mod.clicked.connect(<span class="hljs-variable language_">self</span>.del_module)<br>        btn_layout_l.addWidget(btn_add_mod)<br>        btn_layout_l.addWidget(btn_del_mod)<br>        left_layout.addLayout(btn_layout_l)<br>        <span class="hljs-comment"># --- å³ä¾§æ  (å¥å­) ---</span><br>        right_panel = QWidget()<br>        right_panel.setStyleSheet(<span class="hljs-string">&quot;background-color: #1e1e1e;&quot;</span>)<br>        right_layout = QVBoxLayout(right_panel)<br>        right_layout.setContentsMargins(<span class="hljs-number">20</span>, <span class="hljs-number">15</span>, <span class="hljs-number">20</span>, <span class="hljs-number">15</span>)<br>        lbl_sent = QLabel(<span class="hljs-string">&quot;ğŸ“ å¥å­å†…å®¹&quot;</span>)<br>        lbl_sent.setProperty(<span class="hljs-string">&quot;class&quot;</span>, <span class="hljs-string">&quot;header&quot;</span>)<br>        right_layout.addWidget(lbl_sent)<br>        <br>        lbl_hint = QLabel(<span class="hljs-string">&quot;åŒå‡»æ¡ç›®è¿›è¡Œç¼–è¾‘ï¼Œä½¿ç”¨ &#123;A | B&#125; åˆ›å»ºé€‰é¡¹&quot;</span>)<br>        lbl_hint.setProperty(<span class="hljs-string">&quot;class&quot;</span>, <span class="hljs-string">&quot;hint&quot;</span>)<br>        right_layout.addWidget(lbl_hint)<br>        <span class="hljs-variable language_">self</span>.sentence_list = QListWidget()<br>        <span class="hljs-variable language_">self</span>.sentence_list.setDragDropMode(QAbstractItemView.DragDropMode.InternalMove)<br>        <span class="hljs-variable language_">self</span>.sentence_list.model().rowsMoved.connect(<span class="hljs-variable language_">self</span>.on_sentence_reordered)<br>        <span class="hljs-variable language_">self</span>.sentence_list.itemDoubleClicked.connect(<span class="hljs-variable language_">self</span>.edit_sentence)<br>        right_layout.addWidget(<span class="hljs-variable language_">self</span>.sentence_list)<br>        <span class="hljs-comment"># å³ä¾§æŒ‰é’®ç»„</span><br>        btn_layout_r = QHBoxLayout()<br>        btn_add_sent = QPushButton(<span class="hljs-string">&quot;æ·»åŠ å¥å­&quot;</span>)<br>        btn_add_sent.setProperty(<span class="hljs-string">&quot;class&quot;</span>, <span class="hljs-string">&quot;primary&quot;</span>) <span class="hljs-comment"># è®¾ä¸ºä¸»è¦æŒ‰é’®æ ·å¼</span><br>        btn_add_sent.setCursor(Qt.CursorShape.PointingHandCursor)<br>        btn_add_sent.clicked.connect(<span class="hljs-variable language_">self</span>.add_sentence)<br>        <br>        btn_del_sent = QPushButton(<span class="hljs-string">&quot;åˆ é™¤é€‰ä¸­&quot;</span>)<br>        btn_del_sent.clicked.connect(<span class="hljs-variable language_">self</span>.del_sentence)<br>        <br>        btn_layout_r.addStretch() <span class="hljs-comment"># æŠŠæŒ‰é’®æ¨åˆ°å³è¾¹</span><br>        btn_layout_r.addWidget(btn_del_sent)<br>        btn_layout_r.addWidget(btn_add_sent)<br>        right_layout.addLayout(btn_layout_r)<br>        <span class="hljs-comment"># è®¾ç½®å·¦å³æ¯”ä¾‹ 1:2</span><br>        main_layout.addWidget(left_panel, <span class="hljs-number">1</span>)<br>        main_layout.addWidget(right_panel, <span class="hljs-number">2</span>)<br>        <span class="hljs-variable language_">self</span>.refresh_modules()<br>    <span class="hljs-comment"># --- CRUD é€»è¾‘ ---</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">refresh_modules</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-variable language_">self</span>.module_list.clear()<br>        modules = <span class="hljs-built_in">list</span>(<span class="hljs-variable language_">self</span>.data.keys())<br>        <span class="hljs-keyword">for</span> i, mod <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(modules, <span class="hljs-number">1</span>):<br>            <span class="hljs-variable language_">self</span>.module_list.addItem(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;i&#125;</span>. <span class="hljs-subst">&#123;mod&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">if</span> <span class="hljs-variable language_">self</span>.module_list.count() &gt; <span class="hljs-number">0</span>:<br>            <span class="hljs-variable language_">self</span>.module_list.setCurrentRow(<span class="hljs-number">0</span>)<br>            <span class="hljs-variable language_">self</span>.refresh_sentences()<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">refresh_sentences</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-variable language_">self</span>.sentence_list.clear()<br>        current_item = <span class="hljs-variable language_">self</span>.module_list.currentItem()<br>        <span class="hljs-keyword">if</span> current_item:<br>            <span class="hljs-comment"># æå–å®é™…æ¨¡å—åï¼ˆå»é™¤ç¼–å·ï¼‰</span><br>            current_mod = current_item.text().split(<span class="hljs-string">&#x27;. &#x27;</span>, <span class="hljs-number">1</span>)[<span class="hljs-number">1</span>]<br>            items = <span class="hljs-variable language_">self</span>.data.get(current_mod, [])<br>            <span class="hljs-keyword">for</span> i, sent <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(items, <span class="hljs-number">1</span>):<br>                <span class="hljs-variable language_">self</span>.sentence_list.addItem(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;i&#125;</span>. <span class="hljs-subst">&#123;sent&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">on_module_reordered</span>(<span class="hljs-params">self, parent, start, end, destination, row</span>):<br>        <span class="hljs-comment"># é‡æ–°æ’åºæ•°æ®ä¸­çš„æ¨¡å—</span><br>        modules = <span class="hljs-built_in">list</span>(<span class="hljs-variable language_">self</span>.data.keys())<br>        moved_mod = modules.pop(start)<br>        modules.insert(row, moved_mod)<br>        <span class="hljs-variable language_">self</span>.data = &#123;mod: <span class="hljs-variable language_">self</span>.data[mod] <span class="hljs-keyword">for</span> mod <span class="hljs-keyword">in</span> modules&#125;<br>        <span class="hljs-variable language_">self</span>.save()<br>        <span class="hljs-variable language_">self</span>.refresh_modules()<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">on_sentence_reordered</span>(<span class="hljs-params">self, parent, start, end, destination, row</span>):<br>        current_item = <span class="hljs-variable language_">self</span>.module_list.currentItem()<br>        <span class="hljs-keyword">if</span> current_item:<br>            current_mod = current_item.text().split(<span class="hljs-string">&#x27;. &#x27;</span>, <span class="hljs-number">1</span>)[<span class="hljs-number">1</span>]<br>            sentences = <span class="hljs-variable language_">self</span>.data[current_mod]<br>            moved_sent = sentences.pop(start)<br>            sentences.insert(row, moved_sent)<br>            <span class="hljs-variable language_">self</span>.save()<br>            <span class="hljs-variable language_">self</span>.refresh_sentences()<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">add_module</span>(<span class="hljs-params">self</span>):<br>        name, ok = QInputDialog.getText(<span class="hljs-variable language_">self</span>, <span class="hljs-string">&quot;æ–°å»ºæ¨¡å—&quot;</span>, <span class="hljs-string">&quot;æ¨¡å—åç§°:&quot;</span>)<br>        <span class="hljs-keyword">if</span> ok <span class="hljs-keyword">and</span> name:<br>            <span class="hljs-keyword">if</span> name <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> <span class="hljs-variable language_">self</span>.data:<br>                <span class="hljs-variable language_">self</span>.data[name] = []<br>                <span class="hljs-variable language_">self</span>.save()<br>                <span class="hljs-variable language_">self</span>.refresh_modules()<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">del_module</span>(<span class="hljs-params">self</span>):<br>        item = <span class="hljs-variable language_">self</span>.module_list.currentItem()<br>        <span class="hljs-keyword">if</span> item:<br>            mod_name = item.text().split(<span class="hljs-string">&#x27;. &#x27;</span>, <span class="hljs-number">1</span>)[<span class="hljs-number">1</span>]<br>            confirm = QMessageBox.question(<span class="hljs-variable language_">self</span>, <span class="hljs-string">&quot;ç¡®è®¤&quot;</span>, <span class="hljs-string">f&quot;åˆ é™¤æ¨¡å— &#x27;<span class="hljs-subst">&#123;mod_name&#125;</span>&#x27; åŠå…¶æ‰€æœ‰å¥å­?&quot;</span>, QMessageBox.StandardButton.Yes | QMessageBox.StandardButton.No)<br>            <span class="hljs-keyword">if</span> confirm == QMessageBox.StandardButton.Yes:<br>                <span class="hljs-keyword">del</span> <span class="hljs-variable language_">self</span>.data[mod_name]<br>                <span class="hljs-variable language_">self</span>.save()<br>                <span class="hljs-variable language_">self</span>.refresh_modules()<br>                <span class="hljs-variable language_">self</span>.sentence_list.clear()<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">add_sentence</span>(<span class="hljs-params">self</span>):<br>        current_item = <span class="hljs-variable language_">self</span>.module_list.currentItem()<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> current_item:<br>            <span class="hljs-keyword">return</span> QMessageBox.warning(<span class="hljs-variable language_">self</span>, <span class="hljs-string">&quot;æç¤º&quot;</span>, <span class="hljs-string">&quot;è¯·å…ˆé€‰æ‹©ä¸€ä¸ªæ¨¡å—&quot;</span>)<br>        current_mod = current_item.text().split(<span class="hljs-string">&#x27;. &#x27;</span>, <span class="hljs-number">1</span>)[<span class="hljs-number">1</span>]<br>        dialog = CustomInputDialog(<span class="hljs-string">&quot;æ–°å»ºå¥å­&quot;</span>, <span class="hljs-string">&quot;è¾“å…¥å¥å­ (æ”¯æŒ &#123;A|B&#125; æ ¼å¼):&quot;</span>)<br>        <span class="hljs-keyword">if</span> dialog.<span class="hljs-built_in">exec</span>() == QDialog.DialogCode.Accepted:<br>            text = dialog.getText()<br>            <span class="hljs-keyword">if</span> text:<br>                <span class="hljs-variable language_">self</span>.data[current_mod].append(text)<br>                <span class="hljs-variable language_">self</span>.save()<br>                <span class="hljs-variable language_">self</span>.refresh_sentences()<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">del_sentence</span>(<span class="hljs-params">self</span>):<br>        current_item = <span class="hljs-variable language_">self</span>.module_list.currentItem()<br>        row = <span class="hljs-variable language_">self</span>.sentence_list.currentRow()<br>        <span class="hljs-keyword">if</span> current_item <span class="hljs-keyword">and</span> row &gt;= <span class="hljs-number">0</span>:<br>            current_mod = current_item.text().split(<span class="hljs-string">&#x27;. &#x27;</span>, <span class="hljs-number">1</span>)[<span class="hljs-number">1</span>]<br>            <span class="hljs-keyword">del</span> <span class="hljs-variable language_">self</span>.data[current_mod][row]<br>            <span class="hljs-variable language_">self</span>.save()<br>            <span class="hljs-variable language_">self</span>.refresh_sentences()<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">edit_sentence</span>(<span class="hljs-params">self, item</span>):<br>        current_item = <span class="hljs-variable language_">self</span>.module_list.currentItem()<br>        <span class="hljs-keyword">if</span> current_item:<br>            current_mod = current_item.text().split(<span class="hljs-string">&#x27;. &#x27;</span>, <span class="hljs-number">1</span>)[<span class="hljs-number">1</span>]<br>            <span class="hljs-comment"># æå–å®é™…å¥å­ï¼ˆå»é™¤ç¼–å·ï¼‰</span><br>            sent_text = item.text().split(<span class="hljs-string">&#x27;. &#x27;</span>, <span class="hljs-number">1</span>)[<span class="hljs-number">1</span>]<br>            dialog = CustomInputDialog(<span class="hljs-string">&quot;ç¼–è¾‘å¥å­&quot;</span>, <span class="hljs-string">&quot;å†…å®¹:&quot;</span>, sent_text)<br>            <span class="hljs-keyword">if</span> dialog.<span class="hljs-built_in">exec</span>() == QDialog.DialogCode.Accepted:<br>                text = dialog.getText()<br>                <span class="hljs-keyword">if</span> text:<br>                    row = <span class="hljs-variable language_">self</span>.sentence_list.currentRow()<br>                    <span class="hljs-variable language_">self</span>.data[current_mod][row] = text<br>                    <span class="hljs-variable language_">self</span>.save()<br>                    <span class="hljs-variable language_">self</span>.refresh_sentences()<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">save</span>(<span class="hljs-params">self</span>):<br>        save_data(<span class="hljs-variable language_">self</span>.data)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    app = QApplication(sys.argv)<br>    <br>    <span class="hljs-comment"># åº”ç”¨å…¨å±€æ ·å¼è¡¨</span><br>    app.setStyleSheet(STYLESHEET)<br>    <br>    manager = ManagerWindow()<br>    manager.show()<br>    hotkey_signal = HotkeySignal()<br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">show_quick_selector</span>():<br>        latest_data = load_data()<br>        selector = QuickSelector(latest_data)<br>        <br>        <span class="hljs-comment"># è®©çª—å£å‡ºç°åœ¨å±å¹•ä¸­å¿ƒ</span><br>        screen = app.primaryScreen()<br>        screen_geometry = screen.geometry()<br>        center_point = screen_geometry.center()<br>        frame_geometry = selector.frameGeometry()<br>        frame_geometry.moveCenter(center_point)<br>        selector.move(frame_geometry.topLeft())<br>        <br>        selector.<span class="hljs-built_in">exec</span>()<br>    hotkey_signal.trigger.connect(show_quick_selector)<br>    <span class="hljs-comment"># éé˜»å¡çƒ­é”®ç›‘å¬</span><br>    keyboard.add_hotkey(<span class="hljs-string">&#x27;ctrl + alt&#x27;</span>, <span class="hljs-keyword">lambda</span>: hotkey_signal.trigger.emit())<br>    sys.exit(app.<span class="hljs-built_in">exec</span>())<br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br></code></pre></td></tr></table></figure><hr><h2 id="2-æ‰“åŒ…æˆ-exe-æ–‡ä»¶"><a href="#2-æ‰“åŒ…æˆ-exe-æ–‡ä»¶" class="headerlink" title="2. æ‰“åŒ…æˆ exe æ–‡ä»¶"></a>2. æ‰“åŒ…æˆ exe æ–‡ä»¶</h2><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs nix"><span class="hljs-comment"># 1. å®‰è£…æ‰“åŒ…å·¥å…·</span><br>pip install pyinstaller<br><br><br><span class="hljs-comment"># 2. æ‰“åŒ…æˆ exe æ–‡ä»¶</span><br>pyinstaller <span class="hljs-operator">-</span>-onefile <span class="hljs-operator">-</span>-windowed <span class="hljs-operator">-</span>-icon<span class="hljs-operator">=</span><span class="hljs-string">&quot;D:<span class="hljs-char escape_">\æ–‡</span>ä»¶é›†åˆ<span class="hljs-char escape_">\I</span>CO<span class="hljs-char escape_">\å¿«</span>æ·è¯­æ–™ç®¡ç†.ico&quot;</span> <span class="hljs-operator">-</span>-distpath <span class="hljs-string">&quot;D:<span class="hljs-char escape_">\æ–‡</span>ä»¶é›†åˆ&quot;</span> <span class="hljs-string">&quot;D:<span class="hljs-char escape_">\æ–‡</span>ä»¶é›†åˆ<span class="hljs-char escape_">\å¿«</span>æ·è¯­æ–™ç®¡ç†.py&quot;</span><br><span class="hljs-string">&quot;&quot;</span><span class="hljs-string">&quot;</span><br><span class="hljs-string">1. --onefile</span><br><span class="hljs-string">1. æ‰“åŒ…ä¸ºå•ä¸ª .exe æ–‡ä»¶ã€‚</span><br><span class="hljs-string">2. --windowed</span><br><span class="hljs-string">1. ç¡®ä¿ GUI ç¨‹åºæ— æ§åˆ¶å°çª—å£</span><br><span class="hljs-string">3. --distpath &quot;</span>D:\æ–‡ä»¶é›†åˆ\<span class="hljs-string">&quot;  &quot;</span>D:\æ–‡ä»¶é›†åˆ\å¿«æ·è¯­æ–™ç®¡ç†.py<span class="hljs-string">&quot;</span><br><span class="hljs-string">1. D:<span class="hljs-char escape_">\æ–‡</span>ä»¶é›†åˆ<span class="hljs-char escape_">\ </span>æ˜¯è¾“å‡ºä½ç½®</span><br><span class="hljs-string">2. D:<span class="hljs-char escape_">\æ–‡</span>ä»¶é›†åˆ<span class="hljs-char escape_">\å¿«</span>æ·è¯­æ–™ç®¡ç†.py æ˜¯è¾“å…¥ä½ç½®</span><br><span class="hljs-string">&quot;</span><span class="hljs-string">&quot;&quot;</span><br></code></pre></td></tr></table></figure><hr><h2 id="3-æ³¨æ„äº‹é¡¹"><a href="#3-æ³¨æ„äº‹é¡¹" class="headerlink" title="3. æ³¨æ„äº‹é¡¹"></a>3. æ³¨æ„äº‹é¡¹</h2><h3 id="3-1-æ•°æ®å­˜å‚¨ä½ç½®"><a href="#3-1-æ•°æ®å­˜å‚¨ä½ç½®" class="headerlink" title="3.1. æ•°æ®å­˜å‚¨ä½ç½®"></a>3.1. æ•°æ®å­˜å‚¨ä½ç½®</h3><p><img src="/source/_posts/%E5%B7%A5%E5%85%B7%EF%BC%9A%E5%BF%AB%E6%8D%B7%E8%AF%AD%E6%96%99%E7%AE%A1%E7%90%86/%E5%B7%A5%E5%85%B7%EF%BC%9A%E5%BF%AB%E6%8D%B7%E8%AF%AD%E6%96%99%E7%AE%A1%E7%90%86.png"></p><hr><h3 id="3-2-å¿«æ·é”®ä½ç½®"><a href="#3-2-å¿«æ·é”®ä½ç½®" class="headerlink" title="3.2. å¿«æ·é”®ä½ç½®"></a>3.2. å¿«æ·é”®ä½ç½®</h3><p><img src="/source/_posts/%E5%B7%A5%E5%85%B7%EF%BC%9A%E5%BF%AB%E6%8D%B7%E8%AF%AD%E6%96%99%E7%AE%A1%E7%90%86/%E5%B7%A5%E5%85%B7%EF%BC%9A%E5%BF%AB%E6%8D%B7%E8%AF%AD%E6%96%99%E7%AE%A1%E7%90%86-1.png"></p><hr>]]></content>
    
    
    <categories>
      
      <category>å·¥å…·</category>
      
      <category>å¿«æ·è¯­æ–™ç®¡ç†</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>ç¬”è®°ï¼šKafka</title>
    <link href="/2025/12/11/%E7%AC%94%E8%AE%B0%EF%BC%9AKafka/"/>
    <url>/2025/12/11/%E7%AC%94%E8%AE%B0%EF%BC%9AKafka/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>ç¬”è®°ï¼šJava è¯­æ³•ç³–</title>
    <link href="/2025/12/11/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E8%AF%AD%E6%B3%95%E7%B3%96/"/>
    <url>/2025/12/11/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E8%AF%AD%E6%B3%95%E7%B3%96/</url>
    
    <content type="html"><![CDATA[<h1 id="ä¸€ã€TODO"><a href="#ä¸€ã€TODO" class="headerlink" title="ä¸€ã€TODO"></a>ä¸€ã€TODO</h1><hr><h1 id="äºŒã€è„‘å›¾"><a href="#äºŒã€è„‘å›¾" class="headerlink" title="äºŒã€è„‘å›¾"></a>äºŒã€è„‘å›¾</h1><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/05/05/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E8%AF%AD%E6%B3%95%E7%B3%96/">http://blog.wangjia.ink/2025/05/05/ç¬”è®°ï¼šJavaè¯­æ³•ç³–/</a></p></li></ol><hr><h1 id="ä¸‰ã€Java-è¯­æ³•ç³–åŸºç¡€"><a href="#ä¸‰ã€Java-è¯­æ³•ç³–åŸºç¡€" class="headerlink" title="ä¸‰ã€Java è¯­æ³•ç³–åŸºç¡€"></a>ä¸‰ã€Java è¯­æ³•ç³–åŸºç¡€</h1><h2 id="1-Java-è¯­æ³•ç³–ç›¸å…³åˆ†ç±»"><a href="#1-Java-è¯­æ³•ç³–ç›¸å…³åˆ†ç±»" class="headerlink" title="1. Java è¯­æ³•ç³–ç›¸å…³åˆ†ç±»"></a>1. Java è¯­æ³•ç³–ç›¸å…³åˆ†ç±»</h2><h3 id="1-1-Lambda-è¡¨è¾¾å¼è¯­æ³•ç³–"><a href="#1-1-Lambda-è¡¨è¾¾å¼è¯­æ³•ç³–" class="headerlink" title="1.1. Lambda è¡¨è¾¾å¼è¯­æ³•ç³–"></a>1.1. Lambda è¡¨è¾¾å¼è¯­æ³•ç³–</h3><p>è¯¦è§ç¬”è®°ï¼š<code>Java</code> å‡½æ•°å¼ç¼–ç¨‹</p><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B.md">ç¬”è®°ï¼šJavaå‡½æ•°å¼ç¼–ç¨‹</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/12/01/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B/">http://blog.wangjia.ink/2025/12/01/ç¬”è®°ï¼šJavaå‡½æ•°å¼ç¼–ç¨‹/</a></li></ol></li></ol><hr><h3 id="1-2-å¢å¼º-for-å¾ªç¯è¯­æ³•ç³–"><a href="#1-2-å¢å¼º-for-å¾ªç¯è¯­æ³•ç³–" class="headerlink" title="1.2. å¢å¼º for å¾ªç¯è¯­æ³•ç³–"></a>1.2. å¢å¼º for å¾ªç¯è¯­æ³•ç³–</h3><p>è¯¦è§ç¬”è®°ï¼š<code>Java</code> å‡½æ•°å¼ç¼–ç¨‹</p><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B.md">ç¬”è®°ï¼šJavaå‡½æ•°å¼ç¼–ç¨‹</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/12/01/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B/">http://blog.wangjia.ink/2025/12/01/ç¬”è®°ï¼šJavaå‡½æ•°å¼ç¼–ç¨‹/</a></li></ol></li></ol><hr><h3 id="1-3-try-with-resourcesè¯­æ³•ç³–"><a href="#1-3-try-with-resourcesè¯­æ³•ç³–" class="headerlink" title="1.3. try-with-resourcesè¯­æ³•ç³–"></a>1.3. try-with-resourcesè¯­æ³•ç³–</h3><p>è¯¦è§æºç ï¼š<code>AutoCloseable</code></p><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.AutoCloseable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.lang.AutoCloseableæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/10/10/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.AutoCloseable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/10/10/æºç ï¼šjava.lang.AutoCloseableæºç è§£æ/</a></li></ol></li></ol><hr>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
      <category>Java è¯­æ³•ç³–</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>ç¬”è®°ï¼šJVM</title>
    <link href="/2025/12/10/%E7%AC%94%E8%AE%B0%EF%BC%9AJVM/"/>
    <url>/2025/12/10/%E7%AC%94%E8%AE%B0%EF%BC%9AJVM/</url>
    
    <content type="html"><![CDATA[<h1 id="ä¸€ã€TODO"><a href="#ä¸€ã€TODO" class="headerlink" title="ä¸€ã€TODO"></a>ä¸€ã€TODO</h1><hr><h1 id="äºŒã€è„‘å›¾"><a href="#äºŒã€è„‘å›¾" class="headerlink" title="äºŒã€è„‘å›¾"></a>äºŒã€è„‘å›¾</h1><ol><li><p>Xmind</p></li><li><p>Edraw<br><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJVM/%E7%AC%94%E8%AE%B0%EF%BC%9AJVM.eddx"></p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/12/10/%E7%AC%94%E8%AE%B0%EF%BC%9AJVM/">http://blog.wangjia.ink/2025/12/10/ç¬”è®°ï¼šJVM/</a></p></li><li><p>ä»£ç æ´ªè’ï¼ˆé¢è¯•å®å…¸ï¼‰<br>ğŸ‘‰ <a href="https://www.notion.so/JVM-2c5974fbda5e8009850fdcc845fe0424?source=copy_link">https://www.notion.so/JVM-2c5974fbda5e8009850fdcc845fe0424?source=copy_link</a></p></li></ol><hr><h1 id="ä¸‰ã€JVM-åŸºç¡€"><a href="#ä¸‰ã€JVM-åŸºç¡€" class="headerlink" title="ä¸‰ã€JVM åŸºç¡€"></a>ä¸‰ã€JVM åŸºç¡€</h1><h2 id="1-ç±»çš„åŠ è½½é˜¶æ®µ"><a href="#1-ç±»çš„åŠ è½½é˜¶æ®µ" class="headerlink" title="1. ç±»çš„åŠ è½½é˜¶æ®µ"></a>1. ç±»çš„åŠ è½½é˜¶æ®µ</h2><h3 id="1-1-ç±»çš„åŠ è½½é˜¶æ®µç»„æˆéƒ¨åˆ†"><a href="#1-1-ç±»çš„åŠ è½½é˜¶æ®µç»„æˆéƒ¨åˆ†" class="headerlink" title="1.1. ç±»çš„åŠ è½½é˜¶æ®µç»„æˆéƒ¨åˆ†"></a>1.1. ç±»çš„åŠ è½½é˜¶æ®µç»„æˆéƒ¨åˆ†</h3><p><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJVM/%E7%AC%94%E8%AE%B0%EF%BC%9AJVM-10.png"></p><hr><h2 id="2-è¿è¡Œæ—¶æ•°æ®åŒº"><a href="#2-è¿è¡Œæ—¶æ•°æ®åŒº" class="headerlink" title="2. è¿è¡Œæ—¶æ•°æ®åŒº"></a>2. è¿è¡Œæ—¶æ•°æ®åŒº</h2><h3 id="2-1-è¿è¡Œæ—¶æ•°æ®åŒºç»„æˆéƒ¨åˆ†"><a href="#2-1-è¿è¡Œæ—¶æ•°æ®åŒºç»„æˆéƒ¨åˆ†" class="headerlink" title="2.1. è¿è¡Œæ—¶æ•°æ®åŒºç»„æˆéƒ¨åˆ†"></a>2.1. è¿è¡Œæ—¶æ•°æ®åŒºç»„æˆéƒ¨åˆ†</h3><p><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJVM/%E7%AC%94%E8%AE%B0%EF%BC%9AJVM-11.png"></p><hr><h3 id="2-2-ç¨‹åºè®¡æ•°å™¨"><a href="#2-2-ç¨‹åºè®¡æ•°å™¨" class="headerlink" title="2.2. ç¨‹åºè®¡æ•°å™¨"></a>2.2. ç¨‹åºè®¡æ•°å™¨</h3><h4 id="2-2-1-ç¨‹åºè®¡æ•°å™¨ç»„æˆéƒ¨åˆ†"><a href="#2-2-1-ç¨‹åºè®¡æ•°å™¨ç»„æˆéƒ¨åˆ†" class="headerlink" title="2.2.1. ç¨‹åºè®¡æ•°å™¨ç»„æˆéƒ¨åˆ†"></a>2.2.1. ç¨‹åºè®¡æ•°å™¨ç»„æˆéƒ¨åˆ†</h4><p><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJVM/%E7%AC%94%E8%AE%B0%EF%BC%9AJVM-12.png"></p><hr><h4 id="2-2-2-ç¨‹åºè®¡æ•°å™¨æ¦‚è¿°"><a href="#2-2-2-ç¨‹åºè®¡æ•°å™¨æ¦‚è¿°" class="headerlink" title="2.2.2. ç¨‹åºè®¡æ•°å™¨æ¦‚è¿°"></a>2.2.2. ç¨‹åºè®¡æ•°å™¨æ¦‚è¿°</h4><p>ç¨‹åºè®¡æ•°å™¨ï¼ˆ<code>PC</code> å¯„å­˜å™¨ï¼‰æ˜¯ç”¨äºè®°å½•å½“å‰çº¿ç¨‹è¦å»æ‰§è¡Œçš„ä¸‹ä¸€æ¡ <code>JVM</code> å­—èŠ‚ç æŒ‡ä»¤çš„å†…å­˜åœ°å€ï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼šå®é™…è®°å½•çš„æ˜¯è¿™æ¡ <code>JVM</code> å­—èŠ‚ç æŒ‡ä»¤çš„åç§»é‡ï¼‰</p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>ç¨‹åºå¯„å­˜å™¨æ—¢ä¸ä¼šå‘ç”Ÿ <code>GC</code>ï¼Œä¹Ÿä¸ä¼šæŠ›å‡º <code>OutOfMemoryError</code> é”™è¯¯</li><li>ç¨‹åºå¯„å­˜å™¨æ˜¯çº¿ç¨‹ç§æœ‰çš„åŒºåŸŸï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½æ‹¥æœ‰ç‹¬ç«‹çš„ç¨‹åºå¯„å­˜å™¨</li><li>æ‰§è¡Œå¼•æ“è´Ÿè´£è¯»å–å¹¶æ‰§è¡Œè¯¥ <code>JVM</code> å­—èŠ‚ç æŒ‡ä»¤ã€‚æ‰§è¡Œå¼•æ“åœ¨è¿›è¡Œè¯»å–æ—¶ï¼Œä¼šå°† <code>JVM</code> å­—èŠ‚ç æŒ‡ä»¤çš„åç§»é‡è½¬æ¢ä¸º <code>JVM</code> å­—èŠ‚ç æŒ‡ä»¤çš„å†…å­˜åœ°å€ã€‚å½“æ‰§è¡Œå¼•æ“è¯»å–åˆ° JVM å­—èŠ‚ç æŒ‡ä»¤åï¼Œç¨‹åºè®¡æ•°å™¨å°±è®°å½•å½“å‰çº¿ç¨‹è¦å»æ‰§è¡Œçš„ä¸‹ä¸€æ¡ <code>JVM</code> å­—èŠ‚ç æŒ‡ä»¤çš„å†…å­˜åœ°å€ï¼Œç„¶åæ‰§è¡Œå¼•æ“æ‰å¼€å§‹æ‰§è¡Œè¯¥ <code>JVM</code> å­—èŠ‚ç æŒ‡ä»¤</li><li>å¦‚æœçº¿ç¨‹æ‰§è¡Œçš„æ˜¯ <code>native</code> æ–¹æ³•ï¼Œé‚£ä¹ˆç¨‹åºè®¡æ•°å™¨ä¼šè®°å½• <code>undefined</code>ï¼ˆå› ä¸º <code>native</code> æ–¹æ³•æœ¬è´¨ä¸Šæ˜¯ç¦»å¼€äº† <code>JVM</code> çš„æ§åˆ¶ï¼‰</li><li>çŒ´å“¥çš„çƒ¦æ¼ç®± <code>(ï½¡â€¢Ìï¸¿â€¢Ì€ï½¡)</code>:<ol><li>ç¨‹åºè®¡æ•°å™¨ä¸ºä»€ä¹ˆè¦è®°å½•å½“å‰çº¿ç¨‹è¦å»æ‰§è¡Œçš„ä¸‹ä¸€æ¡ <code>JVM</code> å­—èŠ‚ç æŒ‡ä»¤çš„å†…å­˜åœ°å€ï¼Ÿ<ol><li>ç”±äº <code>CPU</code> éœ€è¦é¢‘ç¹è¿›è¡Œçº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œåˆ‡æ¢å›æ¥æ—¶å¿…é¡»çŸ¥é“ä»é‚£é‡Œç»§ç»­æ‰§è¡Œ</li></ol></li></ol></li></ol></blockquote><hr><h4 id="2-2-3-ç¨‹åºè®¡æ•°å™¨ç©ºé—´å¤§å°"><a href="#2-2-3-ç¨‹åºè®¡æ•°å™¨ç©ºé—´å¤§å°" class="headerlink" title="2.2.3. ç¨‹åºè®¡æ•°å™¨ç©ºé—´å¤§å°"></a>2.2.3. ç¨‹åºè®¡æ•°å™¨ç©ºé—´å¤§å°</h4><p>ç¨‹åºè®¡æ•°å™¨çš„å†…å­˜ç©ºé—´å¤§å°å‡ ä¹å¯ä»¥å¿½ç•¥ä¸è®¡ï¼ˆå› ä¸ºåªéœ€è¦è®°å½•ä¸€ä¸ªå†…å­˜åœ°å€ï¼‰ï¼š</p><ol><li>åœ¨ <code>32 bit</code> çš„ <code>JVM</code> ä¸­ï¼Œç¨‹åºè®¡æ•°å™¨å  <code>4 byte</code></li><li>åœ¨ <code>64 bit</code> çš„ <code>JVM</code> ä¸­ï¼Œç¨‹åºè®¡æ•°å™¨å  <code>8 byte</code></li></ol><hr><h3 id="2-3-è™šæ‹Ÿæœºæ ˆâ€”â€“"><a href="#2-3-è™šæ‹Ÿæœºæ ˆâ€”â€“" class="headerlink" title="2.3. è™šæ‹Ÿæœºæ ˆâ€”â€“&gt;"></a>2.3. è™šæ‹Ÿæœºæ ˆâ€”â€“&gt;</h3><h4 id="2-3-1-è™šæ‹Ÿæœºæ ˆç»„æˆéƒ¨åˆ†"><a href="#2-3-1-è™šæ‹Ÿæœºæ ˆç»„æˆéƒ¨åˆ†" class="headerlink" title="2.3.1. è™šæ‹Ÿæœºæ ˆç»„æˆéƒ¨åˆ†"></a>2.3.1. è™šæ‹Ÿæœºæ ˆç»„æˆéƒ¨åˆ†</h4><p><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJVM/%E7%AC%94%E8%AE%B0%EF%BC%9AJVM-1.png"></p><hr><h4 id="2-3-2-å±€éƒ¨å˜é‡è¡¨"><a href="#2-3-2-å±€éƒ¨å˜é‡è¡¨" class="headerlink" title="2.3.2. å±€éƒ¨å˜é‡è¡¨"></a>2.3.2. å±€éƒ¨å˜é‡è¡¨</h4><h5 id="2-3-2-1-å±€éƒ¨å˜é‡è¡¨æ¦‚è¿°"><a href="#2-3-2-1-å±€éƒ¨å˜é‡è¡¨æ¦‚è¿°" class="headerlink" title="2.3.2.1. å±€éƒ¨å˜é‡è¡¨æ¦‚è¿°"></a>2.3.2.1. å±€éƒ¨å˜é‡è¡¨æ¦‚è¿°</h5><p>å±€éƒ¨å˜é‡è¡¨ç”¨äºå­˜å‚¨æ–¹æ³•å‚æ•°ã€å±€éƒ¨å˜é‡<br><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJVM/%E7%AC%94%E8%AE%B0%EF%BC%9AJVM-13.png"></p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>å±€éƒ¨å˜é‡è¡¨æ˜¯çº¿ç¨‹ç§æœ‰çš„åŒºåŸŸï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½æ‹¥æœ‰ç‹¬ç«‹çš„å±€éƒ¨å˜é‡è¡¨</li><li>å±€éƒ¨å˜é‡è¡¨èƒ½å¤Ÿå­˜å‚¨åŸºæœ¬æ•°æ®ç±»å‹çš„å…ƒç´ ã€å¼•ç”¨æ•°æ®ç±»å‹çš„å…ƒç´ ï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼šå®é™…å­˜å‚¨çš„æ˜¯å¼•ç”¨æ•°æ®ç±»å‹çš„å…ƒç´ çš„å¼•ç”¨ï¼‰ã€è¿”å›åœ°å€ï¼ˆå³ <code>Java5</code> çš„ <code>returnAddress</code> ç±»å‹ï¼Œäº†è§£å³å¯ï¼‰</li><li>é™æ€å˜é‡ã€é™æ€å¸¸é‡ã€å®ä¾‹å˜é‡ã€å®ä¾‹å¸¸é‡åœ¨ä¸åŒé˜¶æ®µä¼šè¢«èµ‹é»˜è®¤å€¼ï¼Œç„¶è€Œæ–¹æ³•å‚æ•°ã€å±€éƒ¨å˜é‡å¹¶ä¸ä¼šåœ¨æŸé˜¶æ®µè¢«èµ‹é»˜è®¤å€¼ã€‚å› æ­¤æˆ‘ä»¬åœ¨ä½¿ç”¨æ–¹æ³•å‚æ•°ã€å±€éƒ¨å˜é‡ä¹‹å‰ï¼Œå¿…é¡»å¯¹å…¶è¿›è¡Œæ‰‹åŠ¨èµ‹å€¼ï¼Œå¦åˆ™ä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯ï¼ˆä¾‹å¦‚ä½ åœ¨å®ä¾‹å˜é‡ä¸­ <code>int i</code>ï¼Œä¸æ‰‹åŠ¨èµ‹å€¼å°±å¯ä»¥æ­£å¸¸ä½¿ç”¨ã€‚ä½†æ˜¯ä½ åœ¨å±€éƒ¨å˜é‡ä¸­ <code>int i</code>ï¼Œä¸æ‰‹åŠ¨èµ‹å€¼è‚¯å®šä¸å¯ä»¥æ­£å¸¸ä½¿ç”¨ï¼‰</li></ol></blockquote><hr><h5 id="2-3-2-2-å±€éƒ¨å˜é‡è¡¨åº•å±‚å®ç°"><a href="#2-3-2-2-å±€éƒ¨å˜é‡è¡¨åº•å±‚å®ç°" class="headerlink" title="2.3.2.2. å±€éƒ¨å˜é‡è¡¨åº•å±‚å®ç°"></a>2.3.2.2. å±€éƒ¨å˜é‡è¡¨åº•å±‚å®ç°</h5><p>å±€éƒ¨å˜é‡è¡¨åº•å±‚æ˜¯åŸºäºä¸€ä¸ªä¸€ç»´æ•°ç»„å®ç°çš„ï¼Œè¯¥æ•°ç»„çš„åŸºæœ¬å­˜å‚¨å•å…ƒæ˜¯å˜é‡æ§½ï¼ˆ<code>Slot</code>ï¼‰ï¼š</p><ol><li>åœ¨ <code>32 bit</code> çš„ <code>JVM</code> ä¸­ï¼Œä¸€ä¸ª <code>Slot</code> å ç”¨ <code>4 byte</code> çš„å†…å­˜ç©ºé—´</li><li>åœ¨ <code>64 bit</code> çš„ <code>JVM</code> ä¸­ï¼Œä¸€ä¸ª <code>Slot</code> å ç”¨ <code>8 byte</code> çš„å†…å­˜ç©ºé—´</li></ol><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>å½“çº¿ç¨‹è°ƒç”¨æŸç±»çš„æ„é€ æ–¹æ³•ã€æŸå®ä¾‹çš„å®ä¾‹æ–¹æ³•æ—¶ï¼ŒæŒ‡å‘è¢«æ„é€ çš„å®ä¾‹ã€è°ƒç”¨çš„å®ä¾‹çš„å†…å­˜åœ°å€çš„å¼•ç”¨ï¼ˆå³ <code>this</code>ï¼‰å°±è¢«å­˜å‚¨åœ¨å±€éƒ¨å˜é‡è¡¨çš„æ•°ç»„ç´¢å¼•ä¸º <code>0</code> çš„æ•°ç»„ä½ç½®ä¸­<ol><li>éœ€è¦æ³¨æ„çš„æ˜¯ï¼š<ol><li>è¿™æ˜¯ <code>Java</code> ä¸­çš„ä¸€ä¸ªè¯­æ³•ç³–ï¼Œä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬èƒ½åœ¨å®ä¾‹æ–¹æ³•ä¸­ä½¿ç”¨ <code>this</code> çš„åŸå› </li><li>ç”±äºçº¿ç¨‹è°ƒç”¨æŸç±»ã€æŸå®ä¾‹çš„é™æ€æ–¹æ³•æ—¶ï¼Œæ ¹æœ¬ä¸å­˜åœ¨ <code>this</code>ï¼Œä¹Ÿå°±å¯¼è‡´æˆ‘ä»¬ä¸èƒ½åœ¨é™æ€æ–¹æ³•ä¸­ä½¿ç”¨ <code>this</code></li></ol></li></ol></li></ol></blockquote><hr><h5 id="2-3-2-3-å±€éƒ¨å˜é‡è¡¨ç©ºé—´å¤§å°"><a href="#2-3-2-3-å±€éƒ¨å˜é‡è¡¨ç©ºé—´å¤§å°" class="headerlink" title="2.3.2.3. å±€éƒ¨å˜é‡è¡¨ç©ºé—´å¤§å°"></a>2.3.2.3. å±€éƒ¨å˜é‡è¡¨ç©ºé—´å¤§å°</h5><p>å±€éƒ¨å˜é‡è¡¨çš„å†…å­˜ç©ºé—´å¤§å°åœ¨ç¼–è¯‘é˜¶æ®µå°±å·²ç»ç¡®å®šäº†ï¼Œåœ¨è¿è¡Œæ—¶æ— æ³•æ›´æ”¹ï¼š</p><ol><li>å ç”¨å†…å­˜ç©ºé—´ <code>32 bit</code> åŠä»¥ä¸‹çš„æ•°æ®ï¼ˆä¾‹å¦‚ <code>byte</code>ã€<code>short</code>ã€<code>int</code>ã€<code>float</code>ã€<code>char</code>ã€<code>boolean</code> æ•°æ®ç±»å‹çš„æ•°æ®ã€å¼•ç”¨æ•°æ®ç±»å‹çš„æ•°æ®ã€è¿”å›åœ°å€ï¼‰å ç”¨ä¸€ä¸ª <code>Slot</code></li><li>å ç”¨å†…å­˜ç©ºé—´ <code>64 bit</code> çš„æ•°æ®ï¼ˆä¾‹å¦‚ <code>long</code>ã€<code>double</code> æ•°æ®ç±»å‹çš„æ•°æ®ï¼‰å ç”¨ä¸¤ä¸ª <code>Slot</code></li></ol><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>åœ¨ <code>JVM</code> ä¸­ï¼Œ<code>byte</code>ã€<code>short</code>ã€<code>char</code>ã€<code>boolean</code> æ•°æ®ç±»å‹çš„æ•°æ®ï¼Œå®é™…ä¸Šæ˜¯è¢«å½“ä½œ <code>int</code> æ•°æ®ç±»å‹çš„æ•°æ®è¿›è¡Œå¤„ç†çš„ï¼ˆå› ä¸º <code>int</code> æ•°æ®ç±»å‹çš„èŒƒå›´æ¶µç›–å®ƒä»¬ï¼Œè€Œä¸” <code>JVM</code> ä¸­å¹¶æ²¡æœ‰ä¸“é—¨å¤„ç† <code>byte</code>ã€<code>short</code>ã€<code>char</code>ã€<code>boolean</code> æ•°æ®ç±»å‹çš„æ•°æ®çš„ <code>JVM</code> å­—èŠ‚ç æŒ‡ä»¤ï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼šå¦‚æœè¿™äº›æ•°æ®ç±»å‹çš„æ•°æ®åœ¨å †åŒºä¸­ï¼ˆä¾‹å¦‚æ˜¯æŸå®ä¾‹çš„å®ä¾‹å˜é‡ï¼‰ï¼Œè¯¥å ç”¨å¤šå°‘å†…å­˜ç©ºé—´å°±å ç”¨å¤šå°‘å†…å­˜ç©ºé—´ï¼‰ï¼‰</li><li><code>Slot</code> æ˜¯å¯ä»¥å¤ç”¨çš„ï¼ˆä¾‹å¦‚å½“å±€éƒ¨å˜é‡ <code>A</code> çš„ç”Ÿå‘½å‘¨æœŸç»“æŸåï¼Œå¦‚æœå£°æ˜äº†æ–°çš„å±€éƒ¨å˜é‡ <code>B</code>ï¼Œé‚£ä¹ˆ <code>B</code> å¯èƒ½ä¼šå¤ç”¨ <code>A</code> çš„ <code>Slot</code>ï¼Œä»è€Œè¾¾åˆ°èŠ‚çœå†…å­˜ç©ºé—´çš„ç›®çš„ï¼‰ä»¥å¦‚ä¸‹ä»£ç ä¸ºä¾‹ï¼Œå±€éƒ¨å˜é‡ <code>b</code> ä¼šå¤ç”¨å±€éƒ¨å˜é‡ <code>a</code> çš„ <code>Slot</code>ï¼Œå› æ­¤æ•´ä¸ª <code>main</code> æ–¹æ³•çš„å±€éƒ¨å˜é‡è¡¨æœ€å¤§åªéœ€è¦ <code>2</code> ä¸ª <code>Slot</code></li></ol></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> &#123;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;  <br>    <br>        &#123;  <br>            <span class="hljs-type">int</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> <span class="hljs-number">10</span>;  <br>            System.out.println(a);  <br>        &#125;  <br>  <br>        &#123;  <br>            <span class="hljs-type">int</span> <span class="hljs-variable">b</span> <span class="hljs-operator">=</span> <span class="hljs-number">20</span>;  <br>            System.out.println(b);  <br>        &#125;  <br>        <br>    &#125;  <br>    <br>&#125;<br></code></pre></td></tr></table></figure><hr><h4 id="2-4-æ–¹æ³•è¿”å›åœ°å€"><a href="#2-4-æ–¹æ³•è¿”å›åœ°å€" class="headerlink" title="2.4. æ–¹æ³•è¿”å›åœ°å€"></a>2.4. æ–¹æ³•è¿”å›åœ°å€</h4><p>å½“çº¿ç¨‹è°ƒç”¨æŸæ–¹æ³•æ—¶ï¼Œ<code>JVM</code> ä¼šå…ˆæŠŠç¨‹åºè®¡æ•°å™¨ä¸­çš„å†…å®¹ï¼ˆå³å½“å‰çº¿ç¨‹è¦å»æ‰§è¡Œçš„ä¸‹ä¸€æ¡ <code>JVM</code> å­—èŠ‚ç æŒ‡ä»¤çš„å†…å­˜åœ°å€ï¼‰è®°å½•åœ¨è¯¥æ–¹æ³•å¯¹åº”çš„æ ˆå¸§ä¸­çš„æ–¹æ³•è¿”å›åœ°å€ä¸­ï¼Œç„¶åå†å¼€å§‹æ‰§è¡Œè¯¥æ–¹æ³•</p><p>å¦‚æœçº¿ç¨‹æ‰§è¡Œæ–¹æ³•çš„è¿‡ç¨‹ä¸­æœªæŠ›å‡ºå¼‚å¸¸ï¼Œé‚£ä¹ˆå½“çº¿ç¨‹æ‰§è¡Œåˆ°ä»¥ä¸‹ <code>JVM</code> å­—èŠ‚ç æŒ‡ä»¤æ—¶ï¼Œå°±ä¼šå°†æ‰§è¡Œçš„æ–¹æ³•å¯¹åº”çš„æ ˆå¸§ä¸­çš„æ–¹æ³•è¿”å›åœ°å€ä¸­çš„å†…å®¹å–å‡ºæ¥ï¼Œå¹¶è®°å½•åœ¨ç¨‹åºè®¡æ•°å™¨ä¸­ï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼šè¿™å°±æ˜¯æ­£å¸¸é€€å‡ºï¼ˆæœªæŠ›å‡ºå¼‚å¸¸ï¼‰ï¼‰ï¼š<br>    1. <code>ireturn</code><br>        1. è¿”å› <code>byte</code>ã€<code>short</code>ã€<code>int</code>ã€<code>char</code>ã€<code>boolean</code>  æ•°æ®ç±»å‹çš„æ•°æ®<br>    2. <code>lreturn</code><br>        1. è¿”å› <code>long</code> æ•°æ®ç±»å‹çš„æ•°æ®<br>    3. <code>freturn</code><br>        1. è¿”å› <code>float</code> æ•°æ®ç±»å‹çš„æ•°æ®<br>    4. <code>dreturn</code><br>        1. è¿”å› <code>double</code> æ•°æ®ç±»å‹çš„æ•°æ®<br>    5. <code>areturn</code><br>        1. è¿”å›å¼•ç”¨æ•°æ®ç±»å‹çš„æ•°æ®<br>    6. <code>return</code><br>        1. è¿”å›ï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼šé€‚ç”¨äºæ— è¿”å›å€¼çš„æ–¹æ³•ï¼‰</p><p>ä½†æ˜¯å¦‚æœçº¿ç¨‹æ‰§è¡Œæ–¹æ³•çš„è¿‡ç¨‹ä¸­æŠ›å‡ºäº†å¼‚å¸¸ï¼Œé‚£ä¹ˆçº¿ç¨‹å°±ä¼šæŸ¥æ‰¾æ–¹æ³•åŒºä¸­è¯¥æ–¹æ³•å¯¹åº”çš„ç±»å¯¹åº”çš„ç±»å…ƒæ•°æ®åŒºä¸­çš„æ–¹æ³•ä¿¡æ¯ä¸­çš„å¼‚å¸¸å¤„ç†å™¨è¡¨ï¼Œè¿™ä¸ªè¡¨ä¸­è®°å½•äº† Fromã€Toã€Targetã€Typeï¼Œçº¿ç¨‹ä¼šæ‹¿ç€è¡Œå·ä» From å’Œ To ä¹‹é—´æ£€æŸ¥ï¼Œå¦‚æœ Type åŒ¹é…ï¼Œå°±è·³åˆ° Target å¤„æ‰§è¡Œï¼ˆå³ catch å—ï¼‰ï¼Œå¦‚æœæœªåŒ¹é…ï¼Œå°±å°†è¯¥æ ˆå¸§å¼¹å‡ºï¼Œå°†å¼‚å¸¸æŠ›ç»™è°ƒç”¨è€…</p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>æ–¹æ³•é€€å‡ºåˆ†ä¸ºæ–¹æ³•æ­£å¸¸é€€å‡ºï¼ˆå‘ç”Ÿå¼‚å¸¸ã€æœªå‘ç”Ÿå¼‚å¸¸ï¼‰ã€æ–¹æ³•å¼‚å¸¸é€€å‡ºï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼šæ–¹æ³•æ­£å¸¸é€€å‡ºï¼ˆå‘ç”Ÿå¼‚å¸¸ï¼‰æ˜¯åœ¨ catch å—ä¸­æ•è·å¹¶å¤„ç†äº†å¼‚å¸¸ï¼Œå¹¶ä¸”æ²¡æœ‰æŠ›å‡ºæ–°çš„å¼‚å¸¸ï¼‰</li><li>å¦‚æœæˆ‘ä»¬æ•è·å¹¶å¤„ç†å¼‚å¸¸æ—¶ï¼ŒæŠ›å‡ºä¸€ä¸ªæ–°çš„å¼‚å¸¸ï¼ŒåŒæ ·ä¼šå†å»æŸ¥è¡¨ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬æ²¡æœ‰åœ¨ catch å—ä¸­åµŒå¥— catchï¼Œå¾ˆå¯èƒ½æ— æ³•æ•è·å¹¶å¤„ç†è¿™ä¸ªæ–°çš„å¼‚å¸¸</li><li>åœ¨æ­£å¸¸é€€å‡ºï¼ˆå‘ç”Ÿå¼‚å¸¸ï¼‰ä¸­ï¼Œå‘ç”Ÿå¼‚å¸¸æ—¶ï¼Œç¨‹åºçš„æ‰§è¡Œæµç¨‹ä¼šç«‹å³è·³è½¬åˆ°å¯¹åº”çš„ <code>catch</code> å—è¿›è¡Œå¤„ç†ã€‚å¼‚å¸¸è¢«æ•è·å¹¶å¤„ç†åï¼Œä¸ä¼šå›åˆ°åŸå…ˆæŠ›å‡ºå¼‚å¸¸çš„ä½ç½®ç»§ç»­å‘ä¸‹æ‰§è¡Œï¼Œè€Œæ˜¯ç›´æ¥é€€å‡º</li></ol></blockquote><hr><h4 id="2-5-ä¸€äº›é™„åŠ ä¿¡æ¯"><a href="#2-5-ä¸€äº›é™„åŠ ä¿¡æ¯" class="headerlink" title="2.5. ä¸€äº›é™„åŠ ä¿¡æ¯"></a>2.5. ä¸€äº›é™„åŠ ä¿¡æ¯</h4><p>åœ¨ <code>JVM</code> è§„èŒƒä¸­ï¼Œå…è®¸åœ¨æ ˆå¸§ä¸­æ·»åŠ ä¸€äº›é™„åŠ ä¿¡æ¯ï¼ˆä¾‹å¦‚è°ƒè¯•ä¿¡æ¯ã€æ€§èƒ½åˆ†æä¿¡æ¯ç­‰ï¼‰ï¼Œä»è€Œè¾¾åˆ°ä¼˜åŒ–ã€è°ƒè¯•ç­‰çš„ç›®çš„</p><hr><h3 id="2-6-æœ¬åœ°æ–¹æ³•æ ˆ"><a href="#2-6-æœ¬åœ°æ–¹æ³•æ ˆ" class="headerlink" title="2.6. æœ¬åœ°æ–¹æ³•æ ˆ"></a>2.6. æœ¬åœ°æ–¹æ³•æ ˆ</h3><p>æœ¬åœ°æ–¹æ³•æ ˆä¸»è¦ç”¨äº <code>native</code> æ–¹æ³•</p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>åœ¨ <code>HotSpot JVM</code> ä¸­ï¼Œè™šæ‹Ÿæœºæ ˆã€æœ¬åœ°æ–¹æ³•æ ˆè¢«åˆå¹¶ä¸ºåŒä¸€ä¸ªæ ˆ</li><li>å¹¶éæ‰€æœ‰ç±»å‹çš„ <code>JVM</code> éƒ½æ”¯æŒ <code>native</code> æ–¹æ³•ï¼ˆå› ä¸ºåœ¨ <code>JVM</code> è§„èŒƒä¸­ï¼Œå¹¶æ²¡æœ‰æ˜ç¡®è¦æ±‚å®ç°æœ¬åœ°æ–¹æ³•æ ˆæ—¶ä½¿ç”¨çš„è¯­è¨€ã€å®ç°çš„æ–¹å¼ç­‰ã€‚ç”šè‡³å¦‚æœä¸æ‰“ç®—æ”¯æŒ <code>native</code> æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥æ— éœ€å®ç°æœ¬åœ°æ–¹æ³•æ ˆï¼‰</li></ol></blockquote><hr><h3 id="2-7-å †åŒº"><a href="#2-7-å †åŒº" class="headerlink" title="2.7. å †åŒº"></a>2.7. å †åŒº</h3><h4 id="2-7-1-å †åŒºç»„æˆéƒ¨åˆ†"><a href="#2-7-1-å †åŒºç»„æˆéƒ¨åˆ†" class="headerlink" title="2.7.1. å †åŒºç»„æˆéƒ¨åˆ†"></a>2.7.1. å †åŒºç»„æˆéƒ¨åˆ†</h4><p><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJVM/%E7%AC%94%E8%AE%B0%EF%BC%9AJVM-2.png"></p><h4 id="2-7-2-å †åŒºæ¦‚è¿°"><a href="#2-7-2-å †åŒºæ¦‚è¿°" class="headerlink" title="2.7.2. å †åŒºæ¦‚è¿°"></a>2.7.2. å †åŒºæ¦‚è¿°</h4><p>å †åŒºæ˜¯ <code>JVM</code> ç®¡ç†å†…å­˜ç©ºé—´çš„æ ¸å¿ƒåŒºåŸŸï¼Œä¹Ÿæ˜¯æ•´ä¸ª <code>JVM</code> ä¸­å†…å­˜ç©ºé—´æœ€å¤§çš„åŒºåŸŸï¼Œå‡ ä¹æ‰€æœ‰çš„å®ä¾‹éƒ½ä¼šåœ¨å †åŒºåˆ†é…å†…å­˜ç©ºé—´ï¼ˆå› ä¸ºéœ€è¦è€ƒè™‘é€ƒé€¸åˆ†æï¼‰</p><blockquote><p>[!NOTE] Title</p><ol><li>å †åŒºæ—¢ä¼šå‘ç”Ÿ <code>GC</code>ï¼Œä¹Ÿä¼šæŠ›å‡º <code>OutOfMemoryError</code> é”™è¯¯ï¼š<ol><li><code>OutOfMemoryError: Java heap space</code><ol><li>å †åŒºå†…å­˜ç©ºé—´ä¸è¶³</li></ol></li></ol></li><li>å †åŒºæ˜¯çº¿ç¨‹å…±äº«çš„åŒºåŸŸï¼ˆä½†æ˜¯éœ€è¦è€ƒè™‘ <code>TLAB</code>ï¼‰ï¼Œåœ¨å•ä¸ª <code>JVM</code> ä¸­å…¨å±€å”¯ä¸€</li></ol></blockquote><hr><h4 id="2-7-3-å †åŒºç©ºé—´å¤§å°"><a href="#2-7-3-å †åŒºç©ºé—´å¤§å°" class="headerlink" title="2.7.3. å †åŒºç©ºé—´å¤§å°"></a>2.7.3. å †åŒºç©ºé—´å¤§å°</h4><p>å †åŒºåœ¨è¿è¡Œæ—¶å…·æœ‰åˆå§‹çš„å†…å­˜ç©ºé—´çš„å¤§å°ï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼šç”± <code>-Xms512m</code> å†³å®šï¼‰ï¼Œå¹¶æ”¯æŒåŠ¨æ€æ‰©å±•å†…å­˜ç©ºé—´ï¼Œä½†æ˜¯å—åˆ°æœ€å¤§å†…å­˜ç©ºé—´çš„é™åˆ¶ï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼šç”± <code>-Xmx2048m</code> å†³å®šï¼‰ï¼Œä¸€æ—¦è¶…å‡ºè¯¥é™åˆ¶ï¼Œå¯èƒ½ä¼šæŠ›å‡º <code>OOM</code> é”™è¯¯ï¼ˆå› ä¸ºéœ€è¦è€ƒè™‘ <code>GC</code>ï¼‰</p><hr><h4 id="2-7-4-å®ä¾‹åœ¨å †åŒºåˆ†é…å†…å­˜ç©ºé—´ç›¸å…³æµç¨‹"><a href="#2-7-4-å®ä¾‹åœ¨å †åŒºåˆ†é…å†…å­˜ç©ºé—´ç›¸å…³æµç¨‹" class="headerlink" title="2.7.4. å®ä¾‹åœ¨å †åŒºåˆ†é…å†…å­˜ç©ºé—´ç›¸å…³æµç¨‹"></a>2.7.4. å®ä¾‹åœ¨å †åŒºåˆ†é…å†…å­˜ç©ºé—´ç›¸å…³æµç¨‹</h4><p><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJVM/%E7%AC%94%E8%AE%B0%EF%BC%9AJVM-3.png"></p><hr><h4 id="2-7-5-TLAB"><a href="#2-7-5-TLAB" class="headerlink" title="2.7.5. TLAB"></a>2.7.5. TLAB</h4><h5 id="2-7-5-1-TLAB-æ¦‚è¿°"><a href="#2-7-5-1-TLAB-æ¦‚è¿°" class="headerlink" title="2.7.5.1. TLAB æ¦‚è¿°"></a>2.7.5.1. TLAB æ¦‚è¿°</h5><p>æƒ³è±¡è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼š<code>JVM</code> ä¸ºäº†å¿«é€Ÿä¸ºå®ä¾‹åœ¨å †åŒºåˆ†é…å†…å­˜ç©ºé—´ï¼Œé‡‡ç”¨äº† â€œæŒ‡é’ˆç¢°æ’â€ æŠ€æœ¯ï¼ˆå³ä½¿ç”¨ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘ <code>Eden</code> åŒºå·²ç»ä½¿ç”¨çš„å†…å­˜ç©ºé—´çš„è¾¹ç•Œï¼Œåœ¨ä¸ºå®ä¾‹åˆ†é…å†…å­˜ç©ºé—´æ—¶ï¼Œåªéœ€è¦æ£€æŸ¥å‰©ä½™çš„å†…å­˜ç©ºé—´æ˜¯å¦è¶³å¤Ÿï¼Œç„¶åæŒ‰éœ€é¡ºåºåç§»æŒ‡é’ˆï¼Œå³å¯å®Œæˆå®ä¾‹åœ¨å †åŒºåˆ†é…å†…å­˜ç©ºé—´ï¼‰ã€‚</p><p>ä½†æ˜¯æˆ‘ä»¬çŸ¥é“ï¼šå †åŒºæ˜¯çº¿ç¨‹å…±äº«çš„åŒºåŸŸã€‚é‚£ä¹ˆåœ¨å¤šçº¿ç¨‹å¹¶å‘åœºæ™¯ä¸‹ï¼Œå°±ä¼šå‡ºç°å¤šçº¿ç¨‹å¹¶å‘å¯¹å †åŒºè¿›è¡Œä¿®æ”¹çš„æƒ…å†µã€‚ä¼ ç»Ÿçš„è§£å†³æ–¹æ¡ˆæ˜¯åŠ é”ï¼Œä½†è¿™ä¼šæˆä¸ºä¸€ä¸ªæ˜¾è‘—çš„æ€§èƒ½ç“¶é¢ˆ</p><p>ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼Œ<code>JVM</code> æä¾›äº† <code>TLAB</code>ã€‚å®ƒå°†å®ä¾‹åœ¨çº¿ç¨‹å…±äº«çš„å †åŒºåˆ†é…å†…å­˜ç©ºé—´ï¼Œå˜æˆå®ä¾‹åœ¨çº¿ç¨‹ç§æœ‰çš„ <code>TLAB</code> åˆ†é…å†…å­˜ç©ºé—´</p><hr><h5 id="2-7-5-2-TLAB-ç›¸å…³æµç¨‹"><a href="#2-7-5-2-TLAB-ç›¸å…³æµç¨‹" class="headerlink" title="2.7.5.2. TLAB ç›¸å…³æµç¨‹"></a>2.7.5.2. TLAB ç›¸å…³æµç¨‹</h5><p><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJVM/%E7%AC%94%E8%AE%B0%EF%BC%9AJVM-5.png"></p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>ç”³è¯·æ–° <code>TLAB</code> æ—¶ï¼Œæ˜¯é€šè¿‡ <code>CAS</code> ä¿è¯å¤šçº¿ç¨‹å¹¶å‘å®‰å…¨çš„ï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼šæ—§ <code>TLAB</code> çš„å‰©ä½™ç©ºé—´ä¼šä½¿ç”¨ä¸€ä¸ª <code>int</code> ç±»å‹çš„æ•°ç»„å¡«å……ï¼Œè¿™éƒ¨åˆ†ç©ºé—´ä¼šè¢« <code>GC</code>ï¼‰</li><li><code>JVM</code> ä¸ºäº†å¿«é€Ÿä¸ºå®ä¾‹åœ¨ <code>TLAB</code> åˆ†é…å†…å­˜ç©ºé—´ï¼Œé‡‡ç”¨äº† â€œæŒ‡é’ˆç¢°æ’â€ æŠ€æœ¯ï¼ˆå› ä¸º <code>TLAB</code> æ˜¯çº¿ç¨‹ç§æœ‰çš„ï¼Œå› æ­¤ä¸å­˜åœ¨å¤šçº¿ç¨‹å¹¶å‘åœºæ™¯ä¸‹çš„å®‰å…¨é—®é¢˜ï¼‰</li></ol></blockquote><hr><h4 id="2-7-6-é€ƒé€¸åˆ†æ"><a href="#2-7-6-é€ƒé€¸åˆ†æ" class="headerlink" title="2.7.6. é€ƒé€¸åˆ†æ"></a>2.7.6. é€ƒé€¸åˆ†æ</h4><h5 id="2-7-6-1-é€ƒé€¸åˆ†ææ¦‚è¿°"><a href="#2-7-6-1-é€ƒé€¸åˆ†ææ¦‚è¿°" class="headerlink" title="2.7.6.1. é€ƒé€¸åˆ†ææ¦‚è¿°"></a>2.7.6.1. é€ƒé€¸åˆ†ææ¦‚è¿°</h5><p>é€ƒé€¸åˆ†ææ˜¯æŒ‡ï¼š<code>JIT</code> åœ¨ç¼–è¯‘ <code>Java</code> ä»£ç æ—¶ï¼Œä¼šåˆ†æä¸€ä¸ªå®ä¾‹åœ¨è¢«åˆ›å»ºåï¼Œæ˜¯å¦è¢«å¤–éƒ¨ï¼ˆå³å…¶ä»–çº¿ç¨‹ã€è°ƒç”¨å¯¹è±¡çš„æ„é€ æ–¹æ³•çš„æ–¹æ³•ä¹‹å¤–çš„æ–¹æ³•ï¼‰å¼•ç”¨ã€‚å¦‚æœ <code>JIT</code> å‘ç°ä¸€ä¸ªå®ä¾‹å¹¶æ²¡æœ‰é€ƒé€¸ï¼Œå°±å¯ä»¥å¯¹è¿™ä¸ªå®ä¾‹è¿›è¡Œæ·±åº¦çš„åº•å±‚ä¼˜åŒ–ï¼Œä»è€Œæå¤§æå‡æ€§èƒ½ã€‚</p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>ä»å·¥ç¨‹å®è·µçš„è§’åº¦æ¥çœ‹ï¼šèƒ½ä½¿ç”¨æ–¹æ³•å‚æ•°ã€å±€éƒ¨å˜é‡ï¼Œå°±ä½¿ç”¨æ–¹æ³•å‚æ•°ã€å±€éƒ¨å˜é‡</li></ol></blockquote><hr><h5 id="2-7-6-2-é€ƒé€¸åˆ†æç›¸å…³åˆ†ç±»"><a href="#2-7-6-2-é€ƒé€¸åˆ†æç›¸å…³åˆ†ç±»" class="headerlink" title="2.7.6.2. é€ƒé€¸åˆ†æç›¸å…³åˆ†ç±»"></a>2.7.6.2. é€ƒé€¸åˆ†æç›¸å…³åˆ†ç±»</h5><ol><li>æ–¹æ³•é€ƒé€¸</li><li>çº¿ç¨‹é€ƒé€¸</li></ol><h5 id="2-7-6-3-æ–¹æ³•é€ƒé€¸"><a href="#2-7-6-3-æ–¹æ³•é€ƒé€¸" class="headerlink" title="2.7.6.3. æ–¹æ³•é€ƒé€¸"></a>2.7.6.3. æ–¹æ³•é€ƒé€¸</h5><p>æ–¹æ³•é€ƒé€¸æ˜¯æŒ‡ï¼šåœ¨æŸæ–¹æ³•ä¸­è°ƒç”¨æŸå¯¹è±¡çš„æ„é€ æ–¹æ³•ï¼Œåˆ›å»ºæŸå®ä¾‹ï¼Œä½†æ˜¯è¯¥å®ä¾‹ä½œä¸ºè¯¥æ–¹æ³•çš„è¿”å›ç»“æœè¿”å›ç»™äº†å…¶ä»–æ–¹æ³•ï¼Œå¯¼è‡´å…¶ä»–æ–¹æ³•å¯èƒ½è®¿é—®è¯¥å®ä¾‹</p><hr><h5 id="2-7-6-4-çº¿ç¨‹é€ƒé€¸"><a href="#2-7-6-4-çº¿ç¨‹é€ƒé€¸" class="headerlink" title="2.7.6.4. çº¿ç¨‹é€ƒé€¸"></a>2.7.6.4. çº¿ç¨‹é€ƒé€¸</h5><p>çº¿ç¨‹é€ƒé€¸æ˜¯æŒ‡ï¼šæŸå®ä¾‹è¢«èµ‹å€¼ç»™é™æ€å˜é‡ã€é™æ€å¸¸é‡ï¼Œå¯¼è‡´å…¶ä»–çº¿ç¨‹å¯èƒ½è®¿é—®è¯¥å®ä¾‹</p><hr><h5 id="2-7-6-5-å®ä¾‹æ²¡æœ‰é€ƒé€¸æ—¶ï¼ŒJIT-å¯¹å…¶è¿›è¡Œçš„ä¼˜åŒ–"><a href="#2-7-6-5-å®ä¾‹æ²¡æœ‰é€ƒé€¸æ—¶ï¼ŒJIT-å¯¹å…¶è¿›è¡Œçš„ä¼˜åŒ–" class="headerlink" title="2.7.6.5. å®ä¾‹æ²¡æœ‰é€ƒé€¸æ—¶ï¼ŒJIT å¯¹å…¶è¿›è¡Œçš„ä¼˜åŒ–"></a>2.7.6.5. å®ä¾‹æ²¡æœ‰é€ƒé€¸æ—¶ï¼ŒJIT å¯¹å…¶è¿›è¡Œçš„ä¼˜åŒ–</h5><ol><li>æ ˆä¸Šåˆ†é…</li><li>æ ‡é‡æ›¿æ¢</li><li>é”æ¶ˆé™¤</li></ol><h6 id="2-7-6-5-1-æ ˆä¸Šåˆ†é…"><a href="#2-7-6-5-1-æ ˆä¸Šåˆ†é…" class="headerlink" title="2.7.6.5.1. æ ˆä¸Šåˆ†é…"></a>2.7.6.5.1. æ ˆä¸Šåˆ†é…</h6><p>æˆ‘ä»¬çŸ¥é“ â€œå‡ ä¹æ‰€æœ‰çš„å®ä¾‹éƒ½ä¼šåœ¨å †åŒºåˆ†é…å†…å­˜ç©ºé—´â€ï¼Œä½†æ˜¯å †åŒºä¸­çš„å®ä¾‹æ˜¯éœ€è¦è¢« <code>GC</code> çš„</p><p>è€Œæ ˆä¸Šåˆ†é…æ˜¯æŒ‡ï¼šå¦‚æœ <code>JIT</code> å‘ç°ä¸€ä¸ªå®ä¾‹å¹¶æ²¡æœ‰é€ƒé€¸ï¼Œå°±å¯ä»¥å°†å®ä¾‹åœ¨å †åŒºåˆ†é…å†…å­˜ç©ºé—´ï¼Œå˜æˆå®ä¾‹åœ¨æ ˆå¸§åˆ†é…å†…å­˜ç©ºé—´ã€‚è¿™æ ·å®ä¾‹å°±å¯ä»¥éšæ ˆå¸§è¢«å¼¹å‡ºè€Œè¢«è‡ªåŠ¨é”€æ¯ï¼Œå®Œå…¨ä¸éœ€è¦è¢« <code>GC</code></p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li><code>HotSpot JVM</code> å¹¶æ²¡æœ‰å®ç°çœŸæ­£æ„ä¹‰ä¸Šçš„æ ˆä¸Šåˆ†é…ï¼ˆå› ä¸º <code>HotSpot JVM</code> ä¸»è¦æ˜¯é€šè¿‡æ ‡é‡æ›¿æ¢å®ç°ä¼˜åŒ–çš„ï¼‰</li></ol></blockquote><hr><h6 id="2-7-6-5-2-æ ‡é‡æ›¿æ¢"><a href="#2-7-6-5-2-æ ‡é‡æ›¿æ¢" class="headerlink" title="2.7.6.5.2. æ ‡é‡æ›¿æ¢"></a>2.7.6.5.2. æ ‡é‡æ›¿æ¢</h6><hr><h6 id="2-7-6-5-3-é”é”€é™¤"><a href="#2-7-6-5-3-é”é”€é™¤" class="headerlink" title="2.7.6.5.3. é”é”€é™¤"></a>2.7.6.5.3. é”é”€é™¤</h6><p>é”é”€é™¤æ˜¯æŒ‡ï¼šå¦‚æœ <code>JIT</code> å‘ç°ä¸€ä¸ªå®ä¾‹å¹¶æ²¡æœ‰é€ƒé€¸ï¼Œå°±å¯ä»¥å°†è¯¥å®ä¾‹ä¸ŠåŠ çš„ <code>synchronized</code> é”å»æ‰ï¼ˆå› ä¸ºæ ¹æœ¬ä¸å­˜åœ¨å¤šçº¿ç¨‹å¹¶å‘åœºæ™¯ä¸‹çš„å®‰å…¨é—®é¢˜ï¼‰</p><hr><h3 id="2-8-æ–¹æ³•åŒº"><a href="#2-8-æ–¹æ³•åŒº" class="headerlink" title="2.8. æ–¹æ³•åŒº"></a>2.8. æ–¹æ³•åŒº</h3><h4 id="2-8-1-æ–¹æ³•åŒºå…·ä½“ç»†èŠ‚"><a href="#2-8-1-æ–¹æ³•åŒºå…·ä½“ç»†èŠ‚" class="headerlink" title="2.8.1. æ–¹æ³•åŒºå…·ä½“ç»†èŠ‚"></a>2.8.1. æ–¹æ³•åŒºå…·ä½“ç»†èŠ‚</h4><p><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJVM/%E7%AC%94%E8%AE%B0%EF%BC%9AJVM-7.png"></p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>æ¯ä¸€ä¸ªå®ä¾‹éƒ½ä¼šæŒæœ‰ä¸€ä¸ªæŒ‡å‘å…¶å¯¹åº”çš„ç±»çš„ç±»å…ƒæ•°æ®åŒºçš„å¼•ç”¨ï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼šæŒæœ‰çš„ä½ç½®æ˜¯å¯¹è±¡å¤´ä¸­çš„ <code>Klass Word</code>ï¼‰</li><li>åœ¨ <code>Java8</code> ä¹‹å‰ï¼Œé™æ€éå†ã€é™æ€å¸¸é‡ä¿å­˜åœ¨æ–¹æ³•åŒºã€‚ä½†æ˜¯åœ¨ <code>Java8</code> ä¹‹åï¼Œé™æ€å˜é‡ã€é™æ€å¸¸é‡ä¿å­˜åœ¨å †åŒºä¸­ï¼ˆå› ä¸ºé™æ€å˜é‡ã€é™æ€å¸¸é‡ä¿å­˜åœ¨å®ä¾‹å¯¹åº”çš„ç±»çš„ç±»å¯¹è±¡ä¸­ï¼Œè€Œç±»å¯¹è±¡ä¸€å®šæ˜¯åœ¨å †åŒºåˆ†é…å†…å­˜ç©ºé—´çš„ï¼ˆå› ä¸º <code>JIT</code> ä¸ä¼šå¯¹ç±»å¯¹è±¡è¿›è¡Œé€ƒé€¸åˆ†æï¼Œå› ä¸ºæ— éœ€ä¹Ÿä¸åº”è¯¥å¯¹å…¶è¿›è¡Œé€ƒé€¸åˆ†æï¼Œè€Œä¸”ä¹Ÿæ— æ³•å¯¹å…¶è¿›è¡Œé€ƒé€¸åˆ†æï¼‰ï¼Œæ‰€ä»¥é™æ€å˜é‡ã€é™æ€å¸¸é‡ä¿å­˜åœ¨å †åŒºï¼‰</li></ol></blockquote><hr><h2 id="3-æ‰§è¡Œå¼•æ“"><a href="#3-æ‰§è¡Œå¼•æ“" class="headerlink" title="3. æ‰§è¡Œå¼•æ“"></a>3. æ‰§è¡Œå¼•æ“</h2>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
      <category>JVM</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>ç¬”è®°ï¼šJava æ€§èƒ½</title>
    <link href="/2025/12/10/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%80%A7%E8%83%BD/"/>
    <url>/2025/12/10/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%80%A7%E8%83%BD/</url>
    
    <content type="html"><![CDATA[<h1 id="ä¸€ã€TODO"><a href="#ä¸€ã€TODO" class="headerlink" title="ä¸€ã€TODO"></a>ä¸€ã€TODO</h1><hr><h1 id="äºŒã€è„‘å›¾"><a href="#äºŒã€è„‘å›¾" class="headerlink" title="äºŒã€è„‘å›¾"></a>äºŒã€è„‘å›¾</h1><ol><li><p><code>Xmind</code></p></li><li><p><code>Edraw</code></p></li><li><p><code>Hexo</code> åœ°å€</p></li><li><p>ä»£ç æ´ªè’ï¼ˆé¢è¯•å®å…¸ï¼‰</p></li></ol><hr><h1 id="ä¸‰ã€å½±å“-Java-æ€§èƒ½çš„æ ¸å¿ƒå› ç´ "><a href="#ä¸‰ã€å½±å“-Java-æ€§èƒ½çš„æ ¸å¿ƒå› ç´ " class="headerlink" title="ä¸‰ã€å½±å“ Java æ€§èƒ½çš„æ ¸å¿ƒå› ç´ "></a>ä¸‰ã€å½±å“ Java æ€§èƒ½çš„æ ¸å¿ƒå› ç´ </h1>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
      <category>Java æ€§èƒ½</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>ç¬”è®°ï¼šJava ä¿®é¥°ç¬¦</title>
    <link href="/2025/12/09/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E4%BF%AE%E9%A5%B0%E7%AC%A6/"/>
    <url>/2025/12/09/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E4%BF%AE%E9%A5%B0%E7%AC%A6/</url>
    
    <content type="html"><![CDATA[<h1 id="ä¸€ã€TODO"><a href="#ä¸€ã€TODO" class="headerlink" title="ä¸€ã€TODO"></a>ä¸€ã€TODO</h1><hr><h1 id="äºŒã€è„‘å›¾"><a href="#äºŒã€è„‘å›¾" class="headerlink" title="äºŒã€è„‘å›¾"></a>äºŒã€è„‘å›¾</h1><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/12/09/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E4%BF%AE%E9%A5%B0%E7%AC%A6/">http://blog.wangjia.ink/2025/12/09/ç¬”è®°ï¼šJavaä¿®é¥°ç¬¦/</a></p></li><li><p>ä»£ç æ´ªè’ï¼ˆé¢è¯•å®å…¸ï¼‰<br>ğŸ‘‰ <a href="https://www.notion.so/Java-2cb974fbda5e801abc7beee5d47d8307?source=copy_link">https://www.notion.so/Java-2cb974fbda5e801abc7beee5d47d8307?source=copy_link</a></p></li></ol><hr><h1 id="ä¸‰ã€Java-ä¿®é¥°ç¬¦åŸºç¡€"><a href="#ä¸‰ã€Java-ä¿®é¥°ç¬¦åŸºç¡€" class="headerlink" title="ä¸‰ã€Java ä¿®é¥°ç¬¦åŸºç¡€"></a>ä¸‰ã€Java ä¿®é¥°ç¬¦åŸºç¡€</h1><h2 id="1-Java-ä¿®é¥°ç¬¦ç›¸å…³åˆ†ç±»"><a href="#1-Java-ä¿®é¥°ç¬¦ç›¸å…³åˆ†ç±»" class="headerlink" title="1. Java ä¿®é¥°ç¬¦ç›¸å…³åˆ†ç±»"></a>1. Java ä¿®é¥°ç¬¦ç›¸å…³åˆ†ç±»</h2><ol><li>è®¿é—®ä¿®é¥°ç¬¦<ol><li><code>public</code><ol><li>å¤©ä¸‹çš†å…¬ï¼ˆ<code>EveryWhere</code>ï¼‰</li></ol></li><li><code>protected</code><ol><li>ç±»å†…éƒ¨ + åŒåŒ…å…„å¼Ÿ + å­å¥³ç‰¹æƒ</li><li>å¦‚æœæ˜¯åˆ«äººå°è£…å¥½çš„ï¼Œç±»å†…éƒ¨æ˜¯åšä¸åˆ°äº†ï¼ŒåŒåŒ…å…„å¼Ÿæ˜¯åšä¸æˆäº†ï¼Œåªèƒ½å°è¯•å­å¥³ç‰¹æƒï¼ˆè¿˜å¯ä»¥è°ƒç”¨å®ƒå°è£…å¥½çš„æ–¹æ³•ï¼‰</li></ol></li><li><code>package-private</code><ol><li>ç±»å†…éƒ¨ + åŒåŒ…å…„å¼Ÿ</li><li>å¦‚æœæ˜¯åˆ«äººå°è£…å¥½çš„ï¼Œç±»å†…éƒ¨æ˜¯åšä¸åˆ°äº†ï¼ŒåŒåŒ…å…„å¼Ÿæ˜¯åšä¸æˆäº†ï¼Œè®¿é—®æ˜¯åšä¸åˆ°äº†ï¼ˆé™¤éè°ƒç”¨å®ƒå°è£…å¥½çš„æ–¹æ³•ï¼‰</li></ol></li><li><code>private</code><ol><li>ç‹¬å®ˆç§˜å¯†ï¼ˆç±»å†…éƒ¨ï¼‰</li><li>å¦‚æœæ˜¯åˆ«äººå°è£…å¥½çš„ï¼Œç±»å†…éƒ¨æ˜¯åšä¸åˆ°äº†ï¼Œè®¿é—®æ˜¯åšä¸åˆ°äº†ï¼ˆé™¤éè°ƒç”¨å®ƒå°è£…å¥½çš„æ–¹æ³•ï¼‰</li></ol></li></ol></li><li>éè®¿é—®ä¿®é¥°ç¬¦<ol><li>ç±»çº§åˆ«çš„éè®¿é—®ä¿®é¥°ç¬¦<ol><li><code>final</code><ol><li>ç±»ä¸å¯è¢«ç»§æ‰¿ï¼ˆæ–­å­ç»å­™ï¼‰</li></ol></li><li><code>static</code><ol><li>é™æ€å†…éƒ¨ç±»ï¼Œå¯ä»¥é€šè¿‡ä¸Šå±‚ç±»çš„ç±»åç›´æ¥è®¿é—®è¯¥ç±»</li></ol></li><li><code>strictfp</code><ol><li>ä¸¥æ ¼æµ®ç‚¹è®¡ç®—ï¼ˆä¿è¯è¯¥ç±»ä¸­æ‰€æœ‰æ¶‰åŠåˆ° <code>float</code>ã€<code>double</code> æ•°æ®ç±»å‹çš„è®¡ç®—ï¼Œåœ¨ä¸åŒçš„ <code>CPU</code> ä¸Šéƒ½èƒ½å¾—åˆ°å®Œå…¨ä¸€è‡´çš„ç»“æœï¼‰</li></ol></li><li><code>abstract</code><ol><li>æŠ½è±¡ç±»</li></ol></li><li><code>sealed</code><ol><li>å¯†å°ç±»ï¼Œéœ€è¦ä½¿ç”¨ <code>permits</code> æŒ‡å®šå“ªäº›å­ç±»å¯ä»¥ç»§æ‰¿å®ƒ</li><li>éœ€è¦æ³¨æ„çš„æ˜¯ï¼šç»§æ‰¿å¯†å°ç±»çš„å­ç±»å¿…é¡»ç”± <code>final</code>ã€<code>sealed</code>ã€<code>non-sealed</code> ä¸­çš„ä»»æ„ä¸€ä¸ªä¿®é¥°ç¬¦è¿›è¡Œä¿®é¥°</li></ol></li><li><code>non-sealed</code><ol><li>éå¯†å°ç±»</li></ol></li></ol></li><li>å±æ€§çº§åˆ«çš„éè®¿é—®ä¿®é¥°ç¬¦<ol><li><code>final</code><ol><li>ä¸èƒ½ä¿®æ”¹è¯¥å±æ€§çš„å€¼ï¼ˆå¿…é¡»åœ¨å®šä¹‰æ—¶ç›´æ¥èµ‹å€¼ï¼Œæˆ–è€…åœ¨æ„é€ å‡½æ•°ä¸­ä¿è¯èµ‹å€¼ï¼‰</li></ol></li><li><code>static</code><ol><li>é™æ€å±æ€§ï¼Œå¯ä»¥é€šè¿‡ç±»åç›´æ¥è®¿é—®è¯¥å±æ€§</li></ol></li><li><code>volatile</code><ol><li>ä¿è¯è¯¥å±æ€§çš„å¯è§æ€§å’Œæœ‰åºæ€§</li></ol></li><li><code>transient</code><ol><li>åºåˆ—åŒ–æ—¶ï¼Œå¿½ç•¥è¿™ä¸ªå±æ€§</li><li>ååºåˆ—åŒ–æ—¶ï¼Œä½¿ç”¨è¿™ä¸ªå±æ€§çš„é»˜è®¤å€¼</li></ol></li></ol></li><li>æ–¹æ³•çº§åˆ«çš„éè®¿é—®ä¿®é¥°ç¬¦<ol><li><code>final</code><ol><li>æ–¹æ³•ä¸å¯è¢«é‡å†™</li></ol></li><li><code>static</code><ol><li>é™æ€æ–¹æ³•ï¼Œå¯ä»¥é€šè¿‡ç±»åç›´æ¥è°ƒç”¨è¯¥æ–¹æ³•</li></ol></li><li><code>native</code><ol><li>æœ¬åœ°æ–¹æ³•ï¼Œæ–¹æ³•çš„å…·ä½“é€»è¾‘ç”±é <code>Java</code> è¯­è¨€å®ç°</li></ol></li><li><code>strictfp</code><ol><li>ä¸¥æ ¼æµ®ç‚¹è®¡ç®—ï¼ˆä¿è¯è¯¥æ–¹æ³•ä¸­æ‰€æœ‰æ¶‰åŠåˆ° <code>float</code>ã€<code>double</code> æ•°æ®ç±»å‹çš„è®¡ç®—ï¼Œåœ¨ä¸åŒçš„ <code>CPU</code> ä¸Šéƒ½èƒ½å¾—åˆ°å®Œå…¨ä¸€è‡´çš„ç»“æœï¼‰</li></ol></li><li><code>default</code><ol><li>æ¥å£æ–¹æ³•çš„é»˜è®¤å®ç°</li></ol></li><li><code>abstract</code><ol><li>æŠ½è±¡æ–¹æ³•ï¼Œç»§æ‰¿è¯¥ç±»çš„éæŠ½è±¡å­ç±»å¿…é¡»é‡å†™è¯¥æ–¹æ³•</li></ol></li><li><code>synchronized</code><ol><li>åŠ  <code>synchronized</code> é”</li></ol></li></ol></li></ol></li></ol><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li><code>private</code> ä¿®é¥°ç¬¦ä¿®é¥°çš„éé™æ€çš„å˜é‡ã€å¸¸é‡ã€æ–¹æ³•ã€å†…éƒ¨ç±»ï¼Œå¯ä»¥è¢«å†…éƒ¨ç±»è®¿é—®</li></ol></blockquote><hr>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
      <category>Java ä¿®é¥°ç¬¦</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.util.Listï¼œEï¼ æºç è§£æ</title>
    <link href="/2025/12/01/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.List%EF%BC%9CE%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/12/01/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.List%EF%BC%9CE%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/12/01/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.io.Serializable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/12/01/æºç ï¼šjava.io.Serializableæºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-Listï¼œEï¼-æ¦‚è¿°"><a href="#3-1-Listï¼œEï¼-æ¦‚è¿°" class="headerlink" title="3.1. Listï¼œEï¼ æ¦‚è¿°"></a>3.1. Listï¼œEï¼ æ¦‚è¿°</h3><p><code>Listï¼œEï¼</code> æ˜¯ä¸€ä¸ªæ¥å£</p><hr><h2 id="æºç éƒ¨åˆ†"><a href="#æºç éƒ¨åˆ†" class="headerlink" title="æºç éƒ¨åˆ†"></a>æºç éƒ¨åˆ†</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">List</span>&lt;E&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Collection</span>&lt;E&gt; &#123;<br><br>    <span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">replaceAll</span><span class="hljs-params">(UnaryOperator&lt;E&gt; operator)</span> &#123;<br>        Objects.requireNonNull(operator);<br>        <span class="hljs-keyword">final</span> ListIterator&lt;E&gt; li = <span class="hljs-built_in">this</span>.listIterator();<br>        <span class="hljs-keyword">while</span> (li.hasNext()) &#123;<br>            li.set(operator.apply(li.next()));<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sort</span><span class="hljs-params">(Comparator&lt;? <span class="hljs-built_in">super</span> E&gt; c)</span> &#123;<br>        Object[] a = <span class="hljs-built_in">this</span>.toArray();<br>        Arrays.sort(a, (Comparator) c);<br>        ListIterator&lt;E&gt; i = <span class="hljs-built_in">this</span>.listIterator();<br>        <span class="hljs-keyword">for</span> (Object e : a) &#123;<br>            i.next();<br>            i.set((E) e);<br>        &#125;<br>    &#125;<br><br>    E <span class="hljs-title function_">get</span><span class="hljs-params">(<span class="hljs-type">int</span> index)</span>;<br><br>    E <span class="hljs-title function_">set</span><span class="hljs-params">(<span class="hljs-type">int</span> index, E element)</span>;<br><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">add</span><span class="hljs-params">(<span class="hljs-type">int</span> index, E element)</span>;<br><br>    E <span class="hljs-title function_">remove</span><span class="hljs-params">(<span class="hljs-type">int</span> index)</span>;<br><br>    <span class="hljs-type">int</span> <span class="hljs-title function_">indexOf</span><span class="hljs-params">(Object o)</span>;<br><br>    <span class="hljs-type">int</span> <span class="hljs-title function_">lastIndexOf</span><span class="hljs-params">(Object o)</span>;<br><br>    ListIterator&lt;E&gt; <span class="hljs-title function_">listIterator</span><span class="hljs-params">()</span>;<br><br>    ListIterator&lt;E&gt; <span class="hljs-title function_">listIterator</span><span class="hljs-params">(<span class="hljs-type">int</span> index)</span>;<br><br>    List&lt;E&gt; <span class="hljs-title function_">subList</span><span class="hljs-params">(<span class="hljs-type">int</span> fromIndex, <span class="hljs-type">int</span> toIndex)</span>;<br><br>    <span class="hljs-keyword">static</span> &lt;E&gt; List&lt;E&gt; <span class="hljs-title function_">of</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> ImmutableCollections.emptyList();<br>    &#125;<br><br>    <span class="hljs-keyword">static</span> &lt;E&gt; List&lt;E&gt; <span class="hljs-title function_">of</span><span class="hljs-params">(E e1)</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ImmutableCollections</span>.List12&lt;&gt;(e1);<br>    &#125;<br><br>    <span class="hljs-keyword">static</span> &lt;E&gt; List&lt;E&gt; <span class="hljs-title function_">of</span><span class="hljs-params">(E e1, E e2)</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ImmutableCollections</span>.List12&lt;&gt;(e1, e2);<br>    &#125;<br><br>    <span class="hljs-meta">@SafeVarargs</span><br>    <span class="hljs-keyword">static</span> &lt;E&gt; List&lt;E&gt; <span class="hljs-title function_">of</span><span class="hljs-params">(E... elements)</span> &#123;<br>        <span class="hljs-keyword">return</span> ImmutableCollections.listOf(elements);<br>    &#125;<br><br>    <span class="hljs-keyword">static</span> &lt;E&gt; List&lt;E&gt; <span class="hljs-title function_">copyOf</span><span class="hljs-params">(Collection&lt;? extends E&gt; coll)</span> &#123;<br>        <span class="hljs-keyword">return</span> ImmutableCollections.listCopy(coll);<br>    &#125;<br>    <br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.util.NavigableSetï¼œEï¼æºç è§£æ</title>
    <link href="/2025/12/01/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.NavigableSet%EF%BC%9CE%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/12/01/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.NavigableSet%EF%BC%9CE%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/12/01/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.SortedSet%EF%BC%9CE%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/12/01/æºç ï¼šjava.util.SortedSetï¼œEï¼æºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-NavigableSetï¼œEï¼-æ¦‚è¿°"><a href="#3-1-NavigableSetï¼œEï¼-æ¦‚è¿°" class="headerlink" title="3.1. NavigableSetï¼œEï¼ æ¦‚è¿°"></a>3.1. NavigableSetï¼œEï¼ æ¦‚è¿°</h3><hr><h2 id="4-æºç éƒ¨åˆ†"><a href="#4-æºç éƒ¨åˆ†" class="headerlink" title="4. æºç éƒ¨åˆ†"></a>4. æºç éƒ¨åˆ†</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">NavigableSet</span>&lt;E&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title class_">SortedSet</span>&lt;E&gt; &#123;<br><br>    E <span class="hljs-title function_">lower</span><span class="hljs-params">(E e)</span>;<br><br>E <span class="hljs-title function_">floor</span><span class="hljs-params">(E e)</span>;<br><br>    E <span class="hljs-title function_">ceiling</span><span class="hljs-params">(E e)</span>;<br><br>    E <span class="hljs-title function_">higher</span><span class="hljs-params">(E e)</span>;<br><br>    E <span class="hljs-title function_">pollFirst</span><span class="hljs-params">()</span>;<br><br>    E <span class="hljs-title function_">pollLast</span><span class="hljs-params">()</span>;<br><br>    NavigableSet&lt;E&gt; <span class="hljs-title function_">descendingSet</span><span class="hljs-params">()</span>;<br><br>    Iterator&lt;E&gt; <span class="hljs-title function_">descendingIterator</span><span class="hljs-params">()</span>;<br><br>    NavigableSet&lt;E&gt; <span class="hljs-title function_">subSet</span><span class="hljs-params">(E fromElement, <span class="hljs-type">boolean</span> fromInclusive,</span><br><span class="hljs-params">                           E toElement,   <span class="hljs-type">boolean</span> toInclusive)</span>;<br><br>    NavigableSet&lt;E&gt; <span class="hljs-title function_">headSet</span><span class="hljs-params">(E toElement, <span class="hljs-type">boolean</span> inclusive)</span>;<br><br>    NavigableSet&lt;E&gt; <span class="hljs-title function_">tailSet</span><span class="hljs-params">(E fromElement, <span class="hljs-type">boolean</span> inclusive)</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.util.Setï¼œEï¼ æºç è§£æ</title>
    <link href="/2025/12/01/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.Set%EF%BC%9CE%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/12/01/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.Set%EF%BC%9CE%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/12/01/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.Set%EF%BC%9CE%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/12/01/æºç ï¼šjava.util.Setï¼œEï¼æºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-Setï¼œEï¼-æ¦‚è¿°"><a href="#3-1-Setï¼œEï¼-æ¦‚è¿°" class="headerlink" title="3.1. Setï¼œEï¼ æ¦‚è¿°"></a>3.1. Setï¼œEï¼ æ¦‚è¿°</h3><p><code>Setï¼œEï¼</code> æ˜¯ä¸€ä¸ªæ¥å£</p><hr><h2 id="4-æºç éƒ¨åˆ†"><a href="#4-æºç éƒ¨åˆ†" class="headerlink" title="4. æºç éƒ¨åˆ†"></a>4. æºç éƒ¨åˆ†</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Set</span>&lt;E&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Collection</span>&lt;E&gt; &#123;<br><br>    <span class="hljs-meta">@SuppressWarnings(&quot;unchecked&quot;)</span><br>    <span class="hljs-keyword">static</span> &lt;E&gt; Set&lt;E&gt; <span class="hljs-title function_">of</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> (Set&lt;E&gt;) ImmutableCollections.EMPTY_SET;<br>    &#125;<br><br>    <span class="hljs-keyword">static</span> &lt;E&gt; Set&lt;E&gt; <span class="hljs-title function_">of</span><span class="hljs-params">(E e1)</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ImmutableCollections</span>.Set12&lt;&gt;(e1);<br>    &#125;<br><br>    <span class="hljs-keyword">static</span> &lt;E&gt; Set&lt;E&gt; <span class="hljs-title function_">of</span><span class="hljs-params">(E e1, E e2)</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ImmutableCollections</span>.Set12&lt;&gt;(e1, e2);<br>    &#125;<br><br>    <span class="hljs-keyword">static</span> &lt;E&gt; Set&lt;E&gt; <span class="hljs-title function_">of</span><span class="hljs-params">(E e1, E e2, E e3)</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ImmutableCollections</span>.SetN&lt;&gt;(e1, e2, e3);<br>    &#125;<br><br>    <span class="hljs-keyword">static</span> &lt;E&gt; Set&lt;E&gt; <span class="hljs-title function_">of</span><span class="hljs-params">(E e1, E e2, E e3, E e4)</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ImmutableCollections</span>.SetN&lt;&gt;(e1, e2, e3, e4);<br>    &#125;<br><br>    <span class="hljs-keyword">static</span> &lt;E&gt; Set&lt;E&gt; <span class="hljs-title function_">of</span><span class="hljs-params">(E e1, E e2, E e3, E e4, E e5)</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ImmutableCollections</span>.SetN&lt;&gt;(e1, e2, e3, e4, e5);<br>    &#125;<br><br>    <span class="hljs-keyword">static</span> &lt;E&gt; Set&lt;E&gt; <span class="hljs-title function_">of</span><span class="hljs-params">(E e1, E e2, E e3, E e4, E e5, E e6)</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ImmutableCollections</span>.SetN&lt;&gt;(e1, e2, e3, e4, e5, e6);<br>    &#125;<br><br>    <span class="hljs-keyword">static</span> &lt;E&gt; Set&lt;E&gt; <span class="hljs-title function_">of</span><span class="hljs-params">(E e1, E e2, E e3, E e4, E e5, E e6, E e7)</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ImmutableCollections</span>.SetN&lt;&gt;(e1, e2, e3, e4, e5, e6, e7);<br>    &#125;<br><br>    <span class="hljs-keyword">static</span> &lt;E&gt; Set&lt;E&gt; <span class="hljs-title function_">of</span><span class="hljs-params">(E e1, E e2, E e3, E e4, E e5, E e6, E e7, E e8)</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ImmutableCollections</span>.SetN&lt;&gt;(e1, e2, e3, e4, e5, e6, e7, e8);<br>    &#125;<br><br>    <span class="hljs-keyword">static</span> &lt;E&gt; Set&lt;E&gt; <span class="hljs-title function_">of</span><span class="hljs-params">(E e1, E e2, E e3, E e4, E e5, E e6, E e7, E e8, E e9)</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ImmutableCollections</span>.SetN&lt;&gt;(e1, e2, e3, e4, e5, e6, e7, e8, e9);<br>    &#125;<br><br>    <span class="hljs-keyword">static</span> &lt;E&gt; Set&lt;E&gt; <span class="hljs-title function_">of</span><span class="hljs-params">(E e1, E e2, E e3, E e4, E e5, E e6, E e7, E e8, E e9, E e10)</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ImmutableCollections</span>.SetN&lt;&gt;(e1, e2, e3, e4, e5, e6, e7, e8, e9, e10);<br>    &#125;<br><br>    <span class="hljs-meta">@SafeVarargs</span><br>    <span class="hljs-meta">@SuppressWarnings(&quot;varargs&quot;)</span><br>    <span class="hljs-keyword">static</span> &lt;E&gt; Set&lt;E&gt; <span class="hljs-title function_">of</span><span class="hljs-params">(E... elements)</span> &#123;<br>        <span class="hljs-keyword">return</span> ImmutableCollections.setOf(elements);<br>    &#125;<br><br>    <span class="hljs-keyword">static</span> &lt;E&gt; Set&lt;E&gt; <span class="hljs-title function_">copyOf</span><span class="hljs-params">(Collection&lt;? extends E&gt; coll)</span> &#123;<br>        <span class="hljs-keyword">if</span> (coll <span class="hljs-keyword">instanceof</span> ImmutableCollections.AbstractImmutableSet &amp;&amp; coll.getClass() != ImmutableCollections.SubList.class) &#123;<br>            <span class="hljs-keyword">return</span> (Set&lt;E&gt;) coll;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">return</span> (Set&lt;E&gt;) Set.of(<span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;&gt;(coll).toArray());<br>        &#125;<br>    &#125;<br>    <br>&#125;<br></code></pre></td></tr></table></figure><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.util.SortedSetï¼œEï¼ æºç è§£æ</title>
    <link href="/2025/12/01/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.SortedSet%EF%BC%9CE%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/12/01/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.SortedSet%EF%BC%9CE%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/12/01/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.SortedSet%EF%BC%9CE%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/12/01/æºç ï¼šjava.util.SortedSetï¼œEï¼æºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-SortedSetï¼œEï¼-æ¦‚è¿°"><a href="#3-1-SortedSetï¼œEï¼-æ¦‚è¿°" class="headerlink" title="3.1. SortedSetï¼œEï¼ æ¦‚è¿°"></a>3.1. SortedSetï¼œEï¼ æ¦‚è¿°</h3><hr><h2 id="4-æºç éƒ¨åˆ†"><a href="#4-æºç éƒ¨åˆ†" class="headerlink" title="4. æºç éƒ¨åˆ†"></a>4. æºç éƒ¨åˆ†</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">SortedSet</span>&lt;E&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Set</span>&lt;E&gt; &#123;<br><br>    Comparator&lt;? <span class="hljs-built_in">super</span> E&gt; comparator();<br><br>    SortedSet&lt;E&gt; <span class="hljs-title function_">subSet</span><span class="hljs-params">(E fromElement, E toElement)</span>;<br><br>    SortedSet&lt;E&gt; <span class="hljs-title function_">headSet</span><span class="hljs-params">(E toElement)</span>;<br><br>    SortedSet&lt;E&gt; <span class="hljs-title function_">tailSet</span><span class="hljs-params">(E fromElement)</span>;<br><br>E <span class="hljs-title function_">first</span><span class="hljs-params">()</span>;<br><br>    E <span class="hljs-title function_">last</span><span class="hljs-params">()</span>;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">default</span> Spliterator&lt;E&gt; <span class="hljs-title function_">spliterator</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Spliterators</span>.IteratorSpliterator&lt;E&gt;(<br>                <span class="hljs-built_in">this</span>, Spliterator.DISTINCT | Spliterator.SORTED | Spliterator.ORDERED) &#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">public</span> Comparator&lt;? <span class="hljs-built_in">super</span> E&gt; getComparator() &#123;<br>                <span class="hljs-keyword">return</span> SortedSet.<span class="hljs-built_in">this</span>.comparator();<br>            &#125;<br>        &#125;;<br>    &#125;<br>    <br>&#125;<br></code></pre></td></tr></table></figure><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.util.concurrent.CompletableFutureï¼œTï¼ æºç è§£æ</title>
    <link href="/2025/12/01/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.CompletableFuture%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/12/01/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.CompletableFuture%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/12/01/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.CompletableFuture%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/12/01/æºç ï¼šjava.util.concurrent.CompletableFutureï¼œTï¼æºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-CompletableFutureï¼œTï¼-æ¦‚è¿°"><a href="#3-1-CompletableFutureï¼œTï¼-æ¦‚è¿°" class="headerlink" title="3.1. CompletableFutureï¼œTï¼ æ¦‚è¿°"></a>3.1. CompletableFutureï¼œTï¼ æ¦‚è¿°</h3><p><code>CompletableFutureï¼œTï¼</code> æ˜¯ä¸€ä¸ªå…·ä½“ç±»ï¼Œå®ç°äº† <code>java.util.concurren.Futureï¼œVï¼</code> æ¥å£ã€<code>java.util.concurrent.CompletionStageï¼œTï¼</code> æ¥å£<br><img src="/source/_posts/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.CompletableFuture%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.CompletableFuture%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.png"></p><p>æˆ‘ä»¬å¯ä»¥ç®€å•çš„ç†è§£ä¸ºï¼šä¸€ä¸ª <code>CompletableFutureï¼œTï¼</code> å®ä¾‹å°±æ˜¯ä¸€ä¸ª â€œé˜¶æ®µâ€</p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>è¯¦è§æºç ï¼š<code>Futureï¼œVï¼</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurren.Future%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurren.Futureï¼œVï¼æºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/09/02/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurren.Future%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/09/02/æºç ï¼šjava.util.concurren.Futureï¼œVï¼æºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>CompletionStageï¼œTï¼</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.CompletionStage%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.CompletionStageï¼œTï¼æºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/12/01/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.CompletionStage%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/12/01/æºç ï¼šjava.util.concurrent.CompletionStageï¼œTï¼æºç è§£æ/</a></li></ol></li></ol></li></ol></blockquote><hr><h3 id="3-2-CompletableFutureï¼œTï¼-ç›¸å…³æµç¨‹"><a href="#3-2-CompletableFutureï¼œTï¼-ç›¸å…³æµç¨‹" class="headerlink" title="3.2. CompletableFutureï¼œTï¼ ç›¸å…³æµç¨‹"></a>3.2. CompletableFutureï¼œTï¼ ç›¸å…³æµç¨‹</h3><p>ä»¥å¦‚ä¸‹ä»£ç ä¸ºä¾‹ï¼Œçº¿ç¨‹ä¼šä»¥éé˜»å¡çš„æ–¹å¼å¿«é€Ÿçš„æ‰§è¡Œå®Œè¿™äº› <code>Java</code> ä»£ç ã€‚å‡è®¾çº¿ç¨‹æ‰§è¡Œåˆ° <code>cfA</code> è¿™ä¸€è¡Œï¼Œä¼šæ ¹æ® <code>CompletableFutureï¼œTï¼#supplyAsync</code> çš„è¯­ä¹‰å»æ‰§è¡Œ <code>TaskA</code>ï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼š<code>CompletableFutureï¼œTï¼#supplyAsync</code> æ˜¯ â€œç‚¹ç«é”®â€ï¼‰</p><p>å½“çº¿ç¨‹æ‰§è¡Œåˆ° <code>cfB1</code> è¿™ä¸€è¡Œï¼Œä¼šæ ¹æ® <code>CompletionStageï¼œTï¼#thenApply</code> çš„è¯­ä¹‰å»æ‰§è¡Œ <code>TaskB1</code>ã€‚å¦‚æœ â€œå‰ç½®æ¡ä»¶â€ éƒ½å·²æ»¡è¶³ï¼Œå¯èƒ½æ˜¯ç”±å½“å‰çº¿ç¨‹æ‰§è¡Œæ ¸å¿ƒåŠ¨ä½œï¼Œä¹Ÿå¯èƒ½æ˜¯ç”±å½“å‰çº¿ç¨‹å°†æ ¸å¿ƒåŠ¨ä½œå°è£…æˆä¸€ä¸ªä»»åŠ¡ï¼Œæäº¤åˆ°çº¿ç¨‹æ± ï¼Œç”±çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ‰§è¡Œæ ¸å¿ƒåŠ¨ä½œï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼šé»˜è®¤æäº¤åˆ° <code>ForkJoinPool.commonPool()</code>ï¼‰ã€‚ä½†æ˜¯å¦‚æœ â€œå‰ç½®æ¡ä»¶â€ æœªéƒ½æ»¡è¶³ï¼Œä¼šå°†æ ¸å¿ƒåŠ¨ä½œ â€œæŒ‚è½½â€ åˆ°æœªå®Œæˆçš„ â€œé˜¶æ®µâ€ ä¸Šï¼Œç­‰åˆ°æœ€åä¸€ä¸ª â€œé˜¶æ®µâ€ å®Œæˆåï¼Œå†æ¥å¤„ç†è¿™ä¸ªæ ¸å¿ƒåŠ¨ä½œï¼Œè¿™å°±æ˜¯å¤§åé¼é¼çš„ â€œå¼‚æ­¥ç¼–ç¨‹å›è°ƒâ€</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> InterruptedException &#123;<br><br><span class="hljs-comment">//...</span><br><br>CompletableFuture&lt;String&gt; cfA = CompletableFuture.supplyAsync(TaskA);<br><br>CompletableFuture&lt;String&gt; cfB1 = cfA.thenApply(TaskB1);<br><br>CompletableFuture&lt;String&gt; cfB2 = cfA.thenApply(TaskB2);<br><br>CompletableFuture&lt;String&gt; cfC = cfA.thenApply(TaskC);<br><br>CompletableFuture&lt;String&gt; cfD = cfC.thenApply(TaskD);<br><br><span class="hljs-comment">//...</span><br><br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>åœ¨åç»­çš„ä»£ç ä¸­ï¼Œåªè¦å­˜åœ¨ â€œä¾èµ– <code>CompletableFuture&lt;T&gt;</code> çš„æ‰§è¡Œç»“æœæ‰èƒ½ç»§ç»­æ‰§è¡Œâ€ çš„æƒ…å†µï¼Œæˆ‘ä»¬ä¸€å¾‹é€šè¿‡å›è°ƒæ¥å¤„ç†ã€‚å…¶ä»–çš„ç®€å•æ“ä½œå¯ä»¥ç›´æ¥ä½¿ç”¨å¸¸è§„æ–¹æ³•</li></ol></blockquote><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.util.concurrent.CompletionStageï¼œTï¼ æºç è§£æ</title>
    <link href="/2025/12/01/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.CompletionStage%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/12/01/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.CompletionStage%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/12/01/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.CompletionStage%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/12/01/æºç ï¼šjava.util.concurrent.CompletionStageï¼œTï¼æºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-CompletionStageï¼œTï¼-æ¦‚è¿°"><a href="#3-1-CompletionStageï¼œTï¼-æ¦‚è¿°" class="headerlink" title="3.1. CompletionStageï¼œTï¼ æ¦‚è¿°"></a>3.1. CompletionStageï¼œTï¼ æ¦‚è¿°</h3><p><code>CompletionStageï¼œTï¼</code> æ˜¯ä¸€ä¸ªæ¥å£</p><p>æˆ‘ä»¬å¯ä»¥ç®€å•çš„ç†è§£ä¸ºï¼šä¸€ä¸ª <code>CompletionStageï¼œTï¼</code> æ¥å£çš„å…·ä½“å®ç°ç±»å®ä¾‹å°±æ˜¯ä¸€ä¸ª â€œé˜¶æ®µâ€</p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>å¯¹äº <code>CompletionStageï¼œTï¼</code> æ¥å£ã€<code>CompletableFutureï¼œTï¼</code> å…·ä½“ç±»ï¼Œå¯ä»¥è¯´æ˜¯æ•´ä¸ª <code>JUC</code> ä¸­æœ€å¤æ‚çš„ä¸€éƒ¨åˆ†ï¼Œ<code>Doug Lea</code> å½“åˆä¸ºå®ƒä»¬æŠ•å…¥äº†å¤§é‡å¿ƒè¡€ã€‚å¯¹äº <code>CompletionStageï¼œTï¼</code> æ¥å£ï¼Œæˆ‘ä»¬åªéœ€è¦èƒ½çœ‹æ‡‚å®ƒçš„æ–¹æ³•å³å¯ï¼Œæ²¡å¿…è¦å¯¹æºç è¿›è¡Œè¿‡åº¦æ·±ç©¶</li></ol></blockquote><hr><h2 id="4-ç›¸å…³æ–¹æ³•"><a href="#4-ç›¸å…³æ–¹æ³•" class="headerlink" title="4. ç›¸å…³æ–¹æ³•"></a>4. ç›¸å…³æ–¹æ³•</h2><p>åœ¨ <code>CompletionStageï¼œTï¼</code> æ¥å£ä¸­ï¼Œæ–¹æ³•çš„å‘½åååˆ†æœ‰è§„å¾‹ï¼šè§¦å‘æ¡ä»¶ + æ ¸å¿ƒåŠ¨ä½œ + æ‰§è¡Œæ–¹å¼</p><ol><li>è§¦å‘æ¡ä»¶<ol><li><code>Then</code><ol><li>å¦‚æœä¸Šä¸€é˜¶æ®µæ‰§è¡ŒæˆåŠŸï¼ˆå³æ­£å¸¸é€€å‡ºï¼‰ï¼Œæ‰æ‰§è¡Œæ ¸å¿ƒåŠ¨ä½œ</li></ol></li><li><code>Both</code><ol><li>å¦‚æœä¸Šä¸€é˜¶æ®µå’Œä¼ å…¥çš„æ–¹æ³•å‚æ•°ï¼ˆå³å¦ä¸€ä¸ªé˜¶æ®µï¼‰éƒ½æ‰§è¡ŒæˆåŠŸï¼ˆå³æ­£å¸¸é€€å‡ºï¼‰ï¼Œæ‰æ‰§è¡Œæ ¸å¿ƒåŠ¨ä½œ</li></ol></li><li><code>Either</code><ol><li>ä¸Šä¸€é˜¶æ®µå’Œä¼ å…¥çš„æ–¹æ³•å‚æ•°ï¼ˆå³å¦ä¸€ä¸ªé˜¶æ®µï¼‰ä»»æ„ä¸€ä¸ªæœ€å…ˆæ‰§è¡Œå®Œæˆï¼Œå¹¶ä¸”æ˜¯æ‰§è¡ŒæˆåŠŸï¼ˆå³æ­£å¸¸é€€å‡ºï¼‰ï¼Œæ‰æ‰§è¡Œæ ¸å¿ƒåŠ¨ä½œ</li><li>ä¸Šä¸€é˜¶æ®µå’Œä¼ å…¥çš„æ–¹æ³•å‚æ•°ï¼ˆå³å¦ä¸€ä¸ªé˜¶æ®µï¼‰ä»»æ„ä¸€ä¸ªæœ€å…ˆæ‰§è¡Œå®Œæˆï¼Œå¹¶ä¸”æ˜¯æ‰§è¡Œå¤±è´¥ï¼ˆå³å¼‚å¸¸é€€å‡ºã€å–æ¶ˆæˆ–åœæ­¢ä»»åŠ¡ï¼‰ï¼Œä¸ä¼šæ‰§è¡Œæ ¸å¿ƒåŠ¨ä½œ</li></ol></li><li><code>Handle</code><ol><li>ä¸Šä¸€é˜¶æ®µæ‰§è¡Œå®Œæˆï¼ˆå³æ­£å¸¸é€€å‡ºã€å¼‚å¸¸é€€å‡ºã€å–æ¶ˆæˆ–åœæ­¢ä»»åŠ¡ï¼‰ï¼Œæ‰æ‰§è¡Œæ ¸å¿ƒåŠ¨ä½œ</li></ol></li><li><code>WhenComplete</code><ol><li>ä¸Šä¸€é˜¶æ®µæ‰§è¡Œå®Œæˆï¼ˆå³æ­£å¸¸é€€å‡ºã€å¼‚å¸¸é€€å‡ºã€å–æ¶ˆæˆ–åœæ­¢ä»»åŠ¡ï¼‰ï¼Œæ‰æ‰§è¡Œæ ¸å¿ƒåŠ¨ä½œ</li></ol></li><li><code>Exceptionally</code><ol><li>ä¸Šä¸€é˜¶æ®µæ‰§è¡Œå¤±è´¥ï¼ˆå³å¼‚å¸¸é€€å‡ºã€å–æ¶ˆæˆ–åœæ­¢ä»»åŠ¡ï¼‰ï¼Œæ‰æ‰§è¡Œæ ¸å¿ƒåŠ¨ä½œ</li></ol></li></ol></li><li>æ ¸å¿ƒåŠ¨ä½œ<ol><li><code>Run</code><ol><li>ä¸æ¥æ”¶ä¸Šä¸€é˜¶æ®µçš„è¿”å›ç»“æœï¼Œæ‰§è¡Œä¸€ä¸ª <code>Runnable</code> ä»»åŠ¡ï¼Œæ²¡æœ‰è¿”å›ç»“æœ</li></ol></li><li><code>Apply</code><ol><li>æ¥æ”¶ä¸Šä¸€é˜¶æ®µçš„è¿”å›ç»“æœï¼Œæ‰§è¡Œä¸€ä¸ª <code>Functionï¼œT, Rï¼</code> ç±»å‹çš„å›è°ƒå‡½æ•°ï¼Œè¿”å›ä¸€ä¸ªç±»å‹ä¸å®šçš„ç»“æœ</li></ol></li><li><code>Accept</code><ol><li>æ¥æ”¶ä¸Šä¸€é˜¶æ®µçš„è¿”å›ç»“æœï¼Œæ‰§è¡Œä¸€ä¸ª <code>Consumerï¼œTï¼</code> ç±»å‹çš„å›è°ƒå‡½æ•°ï¼Œæ²¡æœ‰è¿”å›ç»“æœ</li></ol></li><li><code>Compose</code><ol><li>æ¥æ”¶ä¸Šä¸€é˜¶æ®µçš„è¿”å›ç»“æœï¼Œæ‰§è¡Œä¸€ä¸ª <code>Functionï¼œT, CompletionStageï¼œRï¼ï¼</code> ç±»å‹çš„å›è°ƒå‡½æ•°ï¼Œè¿”å›ä¸€ä¸ª <code>CompletionStageï¼œTï¼</code> ç±»å‹çš„ç»“æœ</li></ol></li><li><code>Combine</code><ol><li>æ¥æ”¶ä¸Šä¸€é˜¶æ®µçš„è¿”å›ç»“æœå’Œå¦ä¸€ä¸ª <code>CompletionStageï¼œTï¼</code> ç±»å‹çš„æ–¹æ³•å‚æ•°ï¼ˆå³å¦ä¸€ä¸ªé˜¶æ®µï¼‰çš„æ‰§è¡Œç»“æœï¼Œæ‰§è¡Œä¸€ä¸ª <code>BiFunctionï¼œT, U, Rï¼</code> ç±»å‹çš„å›è°ƒå‡½æ•°ï¼Œè¿”å›ä¸€ä¸ªç±»å‹ä¸å®šçš„ç»“æœ</li></ol></li></ol></li><li>æ‰§è¡Œæ–¹å¼<ol><li><code>Async</code><ol><li>æœ‰ <code>Async</code><ol><li>å¦‚æœä¸Šä¸€é˜¶æ®µå’Œä¼ å…¥çš„æ–¹æ³•å‚æ•°ï¼ˆå³å¦ä¸€ä¸ªé˜¶æ®µï¼‰éƒ½å·²ç»æ‰§è¡Œå®Œæ¯•<ol><li>ç”±å½“å‰çº¿ç¨‹å°†æ ¸å¿ƒåŠ¨ä½œå°è£…æˆä¸€ä¸ªä»»åŠ¡ï¼Œæäº¤åˆ°çº¿ç¨‹æ± ï¼Œç”±çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ‰§è¡Œæ ¸å¿ƒåŠ¨ä½œï¼ˆé»˜è®¤æäº¤åˆ° <code>ForkJoinPool.commonPool()</code>ï¼Œå¯ä»¥æŒ‡å®šè‡ªå®šä¹‰çº¿ç¨‹æ± ï¼‰</li></ol></li><li>å¦‚æœä¸Šä¸€é˜¶æ®µå’Œä¼ å…¥çš„æ–¹æ³•å‚æ•°ï¼ˆå³å¦ä¸€ä¸ªé˜¶æ®µï¼‰æœ‰æœªæ‰§è¡Œå®Œæ¯•çš„<ol><li>å°†æ ¸å¿ƒåŠ¨ä½œ â€œæŒ‚è½½â€ åˆ°æœªå®Œæˆçš„é˜¶æ®µä¸Šï¼Œå¹¶ç”±æœ€åä¸€ä¸ªæ‰§è¡ŒæŸé˜¶æ®µå®Œæ¯•çš„é‚£ä¸ªçº¿ç¨‹å°†æ ¸å¿ƒåŠ¨ä½œå°è£…æˆä¸€ä¸ªä»»åŠ¡ï¼Œæäº¤åˆ°çº¿ç¨‹æ± ï¼Œç”±çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ‰§è¡Œæ ¸å¿ƒåŠ¨ä½œï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼šé»˜è®¤æäº¤åˆ° <code>ForkJoinPool.commonPool()</code>ï¼Œå¯ä»¥æŒ‡å®šè‡ªå®šä¹‰çº¿ç¨‹æ± ï¼‰</li></ol></li></ol></li><li>æ—  <code>Async</code><ol><li>å¦‚æœä¸Šä¸€é˜¶æ®µå’Œä¼ å…¥çš„æ–¹æ³•å‚æ•°ï¼ˆå³å¦ä¸€ä¸ªé˜¶æ®µï¼‰å·²ç»æ‰§è¡Œå®Œæ¯•<ol><li>ç”±å½“å‰çº¿ç¨‹æ‰§è¡Œæ ¸å¿ƒåŠ¨ä½œ</li></ol></li><li>å¦‚æœä¸Šä¸€é˜¶æ®µå’Œä¼ å…¥çš„æ–¹æ³•å‚æ•°ï¼ˆå³å¦ä¸€ä¸ªé˜¶æ®µï¼‰æœ‰æœªæ‰§è¡Œå®Œæ¯•çš„<ol><li>å°†æ ¸å¿ƒåŠ¨ä½œ â€œæŒ‚è½½â€ åˆ°æœªå®Œæˆçš„é˜¶æ®µä¸Šï¼Œå¹¶ç”±æœ€åä¸€ä¸ªæ‰§è¡ŒæŸé˜¶æ®µå®Œæ¯•çš„é‚£ä¸ªçº¿ç¨‹æ‰§è¡Œæ ¸å¿ƒåŠ¨ä½œ</li></ol></li></ol></li></ol></li></ol></li></ol><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>å¦‚æœå¼‚å¸¸æ²¡æœ‰è¢«æ•è·å¹¶å¤„ç†ï¼Œå°±ä¼šä¸€ç›´å‘åæŠ›å‡º</li><li>å–æ¶ˆæˆ–åœæ­¢ä»»åŠ¡ï¼Œä¹Ÿè¦æ˜¯æ ¸å¿ƒåŠ¨ä½œæ‰§è¡Œçš„æ˜¯ <code>Future</code> ä»»åŠ¡æ‰èƒ½åšåˆ°</li></ol></blockquote><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>ç¬”è®°ï¼šJavaå‡½æ•°å¼ç¼–ç¨‹</title>
    <link href="/2025/12/01/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B/"/>
    <url>/2025/12/01/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B/</url>
    
    <content type="html"><![CDATA[<h1 id="ä¸€ã€TODO"><a href="#ä¸€ã€TODO" class="headerlink" title="ä¸€ã€TODO"></a>ä¸€ã€TODO</h1><ul><li><input disabled="" type="checkbox"> Lambda è¡¨è¾¾å¼é—®é¢˜çˆ†ç ´</li><li><input disabled="" type="checkbox"> Java Stream çš„ä¸²è¡Œæµé—®é¢˜çˆ†ç ´</li><li><input disabled="" type="checkbox"> Java Stream çš„å¹¶è¡Œæµé—®é¢˜çˆ†ç ´</li><li><input disabled="" type="checkbox"> Java Stream çš„ä¸²è¡Œæµé€‚ç”¨åœºæ™¯</li></ul><hr><h1 id="äºŒã€è„‘å›¾"><a href="#äºŒã€è„‘å›¾" class="headerlink" title="äºŒã€è„‘å›¾"></a>äºŒã€è„‘å›¾</h1><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/12/01/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B/">http://blog.wangjia.ink/2025/12/01/ç¬”è®°ï¼šJavaå‡½æ•°å¼ç¼–ç¨‹/</a></p></li><li><p>ä»£ç æ´ªè’ï¼ˆé¢è¯•å®å…¸ï¼‰<br>ğŸ‘‰ <a href="https://www.notion.so/Java-2c3974fbda5e8089b9eae3bb58c6bcce?source=copy_link">https://www.notion.so/Java-2c3974fbda5e8089b9eae3bb58c6bcce?source=copy_link</a></p></li></ol><hr><h1 id="ä¸‰ã€å›è°ƒ"><a href="#ä¸‰ã€å›è°ƒ" class="headerlink" title="ä¸‰ã€å›è°ƒ"></a>ä¸‰ã€å›è°ƒ</h1><h2 id="1-å›è°ƒæ¦‚è¿°"><a href="#1-å›è°ƒæ¦‚è¿°" class="headerlink" title="1. å›è°ƒæ¦‚è¿°"></a>1. å›è°ƒæ¦‚è¿°</h2><p>å›è°ƒæ˜¯æŒ‡ï¼šçº¿ç¨‹åœ¨è°ƒç”¨æ–¹æ³• <code>A</code> æ—¶ï¼Œéœ€è¦å°†æ–¹æ³• <code>B</code> ä½œä¸ºæ–¹æ³•å‚æ•°ä¼ é€’è¿›å»ã€‚çº¿ç¨‹åœ¨æ‰§è¡Œæ–¹æ³• <code>A</code> çš„è¿‡ç¨‹ä¸­ï¼Œä¼šåœ¨æŸä¸ªç‰¹å®šçš„æ—¶æœºå»è°ƒç”¨æ–¹æ³• &#96;B<br><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B.png"></p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>è¿™ä¸ªæ–¹æ³• <code>B</code> æˆ‘ä»¬ç§°ä¹‹ä¸º â€œå›è°ƒå‡½æ•°â€</li></ol></blockquote><hr><h2 id="2-å›è°ƒå‡½æ•°å®ç°æ–¹å¼"><a href="#2-å›è°ƒå‡½æ•°å®ç°æ–¹å¼" class="headerlink" title="2. å›è°ƒå‡½æ•°å®ç°æ–¹å¼"></a>2. å›è°ƒå‡½æ•°å®ç°æ–¹å¼</h2><h3 id="2-1-åŒ¿åå†…éƒ¨ç±»"><a href="#2-1-åŒ¿åå†…éƒ¨ç±»" class="headerlink" title="2.1. åŒ¿åå†…éƒ¨ç±»"></a>2.1. åŒ¿åå†…éƒ¨ç±»</h3><p>å¯¹äº <code>Java</code> è€Œè¨€ï¼Œå®ƒæ˜¯ä¸€é—¨é¢å‘å¯¹è±¡çš„è¯­è¨€ï¼Œæ‰€ä»¥æ— æ³•åƒ <code>JavaScript</code> é‚£æ ·å°†æ–¹æ³•ç›´æ¥ä½œä¸ºæ–¹æ³•å‚æ•°è¿›è¡Œä¼ é€’ï¼Œè€Œæ˜¯å¿…é¡»ä¾èµ–ç±»çš„å®ä¾‹è¿›è¡Œä¼ é€’ã€‚å› æ­¤æˆ‘ä»¬åªèƒ½é€€è€Œæ±‚å…¶æ¬¡ï¼šçº¿ç¨‹åœ¨è°ƒç”¨æ–¹æ³• <code>A</code> æ—¶ï¼Œå°†æŸç±»çš„å®ä¾‹ä½œä¸ºæ–¹æ³•å‚æ•°ä¼ é€’è¿›å»ï¼Œè€Œè¯¥å®ä¾‹èƒ½å¤Ÿè°ƒç”¨æ–¹æ³• <code>B</code>ã€‚çº¿ç¨‹åœ¨æ‰§è¡Œæ–¹æ³• <code>A</code> çš„è¿‡ç¨‹ä¸­ï¼Œä¼šåœ¨æŸä¸ªç‰¹å®šçš„æ—¶æœºä½¿ç”¨è¯¥å®ä¾‹å»è°ƒç”¨æ–¹æ³• <code>B</code></p><p>ä»¥å¦‚ä¸‹ä»£ç ä¸ºä¾‹ï¼Œå‡è®¾æˆ‘ä»¬è¦å°† <code>MyFunctionalInterface#myMethod</code> ä½œä¸ºæ–¹æ³•å‚æ•°ä¼ é€’</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">MyFunctionalInterface</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">myMethod</span><span class="hljs-params">()</span>;<br>    <br>&#125;<br></code></pre></td></tr></table></figure><p>æ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥ä¼ é€’æ‰¿è½½å®ƒçš„ <code>MyFunctionalInterface</code> æ¥å£çš„å…·ä½“å®ç°ç±»å®ä¾‹ã€‚å› æ­¤ï¼Œæ¥æ”¶æ–¹éœ€è¦æ¥æ”¶ä¸€ä¸ª <code>MyFunctionalInterface</code> ç±»å‹çš„æ–¹æ³•å‚æ•°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doSomething</span><span class="hljs-params">(MyFunctionalInterface myFunctionalInterface)</span> &#123;<br>        <span class="hljs-comment">// ...</span><br>        myFunctionalInterface.myMethod();<br>        <span class="hljs-comment">// ...</span><br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>æ‰€ä»¥ä½¿ç”¨åŒ¿åå†…éƒ¨ç±»å®ç°å›è°ƒçš„æœ€ç»ˆå½¢å¼ä¸ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doSomething</span><span class="hljs-params">(MyFunctionalInterface myFunctionalInterface)</span> &#123;<br>        <span class="hljs-comment">// ...</span><br>        myFunctionalInterface.myMethod();<br>        <span class="hljs-comment">// ...</span><br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br><br>        <span class="hljs-type">Test</span> <span class="hljs-variable">test</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Test</span>();<br>        <br>        test.doSomething(<span class="hljs-keyword">new</span> <span class="hljs-title class_">MyFunctionalInterface</span>() &#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">myMethod</span><span class="hljs-params">()</span> &#123;<br>                <span class="hljs-comment">// ...</span><br>            &#125;<br>        &#125;);<br><br>    &#125;<br>    <br>&#125;<br></code></pre></td></tr></table></figure><hr><h3 id="2-2-Lambda-è¡¨è¾¾å¼"><a href="#2-2-Lambda-è¡¨è¾¾å¼" class="headerlink" title="2.2. Lambda è¡¨è¾¾å¼"></a>2.2. Lambda è¡¨è¾¾å¼</h3><h4 id="2-2-1-Lambda-è¡¨è¾¾å¼æ¦‚è¿°"><a href="#2-2-1-Lambda-è¡¨è¾¾å¼æ¦‚è¿°" class="headerlink" title="2.2.1. Lambda è¡¨è¾¾å¼æ¦‚è¿°"></a>2.2.1. Lambda è¡¨è¾¾å¼æ¦‚è¿°</h4><p>æƒ³è±¡è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼šæˆ‘ä»¬çš„ç›®çš„ä»…ä»…æ˜¯ä¼ é€’ä¸€ä¸ªå›è°ƒæ–¹æ³•ï¼Œå´è¢«è¿«è¦åˆ›å»ºä¸€ä¸ªçš„åŒ¿åå†…éƒ¨ç±»ï¼Œç„¶åå†åˆ›å»ºå…¶å®ä¾‹ï¼Œå†é€šè¿‡å…¶å®ä¾‹è°ƒç”¨æ–¹æ³•ï¼Œæ˜¾å¾—éå¸¸ç¬¨é‡å’Œç¹ç</p><p>ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼Œ<code>Java8</code> å¼•å…¥äº† <code>Lambda</code> è¡¨è¾¾å¼ã€‚<code>Lambda</code> è¡¨è¾¾å¼æ˜¯ä¸€ç§è¯­æ³•ç³–ï¼Œåœ¨ç¼–è¯‘é˜¶æ®µä¼šè¢«ç¼–è¯‘å™¨è‡ªåŠ¨è½¬æ¢ä¸ºå¯¹åº”çš„å‡½æ•°å¼æ¥å£çš„å…·ä½“å®ç°ç±»ï¼Œæœ€ç»ˆè¿”å›è¯¥å‡½æ•°å¼æ¥å£çš„å…·ä½“å®ç°ç±»å®ä¾‹ï¼Œå¸®æˆ‘ä»¬ç®€åŒ–äº†ä¸€äº›æ­¥éª¤</p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>å°½ç®¡ <code>Lambda</code> è¡¨è¾¾å¼åŠŸèƒ½å¼ºå¤§ï¼Œä½†å®ƒåªèƒ½ç”¨äºå‡½æ•°å¼æ¥å£ï¼Œè¿”å›ä¸€ä¸ªå‡½æ•°å¼æ¥å£çš„å…·ä½“å®ç°ç±»å®ä¾‹</li><li><code>Lambda</code> è¡¨è¾¾å¼ä½¿ç”¨çš„æ˜¯ <code>invokedynamic</code> å­—èŠ‚ç æŒ‡ä»¤æ¥åˆ›å»ºåŒ¿åå†…éƒ¨ç±»å’ŒåŒ¿åå†…éƒ¨ç±»å®ä¾‹çš„ã€‚è¯¦è§ç¬”è®°ï¼š<code>JVM</code>ï¼ˆ<code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼šï¼Œ<code>Hexo</code> é“¾æ¥ï¼šï¼‰</li></ol></blockquote><hr><h4 id="2-2-2-Lambda-è¡¨è¾¾å¼ç¼–å†™æ–¹å¼"><a href="#2-2-2-Lambda-è¡¨è¾¾å¼ç¼–å†™æ–¹å¼" class="headerlink" title="2.2.2. Lambda è¡¨è¾¾å¼ç¼–å†™æ–¹å¼"></a>2.2.2. Lambda è¡¨è¾¾å¼ç¼–å†™æ–¹å¼</h4><p><code>Lambda</code> è¡¨è¾¾å¼ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼š</p><ol><li>å‚æ•°åˆ—è¡¨<ol><li>æ˜ç¡®æŒ‡å‡ºå‚æ•°ç±»å‹<ol><li>(<code>int a, int b</code>)</li></ol></li><li>æ ¹æ®ä¸Šä¸‹æ–‡è‡ªåŠ¨æ¨æ–­å‚æ•°ç±»å‹<ol><li>(<code>a, b</code>)</li></ol></li><li>éœ€è¦æ³¨æ„çš„æ˜¯ï¼š<ol><li>ä¸å…è®¸å‡ºç°æ—¢æ˜ç¡®æŒ‡å‡ºå‚æ•°ç±»å‹ï¼Œåˆæ ¹æ®ä¸Šä¸‹æ–‡è‡ªåŠ¨æ¨æ–­å‚æ•°ç±»å‹çš„æƒ…å†µï¼ˆä¾‹å¦‚ (<code>int a, b</code>)ï¼‰</li><li>åªæœ‰åœ¨æ°å¥½åªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œå¹¶ä¸”æ˜¯æ ¹æ®ä¸Šä¸‹æ–‡è‡ªåŠ¨æ¨æ–­å‚æ•°ç±»å‹çš„æƒ…å†µä¸‹ï¼Œ<code>Lambda</code> è¡¨è¾¾å¼çš„å‚æ•°åˆ—è¡¨æ‰å¯ä»¥çœç•¥<code> ()</code>ã€‚åœ¨å…¶ä»–æ‰€æœ‰åœºæ™¯ï¼ˆåŒ…æ‹¬æ²¡æœ‰å‚æ•°ï¼‰ï¼Œ<code>() </code>éƒ½å¿…é¡»æ˜¾å¼å†™å‡ºï¼ˆä¾‹å¦‚ <code>a</code> æ˜¯æ­£ç¡®çš„ï¼Œä½†æ˜¯ <code>Object a</code> æ˜¯ä¸æ­£ç¡®çš„ï¼‰</li></ol></li></ol></li><li><code>-&gt;</code></li><li>æ–¹æ³•ä½“<ol><li>å¦‚æœæ–¹æ³•ä½“åªæœ‰ä¸€è¡Œ<ol><li>å¦‚æœæœ‰ <code>return</code><ol><li>å¯ä»¥çœç•¥ <code>return</code>ï¼ˆä¾‹å¦‚ <code>return a + b â” a + b</code>ï¼‰</li></ol></li><li>å¦‚æœæ²¡æœ‰ <code>return</code><ol><li>ç›´æ¥å†™å³å¯ï¼ˆä¾‹å¦‚ <code>System.out.println(&quot;Hello World&quot;)</code>ï¼‰</li></ol></li></ol></li><li>å¦‚æœæ–¹æ³•ä½“æœ‰å¤šè¡Œ<ol><li>å¿…é¡»æœ‰ <code>&#123;&#125;</code>ï¼Œå¹¶ä¸”ä¸èƒ½çœç•¥ <code>return</code>ï¼ˆä¾‹å¦‚ <code>&#123; int c = a + b; return c; &#125;</code>ï¼‰</li></ol></li></ol></li></ol><hr><h4 id="Lambda-è¡¨è¾¾å¼é—®é¢˜çˆ†ç ´"><a href="#Lambda-è¡¨è¾¾å¼é—®é¢˜çˆ†ç ´" class="headerlink" title="Lambda è¡¨è¾¾å¼é—®é¢˜çˆ†ç ´"></a>Lambda è¡¨è¾¾å¼é—®é¢˜çˆ†ç ´</h4><h1 id="å››ã€å‡½æ•°å¼æ¥å£"><a href="#å››ã€å‡½æ•°å¼æ¥å£" class="headerlink" title="å››ã€å‡½æ•°å¼æ¥å£"></a>å››ã€å‡½æ•°å¼æ¥å£</h1><h2 id="1-å‡½æ•°å¼æ¥å£æ¦‚è¿°"><a href="#1-å‡½æ•°å¼æ¥å£æ¦‚è¿°" class="headerlink" title="1. å‡½æ•°å¼æ¥å£æ¦‚è¿°"></a>1. å‡½æ•°å¼æ¥å£æ¦‚è¿°</h2><p>å‡½æ•°å¼æ¥å£æ˜¯æŒ‡ï¼šåªåŒ…å«ä¸€ä¸ªå®ä¾‹æ¥å£æ–¹æ³•ï¼ˆæ™®é€šï¼‰çš„æ¥å£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@FunctionalInterface</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">MyFunctionalInterface</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">myMethod</span><span class="hljs-params">(String s)</span>;<br>    <br><br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>æ ‡æ³¨ <code>@FunctionalInterface</code> ç”¨äºå‘Šè¯‰ç¼–è¯‘å™¨ â€œè¯·å¸®æˆ‘æ£€æŸ¥ä¸€ä¸‹è¿™ä¸ªæ¥å£ï¼Œæ˜¯å¦åªæœ‰ä¸€ä¸ªå®ä¾‹æ¥å£æ–¹æ³•ï¼ˆæ™®é€šï¼‰â€</li><li>è™½ç„¶å‡½æ•°å¼æ¥å£åªåŒ…å«ä¸€ä¸ªå®ä¾‹æ¥å£æ–¹æ³•ï¼ˆæ™®é€šï¼‰ï¼Œä½†æ˜¯èƒ½åŒ…å«å¤šä¸ªå®ä¾‹æ¥å£æ–¹æ³•ï¼ˆ<code>default</code>ï¼‰ã€é™æ€æ¥å£æ–¹æ³•ï¼ˆ<code>default</code>ï¼‰</li></ol></blockquote><hr><h2 id="2-å†…ç½®çš„å‡½æ•°å¼æ¥å£ç›¸å…³åˆ†ç±»"><a href="#2-å†…ç½®çš„å‡½æ•°å¼æ¥å£ç›¸å…³åˆ†ç±»" class="headerlink" title="2. å†…ç½®çš„å‡½æ•°å¼æ¥å£ç›¸å…³åˆ†ç±»"></a>2. å†…ç½®çš„å‡½æ•°å¼æ¥å£ç›¸å…³åˆ†ç±»</h2><p><code>Java8</code> æ€•æˆ‘ä»¬è‡ªå·±å®šä¹‰å‡½æ•°å¼æ¥å£å¤ªéº»çƒ¦ï¼Œæå‰ä¸ºæˆ‘ä»¬å‡†å¤‡å¥½äº†ä¸€äº›å¸¸ç”¨çš„å‡½æ•°å¼æ¥å£ï¼š</p><ol><li>å››å¤§é‡‘åˆš<ol><li><code>Functionï¼œT, Rï¼</code> æ¥å£</li><li><code>Consumerï¼œTï¼</code> æ¥å£</li><li><code>Predicateï¼œTï¼</code> æ¥å£</li><li><code>Supplierï¼œTï¼</code> æ¥å£</li></ol></li><li>æ‰©å±•å˜ä½“<ol><li><code>Bi</code> ç³»åˆ—<ol><li><code>BiFunctionï¼œT, U, Rï¼</code> æ¥å£</li><li><code>BiConsumerï¼œT, Uï¼</code> æ¥å£</li><li><code>BiPredicate&lt;T, U&gt;</code> æ¥å£</li></ol></li><li><code>Operator</code> ç³»åˆ—<ol><li><code>UnaryOperatorï¼œTï¼</code> æ¥å£</li><li><code>BinaryOperatorï¼œTï¼</code> æ¥å£</li><li><code>IntUnaryOperator</code> æ¥å£</li><li><code>IntBinaryOperator</code> æ¥å£</li><li><code>LongUnaryOperator</code> æ¥å£</li><li><code>LongBinaryOperator</code> æ¥å£</li><li><code>DoubleUnaryOperator</code> æ¥å£</li><li><code>DoubleBinaryOperator</code> æ¥å£</li></ol></li><li><code>Primitive</code> ç³»åˆ—<ol><li><code>Functionï¼œT, Rï¼</code> ç›¸å…³<ol><li><code>IntFunctionï¼œRï¼</code> æ¥å£</li><li><code>LongFunctionï¼œRï¼</code> æ¥å£</li><li><code>DoubleFunctionï¼œRï¼</code> æ¥å£</li><li><code>ToIntFunctionï¼œTï¼</code> æ¥å£</li><li><code>ToLongFunctionï¼œTï¼</code> æ¥å£</li><li><code>ToDoubleFunctionï¼œTï¼</code> æ¥å£</li><li><code>IntToLongFunction</code> æ¥å£</li><li><code>IntToDoubleFunction</code> æ¥å£</li><li><code>LongToIntFunction</code> æ¥å£</li><li><code>LongToDoubleFunction</code> æ¥å£</li><li><code>DoubleToIntFunction</code> æ¥å£</li><li><code>DoubleToLongFunction</code> æ¥å£</li><li><code>ToIntBiFunctionï¼œT, Uï¼</code> æ¥å£</li><li><code>ToLongBiFunctionï¼œT, Uï¼</code> æ¥å£</li><li><code>ToDoubleBiFunctionï¼œT, Uï¼</code> æ¥å£</li></ol></li><li><code>Consumerï¼œTï¼</code> ç›¸å…³<ol><li><code>IntConsumer</code> æ¥å£</li><li><code>LongConsumer</code> æ¥å£</li><li><code>DoubleConsumer</code> æ¥å£</li><li><code>ObjIntConsumerï¼œTï¼</code> æ¥å£</li><li><code>ObjLongConsumerï¼œTï¼</code> æ¥å£</li><li><code>ObjDoubleConsumerï¼œTï¼</code> æ¥å£</li></ol></li><li><code>Predicateï¼œTï¼</code> ç›¸å…³<ol><li><code>IntPredicate</code> æ¥å£</li><li><code>LongPredicate</code> æ¥å£</li><li><code>DoublePredicate</code> æ¥å£</li></ol></li><li><code>Supplierï¼œTï¼</code> ç›¸å…³<ol><li><code>IntSupplier</code> æ¥å£</li><li><code>LongSupplier</code> æ¥å£</li><li><code>DoubleSupplier</code> æ¥å£</li><li><code>BooleanSupplier</code> æ¥å£</li></ol></li></ol></li></ol></li></ol><h3 id="2-1-å››å¤§é‡‘åˆš"><a href="#2-1-å››å¤§é‡‘åˆš" class="headerlink" title="2.1. å››å¤§é‡‘åˆš"></a>2.1. å››å¤§é‡‘åˆš</h3><h4 id="2-1-1-Functionï¼œT-Rï¼-æ¥å£"><a href="#2-1-1-Functionï¼œT-Rï¼-æ¥å£" class="headerlink" title="2.1.1. Functionï¼œT, Rï¼  æ¥å£"></a>2.1.1. Functionï¼œT, Rï¼  æ¥å£</h4><p>è¯¦è§æºç ï¼š<code>Functionï¼œT, Rï¼</code></p><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.function.Function%EF%BC%9CT,R%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.function.Functionï¼œT,Rï¼æºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/11/18/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.function.Function%EF%BC%9CT,R%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/18/æºç ï¼šjava.util.function.Functionï¼œT,Rï¼æºç è§£æ/</a></li></ol></li></ol><hr><h4 id="2-1-2-Consumerï¼œTï¼-æ¥å£"><a href="#2-1-2-Consumerï¼œTï¼-æ¥å£" class="headerlink" title="2.1.2. Consumerï¼œTï¼ æ¥å£"></a>2.1.2. Consumerï¼œTï¼ æ¥å£</h4><p>è¯¦è§æºç ï¼š<code>Consumerï¼œTï¼</code></p><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.function.Consumer%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.function.Consumerï¼œTï¼æºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/11/18/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.function.Consumer%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/18/æºç ï¼šjava.util.function.Consumerï¼œTï¼æºç è§£æ/</a></li></ol></li></ol><hr><h4 id="2-1-3-Predicateï¼œTï¼-æ¥å£"><a href="#2-1-3-Predicateï¼œTï¼-æ¥å£" class="headerlink" title="2.1.3. Predicateï¼œTï¼ æ¥å£"></a>2.1.3. Predicateï¼œTï¼ æ¥å£</h4><p>è¯¦è§æºç ï¼š<code>Predicateï¼œTï¼</code></p><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.function.Predicate%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.function.Predicateï¼œTï¼æºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/11/18/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.function.Predicate%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/18/æºç ï¼šjava.util.function.Predicateï¼œTï¼æºç è§£æ/</a></li></ol></li></ol><hr><h4 id="2-1-4-Supplierï¼œTï¼-æ¥å£"><a href="#2-1-4-Supplierï¼œTï¼-æ¥å£" class="headerlink" title="2.1.4. Supplierï¼œTï¼ æ¥å£"></a>2.1.4. Supplierï¼œTï¼ æ¥å£</h4><p>è¯¦è§æºç ï¼š<code>Supplierï¼œTï¼</code></p><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.function.Supplier%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.function.Supplierï¼œTï¼æºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/11/18/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.function.Supplier%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/18/æºç ï¼šjava.util.function.Supplierï¼œTï¼æºç è§£æ/</a></li></ol></li></ol><hr><h1 id="äº”ã€Java-Stream"><a href="#äº”ã€Java-Stream" class="headerlink" title="äº”ã€Java Stream"></a>äº”ã€Java Stream</h1><h2 id="1-Java-Stream-æ¦‚è¿°"><a href="#1-Java-Stream-æ¦‚è¿°" class="headerlink" title="1. Java Stream æ¦‚è¿°"></a>1. Java Stream æ¦‚è¿°</h2><p>æˆ‘ä»¬çŸ¥é“ â€œåœ¨ <code>Java</code> åº”ç”¨ä¸­ï¼Œéå†æŸä¸ªæ•°æ®ç»“æ„æœ‰ä¸¤ç§æ–¹å¼ï¼šåŸºäºç´¢å¼•éå†ã€åŸºäºå¼•ç”¨éå†â€ã€‚ä¸ºäº†é¿å…æ¯ä¸€æ¬¡æƒ³è¦éå†æŸä¸ªæ•°æ®ç»“æ„æ—¶ï¼Œéƒ½è¦æ‰‹åŠ¨ç¼–å†™æ•°æ®ç»“æ„çš„éå†é€»è¾‘ã€‚æ‰€ä»¥æˆ‘ä»¬é€šå¸¸ä½¿ç”¨è¿­ä»£å™¨å°è£…æ•°æ®ç»“æ„çš„éå†é€»è¾‘ï¼Œéå†æ—¶ç›´æ¥ä½¿ç”¨è¿­ä»£å™¨è¿›è¡Œæ•°æ®ç»“æ„çš„éå†ï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼šä½¿ç”¨è¿­ä»£å™¨è¿›è¡Œæ•°æ®ç»“æ„çš„éå†ï¼ŒåŒæ ·éœ€è¦å€ŸåŠ©å¾ªç¯ï¼‰ã€‚å¯å³ä¾¿å¦‚æ­¤ï¼Œæˆ‘ä»¬è¿˜æ˜¯å‘ç°ï¼šä½¿ç”¨è¿­ä»£å™¨è¿›è¡Œæ•°æ®ç»“æ„çš„éå†æ—¶ï¼Œæ“ä½œä»ç„¶æ˜¾å¾—éå¸¸ç¹ç</p><p>äºæ˜¯ <code>Java</code> è¯­è¨€çš„è®¾è®¡å›¢é˜Ÿæä¾›äº†å¢å¼º <code>for</code> å¾ªç¯è¯­æ³•ç³–æ¥ç®€åŒ–æ“ä½œã€‚å¯å°½ç®¡å¦‚æ­¤ï¼Œå¦‚æœæ¶‰åŠåˆ°å¤šä¸ªæ“ä½œï¼Œæ“ä½œä»ç„¶ä¼šæ˜¾å¾—å¤ªç¹çï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException, ClassNotFoundException &#123;<br><br>        <span class="hljs-comment">// åˆ›å»ºé›†åˆ</span><br>        ArrayList&lt;String&gt; list1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>        list1.add(<span class="hljs-string">&quot;å¼ æ— å¿Œ&quot;</span>);<br>        list1.add(<span class="hljs-string">&quot;å‘¨èŠ·è‹¥&quot;</span>);<br>        list1.add(<span class="hljs-string">&quot;èµµæ•&quot;</span>);<br>        list1.add(<span class="hljs-string">&quot;å¼ å¼º&quot;</span>);<br>        list1.add(<span class="hljs-string">&quot;å¼ ä¸‰ä¸°&quot;</span>);<br><br>        <span class="hljs-comment">// æŠŠæ‰€æœ‰ä»¥ â€œå¼ â€ å¼€å¤´çš„å…ƒç´ å­˜å‚¨åˆ°æ–°é›†åˆä¸­</span><br>        ArrayList&lt;String&gt; list2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>        <span class="hljs-keyword">for</span> (String name : list1) &#123;<br>            <span class="hljs-keyword">if</span>(name.startsWith(<span class="hljs-string">&quot;å¼ &quot;</span>))&#123;<br>                list2.add(name);<br>            &#125;<br>        &#125;<br>        <span class="hljs-comment">// æŠŠ â€œå¼ â€ å¼€å¤´çš„ï¼Œé•¿åº¦ä¸º 3 çš„å…ƒç´ å†å­˜å‚¨åˆ°æ–°é›†åˆä¸­</span><br>        ArrayList&lt;String&gt; list3 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>        <span class="hljs-keyword">for</span> (String name : list2) &#123;<br>            <span class="hljs-keyword">if</span>(name.length() == <span class="hljs-number">3</span>)&#123;<br>                list3.add(name);<br>            &#125;<br>        &#125;<br>        <br>        <span class="hljs-comment">// è¾“å‡ºç»“æœ</span><br>        <span class="hljs-keyword">for</span> (String s : list3) &#123;<br>            System.out.println(s);<br>        &#125;<br><br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>è€Œ <code>Java8</code> ä¹‹åçš„ <code>Java Stream</code> ä»¥ä¸€ç§å£°æ˜å¼ã€å‡½æ•°å¼çš„é£æ ¼ï¼Œä¼˜é›…çš„è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException, ClassNotFoundException &#123;<br><br>        ArrayList&lt;String&gt; list = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>        list1.add(<span class="hljs-string">&quot;å¼ æ— å¿Œ&quot;</span>);<br>        list1.add(<span class="hljs-string">&quot;å‘¨èŠ·è‹¥&quot;</span>);<br>        list1.add(<span class="hljs-string">&quot;èµµæ•&quot;</span>);<br>        list1.add(<span class="hljs-string">&quot;å¼ å¼º&quot;</span>);<br>        list1.add(<span class="hljs-string">&quot;å¼ ä¸‰ä¸°&quot;</span>);<br><br>        list.stream().filter(name -&gt; name.startsWith(<span class="hljs-string">&quot;å¼ &quot;</span>)).filter(name -&gt; name.length() == <span class="hljs-number">3</span>).forEach(name -&gt; System.out.println(name));<br><br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>å¢å¼º <code>for</code> å¾ªç¯ï¼ˆ<code>for-each</code> å¾ªç¯ï¼‰æ˜¯ <code>Java</code> æä¾›çš„ä¸€ç§è¯­æ³•ç³–ï¼Œåœ¨ç¼–è¯‘é˜¶æ®µä¼šè¢«ç¼–è¯‘å™¨è‡ªåŠ¨è½¬æ¢ä¸ºä½¿ç”¨è¿­ä»£å™¨è¿›è¡Œæ•°æ®ç»“æ„çš„éå†ï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼šæ˜¯ä½¿ç”¨è¿­ä»£å™¨å®ç°æ•°æ®ç»“æ„çš„éå†ï¼Œè€Œä¸æ˜¯ä½¿ç”¨å¯æ‹†åˆ†è¿­ä»£å™¨å®ç°æ•°æ®ç»“æ„çš„éå†ï¼‰</li></ol></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ç¼–è¯‘å‰</span><br><span class="hljs-keyword">for</span> (T t : iterable) &#123;<br>xxxxxx<br>&#125;<br><br><br><span class="hljs-comment">// ç¼–è¯‘å</span><br><span class="hljs-keyword">for</span> (Iterator&lt;T&gt; it = iterable.iterator(); it.hasNext(); ) &#123;<br><span class="hljs-type">T</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> it.next();<br>xxxxxx<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹<br>2. å¦‚æœä»…ä»…æ˜¯ä¸ºäº†ä»£ç çœ‹èµ·æ¥ä¼˜é›…ï¼Œ<code>Java</code> è¯­è¨€çš„è®¾è®¡å›¢é˜Ÿæ˜¯ä¸å¯èƒ½å¤§åŠ¨å¹²æˆˆå¼•å…¥ <code>Java Stream</code> è¿™ä¸€åºå¤§çš„ä½“ç³»çš„ã€‚å…¶å® <code>Java Stream</code> è¢«å¼•å…¥çš„çœŸæ­£åŸå› æ˜¯ï¼šæƒ°æ€§æ±‚å€¼ã€å¹¶è¡Œå¤„ç†<br>    1. æƒ°æ€§æ±‚å€¼<br>        1. å½“æ‰§è¡Œ <code>Java Stream</code> çš„ä¸­é—´æ–¹æ³•æ—¶ï¼Œå¹¶ä¸ä¼šåƒä¼ ç»Ÿçš„å¤„ç†æ–¹æ³•ä¸€æ ·ï¼šæ‰§è¡Œæ¯ä¸€æ­¥æ—¶éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ•°æ®ç»“æ„ï¼Œç„¶åéå†æŸä¸ªæ•°æ®ç»“æ„ï¼Œè®©æ•°æ®ç»“æ„ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½æ‰§è¡Œè¿™ä¸€æ­¥ï¼Œå°†å…ƒç´ è¢«è¿™ä¸€æ­¥å¤„ç†åçš„ç»“æœ â€œå¢â€ è¿›è¿™ä¸ªæ–°çš„æ•°æ®ç»“æ„ä¸­ã€‚æ‰§è¡Œå®Œè¿™ä¸€æ­¥ï¼Œå†æ‰§è¡Œä¸‹ä¸€æ­¥ï¼ˆå³ä¸€æ­¥ä¸€æ­¥æ¥ï¼‰<br>        2. ç›¸åï¼Œåœ¨æ‰§è¡Œ <code>Java Stream</code> çš„ä¸­é—´æ–¹æ³•æ—¶ï¼Œåªæ˜¯ä¼šè®°å½•ä¸‹è¿™ä¸€æ­¥çš„é“¾å¼é€»è¾‘ï¼Œå¹¶ä¸ä¼šç«‹å³æ‰§è¡Œã€‚ç›´åˆ°æ‰§è¡Œåˆ° <code>Java Stream</code> çš„ç»“æŸæ–¹æ³•æ—¶ï¼Œ<code>Java Stream</code> æ‰ä¼šæŒ‰ç…§é“¾å¼é€»è¾‘éå†æŸä¸ªæ•°æ®ç»“æ„ï¼Œè®©æ•°æ®ç»“æ„ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½æ‰§è¡Œå®Œæ•´ä¸ªé“¾å¼é€»è¾‘ã€‚å¤„ç†å®Œè¿™ä¸€ä¸ªå…ƒç´ ï¼Œå†å¤„ç†ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œä»è€Œé¿å…äº†å¤§é‡çš„ä¸­é—´çš„æ•°æ®ç»“æ„çš„åˆ›å»ºï¼ˆå³ä¸€ä¸ªä¸€ä¸ªæ¥ï¼‰<br>        3. éœ€è¦æ³¨æ„çš„æ˜¯ï¼š<code>90%</code> éƒ½æ˜¯åŸºäºä¸Šè¿°çš„æµç¨‹ï¼Œä½†æ˜¯ä¹Ÿæœ‰ <code>10%</code> å¹¶ä¸æ˜¯è¿™æ ·ã€‚è¿™æ˜¯å› ä¸ºæ¶‰åŠåˆ°äº†æ’åºæ–¹æ³•ï¼Œè¿™æ ·çš„è¯éœ€è¦è®© <code>Java Stream</code> ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½æ‰§è¡Œå®Œè¿™ä¸€æ­¥ï¼Œç„¶åå†æŒ‰ä¸Šè¿°çš„æµç¨‹ç»§ç»­æ‰§è¡Œ<br>    2. å¹¶è¡Œå¤„ç†<br>        1. æˆ‘ä»¬çŸ¥é“ â€œåœ¨ <code>Java</code> åº”ç”¨ä¸­ï¼Œéå†æŸä¸ªæ•°æ®ç»“æ„æœ‰ä¸¤ç§æ–¹å¼ï¼šåŸºäºç´¢å¼•éå†ã€åŸºäºå¼•ç”¨éå†â€ã€‚å¦‚æœè®©æˆ‘ä»¬è‡ªå·±ç¼–å†™æ•°æ®ç»“æ„çš„éå†é€»è¾‘ï¼Œæˆ‘ä»¬å¾ˆå¯èƒ½æ˜¯ä½¿ç”¨å•çº¿ç¨‹è¿›è¡Œæ•°æ®ç»“æ„çš„éå†<br>        2. å› ä¸ºå¦‚æœæˆ‘ä»¬å¸Œæœ›ä½¿ç”¨å¤šçº¿ç¨‹è¿›è¡Œæ•°æ®ç»“æ„çš„éå†ï¼Œå°±å¿…é¡»æå‰å°†æ•°æ®ç»“æ„ä¸­çš„å…ƒç´ è¿›è¡Œæ‹†åˆ†ï¼Œç„¶åæ‰‹åŠ¨åˆ›å»ºæ–°çš„æ•°æ®ç»“æ„æ¥ä¿å­˜æ¯ä¸€æ®µè¢«æ‹†åˆ†åçš„å…ƒç´ ã€‚å½“ä½¿ç”¨å¤šçº¿ç¨‹è¿›è¡Œæ•°æ®ç»“æ„çš„éå†åï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ‰‹åŠ¨åˆå¹¶ç»“æœã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å¤„ç†å¤šçº¿ç¨‹å¹¶å‘æƒ…å†µä¸‹çš„å®‰å…¨é—®é¢˜ã€‚è¿™æ ·ä¸€å¥—æ•´ä¸‹æ¥ï¼Œæ“ä½œå°±æ˜¾å¾—éå¸¸ç¹çï¼Œä¸å¦‚ç›´æ¥ä½¿ç”¨å•çº¿ç¨‹è¿›è¡Œæ•°æ®ç»“æ„çš„éå†æ¥çš„æ–¹ä¾¿<br>        3. ä½†æ˜¯ <code>Java Stream</code> å·²ç»å¸®æˆ‘ä»¬å°è£…äº†è¿™äº›å¤æ‚é€»è¾‘ï¼Œä½¿æˆ‘ä»¬èƒ½æ›´è½»æ¾åœ°ä½¿ç”¨å¤šçº¿ç¨‹è¿›è¡Œæ•°æ®ç»“æ„çš„éå†ï¼ˆå¹¶è¡Œæµï¼‰<br>3. <code>Java Stream</code> çš„å¹¶è¡Œæµæ˜¯ä½¿ç”¨ <code>ForkJoinPool</code> å®ç°åˆ†è€Œæ²»ä¹‹ã€è¿­ä»£æ‹†åˆ†ã€å·¥ä½œçªƒå–çš„ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬æ—¥å¸¸åœ¨ä½¿ç”¨ <code>ForkJoinPool</code> æ—¶ï¼Œæ˜¯éœ€è¦æ‰‹åŠ¨ç¼–å†™å…ƒç´ æˆ–æ•°æ®çš„è¿­ä»£æ‹†åˆ†é€»è¾‘çš„ï¼Œä½ å¯èƒ½ç–‘æƒ‘ï¼š<code>Java Stream</code> çš„å¹¶è¡Œæµçš„è¿­ä»£æ‹†åˆ†é€»è¾‘è¢«å†™åˆ°äº†å“ªé‡Œï¼Ÿ<br>    1. æˆ‘ä»¬çŸ¥é“ â€œä¸ç®¡æ˜¯ <code>Java Stream</code> çš„ä¸²è¡Œæµè¿˜æ˜¯ <code>Java Stream</code> çš„å¹¶è¡Œæµï¼Œéƒ½è¦ä»¥å¯æ‹†åˆ†è¿­ä»£å™¨ä¸ºèµ·ç‚¹â€ã€‚æ‰€ä»¥èƒ½åˆ›å»º <code>Java Stream</code> çš„å¹¶è¡Œæµæˆ– <code>Java Stream</code> çš„ä¸²è¡Œæµçš„æ•°æ®ç»“æ„ï¼Œé€šå¸¸ä¼šåŒ…å«ä¸€ä¸ªå®ç° <code>Spliteratorï¼œTï¼</code> æ¥å£çš„å†…éƒ¨ç±»ï¼Œè€Œå¹¶è¡Œæµçš„è¿­ä»£æ‹†åˆ†é€»è¾‘å°±è¢«å†™åœ¨è¿™ä¸ªå†…éƒ¨ç±»ä¸­<br>    2. ä»¥ä¸Šè¿°ä»£ç ä¸ºä¾‹ï¼Œå¹¶è¡Œæµçš„è¿­ä»£æ‹†åˆ†é€»è¾‘å°±è¢«å†™åœ¨ <code>HashMapï¼œK, Vï¼.KeySpliteratorï¼œK, Vï¼</code>ï¼ˆç”±äº <code>HashSetï¼œEï¼</code> åº•å±‚æ˜¯åŸºäºä¸€ä¸ª <code>HashMapï¼œK, Vï¼</code> å®ç°çš„ï¼Œæ‰€ä»¥ç›´æ¥ä½¿ç”¨ <code>HashMapï¼œK, Vï¼</code> çš„å†…éƒ¨ç±»ï¼‰</p></blockquote><hr><h2 id="2-Java-Stream-ç›¸å…³åˆ†ç±»"><a href="#2-Java-Stream-ç›¸å…³åˆ†ç±»" class="headerlink" title="2. Java Stream ç›¸å…³åˆ†ç±»"></a>2. Java Stream ç›¸å…³åˆ†ç±»</h2><ol><li>ä»¥ <code>Java Stream</code> å¤„ç†çš„å…ƒç´ çš„æ•°æ®ç±»å‹åˆ†ç±»ï¼š<ol><li>æ™®é€šæµï¼ˆå³å¤„ç†å¼•ç”¨æ•°æ®ç±»å‹çš„å…ƒç´ çš„æµï¼‰<ol><li><code>Streamï¼œTï¼</code> æ¥å£çš„å…·ä½“å®ç°ç±»</li></ol></li><li>ç‰¹åŒ–æµï¼ˆå³å¤„ç†åŸºæœ¬æ•°æ®ç±»å‹çš„å…ƒç´ çš„æµï¼‰<ol><li><code>IntStream</code> æ¥å£çš„å…·ä½“å®ç°ç±»</li><li><code>LongStream</code> æ¥å£çš„å…·ä½“å®ç°ç±»</li><li><code>DoubleStream</code> æ¥å£çš„å…·ä½“å®ç°ç±»</li></ol></li></ol></li><li>ä»¥ <code>Java Stream</code> çš„æ‰§è¡Œæ–¹å¼åˆ†ç±»ï¼š<ol><li>ä¸²è¡Œæµ</li><li>å¹¶è¡Œæµ</li></ol></li></ol><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>çŒ´å“¥çš„çƒ¦æ¼ç®± <code>(ï½¡â€¢Ìï¸¿â€¢Ì€ï½¡)</code>ï¼š<ol><li>ä¸ºä»€ä¹ˆæä¾›äº†ç‰¹åŒ–æµï¼Ÿä½¿ç”¨æ™®é€šæµéš¾é“è§£å†³ä¸äº†æˆ‘ä»¬çš„é—®é¢˜å—ï¼Ÿ<ol><li>å› ä¸ºæ™®é€šæµæ¶‰åŠåˆ°äº† <code>Java</code> æ³›å‹ã€‚æˆ‘ä»¬çŸ¥é“ â€œä¸€æ—¦æŸä¸ªä¸œè¥¿æ¶‰åŠåˆ° <code>Java</code> æ³›å‹ï¼Œé‚£ä¹ˆå…¶åœ¨å¤„ç†åŸºæœ¬æ•°æ®ç±»å‹çš„å…ƒç´ æ—¶ï¼Œå°±ä¼šå‡ºç°å¾ˆå¤šé—®é¢˜â€</li><li>æˆ‘ä»¬å…ˆæ¥å›é¡¾ä¸€ä¸‹é›†åˆåœ¨æ¶‰åŠåˆ° <code>Java</code> æ³›å‹åï¼Œåœ¨å¤„ç†åŸºæœ¬æ•°æ®ç±»å‹çš„å…ƒç´ æ—¶å‡ºç°çš„é—®é¢˜ï¼š<ol><li>å†…å­˜æ–¹é¢çš„å‹åŠ›<ol><li>å¦‚æœæˆ‘ä»¬åªæ˜¯æƒ³å­˜å‚¨ä¸€äº¿ä¸ªåŸºæœ¬æ•°æ®ç±»å‹çš„å…ƒç´ ï¼Œä½†æ˜¯ç”±äºé›†åˆæ¶‰åŠåˆ° <code>Java</code> æ³›å‹ï¼Œæ‰€ä»¥é›†åˆä¸­åªèƒ½å­˜å‚¨å¼•ç”¨æ•°æ®ç±»å‹çš„å…ƒç´ ï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼šå®é™…å­˜å‚¨çš„æ˜¯å¼•ç”¨æ•°æ®ç±»å‹çš„å…ƒç´ çš„å¼•ç”¨ï¼‰ã€‚æ‰€ä»¥åŸºæœ¬æ•°æ®ç±»å‹çš„å…ƒç´ åªèƒ½åœ¨è‡ªåŠ¨è£…ç®±åå† â€œå¢â€ è¿›é›†åˆä¸­</li><li>ä¾‹å¦‚ä¸€ä¸ª <code>int</code> ç±»å‹çš„æ•°æ®æ˜¯ <code>4 byte</code>ï¼Œä½†æ˜¯ä¸€ä¸ª <code>Integer</code> ç±»å‹çš„æ•°æ®åœ¨ <code>32 bit</code> è™šæ‹Ÿæœºä¸‹å¯èƒ½éœ€è¦ <code>16 byte</code>ï¼Œé‚£ä¹ˆå¯¹äºä¸€äº¿ä¸ªæ•°æ®ï¼Œå°±å¤šæ¶ˆè€—äº† <code>1525 MB</code> çš„å†…å­˜ï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼šç”±äºé›†åˆä¸­å®é™…å­˜å‚¨çš„æ˜¯å¼•ç”¨æ•°æ®ç±»å‹çš„å…ƒç´ çš„å¼•ç”¨ï¼Œè¿™ä¸€äº¿ä¸ªå¼•ç”¨ä¹Ÿå ç”¨äº†ä¸å°çš„å†…å­˜ï¼‰</li></ol></li><li><code>CPU</code> æ–¹é¢çš„å‹åŠ›<ol><li>å¦‚æœæˆ‘ä»¬å¯¹é›†åˆä¸­çš„å…ƒç´ åšä¸€æ¬¡ç®€å•çš„è®¡ç®—æ“ä½œï¼ˆä¾‹å¦‚å¯¹æ¯ä¸ªå…ƒç´ æ‰§è¡Œ <code>+1</code>ï¼‰æ—¶ï¼Œå°±ä¼šè§¦å‘è¿™ä¸€äº¿ä¸ªå…ƒç´ çš„è‡ªåŠ¨æ‹†ç®± â” è®¡ç®— â” è‡ªåŠ¨è£…ç®±</li><li>é™¤æ­¤ä¹‹å¤–ï¼Œç”±äºé›†åˆä¸­å®é™…å­˜å‚¨çš„æ˜¯å¼•ç”¨æ•°æ®ç±»å‹çš„å…ƒç´ çš„å¼•ç”¨ï¼Œæ‰€ä»¥è¦è®¿é—®æŸå…ƒç´ æ—¶ï¼Œå°±è¦å…ˆé€šè¿‡å…¶å¼•ç”¨æŒ‡å‘çš„å†…å­˜åœ°å€æ‰¾åˆ°è¯¥å…ƒç´ ã€‚è¿™ä¸ªå¯»å€çš„è¿‡ç¨‹æœ¬èº«å°±å­˜åœ¨è¾ƒå¤§çš„å¼€é”€ï¼Œè€Œä¸”å®ƒå¹¶ä¸åƒæ•°ç»„é‚£æ ·ï¼Œæ˜¯åˆ†é…è¿ç»­å†…å­˜çš„æ•°æ®ç»“æ„ï¼Œä¸€æ¬¡æ€§å°±èƒ½åŠ è½½å¤šä¸ªå…ƒç´ ï¼Œè€Œæ˜¯ â€œä¸œä¸€å—è¥¿ä¸€å—â€ çš„ï¼Œä»è€Œå¤§å¤§å¢åŠ äº†å¯»å€å¼€é”€ï¼ˆæœ¯è¯­æ˜¯ï¼š<code>CPU</code> ç¼“å­˜å‘½ä¸­ç‡ä½ï¼‰</li></ol></li></ol></li><li>è€Œæ™®é€šæµåœ¨æ¶‰åŠåˆ° <code>Java</code> æ³›å‹åï¼Œåœ¨å¤„ç†åŸºæœ¬æ•°æ®ç±»å‹çš„å…ƒç´ æ—¶ä¼šå‡ºç°æ›´å¤šçš„é—®é¢˜ï¼š<ol><li>å¦‚æœæˆ‘ä»¬ä½¿ç”¨æ™®é€šæµéå†çš„çš„æ˜¯ä¸€ä¸ªæ•°ç»„ï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼šæ•°ç»„æ˜¯ <code>Java</code> ä¸­å”¯ä¸€æ—¢èƒ½å­˜å‚¨åŸºæœ¬æ•°æ®ç±»å‹çš„å…ƒç´ ï¼Œåˆèƒ½å­˜å‚¨å¼•ç”¨æ•°æ®ç±»å‹çš„å…ƒç´ ï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼šå®é™…å­˜å‚¨çš„æ˜¯å¼•ç”¨æ•°æ®ç±»å‹çš„å…ƒç´ çš„å¼•ç”¨ï¼‰çš„æ•°æ®ç»“æ„ï¼‰<ol><li>è¿™ç›¸å½“äºäººä¸ºåœ°é™ä½å¤„ç†æ•ˆç‡ã€‚å› ä¸ºæ™®é€šæµæ¶‰åŠåˆ° <code>Java</code> æ³›å‹ï¼Œæ‰€ä»¥åªèƒ½å¤„ç†å¼•ç”¨æ•°æ®ç±»å‹çš„å…ƒç´ ã€‚æ‰€ä»¥å³ä¾¿æ•°ç»„ä¸­å­˜å‚¨çš„æ˜¯åŸºæœ¬æ•°æ®ç±»å‹çš„å…ƒç´ ï¼Œä¸ºäº†è¢«æ™®é€šæµå¤„ç†ï¼Œä¹Ÿéœ€è¦å…ˆå¯¹å…¶è¿›è¡Œè‡ªåŠ¨è£…ç®±ï¼ˆå³åˆ›å»ºä¸€äº¿ä¸ªåŒ…è£…ç±»å®ä¾‹ï¼Œä»…ä¸ºäº†å¼€å§‹ï¼‰</li><li>é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜å…·æœ‰é›†åˆåœ¨æ¶‰åŠåˆ° <code>Java</code> æ³›å‹åï¼Œåœ¨å¤„ç†åŸºæœ¬æ•°æ®ç±»å‹çš„å…ƒç´ æ—¶å‡ºç°çš„é—®é¢˜</li></ol></li><li>å¦‚æœæˆ‘ä»¬ä½¿ç”¨æ™®é€šæµéå†çš„æ˜¯ä¸€ä¸ªé›†åˆï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼šç”±äºé›†åˆæ¶‰åŠåˆ° <code>Java</code> æ³›å‹ï¼Œæ‰€ä»¥é›†åˆä¸­åªèƒ½å­˜å‚¨å¼•ç”¨æ•°æ®ç±»å‹çš„å…ƒç´ ï¼ˆå®é™…å­˜å‚¨çš„æ˜¯å¼•ç”¨æ•°æ®ç±»å‹çš„å…ƒç´ çš„å¼•ç”¨ï¼‰ï¼‰<ol><li>ç”±äºé›†åˆä¸­å­˜å‚¨çš„å…ƒç´ ï¼Œå·²ç»æ˜¯è‡ªåŠ¨è£…ç®±åçš„å…ƒç´ äº†ï¼Œæ‰€ä»¥ä¸éœ€è¦å†å¯¹å…¶è¿›è¡Œè‡ªåŠ¨è£…ç®±äº†ã€‚ä½†æ˜¯ä»ç„¶å…·æœ‰é›†åˆåœ¨æ¶‰åŠåˆ° <code>Java</code> æ³›å‹åï¼Œåœ¨å¤„ç†åŸºæœ¬æ•°æ®ç±»å‹çš„å…ƒç´ æ—¶å‡ºç°çš„é—®é¢˜</li></ol></li><li>é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜ä¼šå­˜åœ¨ <code>GC</code> æ–¹é¢çš„å‹åŠ›ï¼š<ol><li><code>Java Stream</code> ä¸­æœ€åˆçš„å…ƒç´ ï¼Œéƒ½æ˜¯è¢«æ‰€éå†çš„æ•°æ®ç»“æ„æ‰€å¼•ç”¨çš„ï¼Œæ‰€ä»¥ä¸ç”¨æ‹…å¿ƒå®ƒä»¬è¢« <code>GC</code></li><li>ä½†æ˜¯åœ¨ <code>Java Stream</code> çš„æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœåˆ›å»ºäº†æ–°çš„å®ä¾‹ï¼ˆä¾‹å¦‚æˆ‘ä»¬åœ¨æŸä¸€ä¸ªä¸­é—´æ–¹æ³•ä¸­ï¼Œè¦å¯¹ <code>Java Stream</code> ä¸­çš„æ¯ä¸ªå…ƒç´ åšä¸€æ¬¡ç®€å•çš„è®¡ç®—æ“ä½œï¼ˆä¾‹å¦‚å¯¹æ¯ä¸ªå…ƒç´ æ‰§è¡Œ <code>+1</code>ï¼‰ï¼Œé‚£ä¹ˆå°±ä¼šäº§ç”Ÿä¸€äº¿ä¸ªæ–°çš„åŒ…è£…ç±»å®ä¾‹ï¼‰ã€‚ç”±äºè¿™äº›æ–°çš„å®ä¾‹å¹¶ä¸æ˜¯æ•°æ®ç»“æ„ä¸­çš„å…ƒç´ ï¼Œæ‰€ä»¥å¦‚æœå®ƒä»¬åœ¨ä¸‹ä¸€æ­¥è¢«æ‹¦æˆªäº†ï¼ˆä¾‹å¦‚æ‹¦æˆªäº† <code>100</code> ä¸‡ä¸ªå®ä¾‹ï¼‰ï¼Œé‚£ä¹ˆè¿™äº›å®ä¾‹å°±ä¼šå¤±å»å¼•ç”¨ï¼Œéœ€è¦è¢« <code>GC</code>ã€‚æˆ‘çš„æ„æ€æ˜¯ï¼š<code>Java Stream</code> ä¸­æ¶‰åŠåˆ°çš„å…ƒç´ ï¼Œé™¤äº†æ•°æ®ç»“æ„ä¸­çš„å…ƒç´ å’Œåœ¨ç»“æŸæ–¹æ³•ä¸­è¢«æ”¶é›†åˆ°æŸå¤„çš„å…ƒç´ ï¼Œæ‰€æœ‰çš„ä¸­é—´å…ƒç´ éƒ½æ˜¯ â€œåƒåœ¾â€ï¼Œéœ€è¦è¢« <code>GC</code>ï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼šæ•°æ®ç»“æ„ä¸­çš„å…ƒç´ å’Œåœ¨ç»“æŸæ–¹æ³•ä¸­è¢«æ”¶é›†åˆ°æŸå¤„çš„å…ƒç´ ä¼šä¸ä¼šè¢« <code>GC</code>ï¼Œè¿˜è¦çœ‹å¼ºè½¯å¼±è™šå››å¼•ç”¨ï¼‰</li><li>éœ€è¦æ³¨æ„çš„æ˜¯ï¼šè¿™æ˜¯æ•´ä¸ª <code>Java Stream</code> ä½“ç³»çš„ â€œé€šç—…â€ï¼Œè€Œä¸æ˜¯å› ä¸ºæ™®é€šæµåœ¨æ¶‰åŠåˆ° <code>Java</code> æ³›å‹åï¼Œåœ¨å¤„ç†åŸºæœ¬æ•°æ®ç±»å‹æ—¶æ‰å‡ºç°è¿™ä¸ªé—®é¢˜ã€‚åªä¸è¿‡ç”±äºæ™®é€šæµåœ¨æ¶‰åŠåˆ° <code>Java</code> æ³›å‹åï¼Œåœ¨å¤„ç†åŸºæœ¬æ•°æ®ç±»å‹çš„å…ƒç´ æ—¶å‡ºç°äº†å¤§é‡çš„è‡ªåŠ¨è£…ç®±ã€è‡ªåŠ¨æ‹†ç®±ï¼Œå¤§å¤§åŠ é‡äº†è¿™ä¸ªé—®é¢˜</li></ol></li></ol></li></ol></li><li>ä¸ºä»€ä¹ˆç‰¹åŒ–æµåªæä¾›äº†å¤„ç† <code>int</code>ã€<code>long</code>ã€<code>double</code> ç±»å‹çš„å…ƒç´ çš„æµï¼Ÿ<ol><li>å› ä¸ºå¤„ç† <code>byte</code>ã€<code>short</code>ã€<code>char</code> ç±»å‹çš„å…ƒç´ ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨å¤„ç† <code>int</code> ç±»å‹çš„å…ƒç´ çš„æµï¼ˆå› ä¸º <code>int</code> ç±»å‹çš„èŒƒå›´æ¶µç›–äº†å®ƒä»¬ï¼‰</li><li>è€Œå¤„ç† <code>float</code> ç±»å‹çš„å…ƒç´ ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨å¤„ç† <code>double</code> ç±»å‹çš„å…ƒç´ çš„æµï¼ˆå› ä¸º <code>double</code> ç±»å‹çš„ç²¾åº¦æ¶µç›–äº†å®ƒï¼‰</li><li>å¹¶ä¸” <code>boolean</code> ç±»å‹çš„å…ƒç´ é€šå¸¸ä¸éœ€è¦å‚ä¸è®¡ç®—</li></ol></li></ol></li></ol></blockquote><hr><h2 id="Java-Stream-é—®é¢˜çˆ†ç ´"><a href="#Java-Stream-é—®é¢˜çˆ†ç ´" class="headerlink" title="Java Stream é—®é¢˜çˆ†ç ´"></a>Java Stream é—®é¢˜çˆ†ç ´</h2><h3 id="Java-Stream-çš„å¹¶è¡Œæµé—®é¢˜çˆ†ç ´"><a href="#Java-Stream-çš„å¹¶è¡Œæµé—®é¢˜çˆ†ç ´" class="headerlink" title="Java Stream çš„å¹¶è¡Œæµé—®é¢˜çˆ†ç ´"></a>Java Stream çš„å¹¶è¡Œæµé—®é¢˜çˆ†ç ´</h3><p>è™½ç„¶å¹¶è¡Œå¤„ç†æ˜¯ <code>Java Stream</code> è¢«å¼•å…¥çš„çœŸæ­£åŸå› ä¹‹ä¸€ï¼Œä½†é—æ†¾çš„æ˜¯ï¼Œ<code>Java Stream</code> çš„å¹¶è¡Œæµåœ¨æ—¥å¸¸å¼€å‘ä¸­å¹¶ä¸å¸¸è§ï¼Œå› ä¸ºå®ƒæœ‰è¿™æ ·å‡ ä¸ª â€œå‘â€ï¼š</p><ol><li>æˆ‘ä»¬åœ¨ä½¿ç”¨ <code>Java Stream</code> çš„å¹¶è¡Œæµæ—¶ï¼Œå¾ˆå®¹æ˜“å› ä¸ºå®ƒçš„ç¼–å†™é£æ ¼è€Œäº§ç”Ÿ â€œæˆ‘åœ¨ä½¿ç”¨å•çº¿ç¨‹è¿›è¡Œæ•°æ®ç»“æ„çš„éå†â€ çš„æ„Ÿè§‰ï¼Œä»è€Œå¿½è§†äº†å¤šçº¿ç¨‹å¹¶å‘æƒ…å†µä¸‹çš„å®‰å…¨é—®é¢˜ã€‚è™½ç„¶ <code>Java Stream</code> å·²ç»å¸®æˆ‘ä»¬å¤„ç†äº†å¾ˆå¤šçš„å¤šçº¿ç¨‹å¹¶å‘æƒ…å†µä¸‹çš„å®‰å…¨é—®é¢˜ï¼Œä½†æ˜¯ä½ åƒåœ¨ç»“æŸæ–¹æ³•ä¸­ï¼Œå°† <code>Java Stream</code> ä¸­çš„å…ƒç´ æ”¶é›†åˆ°éå¤šçº¿ç¨‹å¹¶å‘å®‰å…¨çš„æ•°æ®ç»“æ„ï¼ˆä¾‹å¦‚ <code>ArrayListï¼œEï¼</code>ï¼‰ä¸­çš„æƒ…å†µï¼Œéœ€è¦æˆ‘ä»¬è‡ªå·±ç‰¹åˆ«æ³¨æ„</li><li>æˆ‘ä»¬çŸ¥é“ â€œ<code>Java Stream</code> çš„å¹¶è¡Œæµæ˜¯ä½¿ç”¨ <code>ForkJoinPool</code> å®ç°åˆ†è€Œæ²»ä¹‹ã€è¿­ä»£æ‹†åˆ†ã€å·¥ä½œçªƒå–çš„â€ã€‚ä½†æ˜¯ <code>Java Stream</code> çš„å¹¶è¡Œæµé»˜è®¤ä½¿ç”¨çš„æ˜¯å•ä¸ª <code>JVM</code> ä¸­å…¨å±€å”¯ä¸€çš„ <code>ForkJoinPool.commonPool()</code>ã€‚æ‰€ä»¥ä¸€ä¸ª <code>Java</code> æœåŠ¡ä¸­ï¼Œæ‰€æœ‰ <code>Java Stream</code> çš„å¹¶è¡Œæµï¼Œç”šè‡³æ˜¯ä¸ç›¸å…³ä½†æ¶‰åŠåˆ° <code>ForkJoinPool.commonPool()</code> çš„ä¸šåŠ¡ï¼ˆä¾‹å¦‚ <code>CompletableFutureï¼œTï¼</code>ï¼‰ï¼Œéƒ½ä¼šå»ç«äº‰ <code>ForkJoinPool.commonPool()</code> ä¸­çš„çº¿ç¨‹</li><li>ç”±äº <code>Java Stream</code> çš„å¹¶è¡Œæµä½¿ç”¨äº† <code>ForkJoinPool</code>ï¼Œè€Œä¸€æ—¦æˆ‘ä»¬çš„çº¿ç¨‹æ¶‰åŠåˆ°è®©å…¶ä»–çº¿ç¨‹å»æ‰§è¡Œä¸€äº›ä»»åŠ¡æ—¶ï¼Œå°±åŠ¿å¿…ä¼šå‡ºç°ä¸€ä¸ªé—®é¢˜ï¼š<code>ThreadLocal</code> å› ä¸ºæ— æ³•è·¨çº¿ç¨‹è€Œ â€œä¸¢å¤±â€</li><li>ç”±äº <code>Java Stream</code> çš„å¹¶è¡Œæµä½¿ç”¨äº† <code>ForkJoinPool</code>ï¼Œè€Œä½¿ç”¨ <code>ForkJoinPool</code> æœ¬èº«å°±ç®—æœ‰æˆæœ¬çš„ï¼ˆä¾‹å¦‚åˆ›å»ºä»»åŠ¡ã€çº¿ç¨‹è°ƒåº¦ã€ä¸Šä¸‹æ–‡åˆ‡æ¢ã€æ•°æ®çš„è¿­ä»£æ‹†åˆ†ã€å·¥ä½œçªƒå–ã€ç»“æœåˆå¹¶ç­‰ï¼‰ï¼Œå¦‚æœå¤„ç†çš„æ•°æ®å¹¶ä¸å¤šï¼Œé‚£ä¹ˆä½¿ç”¨ <code>Java Stream</code> çš„å¹¶è¡Œæµåè€Œå¾—ä¸å¿å¤±</li><li>æˆ‘ä»¬çŸ¥é“ â€œå¯¹äºåº•å±‚æ˜¯åŸºäºéè¿ç»­å†…å­˜çš„æ•°æ®ç»“æ„ï¼Œä¸å¤ªå»ºè®®ä½¿ç”¨ <code>Java Stream</code> çš„å¹¶è¡Œæµâ€ã€‚æ‰€è°“çš„ â€œä¸å¤ªå»ºè®®â€ æ˜¯æŒ‡ï¼šéœ€è¦æˆ‘ä»¬è‡ªè¡Œæƒè¡¡ï¼Œå¦‚æœå¯¹æ•°æ®ç»“æ„ä¸­çš„å…ƒç´ è¿›è¡Œè¿­ä»£æ‹†åˆ†çš„æ—¶é—´ ï¼ ä½¿ç”¨ <code>Java Stream</code> çš„å¹¶è¡ŒæµèŠ‚çœçš„æ—¶é—´ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ˜¯è‚¯å®šä¸èƒ½ä½¿ç”¨ <code>Java Stream</code> çš„å¹¶è¡Œæµ</li></ol><hr><h2 id="3-Java-Stream-é€‚ç”¨åœºæ™¯"><a href="#3-Java-Stream-é€‚ç”¨åœºæ™¯" class="headerlink" title="3. Java Stream é€‚ç”¨åœºæ™¯"></a>3. Java Stream é€‚ç”¨åœºæ™¯</h2><h3 id="Java-Stream-çš„å¹¶è¡Œæµé€‚ç”¨åœºæ™¯"><a href="#Java-Stream-çš„å¹¶è¡Œæµé€‚ç”¨åœºæ™¯" class="headerlink" title="Java Stream çš„å¹¶è¡Œæµé€‚ç”¨åœºæ™¯"></a>Java Stream çš„å¹¶è¡Œæµé€‚ç”¨åœºæ™¯</h3><p>å¹¶è¡Œæµé€‚ç”¨ä»¥ä¸‹åœºæ™¯ä¸ºï¼š</p><ol><li>ç¦»çº¿æ‰¹å¤„ç†</li><li>æµ·é‡æ•°æ®å¤„ç†</li><li>çº¯ <code>CPU</code> å¯†é›†å‹</li><li>åº•å±‚æ˜¯åŸºäºè¿ç»­å†…å­˜çš„æ•°æ®ç»“æ„</li></ol><hr><h2 id="5-Java-Stream-ç›¸å…³å¸¸ç”¨æ–¹æ³•"><a href="#5-Java-Stream-ç›¸å…³å¸¸ç”¨æ–¹æ³•" class="headerlink" title="5. Java Stream ç›¸å…³å¸¸ç”¨æ–¹æ³•"></a>5. Java Stream ç›¸å…³å¸¸ç”¨æ–¹æ³•</h2><p><code>Java Stream</code> ç›¸å…³çš„å¸¸ç”¨æ–¹æ³•ä¸»è¦åŒ…æ‹¬ï¼š</p><ol><li>åˆ›å»ºæ–¹æ³•</li><li>ä¸­é—´æ–¹æ³•</li><li>ç»“æŸæ–¹æ³•</li></ol><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>åˆ¤æ–­ä¸€ä¸ªæ–¹æ³•æ˜¯ä¸­é—´æ–¹æ³•è¿˜æ˜¯ç»“æŸæ–¹æ³•ï¼Œåªéœ€è¦çœ‹è¯¥æ–¹æ³•æ˜¯å¦è¿”å›ä¸€ä¸ª <code>Java Stream</code></li><li><code>Java Stream</code> ç›¸å…³çš„å¸¸ç”¨æ–¹æ³•ä¸»è¦åŒ…æ‹¬ï¼š<ol><li><code>java.util.stream.Streamï¼œTï¼</code>  æ¥å£ä¸­çš„ä¸€äº›æ–¹æ³•</li><li><code>java.util.stream.IntStream</code>  æ¥å£ä¸­çš„ä¸€äº›æ–¹æ³•</li><li><code>java.util.stream.LongStream</code>  æ¥å£ä¸­çš„ä¸€äº›æ–¹æ³•</li><li><code>java.util.stream.DoubleStream</code>  æ¥å£ä¸­çš„ä¸€äº›æ–¹æ³•</li></ol></li></ol></blockquote><h3 id="5-1-åˆ›å»ºæ–¹æ³•"><a href="#5-1-åˆ›å»ºæ–¹æ³•" class="headerlink" title="5.1. åˆ›å»ºæ–¹æ³•"></a>5.1. åˆ›å»ºæ–¹æ³•</h3><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>é™¤äº†ä¸‹é¢çš„æ–¹æ³•å¤–ï¼Œ<code>Java Stream</code> è¿˜æœ‰å¾ˆå¤šåˆ›å»ºæ–¹æ³•ï¼Œä½†æŒæ¡è¿™äº›åˆ›å»ºæ–¹æ³•å·²ç»è¶³å¤Ÿäº†</li></ol></blockquote><h4 id="5-1-1-æ ¹æ®æ•°ç»„åˆ›å»º-Java-Stream"><a href="#5-1-1-æ ¹æ®æ•°ç»„åˆ›å»º-Java-Stream" class="headerlink" title="5.1.1. æ ¹æ®æ•°ç»„åˆ›å»º Java Stream"></a>5.1.1. æ ¹æ®æ•°ç»„åˆ›å»º Java Stream</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">int</span>[] myArray = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[<span class="hljs-number">10</span>];<br><br><span class="hljs-comment">// ä¸²è¡Œæµ</span><br>Arrays.stream(myArray).<span class="hljs-keyword">var</span><br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>ä¼šæ ¹æ®æ•°ç»„çš„ç±»å‹è¿”å›å¯¹åº”çš„ <code>Java Stream</code>ï¼ˆå³æ™®é€šæµã€ç‰¹åŒ–æµï¼‰</li></ol></blockquote><hr><h4 id="5-1-2-æ ¹æ®é›†åˆåˆ›å»º-Java-Stream"><a href="#5-1-2-æ ¹æ®é›†åˆåˆ›å»º-Java-Stream" class="headerlink" title="5.1.2. æ ¹æ®é›†åˆåˆ›å»º Java Stream"></a>5.1.2. æ ¹æ®é›†åˆåˆ›å»º Java Stream</h4><h5 id="5-1-2-1-æ ¹æ®-Setï¼œEï¼-åˆ›å»º-Java-Stream"><a href="#5-1-2-1-æ ¹æ®-Setï¼œEï¼-åˆ›å»º-Java-Stream" class="headerlink" title="5.1.2.1. æ ¹æ® Setï¼œEï¼ åˆ›å»º Java Stream"></a>5.1.2.1. æ ¹æ® Setï¼œEï¼ åˆ›å»º Java Stream</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java">Set&lt;String&gt; mySet = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;&gt;();<br><br><span class="hljs-comment">// ä¸²è¡Œæµ</span><br>mySet.stream().<span class="hljs-keyword">var</span><br><br><span class="hljs-comment">// å¹¶è¡Œæµ</span><br>mySet.parallelStream().<span class="hljs-keyword">var</span><br></code></pre></td></tr></table></figure><hr><h5 id="5-1-2-2-æ ¹æ®-Listï¼œEï¼-åˆ›å»º-Java-Stream"><a href="#5-1-2-2-æ ¹æ®-Listï¼œEï¼-åˆ›å»º-Java-Stream" class="headerlink" title="5.1.2.2. æ ¹æ® Listï¼œEï¼ åˆ›å»º Java Stream"></a>5.1.2.2. æ ¹æ® Listï¼œEï¼ åˆ›å»º Java Stream</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java">ArrayList&lt;String&gt; myList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br><br><span class="hljs-comment">// ä¸²è¡Œæµ</span><br>myList.stream().<span class="hljs-keyword">var</span><br><br><span class="hljs-comment">// å¹¶è¡Œæµ</span><br>myList.parallelStream().<span class="hljs-keyword">var</span><br></code></pre></td></tr></table></figure><hr><h5 id="5-1-2-3-æ ¹æ®-Mapï¼œK-Vï¼-åˆ›å»º-Java-Stream"><a href="#5-1-2-3-æ ¹æ®-Mapï¼œK-Vï¼-åˆ›å»º-Java-Stream" class="headerlink" title="5.1.2.3. æ ¹æ® Mapï¼œK, Vï¼ åˆ›å»º Java Stream"></a>5.1.2.3. æ ¹æ® Mapï¼œK, Vï¼ åˆ›å»º Java Stream</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java">HashMap&lt;String,Integer&gt; myHashMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br><br><span class="hljs-comment">// Key çš„ä¸²è¡Œæµ</span><br>myHashMap.keySet().stream().<span class="hljs-keyword">var</span><br><br><span class="hljs-comment">// Key çš„å¹¶è¡Œæµ</span><br>myHashMap.keySet().parallelStream().<span class="hljs-keyword">var</span><br><br><span class="hljs-comment">// Value çš„ä¸²è¡Œæµ</span><br>myHashMap.values().stream().<span class="hljs-keyword">var</span><br><br><span class="hljs-comment">// Value  çš„å¹¶è¡Œæµ</span><br>myHashMap.values().parallelStream().<span class="hljs-keyword">var</span><br><br><span class="hljs-comment">// Key-Value çš„ä¸²è¡Œæµ</span><br>myHashMap.entrySet().stream().<span class="hljs-keyword">var</span><br><br><span class="hljs-comment">// Key-Value çš„å¹¶è¡Œæµ</span><br>myHashMap.entrySet().parallelStream().<span class="hljs-keyword">var</span><br></code></pre></td></tr></table></figure><hr><h5 id="5-1-2-4-æ ¹æ®-Queueï¼œEï¼-åˆ›å»º-Java-Stream"><a href="#5-1-2-4-æ ¹æ®-Queueï¼œEï¼-åˆ›å»º-Java-Stream" class="headerlink" title="5.1.2.4. æ ¹æ® Queueï¼œEï¼ åˆ›å»º Java Stream"></a>5.1.2.4. æ ¹æ® Queueï¼œEï¼ åˆ›å»º Java Stream</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java">PriorityQueue&lt;String&gt; myQueue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PriorityQueue</span>&lt;&gt;(<span class="hljs-number">5</span>);<br><br><span class="hljs-comment">// ä¸²è¡Œæµ</span><br>myQueue.stream().<span class="hljs-keyword">var</span><br><br><span class="hljs-comment">// å¹¶è¡Œæµ</span><br>myQueue.parallelStream().<span class="hljs-keyword">var</span><br></code></pre></td></tr></table></figure><hr><h4 id="5-1-3-åˆå¹¶ä¸¤ä¸ª-Java-Stream"><a href="#5-1-3-åˆå¹¶ä¸¤ä¸ª-Java-Stream" class="headerlink" title="5.1.3. åˆå¹¶ä¸¤ä¸ª Java Stream"></a>5.1.3. åˆå¹¶ä¸¤ä¸ª Java Stream</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java">Stream&lt;String&gt; myStreamA = Stream.of(<span class="hljs-string">&quot;A&quot;</span>, <span class="hljs-string">&quot;B&quot;</span>);<br><br>Stream&lt;String&gt; myStreamB = Stream.of(<span class="hljs-string">&quot;C&quot;</span>, <span class="hljs-string">&quot;D&quot;</span>);<br><br>Stream&lt;String&gt; resultStream = Stream.concat(myStreamA, myStreamB);<br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>è¯¥æ–¹æ³•æ˜¯è®©ä¸¤ä¸ª <code>Java Stream</code> â€œé¦–å°¾ç›¸è¿â€ åˆå¹¶æˆä¸€ä¸ªæ–°çš„ <code>Java Stream</code></li><li>å‚ä¸åˆå¹¶çš„ä¸¤ä¸ª <code>Java Stream</code> ä¸­ï¼Œåªè¦æœ‰ä¸€ä¸ªæ˜¯ <code>Java Stream</code> çš„å¹¶è¡Œæµï¼Œé‚£ä¹ˆåˆå¹¶çš„ç»“æœå°±æ˜¯ä¸€ä¸ª <code>Java Stream</code> çš„å¹¶è¡Œæµ</li><li>å‚ä¸åˆå¹¶çš„ä¸¤ä¸ª <code>Java Stream</code> ä¸­ï¼Œå¦‚æœç¬¬ä¸€ä¸ª <code>Java Stream</code> æ˜¯ä¸€ä¸ª â€œæ— ç©·æµâ€ï¼Œé‚£ä¹ˆç¬¬äºŒä¸ª <code>Java Stream</code> ä¸­çš„å…ƒç´ å¯èƒ½æ°¸è¿œä¸èƒ½è¢«å¤„ç†</li><li>å¦‚æœæœ‰å¤šä¸ª <code>Java Stream</code> è¦åˆå¹¶ï¼Œä¸è¦åµŒå¥—ä½¿ç”¨ <code>Streamï¼œTï¼#concat</code>ï¼ˆä¾‹å¦‚ <code>Stream.concat(Stream.concat(a, b), c)</code>ï¼‰ã€‚æ¨èæŠŠå®ƒä»¬ â€œå¢â€ è¿›ä¸€ä¸ªé›†åˆä¸­ï¼Œç„¶åå†è°ƒç”¨ <code>Streamï¼œTï¼#flatMap</code>ï¼š</li></ol></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">Stream&lt;Stream&lt;String&gt;&gt; streams = Stream.of(s1, s2, s3, s4);<br><br>Stream&lt;String&gt; result = streams.flatMap(s -&gt; s);<br></code></pre></td></tr></table></figure><hr><h3 id="5-2-ä¸­é—´æ–¹æ³•"><a href="#5-2-ä¸­é—´æ–¹æ³•" class="headerlink" title="5.2. ä¸­é—´æ–¹æ³•"></a>5.2. ä¸­é—´æ–¹æ³•</h3><h4 id="5-2-1-é€šç”¨æ–¹æ³•"><a href="#5-2-1-é€šç”¨æ–¹æ³•" class="headerlink" title="5.2.1. é€šç”¨æ–¹æ³•"></a>5.2.1. é€šç”¨æ–¹æ³•</h4><p>é€šç”¨æ–¹æ³•æ˜¯ <code>java.util.stream.Streamï¼œTï¼</code> æ¥å£ä¸­çš„ä¸€äº›æ–¹æ³•</p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>é™¤äº†ä¸‹é¢çš„æ–¹æ³•å¤–ï¼Œè¿˜æœ‰åˆ‡ç‰‡æ–¹æ³•ã€æ˜ å°„æ–¹æ³•ã€æ’åºæ–¹æ³•ã€è°ƒè¯•æ–¹æ³•ï¼Œç”¨åˆ°å†å­¦</li></ol></blockquote><h5 id="5-2-1-1-è¿‡æ»¤æ–¹æ³•"><a href="#5-2-1-1-è¿‡æ»¤æ–¹æ³•" class="headerlink" title="5.2.1.1. è¿‡æ»¤æ–¹æ³•"></a>5.2.1.1. è¿‡æ»¤æ–¹æ³•</h5><h6 id="5-2-1-1-1-Streamï¼œTï¼-filter-Predicateï¼œ-super-Tï¼-predicate"><a href="#5-2-1-1-1-Streamï¼œTï¼-filter-Predicateï¼œ-super-Tï¼-predicate" class="headerlink" title="5.2.1.1.1. Streamï¼œTï¼  filter(Predicateï¼œ? super Tï¼  predicate)"></a>5.2.1.1.1. Streamï¼œTï¼  filter(Predicateï¼œ? super Tï¼  predicate)</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">myList.stream().filter(s -&gt; s.startsWith(<span class="hljs-string">&quot;å¼ &quot;</span>))...<br></code></pre></td></tr></table></figure><hr><h5 id="5-2-1-2-å»é‡æ–¹æ³•"><a href="#5-2-1-2-å»é‡æ–¹æ³•" class="headerlink" title="5.2.1.2. å»é‡æ–¹æ³•"></a>5.2.1.2. å»é‡æ–¹æ³•</h5><h6 id="5-2-1-2-1-Streamï¼œTï¼-distinct"><a href="#5-2-1-2-1-Streamï¼œTï¼-distinct" class="headerlink" title="5.2.1.2.1. Streamï¼œTï¼  distinct()"></a>5.2.1.2.1. Streamï¼œTï¼  distinct()</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">myList.stream().distinct()...<br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>è¯¥æ–¹æ³•æ˜¯ä¾èµ– <code>HashSetï¼œEï¼</code> å®ç°å»é‡çš„ï¼Œæ‰€ä»¥åˆ¤æ–­å…ƒç´ æ˜¯å¦ç›¸åŒæ˜¯æ ¹æ® <code>Object#hashCode</code> å’Œ <code>Object#equals</code> æ¥åˆ¤æ–­çš„ã€‚è¯¦è§ç¬”è®°ï¼š<code>Java</code> æ•°æ®ç±»å‹ï¼ˆ<code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<a href="%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B.md">ç¬”è®°ï¼šJavaæ•°æ®ç±»å‹</a>ï¼Œ<code>Hexo</code> é“¾æ¥ï¼š <a href="http://blog.wangjia.ink/2025/11/27/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/">http://blog.wangjia.ink/2025/11/27/ç¬”è®°ï¼šJavaæ•°æ®ç±»å‹/</a> ï¼‰</li></ol></blockquote><hr><h5 id="5-2-1-3-æ˜ å°„æ–¹æ³•"><a href="#5-2-1-3-æ˜ å°„æ–¹æ³•" class="headerlink" title="5.2.1.3. æ˜ å°„æ–¹æ³•"></a>5.2.1.3. æ˜ å°„æ–¹æ³•</h5><h6 id="5-2-1-3-1-ï¼œRï¼-Streamï¼œRï¼-map-Functionï¼œ-super-T-extends-Rï¼-mapper"><a href="#5-2-1-3-1-ï¼œRï¼-Streamï¼œRï¼-map-Functionï¼œ-super-T-extends-Rï¼-mapper" class="headerlink" title="5.2.1.3.1. ï¼œRï¼ Streamï¼œRï¼ map(Functionï¼œ? super T, ? extends Rï¼ mapper)"></a>5.2.1.3.1. ï¼œRï¼ Streamï¼œRï¼ map(Functionï¼œ? super T, ? extends Rï¼ mapper)</h6><p>è¯¥æ–¹æ³•ç”¨äºéé˜»å¡å¯¹ <code>Java Stream</code> ä¸­çš„æ¯ä¸ªå…ƒç´ æ‰§è¡Œä¼ å…¥çš„æ–¹æ³•å‚æ•° <code>mapper</code>ï¼ˆå³ä¸€ä¸ª <code>Functionï¼œT, Rï¼</code> ç±»å‹çš„å›è°ƒå‡½æ•°ï¼‰</p><p>è¯¥æ–¹æ³•ä¸ <code>Streamï¼œTï¼#flatMap</code> çš„åŒºåˆ«åœ¨äºï¼š<code>Streamï¼œTï¼#flatMap</code> åœ¨å¤„ç†å®Œ <code>Java Stream</code> ä¸­çš„æ¯ä¸ªå…ƒç´ åï¼Œå¿…é¡»è¿”å›ä¸€ä¸ª <code>Java Stream</code>ï¼Œå¹¶æœ€ç»ˆåˆæˆä¸€ä¸ªå¤§çš„ <code>Java Stream</code>ã€‚ä½†æ˜¯è¯¥æ–¹æ³•åœ¨å¤„ç†å®Œ <code>Java Stream</code> ä¸­çš„æ¯ä¸ªå…ƒç´ åï¼Œä¸èƒ½è¿”å›ä¸€ä¸ª <code>Java Stream</code>ï¼Œè€Œæ˜¯è¿”å›å…¶ä»–å¼•ç”¨æ•°æ®ç±»å‹çš„å®ä¾‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">myList.stream().map(name -&gt; name.length())...<br></code></pre></td></tr></table></figure><hr><h6 id="5-2-1-3-2-IntStream-mapToInt-ToIntFunctionï¼œ-super-Tï¼-mapper"><a href="#5-2-1-3-2-IntStream-mapToInt-ToIntFunctionï¼œ-super-Tï¼-mapper" class="headerlink" title="5.2.1.3.2. IntStream mapToInt(ToIntFunctionï¼œ? super Tï¼ mapper)"></a>5.2.1.3.2. IntStream mapToInt(ToIntFunctionï¼œ? super Tï¼ mapper)</h6><p>è¯¥æ–¹æ³•ç”¨äºéé˜»å¡å°†æ™®é€šæµè½¬åŒ–æˆç‰¹åŒ–æµ</p><hr><h6 id="5-2-1-3-3-LongStream-mapToLong-ToLongFunctionï¼œ-super-Tï¼-mapper"><a href="#5-2-1-3-3-LongStream-mapToLong-ToLongFunctionï¼œ-super-Tï¼-mapper" class="headerlink" title="5.2.1.3.3. LongStream mapToLong(ToLongFunctionï¼œ? super Tï¼ mapper)"></a>5.2.1.3.3. LongStream mapToLong(ToLongFunctionï¼œ? super Tï¼ mapper)</h6><p>è¯¥æ–¹æ³•ç”¨äºéé˜»å¡å°†æ™®é€šæµè½¬åŒ–æˆç‰¹åŒ–æµ</p><hr><h6 id="5-2-1-3-4-DoubleStream-mapToDouble-ToDoubleFunctionï¼œ-super-Tï¼-mapper"><a href="#5-2-1-3-4-DoubleStream-mapToDouble-ToDoubleFunctionï¼œ-super-Tï¼-mapper" class="headerlink" title="5.2.1.3.4. DoubleStream mapToDouble(ToDoubleFunctionï¼œ? super Tï¼ mapper)"></a>5.2.1.3.4. DoubleStream mapToDouble(ToDoubleFunctionï¼œ? super Tï¼ mapper)</h6><p>è¯¥æ–¹æ³•ç”¨äºéé˜»å¡å°†æ™®é€šæµè½¬åŒ–æˆç‰¹åŒ–æµ</p><hr><h6 id="5-2-1-3-5-ï¼œRï¼-Streamï¼œRï¼-flatMap-Functionï¼œ-super-T-extends-Streamï¼œ-extends-Rï¼ï¼-mapper"><a href="#5-2-1-3-5-ï¼œRï¼-Streamï¼œRï¼-flatMap-Functionï¼œ-super-T-extends-Streamï¼œ-extends-Rï¼ï¼-mapper" class="headerlink" title="5.2.1.3.5. ï¼œRï¼ Streamï¼œRï¼ flatMap(Functionï¼œ? super T, ? extends Streamï¼œ? extends Rï¼ï¼ mapper)"></a>5.2.1.3.5. ï¼œRï¼ Streamï¼œRï¼ flatMap(Functionï¼œ? super T, ? extends Streamï¼œ? extends Rï¼ï¼ mapper)</h6><p>è¯¥æ–¹æ³•ç”¨äºéé˜»å¡å¯¹ <code>Java Stream</code> ä¸­çš„æ¯ä¸ªå…ƒç´ æ‰§è¡Œä¼ å…¥çš„æ–¹æ³•å‚æ•° <code>mapper</code>ï¼ˆå³ä¸€ä¸ª <code>Functionï¼œT, Rï¼</code> ç±»å‹çš„å›è°ƒå‡½æ•°ï¼‰</p><p>è¯¥æ–¹æ³•ä¸ <code>Streamï¼œTï¼#map</code> çš„åŒºåˆ«åœ¨äºï¼š è¯¥æ–¹æ³•åœ¨å¤„ç†å®Œ <code>Java Stream</code> ä¸­çš„æ¯ä¸ªå…ƒç´ åï¼Œå¿…é¡»è¿”å›ä¸€ä¸ª <code>Java Stream</code>ï¼Œå¹¶æœ€ç»ˆåˆæˆä¸€ä¸ªå¤§çš„ <code>Java Stream</code>ã€‚ä½†æ˜¯ <code>Streamï¼œTï¼#Map</code> åœ¨å¤„ç†å®Œ <code>Java Stream</code> ä¸­çš„æ¯ä¸ªå…ƒç´ åï¼Œä¸èƒ½è¿”å›ä¸€ä¸ª <code>Java Stream</code>ï¼Œè€Œæ˜¯è¿”å›å…¶ä»–å¼•ç”¨æ•°æ®ç±»å‹çš„å®ä¾‹</p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li><code>Streamï¼œTï¼#map</code> æœ€æ ¸å¿ƒçš„ä½œç”¨å°±æ˜¯æ¶ˆé™¤åµŒå¥—ï¼ˆå³è§£æ„ï¼‰ï¼š</li></ol></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//é’ˆå¯¹ Array </span><br>String[][] matrix = &#123;<br>    &#123;<span class="hljs-string">&quot;A&quot;</span>, <span class="hljs-string">&quot;B&quot;</span>&#125;,<br>    &#123;<span class="hljs-string">&quot;C&quot;</span>, <span class="hljs-string">&quot;D&quot;</span>&#125;<br>&#125;;<br><br><span class="hljs-comment">// é’ˆå¯¹ Setï¼œEï¼ </span><br>Set&lt;Set&lt;String&gt;&gt; teamTags = Set.of(<br>    Set.of(<span class="hljs-string">&quot;Java&quot;</span>, <span class="hljs-string">&quot;Spring&quot;</span>),  <br>    Set.of(<span class="hljs-string">&quot;Spring&quot;</span>, <span class="hljs-string">&quot;MyBatis&quot;</span>) <br>);<br><br><span class="hljs-comment">// é’ˆå¯¹ Listï¼œEï¼ </span><br>List&lt;List&lt;String&gt;&gt; school = List.of(<br>    List.of(<span class="hljs-string">&quot;å­¦ç”ŸA&quot;</span>, <span class="hljs-string">&quot;å­¦ç”ŸB&quot;</span>), <br>    List.of(<span class="hljs-string">&quot;å­¦ç”ŸC&quot;</span>, <span class="hljs-string">&quot;å­¦ç”ŸD&quot;</span>) <br>);<br><br><span class="hljs-comment">// é’ˆå¯¹ Mapï¼œK, Vï¼ </span><br>Map&lt;String, List&lt;String&gt;&gt; bookshelf = Map.of(<br>    <span class="hljs-string">&quot;ç§‘æŠ€&quot;</span>, List.of(<span class="hljs-string">&quot;æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœº&quot;</span>, <span class="hljs-string">&quot;å¹¶å‘ç¼–ç¨‹å®æˆ˜&quot;</span>),<br>    <span class="hljs-string">&quot;æ–‡å­¦&quot;</span>, List.of(<span class="hljs-string">&quot;ä¸‰ä½“&quot;</span>)<br>);<br><br><span class="hljs-comment">// é’ˆå¯¹ Queueï¼œEï¼ </span><br>Queue&lt;List&lt;String&gt;&gt; messageQueue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedList</span>&lt;&gt;();<br>messageQueue.add(List.of(<span class="hljs-string">&quot;Msg1&quot;</span>, <span class="hljs-string">&quot;Msg2&quot;</span>));<br>messageQueue.add(List.of(<span class="hljs-string">&quot;Msg3&quot;</span>));<br></code></pre></td></tr></table></figure><hr><h6 id="5-2-1-3-6-IntStream-flatMapToInt-Functionï¼œ-super-T-extends-IntStreamï¼-mapper"><a href="#5-2-1-3-6-IntStream-flatMapToInt-Functionï¼œ-super-T-extends-IntStreamï¼-mapper" class="headerlink" title="5.2.1.3.6. IntStream flatMapToInt(Functionï¼œ? super T, ? extends IntStreamï¼ mapper)"></a>5.2.1.3.6. IntStream flatMapToInt(Functionï¼œ? super T, ? extends IntStreamï¼ mapper)</h6><p>è¯¥æ–¹æ³•ç”¨äºéé˜»å¡å°†æ™®é€šæµè½¬åŒ–æˆç‰¹åŒ–æµï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼šå…ˆæ‰å¹³åŒ–ï¼Œå†è½¬åŒ–ï¼‰</p><hr><h6 id="5-2-1-3-7-LongStream-flatMapToLong-Functionï¼œ-super-T-extends-LongStreamï¼-mapper"><a href="#5-2-1-3-7-LongStream-flatMapToLong-Functionï¼œ-super-T-extends-LongStreamï¼-mapper" class="headerlink" title="5.2.1.3.7. LongStream flatMapToLong(Functionï¼œ? super T, ? extends LongStreamï¼ mapper)"></a>5.2.1.3.7. LongStream flatMapToLong(Functionï¼œ? super T, ? extends LongStreamï¼ mapper)</h6><p>è¯¥æ–¹æ³•ç”¨äºéé˜»å¡å°†æ™®é€šæµè½¬åŒ–æˆç‰¹åŒ–æµï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼šå…ˆæ‰å¹³åŒ–ï¼Œå†è½¬åŒ–ï¼‰</p><hr><h6 id="5-2-1-3-8-DoubleStream-flatMapToDouble-Functionï¼œ-super-T-extends-DoubleStreamï¼-mapper"><a href="#5-2-1-3-8-DoubleStream-flatMapToDouble-Functionï¼œ-super-T-extends-DoubleStreamï¼-mapper" class="headerlink" title="5.2.1.3.8. DoubleStream flatMapToDouble(Functionï¼œ? super T, ? extends DoubleStreamï¼ mapper)"></a>5.2.1.3.8. DoubleStream flatMapToDouble(Functionï¼œ? super T, ? extends DoubleStreamï¼ mapper)</h6><p>è¯¥æ–¹æ³•ç”¨äºéé˜»å¡å°†æ™®é€šæµè½¬åŒ–æˆç‰¹åŒ–æµï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼šå…ˆæ‰å¹³åŒ–ï¼Œå†è½¬åŒ–ï¼‰</p><hr><h4 id="5-2-2-ç‰¹åŒ–æµç‹¬å±æ–¹æ³•"><a href="#5-2-2-ç‰¹åŒ–æµç‹¬å±æ–¹æ³•" class="headerlink" title="5.2.2. ç‰¹åŒ–æµç‹¬å±æ–¹æ³•"></a>5.2.2. ç‰¹åŒ–æµç‹¬å±æ–¹æ³•</h4><p>ç‰¹åŒ–æµç‹¬å±æ–¹æ³•æ˜¯ <code>java.util.stream.IntStream</code> æ¥å£ã€<code>java.util.stream.LongStream</code> æ¥å£ã€<code>java.util.stream.DoubleStream</code> æ¥å£ä¸­çš„ä¸€äº›æ–¹æ³•</p><hr><h3 id="5-3-ç»“æŸæ–¹æ³•"><a href="#5-3-ç»“æŸæ–¹æ³•" class="headerlink" title="5.3. ç»“æŸæ–¹æ³•"></a>5.3. ç»“æŸæ–¹æ³•</h3><h4 id="5-3-1-é€šç”¨æ–¹æ³•"><a href="#5-3-1-é€šç”¨æ–¹æ³•" class="headerlink" title="5.3.1. é€šç”¨æ–¹æ³•"></a>5.3.1. é€šç”¨æ–¹æ³•</h4><p>é€šç”¨æ–¹æ³•æ˜¯ <code>java.util.stream.Streamï¼œTï¼</code> æ¥å£ä¸­çš„ä¸€äº›æ–¹æ³•</p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>é™¤äº†ä¸‹é¢çš„æ–¹æ³•å¤–ï¼Œè¿˜æœ‰ç»Ÿè®¡æ–¹æ³•ã€åŒ¹é…æ–¹æ³•ã€æŸ¥è¯¢æ–¹æ³•ï¼Œç”¨åˆ°å†å­¦</li></ol></blockquote><h5 id="5-3-1-1-éå†æ–¹æ³•"><a href="#5-3-1-1-éå†æ–¹æ³•" class="headerlink" title="5.3.1.1. éå†æ–¹æ³•"></a>5.3.1.1. éå†æ–¹æ³•</h5><h6 id="5-3-1-1-1-void-forEach-Consumerï¼œ-super-Tï¼-action"><a href="#5-3-1-1-1-void-forEach-Consumerï¼œ-super-Tï¼-action" class="headerlink" title="5.3.1.1.1. void forEach(Consumerï¼œ? super Tï¼  action)"></a>5.3.1.1.1. void forEach(Consumerï¼œ? super Tï¼  action)</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">myList.stream().forEach(name -&gt; System.out.println(name))<br></code></pre></td></tr></table></figure><hr><h5 id="5-3-1-2-æ”¶é›†æ–¹æ³•"><a href="#5-3-1-2-æ”¶é›†æ–¹æ³•" class="headerlink" title="5.3.1.2. æ”¶é›†æ–¹æ³•"></a>5.3.1.2. æ”¶é›†æ–¹æ³•</h5><h6 id="5-3-1-2-1-å°†å…ƒç´ æ”¶é›†åˆ°-String-ä¸­"><a href="#5-3-1-2-1-å°†å…ƒç´ æ”¶é›†åˆ°-String-ä¸­" class="headerlink" title="5.3.1.2.1. å°†å…ƒç´ æ”¶é›†åˆ° String ä¸­"></a>5.3.1.2.1. å°†å…ƒç´ æ”¶é›†åˆ° String ä¸­</h6><p><font color="#92d050">1. Streamï¼œTï¼#collect(Collectorï¼œ? super T, A, Rï¼ collector) ç»“åˆ Collectors.joining()</font><br>è¯¥æ–¹æ³•ç”¨äºéé˜»å¡å°†å…ƒç´ æ‹¼æ¥æˆä¸€ä¸ªé•¿å­—ç¬¦ä¸²</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">myList.stream().collect(Collectors.joining()).<span class="hljs-keyword">var</span><br></code></pre></td></tr></table></figure><p><font color="#92d050">2. Streamï¼œTï¼#collect(Collectorï¼œ? super T, A, Rï¼ collector)  ç»“åˆ Collectors.joining(CharSequence delimiter)</font><br>è¯¥æ–¹æ³•ç”¨äºéé˜»å¡å°†å…ƒç´ æ‹¼æ¥æˆä¸€ä¸ªé•¿å­—ç¬¦ä¸²ï¼Œå¹¶ä¸”ä¸­é—´ç”¨æŒ‡å®šçš„ç¬¦å·éš”å¼€</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">myList.stream().collect(Collectors.joining(<span class="hljs-string">&quot;,&quot;</span>)).<span class="hljs-keyword">var</span><br></code></pre></td></tr></table></figure><p><font color="#92d050">3. Streamï¼œTï¼#collect(Collectorï¼œ? super T, A, Rï¼ collector)  ç»“åˆ Collectors.joining(CharSequence delimiter, CharSequence prefix, CharSequence suffix)</font><br>è¯¥æ–¹æ³•ç”¨äºéé˜»å¡å°†å…ƒç´ æ‹¼æ¥æˆä¸€ä¸ªé•¿å­—ç¬¦ä¸²ï¼Œå¹¶ä¸”ä¸­é—´ç”¨æŒ‡å®šçš„ç¬¦å·éš”å¼€ï¼Œè€Œä¸”åœ¨æ‹¼æ¥åçš„å­—ç¬¦ä¸²çš„å¼€å¤´å’Œç»“å°¾è¿½åŠ æŒ‡å®šçš„ç¬¦å·ï¼ˆå³å‰ç¼€å’Œåç¼€ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">myList.stream().collect(Collectors.joining(<span class="hljs-string">&quot;,&quot;</span>, <span class="hljs-string">&quot;[&quot;</span>, <span class="hljs-string">&quot;]&quot;</span>)).<span class="hljs-keyword">var</span><br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>ç»“æœçš„å½¢å¼æ˜¯è¿™æ ·çš„ï¼š<code>[A, ,B, C]</code></li></ol></blockquote><hr><h6 id="5-3-1-2-2-å°†å…ƒç´ æ”¶é›†åˆ°æ•°ç»„ä¸­"><a href="#5-3-1-2-2-å°†å…ƒç´ æ”¶é›†åˆ°æ•°ç»„ä¸­" class="headerlink" title="5.3.1.2.2. å°†å…ƒç´ æ”¶é›†åˆ°æ•°ç»„ä¸­"></a>5.3.1.2.2. å°†å…ƒç´ æ”¶é›†åˆ°æ•°ç»„ä¸­</h6><p><font color="#92d050">1. Streamï¼œTï¼#toArray()</font><br>è¯¥æ–¹æ³•ç”¨äºéé˜»å¡å°†å…ƒç´ æ”¶é›†åˆ° <code>Object</code> ç±»å‹çš„ <code>Array</code> å®ä¾‹ä¸­</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">myList.stream().toArray().<span class="hljs-keyword">var</span><br></code></pre></td></tr></table></figure><p><font color="#92d050">2. Streamï¼œTï¼#toArray(IntFunctionï¼œA[]ï¼ generator)</font><br>è¯¥æ–¹æ³•ç”¨äºå°†å…ƒç´ æ”¶é›†åˆ° â€œå®ä¾‹åŒ–å·¥å‚â€ åˆ›å»ºçš„ <code>Array</code> å®ä¾‹ä¸­ï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼šé˜»å¡ã€éé˜»å¡ã€é™æ—¶é˜»å¡è¦çœ‹å›è°ƒå‡½æ•°çš„å…·ä½“é€»è¾‘ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">myList.stream().toArray(size -&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>[<span class="hljs-number">100</span>]).<span class="hljs-keyword">var</span><br></code></pre></td></tr></table></figure><hr><h6 id="5-3-1-2-3-å°†å…ƒç´ æ”¶é›†åˆ°-Listï¼œEï¼-ä¸­"><a href="#5-3-1-2-3-å°†å…ƒç´ æ”¶é›†åˆ°-Listï¼œEï¼-ä¸­" class="headerlink" title="5.3.1.2.3. å°†å…ƒç´ æ”¶é›†åˆ° Listï¼œEï¼ ä¸­"></a>5.3.1.2.3. å°†å…ƒç´ æ”¶é›†åˆ° Listï¼œEï¼ ä¸­</h6><p><font color="#92d050">1. Streamï¼œTï¼#collect(Collectorï¼œ? super T, A, Rï¼ collector) ç»“åˆ Collectors.toCollection(Supplierï¼œCï¼ collectionFactory)</font><br>è¯¥æ–¹æ³•ç”¨äºå°†å…ƒç´ æ”¶é›†åˆ° â€œå®ä¾‹åŒ–å·¥å‚â€ åˆ›å»ºçš„ <code>Listï¼œEï¼</code> å®ä¾‹ä¸­ï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼šé˜»å¡ã€éé˜»å¡ã€é™æ—¶é˜»å¡è¦çœ‹å›è°ƒå‡½æ•°çš„å…·ä½“é€»è¾‘ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">myList.stream().collect(Collectors.toCollection(() -&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;())).<span class="hljs-keyword">var</span><br></code></pre></td></tr></table></figure><hr><h6 id="5-3-1-2-4-å°†å…ƒç´ æ”¶é›†åˆ°-Setï¼œEï¼-ä¸­"><a href="#5-3-1-2-4-å°†å…ƒç´ æ”¶é›†åˆ°-Setï¼œEï¼-ä¸­" class="headerlink" title="5.3.1.2.4. å°†å…ƒç´ æ”¶é›†åˆ° Setï¼œEï¼ ä¸­"></a>5.3.1.2.4. å°†å…ƒç´ æ”¶é›†åˆ° Setï¼œEï¼ ä¸­</h6><p><font color="#92d050">1. Streamï¼œTï¼#collect(Collectorï¼œ? super T, A, Rï¼ collector) ç»“åˆ Collectors.toCollection(Supplierï¼œCï¼ collectionFactory)</font><br>è¯¥æ–¹æ³•ç”¨äºå°†å…ƒç´ æ”¶é›†åˆ° â€œå®ä¾‹åŒ–å·¥å‚â€ åˆ›å»ºçš„ <code>Setï¼œEï¼</code> å®ä¾‹ä¸­ï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼šé˜»å¡ã€éé˜»å¡ã€é™æ—¶é˜»å¡è¦çœ‹å›è°ƒå‡½æ•°çš„å…·ä½“é€»è¾‘ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">myList.stream().collect(Collectors.toCollection(() -&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeSet</span>&lt;&gt;())).<span class="hljs-keyword">var</span><br></code></pre></td></tr></table></figure><hr><h6 id="5-3-1-2-5-å°†å…ƒç´ æ”¶é›†åˆ°-Mapï¼œK-Vï¼-ä¸­"><a href="#5-3-1-2-5-å°†å…ƒç´ æ”¶é›†åˆ°-Mapï¼œK-Vï¼-ä¸­" class="headerlink" title="5.3.1.2.5. å°†å…ƒç´ æ”¶é›†åˆ° Mapï¼œK, Vï¼ ä¸­"></a>5.3.1.2.5. å°†å…ƒç´ æ”¶é›†åˆ° Mapï¼œK, Vï¼ ä¸­</h6><p><font color="#92d050">1. Streamï¼œTï¼#collect(Collectorï¼œ? super T, A, Rï¼ collector) ç»“åˆ Collectors.toMap(Functionï¼œ? super T, ? extends Kï¼ keyMapper, Functionï¼œ? super T, ? extends Uï¼ valueMapper, BinaryOperatorï¼œUï¼ mergeFunction, Supplierï¼œMï¼ mapFactory)</font><br>è¯¥æ–¹æ³•ç”¨äºå°†å…ƒç´ æ”¶é›†åˆ° â€œå®ä¾‹åŒ–å·¥å‚â€ åˆ›å»ºçš„ <code>Mapï¼œK, Vï¼</code> å®ä¾‹ä¸­ï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼šé˜»å¡ã€éé˜»å¡ã€é™æ—¶é˜»å¡è¦çœ‹å›è°ƒå‡½æ•°çš„å…·ä½“é€»è¾‘ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java">myList.stream().collect(<br>    Collectors.toMap(<br>    <br> <span class="hljs-comment">// Key</span><br>        user -&gt; user.getId(),<br>        <br><span class="hljs-comment">// Value</span><br>        user -&gt; user,<br>        <br>    <span class="hljs-comment">// Key é‡å¤æ—¶çš„å†²çªè§£å†³ç­–ç•¥</span><br>        (oldV, newV) -&gt; newV,<br>        <br>        <span class="hljs-comment">// ç”Ÿæˆ Mapï¼œK, Vï¼ å®ä¾‹çš„ â€œå®ä¾‹åŒ–å·¥å‚â€</span><br>        () -&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedHashMap</span>&lt;&gt;()<br>    )<br>).<span class="hljs-keyword">var</span><br></code></pre></td></tr></table></figure><p><font color="#92d050">2. Streamï¼œTï¼#collect(Collectorï¼œ? super T, A, Rï¼ collector) ç»“åˆ Collectors.groupingBy(Functionï¼œ? super T, ? extends Kï¼ classifier, Supplierï¼œMï¼ mapFactory, Collectorï¼œ? super T, A, Dï¼ downstream)</font><br>è¯¥æ–¹æ³•ç”¨äºå°†å…ƒç´ æ”¶é›†åˆ° â€œå®ä¾‹åŒ–å·¥å‚â€ åˆ›å»ºçš„ <code>Mapï¼œK, Vï¼</code> å®ä¾‹ä¸­ï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼šé˜»å¡ã€éé˜»å¡ã€é™æ—¶é˜»å¡è¦çœ‹å›è°ƒå‡½æ•°çš„å…·ä½“é€»è¾‘ï¼‰</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼šè¯¥æ–¹æ³•å…¶å®æ˜¯å°†å…ƒç´ æ”¶é›†åˆ° <code>Mapï¼œK, Listï¼œVï¼ï¼</code> å®ä¾‹ä¸­ï¼Œç±»ä¼¼äº <code>MySQL</code> ä¸­çš„åˆ†ç»„æŸ¥è¯¢</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java">TreeMap&lt;Long, List&lt;User&gt;&gt; sortedGroupMap = myList.stream().collect(<br>    Collectors.groupingBy(<br>    <br>    <span class="hljs-comment">// åˆ†ç±»å™¨ï¼ˆåˆ†ç»„å™¨ï¼‰</span><br>        User::getDeptId, <br>        <br>        <span class="hljs-comment">// åˆ›å»º Mapï¼œK, Vï¼ å®ä¾‹çš„ â€œå®ä¾‹åŒ–å·¥å‚â€</span><br>        TreeMap::<span class="hljs-keyword">new</span>,<br>        <br>        <span class="hljs-comment">// å°†å…ƒç´ åˆ†ç»„åï¼Œå¯¹æ¯ä¸€ç»„æ‰§è¡Œè¯¥ä¼ å…¥çš„æ–¹æ³•å‚æ•°</span><br>        Collectors.toList()<br>    )<br>);<br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>æ‰€è°“çš„ â€œå°†å…ƒç´ åˆ†ç»„åï¼Œå¯¹æ¯ä¸€ç»„æ‰§è¡Œè¯¥ä¼ å…¥çš„æ–¹æ³•å‚æ•°â€ æ˜¯æŒ‡ï¼šç±»ä¼¼äº <code>MySQL</code> ä¸­çš„åˆ†ç»„æŸ¥è¯¢é€šå¸¸ä¸èšåˆå‡½æ•°é…åˆä½¿ç”¨ä¸€æ ·ï¼Œè¿™é‡Œå°±æ‰®æ¼” â€œèšåˆå‡½æ•°â€ çš„è§’è‰²ï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼šé€šå¸¸ç»“åˆ <code>Collectors</code> æä¾›çš„ä¸€äº›æ–¹æ³•ï¼‰</li></ol></blockquote><p><font color="#92d050">3. Streamï¼œTï¼#collect(Collectorï¼œ? super T, A, Rï¼ collector) ç»“åˆ Collectors.groupingByConcurrent(Functionï¼œ? super T, ? extends Kï¼ classifier, Supplierï¼œMï¼ mapFactory, Collectorï¼œ? super T, A, Dï¼ downstream) </font><br>è¯¥æ–¹æ³•ç”¨äºå°†å…ƒç´ æ”¶é›†åˆ° â€œå®ä¾‹åŒ–å·¥å‚â€ åˆ›å»ºçš„ <code>Mapï¼œK, Vï¼</code> å®ä¾‹ä¸­ï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼šé˜»å¡ã€éé˜»å¡ã€é™æ—¶é˜»å¡è¦çœ‹å›è°ƒå‡½æ•°çš„å…·ä½“é€»è¾‘ï¼‰</p><p>è¯¥æ–¹æ³•åŒæ ·æ˜¯å°†å…ƒç´ æ”¶é›†åˆ° <code>Mapï¼œK, Listï¼œVï¼ï¼</code> å®ä¾‹ä¸­ï¼Œç±»ä¼¼äº <code>MySQL</code> ä¸­çš„åˆ†ç»„æŸ¥è¯¢</p><p>è¯¥æ–¹æ³•ä¸ä¸Šé¢çš„æ–¹æ³•çš„åŒºåˆ«åœ¨äºï¼š æˆ‘ä»¬çŸ¥é“ â€œ<code>Java Stream</code> çš„å¹¶è¡Œæµæ˜¯ä½¿ç”¨ <code>ForkJoinPool</code> å®ç°åˆ†è€Œæ²»ä¹‹ã€è¿­ä»£æ‹†åˆ†ã€å·¥ä½œçªƒå–çš„â€ã€‚å¦‚æœä½¿ç”¨ä¸Šé¢çš„æ–¹æ³•ï¼Œä¼šç”Ÿæˆå¤šä¸ªå° <code>Mapï¼œK, Vï¼</code> å®ä¾‹ç”¨æ¥å­˜å‚¨æ¯éƒ¨åˆ†è¢«æ‹†åˆ†åçš„å…ƒç´ è¢« <code>Java Stream</code> å¤„ç†åçš„ç»“æœï¼Œç„¶åå†åˆå¹¶æˆä¸€ä¸ªå¤§çš„ <code>Mapï¼œK, Vï¼</code> å®ä¾‹ã€‚è€Œè¯¥æ–¹æ³•æ˜¯è®©æ‰€æœ‰æ‰§è¡Œ <code>Java Stream</code> çš„å¹¶è¡Œæµçš„çº¿ç¨‹å…±åŒå‘åŒä¸€ä¸ªå¤šçº¿ç¨‹å¹¶å‘å®‰å…¨çš„ <code>Mapï¼œK, Vï¼</code> å®ä¾‹è¿›è¡Œå†™æ“ä½œï¼Œä¸éœ€è¦åˆ›å»ºå¤šä¸ªå° <code>Mapï¼œK, Vï¼</code> å®ä¾‹å’Œæœ€åçš„åˆå¹¶åŠ¨ä½œ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java">ConcurrentMap&lt;Long, List&lt;User&gt;&gt; concurrentMap = myList.parallelStream().collect(<br>    Collectors.groupingByConcurrent(<br>    <br>    <span class="hljs-comment">// åˆ†ç±»å™¨ï¼ˆåˆ†ç»„å™¨ï¼‰</span><br>        User::getDeptId,<br>        <br>        <span class="hljs-comment">// ç”Ÿæˆ Mapï¼œK, Vï¼ å®ä¾‹çš„ â€œå®ä¾‹åŒ–å·¥å‚â€</span><br>        ConcurrentHashMap::<span class="hljs-keyword">new</span>,<br>        <br>        <span class="hljs-comment">// å°†å…ƒç´ åˆ†ç»„åï¼Œå¯¹æ¯ä¸€ç»„æ‰§è¡Œè¯¥ä¼ å…¥çš„æ–¹æ³•å‚æ•°</span><br>        Collectors.toList()<br>    )<br>);<br></code></pre></td></tr></table></figure><hr><h4 id="5-3-2-ç‰¹åŒ–æµç‹¬å±æ–¹æ³•"><a href="#5-3-2-ç‰¹åŒ–æµç‹¬å±æ–¹æ³•" class="headerlink" title="5.3.2. ç‰¹åŒ–æµç‹¬å±æ–¹æ³•"></a>5.3.2. ç‰¹åŒ–æµç‹¬å±æ–¹æ³•</h4><p>ç‰¹åŒ–æµç‹¬å±æ–¹æ³•æ˜¯ <code>java.util.stream.IntStream</code> æ¥å£ã€<code>java.util.stream.LongStream</code> æ¥å£ã€<code>java.util.stream.DoubleStream</code> æ¥å£ä¸­çš„ä¸€äº›æ–¹æ³•</p><hr><h1 id="å…­ã€CompletableFutureï¼œTï¼"><a href="#å…­ã€CompletableFutureï¼œTï¼" class="headerlink" title="å…­ã€CompletableFutureï¼œTï¼"></a>å…­ã€CompletableFutureï¼œTï¼</h1><p>è¯¦è§æºç ï¼š<code>CompletableFutureï¼œTï¼</code></p><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.CompletableFuture%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.CompletableFutureï¼œTï¼æºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/12/01/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.CompletableFuture%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/12/01/æºç ï¼šjava.util.concurrent.CompletableFutureï¼œTï¼æºç è§£æ/</a></li></ol></li></ol><hr>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
      <category>Java å‡½æ•°å¼ç¼–ç¨‹</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.util.RandomAccess æºç è§£æ</title>
    <link href="/2025/11/30/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.RandomAccess%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/11/30/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.RandomAccess%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/11/30/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.RandomAccess%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/30/æºç ï¼šjava.util.RandomAccessæºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-RandomAccess-æ¦‚è¿°"><a href="#3-1-RandomAccess-æ¦‚è¿°" class="headerlink" title="3.1. RandomAccess æ¦‚è¿°"></a>3.1. RandomAccess æ¦‚è¿°</h3><p><code>RandomAccess</code> æ˜¯ä¸€ä¸ªæ¥å£</p><p>æˆ‘ä»¬çŸ¥é“ï¼šåœ¨ <code>Java</code> åº”ç”¨ä¸­ï¼Œéå†ä¸€ä¸ªé›†åˆé€šå¸¸æœ‰ä¸¤ç§æ–¹å¼ï¼šç´¢å¼•éå†ã€è¿­ä»£å™¨éå†ã€‚è€Œ <code>RandomAccess</code> æ˜¯ä¸€ä¸ªæ ‡è®°æ¥å£ï¼Œåªè¦æˆ‘ä»¬ <code>Implements RandomAccess</code>ï¼Œä»–å°±å‘Šè¯‰å…¶ä»–ç®—æ³• â€œä½¿ç”¨å“ªç§éå†æ–¹å¼æœ€å¿«â€ï¼ˆæ˜¯å‘Šè¯‰å…¶ä»–ç®—æ³•ï¼‰</p><p>å¦‚æœ <code>Implements RandomAccess</code>ï¼Œæœ€å¥½ä½¿ç”¨ç´¢å¼•éå†ã€‚å¦‚æœæ²¡æœ‰ <code>Implements RandomAccess</code>ï¼Œæœ€å¥½ä½¿ç”¨è¿­ä»£å™¨éå†</p><hr><h2 id="4-æºç éƒ¨åˆ†"><a href="#4-æºç éƒ¨åˆ†" class="headerlink" title="4. æºç éƒ¨åˆ†"></a>4. æºç éƒ¨åˆ†</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Iterable</span>&lt;T&gt; &#123;<br><br><span class="hljs-comment">// ç”¨äºéé˜»å¡è·å–è¿­ä»£å™¨å®ä¾‹</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// å³è·å–ä¸€ä¸ªå®ç°äº† Iterator æ¥å£çš„å…·ä½“å®ç°ç±»å®ä¾‹ï¼Œå…¶å†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ªæ•°æ®ç»“æ„ç”¨æ¥å­˜å‚¨å…ƒç´ </span><br>    Iterator&lt;T&gt; <span class="hljs-title function_">iterator</span><span class="hljs-params">()</span>;<br><br><span class="hljs-comment">// ç”¨äºéé˜»å¡éå†è¿­ä»£å™¨å®ä¾‹ç»´æŠ¤çš„æ•°æ®ç»“æ„ä¸­çš„æ‰€æœ‰å…ƒç´ ï¼Œå¹¶å¯¹æ¯ä¸ªå…ƒç´ æ‰§è¡Œä¼ å…¥çš„æ–¹æ³•å‚æ•° action</span><br>    <span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">forEach</span><span class="hljs-params">(Consumer&lt;? <span class="hljs-built_in">super</span> T&gt; action)</span> &#123;<br>        Objects.requireNonNull(action);<br>        <span class="hljs-keyword">for</span> (T t : <span class="hljs-built_in">this</span>) &#123;<br>            action.accept(t);<br>        &#125;<br>    &#125;<br><br><span class="hljs-comment">// ç”¨äºéé˜»å¡è·å–å¯æ‹†åˆ†è¿­ä»£å™¨å®ä¾‹</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// å³è·å–ä¸€ä¸ªå®ç°äº† Spliterator æ¥å£çš„å…·ä½“å®ç°ç±»å®ä¾‹</span><br>    <span class="hljs-keyword">default</span> Spliterator&lt;T&gt; <span class="hljs-title function_">spliterator</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> Spliterators.spliteratorUnknownSize(iterator(), <span class="hljs-number">0</span>);<br>    &#125;<br>    <br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>è¯¦è§æºç ï¼š<code>Iteratorï¼œEï¼</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.Iterator%EF%BC%9CE%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.Iteratorï¼œEï¼æºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/08/25/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.Iterator%EF%BC%9CE%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/08/25/æºç ï¼šjava.util.Iteratorï¼œEï¼æºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>Consumerï¼œTï¼</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.function.Consumer%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.function.Consumerï¼œTï¼æºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/11/18/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.function.Consumer%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/18/æºç ï¼šjava.util.function.Consumerï¼œTï¼æºç è§£æ/</a></li></ol></li></ol></li><li>å¢å¼º <code>for</code> å¾ªç¯ï¼ˆ<code>for-each</code> å¾ªç¯ï¼‰æ˜¯ <code>Java</code> æä¾›çš„ä¸€ç§è¯­æ³•ç³–ï¼Œåœ¨ç¼–è¯‘é˜¶æ®µä¼šè¢«ç¼–è¯‘å™¨è‡ªåŠ¨è½¬æ¢ä¸ºç­‰ä»·çš„è¿­ä»£å™¨éå†ä»£ç </li></ol></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ç¼–è¯‘å‰</span><br><span class="hljs-keyword">for</span> (T t : iterable) &#123;<br>xxxxxx<br>&#125;<br><br><br><span class="hljs-comment">// ç¼–è¯‘å</span><br><span class="hljs-keyword">for</span> (Iterator&lt;T&gt; it = iterable.iterator(); it.hasNext(); ) &#123;<br><span class="hljs-type">T</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> it.next();<br>xxxxxx<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹<br>4. <code>Spliterator</code> æ˜¯ <code>Java8</code> ä¸ºäº†æ”¯æŒå¹¶è¡Œæµè€Œä¸“é—¨å¼•å…¥çš„ä¸€ä¸ªæ¥å£ã€‚è¯¦è§ç¬”è®°ï¼š<code>Java</code> å‡½æ•°å¼ç¼–ç¨‹ï¼ˆ<code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<a href="%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B.md">ç¬”è®°ï¼šJavaå‡½æ•°å¼ç¼–ç¨‹</a>ï¼Œ<code>Hexo</code> é“¾æ¥ï¼šï¼‰</p></blockquote><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>ç¬”è®°ï¼šJava æ•°æ®ç±»å‹</title>
    <link href="/2025/11/27/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/"/>
    <url>/2025/11/27/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/</url>
    
    <content type="html"><![CDATA[<h1 id="ä¸€ã€TODO"><a href="#ä¸€ã€TODO" class="headerlink" title="ä¸€ã€TODO"></a>ä¸€ã€TODO</h1><ul><li><input disabled="" type="checkbox"> List<ul><li><input checked="" disabled="" type="checkbox"> ArrayList</li><li><input checked="" disabled="" type="checkbox"> LinkedList</li><li><input disabled="" type="checkbox"> CopyOnWriteArrayList</li></ul></li><li><input disabled="" type="checkbox"> Set å»é‡ï¼Œå»é‡ï¼Œå»é‡ï¼ï¼ï¼ï¼è¯´å•Š<ul><li><input disabled="" type="checkbox"> TreeSet</li><li><input disabled="" type="checkbox"> HashSet</li><li><input disabled="" type="checkbox"> EnumSet</li><li><input disabled="" type="checkbox"> LinkedHashSet æœ€é‡è¦çš„å°±æ˜¯ LRU</li><li><input disabled="" type="checkbox"> CopyOnWriteArraySet</li></ul></li><li><input disabled="" type="checkbox"> Map<ul><li><input checked="" disabled="" type="checkbox"> TreeMap</li><li><input checked="" disabled="" type="checkbox"> HashMap</li><li><input disabled="" type="checkbox"> EnumMap</li><li><input checked="" disabled="" type="checkbox"> WeakHashMap</li><li><input checked="" disabled="" type="checkbox"> LinkedHashMap</li><li><input checked="" disabled="" type="checkbox"> ConcurrentHashMap</li><li><input disabled="" type="checkbox"> ConcurrentSkipListMap</li></ul></li><li><input disabled="" type="checkbox"> Queue<ul><li><input checked="" disabled="" type="checkbox"> LinkedList</li><li><input disabled="" type="checkbox"> ArrayBlockingQueue</li><li><input disabled="" type="checkbox"> LinkedBlockingQueue</li><li><input disabled="" type="checkbox"> PriorityBlockingQueue</li><li><input disabled="" type="checkbox"> DelayQueue</li><li><input disabled="" type="checkbox"> SynchronousQueue</li><li><input disabled="" type="checkbox"> LinkedTransferQueue</li><li><input disabled="" type="checkbox"> PriorityQueue</li><li><input disabled="" type="checkbox"> ConcurrentLinkedQueue</li><li><input disabled="" type="checkbox"> ScheduledThreadPoolExecutor.DelayedWorkQueue</li><li><input disabled="" type="checkbox"> ForkJoinPool.WorkQueue</li><li><input disabled="" type="checkbox"> ArrayDeque</li><li><input disabled="" type="checkbox"> LinkedBlockingDeque</li><li><input disabled="" type="checkbox"> ConcurrentLinkedDeque</li></ul></li><li><input disabled="" type="checkbox"> instanceof çš„åŸç†</li><li><input disabled="" type="checkbox"> ä¸ºä»€ä¹ˆ Java è¦è®¾è®¡æˆ â€œä¼ªæ³›å‹â€</li><li><input disabled="" type="checkbox"> ä¸ºä»€ä¹ˆæ— æ³•ä½¿ç”¨ instanceof æ£€æŸ¥æ³›å‹ç±»å‹ï¼ˆæ³›å‹ç±»å‹æ˜¯æŒ‡ä»€ä¹ˆï¼‰</li><li><input disabled="" type="checkbox"> å†…éƒ¨ç±»ä¹‹åï¼Œç»§ç»­å›åˆ° Java å‡½æ•°å¼ç¼–ç¨‹ä»lambda è¡¨è¾¾å¼ç»§ç»­å¼€å§‹</li></ul><hr><h1 id="äºŒã€è„‘å›¾"><a href="#äºŒã€è„‘å›¾" class="headerlink" title="äºŒã€è„‘å›¾"></a>äºŒã€è„‘å›¾</h1><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/11/27/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/">http://blog.wangjia.ink/2025/11/27/ç¬”è®°ï¼šJavaæ•°æ®ç±»å‹/</a></p></li><li><p>ä»£ç æ´ªè’ï¼ˆé¢è¯•å®å…¸ï¼‰<br>ğŸ‘‰ <a href="https://www.notion.so/Java-2b7974fbda5e80849377f2d49f812c50?source=copy_link">https://www.notion.so/Java-2b7974fbda5e80849377f2d49f812c50?source=copy_link</a></p></li></ol><hr><h1 id="å››ã€å¼•ç”¨æ•°æ®ç±»å‹"><a href="#å››ã€å¼•ç”¨æ•°æ®ç±»å‹" class="headerlink" title="å››ã€å¼•ç”¨æ•°æ®ç±»å‹"></a>å››ã€å¼•ç”¨æ•°æ®ç±»å‹</h1><h2 id="1-ç±»"><a href="#1-ç±»" class="headerlink" title="1. ç±»"></a>1. ç±»</h2><h3 id="1-1-å…·ä½“ç±»"><a href="#1-1-å…·ä½“ç±»" class="headerlink" title="1.1. å…·ä½“ç±»"></a>1.1. å…·ä½“ç±»</h3><h4 id="1-1-1-å†…éƒ¨ç±»"><a href="#1-1-1-å†…éƒ¨ç±»" class="headerlink" title="1.1.1. å†…éƒ¨ç±»"></a>1.1.1. å†…éƒ¨ç±»</h4><ol><li>å®ä¾‹å†…éƒ¨ç±»</li><li>é™æ€å†…éƒ¨ç±»</li><li>å±€éƒ¨å†…éƒ¨ç±»</li><li>åŒ¿åå†…éƒ¨ç±»</li><li><code>Lambda</code> è¡¨è¾¾å¼</li></ol><table><thead><tr><th>ç‰¹æ€§</th><th><strong>å®ä¾‹å†…éƒ¨ç±»</strong></th><th><strong>é™æ€å†…éƒ¨ç±»</strong></th><th><strong>å±€éƒ¨å†…éƒ¨ç±»</strong></th><th><strong>åŒ¿åå†…éƒ¨ç±»</strong></th><th>Lambda è¡¨è¾¾å¼</th></tr></thead><tbody><tr><td><strong>ä½ç½®</strong></td><td>ç±»å†…éƒ¨ï¼Œä½†æ˜¯åœ¨æ–¹æ³•å¤–éƒ¨</td><td>ç±»å†…éƒ¨ï¼Œä½†æ˜¯åœ¨æ–¹æ³•å¤–éƒ¨</td><td>æ–¹æ³•å†…éƒ¨</td><td>1. ç±»å†…éƒ¨ï¼Œä½†æ˜¯åœ¨æ–¹æ³•å¤–éƒ¨ï¼ˆèµ‹å€¼ï¼‰<br>2. æ–¹æ³•å‚æ•°<br>3. æ–¹æ³•å†…éƒ¨</td><td>1. ç±»å†…éƒ¨ï¼Œä½†æ˜¯åœ¨æ–¹æ³•å¤–éƒ¨ï¼ˆèµ‹å€¼ï¼‰<br>2. æ–¹æ³•å‚æ•°<br>3. æ–¹æ³•å†…éƒ¨</td></tr><tr><td><strong>å¯¹è±¡çš„å®ä¾‹åŒ–æ–¹å¼</strong></td><td>å…ˆåˆ›å»ºä¸Šå±‚ç±»å®ä¾‹ï¼Œå†é€šè¿‡ä¸Šå±‚ç±»å®ä¾‹åˆ›å»ºå†…éƒ¨ç±»å®ä¾‹</td><td>ç›´æ¥åˆ›å»ºå†…éƒ¨ç±»å®ä¾‹</td><td>ç›´æ¥åˆ›å»ºå†…éƒ¨ç±»å®ä¾‹ï¼ˆåªèƒ½åœ¨åˆ›å»ºå±€éƒ¨å†…éƒ¨ç±»çš„æ–¹æ³•å†…éƒ¨åˆ›å»ºå†…éƒ¨ç±»å®ä¾‹ï¼‰</td><td>åˆ›å»ºå†…éƒ¨ç±»çš„åŒæ—¶ï¼Œä¼šè‡ªåŠ¨åˆ›å»ºå†…éƒ¨ç±»å®ä¾‹</td><td>åˆ›å»º <code>Lambda</code> è¡¨è¾¾å¼çš„åŒæ—¶ï¼Œä¼šè‡ªåŠ¨åˆ›å»ºå†…éƒ¨ç±»å®ä¾‹</td></tr><tr><td><strong>this æŒ‡å‘çš„ä½ç½®</strong></td><td>å†…éƒ¨ç±»å®ä¾‹æœ¬èº«</td><td>å†…éƒ¨ç±»å®ä¾‹æœ¬èº«</td><td>å†…éƒ¨ç±»å®ä¾‹æœ¬èº«</td><td>å†…éƒ¨ç±»å®ä¾‹æœ¬èº«</td><td>1. å¦‚æœ <code>Lambda</code> è¡¨è¾¾å¼è¢«åˆ›å»ºåœ¨ç±»çš„å†…éƒ¨ï¼Œä½†æ˜¯åœ¨æ–¹æ³•å¤–ï¼šä¸Šå±‚ç±»å®ä¾‹<br>2. å¦‚æœ <code>Lambda</code> è¡¨è¾¾å¼è¢«åˆ›å»ºåœ¨å®ä¾‹æ–¹æ³•çš„æ–¹æ³•å‚æ•°æˆ–æ–¹æ³•å†…éƒ¨ï¼šè°ƒç”¨è¿™ä¸ªå®ä¾‹æ–¹æ³•çš„å®ä¾‹<br>3. å¦‚æœ <code>Lambda</code> è¡¨è¾¾å¼è¢«åˆ›å»ºåœ¨é™æ€æ–¹æ³•çš„æ–¹æ³•å‚æ•°æˆ–æ–¹æ³•å†…éƒ¨ï¼šæ²¡æœ‰ <code>this</code>ï¼Œä¸èƒ½ä½¿ç”¨ <code>this</code></td></tr><tr><td><strong>æ˜¯å¦æŒæœ‰ä¸Šå±‚ç±»çš„å¼•ç”¨</strong></td><td>âœ…ï¼ˆ<code>this$0</code>ï¼‰</td><td>âŒ</td><td>1. å¦‚æœå±€éƒ¨å†…éƒ¨ç±»è¢«åˆ›å»ºåœ¨å®ä¾‹æ–¹æ³•çš„å†…éƒ¨ï¼šâœ…<br>2. å¦‚æœå±€éƒ¨å†…éƒ¨ç±»è¢«åˆ›å»ºåœ¨é™æ€æ–¹æ³•çš„å†…éƒ¨ï¼šâŒ</td><td>1. å¦‚æœä¸æ¶‰åŠåˆ°é™æ€ï¼šâœ…<br>2. å¦‚æœæ¶‰åŠåˆ°é™æ€ï¼šâŒï¼ˆä¾‹å¦‚åŒ¿åå†…éƒ¨ç±»å®ä¾‹è¢«èµ‹å€¼ç»™é™æ€å˜é‡æˆ–é™æ€å¸¸é‡ï¼Œåˆæˆ–è€…åŒ¿åå†…éƒ¨ç±»è¢«åˆ›å»ºåœ¨é™æ€æ–¹æ³•çš„æ–¹æ³•å‚æ•°æˆ–æ–¹æ³•å†…éƒ¨ï¼‰</td><td>1. å¦‚æœ <code>Lambda</code> è¡¨è¾¾å¼çš„æ–¹æ³•ä½“ä¸­æ¶‰åŠåˆ°ä¸Šå±‚ç±»çš„éé™æ€å˜é‡ã€å¸¸é‡ã€æ–¹æ³•ã€å†…éƒ¨ç±»ï¼šâœ…<br>2. å¦‚æœ <code>Lambda</code> è¡¨è¾¾å¼çš„æ–¹æ³•ä½“ä¸­æ²¡æœ‰æ¶‰åŠåˆ°ä¸Šå±‚ç±»çš„éé™æ€å˜é‡ã€å¸¸é‡ã€æ–¹æ³•ã€å†…éƒ¨ç±»ï¼šâŒ</td></tr><tr><td><strong>æ”¯æŒçš„è®¿é—®ä¿®é¥°ç¬¦</strong></td><td>æ‰€æœ‰</td><td>æ‰€æœ‰</td><td>ä¸æ”¯æŒ</td><td>ä¸æ”¯æŒ</td><td>ä¸æ”¯æŒ</td></tr><tr><td><strong>æ”¯æŒçš„ç±»çº§åˆ«çš„éè®¿é—®ä¿®é¥°ç¬¦</strong></td><td><code>final</code>ã€<code>strictfp</code>ã€<code>abstract</code>ã€<code>sealed</code>ã€<code>non-sealed</code></td><td><code>final</code>ã€<code>static</code>ã€<code>strictfp</code>ã€<code>abstract</code>ã€<code>sealed</code>ã€<code>non-sealed</code></td><td><code>final</code>ã€<code>strictfp</code>ã€<code>asbtract</code></td><td>ä¸æ”¯æŒ</td><td>ä¸æ”¯æŒ</td></tr><tr><td><strong>æ”¯æŒçš„å±æ€§çº§åˆ«çš„éè®¿é—®ä¿®é¥°ç¬¦</strong></td><td><code>final</code>ã€<code>volatile</code>ã€<code>transient</code></td><td><code>final</code>ã€<code>static</code>ã€<code>volatile</code>ã€<code>tr</code>abstract<code>ã€</code>sealed<code>ã€</code>non-sealed<code>ansient</code>ï¼ˆåœ¨ <code>Java16</code> ä¹‹åï¼Œå…è®¸åœ¨å†…éƒ¨ç±»ä¸­ä½¿ç”¨ <code>static</code> éè®¿é—®ä¿®é¥°ç¬¦ï¼‰</td><td><code>final</code>ã€<code>static</code>ã€<code>volatile</code>ã€<code>transient</code>ï¼ˆåœ¨ <code>Java16</code> ä¹‹åï¼Œå…è®¸åœ¨å†…éƒ¨ç±»ä¸­ä½¿ç”¨ <code>static</code> éè®¿é—®ä¿®é¥°ç¬¦ï¼‰</td><td><code>final</code>ã€<code>static</code>ã€<code>volatile</code>ã€<code>transient</code>ï¼ˆåœ¨ <code>Java16</code> ä¹‹åï¼Œå…è®¸åœ¨å†…éƒ¨ç±»ä¸­ä½¿ç”¨ <code>static</code> éè®¿é—®ä¿®é¥°ç¬¦ï¼‰</td><td><code>final</code>ï¼ˆ<code>Lambda</code> è¡¨è¾¾å¼å’Œå…¶ä»–å››ç§å†…éƒ¨ç±»ç»ˆç©¶æ˜¯ä¸åŒã€‚åˆ›å»ºå››ç§å†…éƒ¨ç±»æ˜¯çœŸçš„åœ¨åˆ›å»ºä¸€ä¸ªç±»ï¼Œå±æ€§æ˜¯æ­£å„¿å…«ç»çš„å±æ€§ã€‚ä½†æ˜¯æˆ‘ä»¬åˆ›å»º <code>Lambda</code> è¡¨è¾¾å¼ï¼Œå…¶æ–¹æ³•ä½“æœ¬è´¨ä¸Šå¯¹æŸå‡½æ•°å¼æ¥å£çš„æ¥å£æ–¹æ³•ï¼ˆæ™®é€šï¼‰çš„å®ç°ï¼Œæ‰€ä»¥å±æ€§å…¶å®æ˜¯å±€éƒ¨å˜é‡ã€‚è€Œå±€éƒ¨å˜é‡åªæ”¯æŒ <code>final</code> éè®¿é—®ä¿®é¥°ç¬¦</td></tr><tr><td><strong>æ”¯æŒçš„æ–¹æ³•çº§åˆ«çš„éè®¿é—®ä¿®é¥°ç¬¦</strong></td><td><code>final</code>ã€<code>native</code>ã€<code>strictfp</code>ã€<code>synchronized</code></td><td><code>final</code>ã€<code>static</code>ã€<code>native</code>ã€<code>strictfp</code>ã€<code>synchronized</code>ï¼ˆåœ¨ <code>Java16</code> ä¹‹åï¼Œå…è®¸åœ¨å†…éƒ¨ç±»ä¸­ä½¿ç”¨ <code>static</code> éè®¿é—®ä¿®é¥°ç¬¦ï¼‰</td><td><code>final</code>ã€<code>static</code>ã€<code>native</code>ã€<code>strictfp</code>ã€<code>synchronized</code>ï¼ˆåœ¨ <code>Java16</code> ä¹‹åï¼Œå…è®¸åœ¨å†…éƒ¨ç±»ä¸­ä½¿ç”¨ <code>static</code> éè®¿é—®ä¿®é¥°ç¬¦ï¼‰</td><td><code>final</code>ã€<code>static</code>ã€<code>native</code>ã€<code>strictfp</code>ã€<code>synchronized</code>ï¼ˆåœ¨ <code>Java16</code> ä¹‹åï¼Œå…è®¸åœ¨å†…éƒ¨ç±»ä¸­ä½¿ç”¨ <code>static</code> éè®¿é—®ä¿®é¥°ç¬¦ï¼‰</td><td>ä¸æ”¯æŒ</td></tr><tr><td><strong>æ˜¯å¦èƒ½ç›´æ¥è®¿é—®ä¸Šå±‚ç±»ä¸­çš„éé™æ€çš„å˜é‡ã€å¸¸é‡ã€æ–¹æ³•ã€å†…éƒ¨ç±»</strong></td><td>âœ…</td><td>âŒ</td><td>1. å¦‚æœå±€éƒ¨å†…éƒ¨ç±»è¢«åˆ›å»ºåœ¨å®ä¾‹æ–¹æ³•çš„å†…éƒ¨ï¼šâœ…<br>2. å¦‚æœå±€éƒ¨å†…éƒ¨ç±»è¢«åˆ›å»ºåœ¨é™æ€æ–¹æ³•çš„å†…éƒ¨ï¼šâŒ</td><td>1. å¦‚æœä¸æ¶‰åŠåˆ°é™æ€ï¼šâœ…<br>2. å¦‚æœæ¶‰åŠåˆ°é™æ€ï¼šâŒ</td><td>1. å¦‚æœ <code>Lambda</code> è¡¨è¾¾å¼çš„æ–¹æ³•ä½“ä¸­æ¶‰åŠåˆ°ä¸Šå±‚ç±»çš„éé™æ€å˜é‡ã€å¸¸é‡ã€æ–¹æ³•ã€å†…éƒ¨ç±»ï¼šâœ…<br>2. å¦‚æœ <code>Lambda</code> è¡¨è¾¾å¼çš„æ–¹æ³•ä½“ä¸­æ²¡æœ‰æ¶‰åŠåˆ°ä¸Šå±‚ç±»çš„éé™æ€å˜é‡ã€å¸¸é‡ã€æ–¹æ³•ã€å†…éƒ¨ç±»ï¼šâŒ</td></tr><tr><td><strong>.class æ–‡ä»¶çš„æ–‡ä»¶å</strong></td><td><code>Outer$Inner.class</code></td><td><code>Outer$Inner.class</code></td><td><code>Outer$1Inner.class</code>ï¼ˆæœ‰æ•°å­—ç¼–å·ï¼‰</td><td><code>Outer$1.class</code>ï¼ˆçº¯æ•°å­—ç¼–å·ï¼‰</td><td>æ—  <code>.class</code> æ–‡ä»¶</td></tr></tbody></table><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>å±€éƒ¨å†…éƒ¨ç±»ä¸­çš„å˜é‡ã€å¸¸é‡å¹¶ä¸æ˜¯å±€éƒ¨å˜é‡ï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ªæ­£å„¿å…«ç»çš„ç±»ï¼Œåªä¸è¿‡è¢«åˆ›å»ºåœ¨æŸæ–¹æ³•çš„å†…éƒ¨ã€‚è€Œæ–¹æ³•ä¸­çš„å˜é‡æ‰æ˜¯çœŸæ­£çš„å±€éƒ¨å˜é‡</li><li>åŒ¿åå†…éƒ¨ç±»å’Œ <code>Lambda</code> è¡¨è¾¾å¼ä¸åƒå…¶ä»–å†…éƒ¨ç±»ä¸€æ ·ï¼Œéœ€è¦å…ˆåˆ›å»ºç±»ç„¶åå†åˆ›å»ºå…¶å®ä¾‹ï¼Œè€Œæ˜¯æˆ‘ä»¬åœ¨åˆ›å»ºåŒ¿åå†…éƒ¨ç±»å’Œ <code>Lambda</code> è¡¨è¾¾å¼çš„æ—¶å€™ï¼Œå°±è‡ªåŠ¨åˆ›å»ºäº†å…¶å®ä¾‹å¹¶è¿”å›ã€‚æ‰€ä»¥æˆ‘ä»¬è¯´ â€œåŒ¿åå†…éƒ¨ç±»å’Œ <code>Lambda</code> è¡¨è¾¾å¼å¯ä»¥åˆ›å»ºåœ¨ç±»å†…éƒ¨ï¼Œä½†æ˜¯åœ¨æ–¹æ³•å¤–éƒ¨â€ï¼Œå…¶å®å°±æ˜¯å°†å…¶è¿”å›çš„å®ä¾‹èµ‹å€¼ç»™ç±»çš„å˜é‡æˆ–å¸¸é‡ï¼š</li></ol></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Demo</span> &#123;<br><br>    <span class="hljs-type">Runnable</span> <span class="hljs-variable">memberLambda</span> <span class="hljs-operator">=</span> () -&gt; System.out.println(<span class="hljs-string">&quot;...&quot;</span>);<br>    <br><span class="hljs-comment">// ...</span><br><br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] Title<br>3. é™æ€å†…éƒ¨ç±»ä¸ä¸Šå±‚ç±»åœ¨åœ°ä½ä¸Šæ˜¯ä¸€æ ·çš„ï¼Œå› ä¸ºé™æ€å†…éƒ¨ç±»é™¤äº†åœ¨ä¸Šå±‚ç±»çš„å†…éƒ¨ï¼Œå…¶ä»–çš„å’Œä¸Šå±‚ç±»ä¸€ç‚¹å…³ç³»æ²¡æœ‰ï¼Œæ‰€ä»¥ä¸ä¼šæŒæœ‰ä¸Šå±‚ç±»çš„å¼•ç”¨<br>4. æ‰€è°“çš„ â€œæŒæœ‰ä¸Šå±‚ç±»çš„å¼•ç”¨â€ æ˜¯æŒ‡ï¼šåœ¨ç¼–è¯‘é˜¶æ®µï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨ä¸ºå†…éƒ¨ç±»æ·»åŠ ä¸€ä¸ªå®ä¾‹å˜é‡ï¼Œç”¨äºè®°å½•ä¸Šå±‚ç±»çš„å¼•ç”¨ï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼šåªä¼šè®°å½•ä¸Šå±‚ç±»çš„å¼•ç”¨ï¼Œå¹¶ä¸ä¼šè®°å½•ä¸Šå±‚ç±»çš„ä¸Šå±‚ç±»çš„å¼•ç”¨ã€‚å¦‚æœç¡®å®éœ€è¦è®¿é—®ä¸Šå±‚ç±»çš„ä¸Šå±‚ç±»ï¼Œéœ€è¦å€ŸåŠ©ä¸Šå±‚ç±»æŒæœ‰çš„å¼•ç”¨æ¥è®¿é—®ï¼‰<br>5. å¦‚æœå†…éƒ¨ç±»èƒ½ç›´æ¥è®¿é—®ä¸Šå±‚ç±»ä¸­çš„éé™æ€çš„å˜é‡ã€å¸¸é‡ã€æ–¹æ³•ã€å†…éƒ¨ç±»ï¼Œé‚£ä¹ˆå³ä¾¿æ˜¯ä½¿ç”¨ <code>private</code> è®¿é—®ä¿®é¥°ç¬¦ä¿®é¥°ï¼Œä¹Ÿèƒ½è®¿é—®<br>6. å±€éƒ¨å†…éƒ¨ç±»ã€åŒ¿åå†…éƒ¨ç±»ã€<code>Lambda</code> è¡¨è¾¾å¼å¦‚æœéœ€è¦è®¿é—®å±€éƒ¨å˜é‡ï¼Œåªèƒ½è®¿é—® <code>final</code> ä¿®é¥°çš„å±€éƒ¨å˜é‡æˆ– <code>Effectively Final</code> çš„å±€éƒ¨å˜é‡ï¼ˆåœ¨ç¼–è¯‘é˜¶æ®µï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨åˆ¤æ–­å‡ºå“ªäº›å˜é‡åœ¨åˆå§‹åŒ–åå°±æ²¡æœ‰å†è¢«ä¿®æ”¹è¿‡ï¼Œé‚£ä¹ˆè¿™äº›å˜é‡å°±ç®— <code>Effectively Final</code> çš„å˜é‡ï¼‰<br>7. å±€éƒ¨å˜é‡ä¹Ÿåªèƒ½æ˜¯ <code>final</code> ä¿®é¥°çš„å±€éƒ¨å˜é‡æˆ– <code>Effectively Final</code> çš„å±€éƒ¨å˜é‡ï¼Œå¦åˆ™åœ¨ç¼–è¯‘é˜¶æ®µï¼Œç¼–è¯‘å™¨ä¼šæŠ¥é”™<br>8. ä¸ªäººæ¨èè§„èŒƒä¸€äº›è¯­æ³•ï¼š<br>    1. è®¿é—®æœ¬æ–¹æ³•ä¸­çš„æˆå‘˜æ—¶ï¼š<br>        1. å˜é‡ã€å¸¸é‡<br>            1. å±€éƒ¨å˜é‡<br>                1. ä½¿ç”¨ <code>secret</code><br>        2. å†…éƒ¨ç±»<br>            1. å±€éƒ¨å†…éƒ¨ç±»<br>                1. åˆ›å»ºå®ä¾‹æ—¶ä½¿ç”¨ <code>new Inner()</code><br>    2. è®¿é—®æœ¬ç±»å®ä¾‹ä¸­çš„æˆå‘˜æ—¶ï¼š<br>        1. å˜é‡ã€å¸¸é‡<br>            1. æ™®é€šå¸¸é‡ã€å®ä¾‹å˜é‡<br>                1. ä½¿ç”¨ <code>this.secret</code><br>            2. é™æ€å¸¸é‡ã€é™æ€å˜é‡<br>                1. ä½¿ç”¨  <code>ç±»å.secret</code><br>        2. æ–¹æ³•<br>            1. å®ä¾‹æ–¹æ³•<br>                1. ä½¿ç”¨ <code>this.run()</code><br>            2. é™æ€æ–¹æ³•<br>                1. ä½¿ç”¨ <code>ç±»å.run()</code><br>        3. å†…éƒ¨ç±»<br>            1. å®ä¾‹å†…éƒ¨ç±»<br>                1. åˆ›å»ºå®ä¾‹æ—¶ä½¿ç”¨ <code>this.new Inner()</code><br>            2. é™æ€å†…éƒ¨ç±»<br>                1. åˆ›å»ºå®ä¾‹æ—¶ä½¿ç”¨ <code>new ç±»å.Inner()</code><br>    3. è®¿é—®ä¸Šå±‚ç±»å®ä¾‹ä¸­çš„æˆå‘˜æ—¶ï¼š<br>        1. å˜é‡ã€å¸¸é‡<br>            1. æ™®é€šå¸¸é‡ã€å®ä¾‹å˜é‡<br>                1. ä½¿ç”¨ <code>Outer.this.secret</code><br>            2. é™æ€å¸¸é‡ã€é™æ€å˜é‡<br>                1. ä½¿ç”¨  <code>ç±»å.secret</code><br>        2. æ–¹æ³•<br>            1. å®ä¾‹æ–¹æ³•<br>                1. ä½¿ç”¨ <code>Outer.this.run()</code><br>            2. é™æ€æ–¹æ³•<br>                1. ä½¿ç”¨ <code>ç±»å.run()</code><br>        3. å†…éƒ¨ç±»<br>            1. å®ä¾‹å†…éƒ¨ç±»<br>                1. åˆ›å»ºå®ä¾‹æ—¶ä½¿ç”¨ <code>Outer.this.new Inner()</code><br>            2. é™æ€å†…éƒ¨ç±»<br>                1. åˆ›å»ºå®ä¾‹æ—¶ä½¿ç”¨ <code>new ç±»å.Inner()</code><br>        4. éœ€è¦æ³¨æ„çš„æ˜¯ï¼šè®¿é—®ä¸Šå±‚ç±»å®ä¾‹ä¸­çš„æˆå‘˜ï¼Œéœ€è¦å†…éƒ¨ç±»å®ä¾‹æŒæœ‰ä¸Šå±‚ç±»çš„å¼•ç”¨<br>    4. è®¿é—®å…¶ä»–ç±»å®ä¾‹ä¸­çš„æˆå‘˜æ—¶ï¼š<br>        1. å˜é‡ã€å¸¸é‡<br>            1. æ™®é€šå¸¸é‡ã€å®ä¾‹å˜é‡<br>                1. ä½¿ç”¨ <code>new Outer() </code>å’Œ <code>outer.secret</code><br>            2. é™æ€å¸¸é‡ã€é™æ€å˜é‡<br>                1. ä½¿ç”¨  <code>ç±»å.secret</code><br>        2. æ–¹æ³•<br>            1. å®ä¾‹æ–¹æ³•<br>                1. ä½¿ç”¨ <code>new Outer() </code>å’Œ <code>outer.run()</code><br>            2. é™æ€æ–¹æ³•<br>                1. ä½¿ç”¨ <code>ç±»å.run()</code><br>        3. å†…éƒ¨ç±»<br>            1. å®ä¾‹å†…éƒ¨ç±»<br>                1. åˆ›å»ºå®ä¾‹æ—¶ä½¿ç”¨ <code>new Outer() </code>å’Œ <code>outer.new Inner()</code><br>            2. é™æ€å†…éƒ¨ç±»<br>                1. åˆ›å»ºå®ä¾‹æ—¶ä½¿ç”¨ <code>new ç±»å.Inner()</code></p></blockquote><hr><h2 id="2-é›†åˆ"><a href="#2-é›†åˆ" class="headerlink" title="2. é›†åˆ"></a>2. é›†åˆ</h2><h3 id="2-1-Setï¼œEï¼"><a href="#2-1-Setï¼œEï¼" class="headerlink" title="2.1. Setï¼œEï¼"></a>2.1. Setï¼œEï¼</h3><h4 id="2-1-1-Setï¼œEï¼-åŸºç¡€ä½“ç³»"><a href="#2-1-1-Setï¼œEï¼-åŸºç¡€ä½“ç³»" class="headerlink" title="2.1.1. Setï¼œEï¼ åŸºç¡€ä½“ç³»"></a>2.1.1. Setï¼œEï¼ åŸºç¡€ä½“ç³»</h4><p><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B-3.png"></p><ol><li>è¯¦è§æºç ï¼š<code>Serializable</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.io.Serializable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.io.Serializableæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/10/28/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.io.Serializable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/10/28/æºç ï¼šjava.io.Serializableæºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>Cloneable</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.Cloneable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.lang.Cloneableæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/11/06/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.Cloneable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/06/æºç ï¼šjava.lang.Cloneableæºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>Iterableï¼œEï¼</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<br> 1. <a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.Iterable%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.lang.Iterableï¼œTï¼æºç è§£æ</a></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/08/25/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.Iterable%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/08/25/æºç ï¼šjava.lang.Iterableï¼œTï¼æºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>Collectionï¼œEï¼</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.Collection%EF%BC%9CE%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.Collectionï¼œEï¼æºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/08/25/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.Collection%EF%BC%9CE%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/08/25/æºç ï¼šjava.util.Collectionï¼œEï¼æºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>Setï¼œEï¼</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.Set%EF%BC%9CE%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.Setï¼œEï¼æºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/12/01/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.Set%EF%BC%9CE%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/12/01/æºç ï¼šjava.util.Setï¼œEï¼æºç è§£æ/</a></li></ol></li></ol></li></ol><hr><h4 id="2-1-2-Setï¼œEï¼-ç›¸å…³åˆ†ç±»"><a href="#2-1-2-Setï¼œEï¼-ç›¸å…³åˆ†ç±»" class="headerlink" title="2.1.2. Setï¼œEï¼ ç›¸å…³åˆ†ç±»"></a>2.1.2. Setï¼œEï¼ ç›¸å…³åˆ†ç±»</h4><ol><li><code>TreeSetï¼œEï¼</code></li><li><code>HashSetï¼œEï¼</code></li><li><code>EnumSetï¼œEï¼</code></li><li><code>LinkedHashSetï¼œEï¼</code></li><li><code>CopyOnWriteArraySetï¼œEï¼</code></li><li><code>ConcurrentSkipListSetï¼œEï¼</code></li><li><code>ConcurrentHashMapï¼œK, Vï¼.KeySetView&lt;K,V&gt;</code></li></ol><h4 id="2-1-3-TreeSetï¼œEï¼"><a href="#2-1-3-TreeSetï¼œEï¼" class="headerlink" title="2.1.3. TreeSetï¼œEï¼"></a>2.1.3. TreeSetï¼œEï¼</h4><h5 id="2-1-3-1-TreeSetï¼œEï¼-ä½“ç³»ç»“æ„"><a href="#2-1-3-1-TreeSetï¼œEï¼-ä½“ç³»ç»“æ„" class="headerlink" title="2.1.3.1. TreeSetï¼œEï¼ ä½“ç³»ç»“æ„"></a>2.1.3.1. TreeSetï¼œEï¼ ä½“ç³»ç»“æ„</h5><p><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B-5.png"></p><hr><h5 id="2-1-3-2-TreeSetï¼œEï¼-åº•å±‚å®ç°"><a href="#2-1-3-2-TreeSetï¼œEï¼-åº•å±‚å®ç°" class="headerlink" title="2.1.3.2. TreeSetï¼œEï¼ åº•å±‚å®ç°"></a>2.1.3.2. TreeSetï¼œEï¼ åº•å±‚å®ç°</h5><p><code>TreeSetï¼œEï¼</code> åº•å±‚æ˜¯åŸºäºä¸€ä¸ª <code>TreeMapï¼œK, Vï¼</code> å®ç°çš„</p><p><code>TreeSetï¼œEï¼</code> æ˜¯é€šè¿‡ <code>TreeSetï¼œEï¼â”m</code> å­˜å‚¨æ•°æ®çš„ï¼Œè€Œå®ƒåˆæ˜¯ <code>NavigableMapï¼œK, Vï¼</code> ç±»å‹ï¼ˆå®é™…åˆå§‹åŒ–æ—¶å°±æ˜¯ä¸€ä¸ª <code>TreeMapï¼œK, Vï¼</code>ï¼‰</p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>è™½ç„¶è¯´ <code>TreeSetï¼œEï¼</code> åº•å±‚æ˜¯åŸºäº <code>TreeMapï¼œK, Vï¼</code> å®ç°çš„ï¼Œä½†æ˜¯åªä½¿ç”¨äº† <code>TreeMapï¼œK, Vï¼</code> çš„ <code>Key</code> æ¥å­˜å‚¨æ•°æ®</li><li>ç”±äº <code>TreeSetï¼œEï¼</code> åº•å±‚æ˜¯åŸºäº <code>TreeMapï¼œK, Vï¼</code> å®ç°çš„ï¼Œæ‰€ä»¥ <code>TreeSetï¼œEï¼</code> èƒ½å¤Ÿè‡ªåŠ¨å¯¹å…ƒç´ è¿›è¡Œæ’åºï¼ˆè‡ªç„¶æ’åºã€å®šåˆ¶æ’åºï¼‰</li></ol></blockquote><hr><h5 id="2-1-3-3-TreeSetï¼œEï¼-é—®é¢˜çˆ†ç ´"><a href="#2-1-3-3-TreeSetï¼œEï¼-é—®é¢˜çˆ†ç ´" class="headerlink" title="2.1.3.3. TreeSetï¼œEï¼ é—®é¢˜çˆ†ç ´"></a>2.1.3.3. TreeSetï¼œEï¼ é—®é¢˜çˆ†ç ´</h5><p>ç”±äº<code>TreeSetï¼œEï¼</code> åº•å±‚æ˜¯åŸºäºä¸€ä¸ª <code>TreeMapï¼œK, Vï¼</code> å®ç°çš„ï¼Œæ‰€ä»¥ <code>TreeMapï¼œK, Vï¼</code> æ‹¥æœ‰çš„é—®é¢˜ï¼Œ<code>TreeSetï¼œEï¼</code> ä¸€èˆ¬éƒ½æœ‰ã€‚è¯¦è§ä¸‹æ–‡ï¼š<code>TreeMapï¼œK, Vï¼</code></p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>è™½ç„¶è¯´ <code>TreeSetï¼œEï¼</code> åº•å±‚æ˜¯åŸºäº <code>TreeMapï¼œK, Vï¼</code> å®ç°çš„ï¼Œä½†æ˜¯åªä½¿ç”¨äº† <code>TreeMapï¼œK, Vï¼</code> çš„ <code>Key</code> æ¥å­˜å‚¨æ•°æ®ã€‚æ‰€ä»¥æˆ‘ä»¬ç€é‡çœ‹ <code>TreeMapï¼œK, Vï¼</code> çš„ <code>Key</code></li><li>ä¸ºäº†è§£å†³ <code>TreeSetï¼œEï¼</code> å¤šçº¿ç¨‹å¹¶å‘å®‰å…¨æ€§é—®é¢˜ï¼Œæˆ‘ä»¬é€šå¸¸ä¸ºå…¶åŠ é”æˆ–è€…ä½¿ç”¨å¦å¤–ä¸€ç§æ•°æ®ç»“æ„ï¼š<code>ConcurrentSkipListSetï¼œEï¼</code></li></ol></blockquote><hr><h4 id="2-1-4-HashSetï¼œEï¼"><a href="#2-1-4-HashSetï¼œEï¼" class="headerlink" title="2.1.4. HashSetï¼œEï¼"></a>2.1.4. HashSetï¼œEï¼</h4><h5 id="2-1-4-1-HashSetï¼œEï¼-ä½“ç³»ç»“æ„"><a href="#2-1-4-1-HashSetï¼œEï¼-ä½“ç³»ç»“æ„" class="headerlink" title="2.1.4.1. HashSetï¼œEï¼ ä½“ç³»ç»“æ„"></a>2.1.4.1. HashSetï¼œEï¼ ä½“ç³»ç»“æ„</h5><p><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B-6.png"></p><hr><h5 id="2-1-4-2-HashSetï¼œEï¼-åº•å±‚å®ç°"><a href="#2-1-4-2-HashSetï¼œEï¼-åº•å±‚å®ç°" class="headerlink" title="2.1.4.2. HashSetï¼œEï¼ åº•å±‚å®ç°"></a>2.1.4.2. HashSetï¼œEï¼ åº•å±‚å®ç°</h5><p><code>HashSetï¼œEï¼</code> åº•å±‚æ˜¯åŸºäºä¸€ä¸ª <code>HashMapï¼œK, Vï¼</code> å®ç°çš„</p><p><code>HashSetï¼œEï¼</code> æ˜¯é€šè¿‡ <code>HashSetï¼œEï¼â”map</code> å­˜å‚¨æ•°æ®çš„ï¼Œè€Œå®ƒåˆæ˜¯ <code>HashMapï¼œK, Vï¼</code> ç±»å‹</p><hr><h5 id="2-1-4-3-HashSetï¼œEï¼-é—®é¢˜çˆ†ç ´"><a href="#2-1-4-3-HashSetï¼œEï¼-é—®é¢˜çˆ†ç ´" class="headerlink" title="2.1.4.3. HashSetï¼œEï¼ é—®é¢˜çˆ†ç ´"></a>2.1.4.3. HashSetï¼œEï¼ é—®é¢˜çˆ†ç ´</h5><p>ç”±äº<code>HashSetï¼œEï¼</code> åº•å±‚æ˜¯åŸºäºä¸€ä¸ª <code>HashMapï¼œK, Vï¼</code> å®ç°çš„ï¼Œæ‰€ä»¥ <code>HashMapï¼œK, Vï¼</code> æ‹¥æœ‰çš„é—®é¢˜ï¼Œ<code>HashSetï¼œEï¼</code> ä¸€èˆ¬éƒ½æœ‰ã€‚è¯¦è§ä¸‹æ–‡ï¼š<code>HashMapï¼œK, Vï¼</code></p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>è™½ç„¶è¯´ <code>HashSetï¼œEï¼</code> åº•å±‚æ˜¯åŸºäº <code>HashMapï¼œK, Vï¼</code> å®ç°çš„ï¼Œä½†æ˜¯åªä½¿ç”¨äº† <code>HashMapï¼œK, Vï¼</code> çš„ <code>Key</code> æ¥å­˜å‚¨æ•°æ®ã€‚æ‰€ä»¥æˆ‘ä»¬ç€é‡çœ‹ <code>HashMapï¼œK, Vï¼</code> çš„ <code>Key</code></li><li>ä¸ºäº†è§£å†³ <code>HashSetï¼œEï¼</code> å¤šçº¿ç¨‹å¹¶å‘å®‰å…¨æ€§é—®é¢˜ï¼Œæˆ‘ä»¬é€šå¸¸ä¸ºå…¶åŠ é”æˆ–è€…ä½¿ç”¨å¦å¤–ä¸€ç§æ•°æ®ç»“æ„ï¼š<code>ConcurrentHashMapï¼œK, Vï¼.KeySetView&lt;K,V&gt;</code></li></ol></blockquote><hr><h4 id="2-1-5-LinkedHashSetï¼œEï¼"><a href="#2-1-5-LinkedHashSetï¼œEï¼" class="headerlink" title="2.1.5. LinkedHashSetï¼œEï¼"></a>2.1.5. LinkedHashSetï¼œEï¼</h4><h5 id="2-1-5-1-LinkedHashSetï¼œEï¼-ä½“ç³»ç»“æ„"><a href="#2-1-5-1-LinkedHashSetï¼œEï¼-ä½“ç³»ç»“æ„" class="headerlink" title="2.1.5.1. LinkedHashSetï¼œEï¼ ä½“ç³»ç»“æ„"></a>2.1.5.1. LinkedHashSetï¼œEï¼ ä½“ç³»ç»“æ„</h5><p><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B-27.png"></p><hr><h5 id="2-1-5-2-LinkedHashSetï¼œEï¼-åº•å±‚å®ç°"><a href="#2-1-5-2-LinkedHashSetï¼œEï¼-åº•å±‚å®ç°" class="headerlink" title="2.1.5.2. LinkedHashSetï¼œEï¼ åº•å±‚å®ç°"></a>2.1.5.2. LinkedHashSetï¼œEï¼ åº•å±‚å®ç°</h5><p><code>LinkedHashSetï¼œEï¼</code> åº•å±‚æ˜¯åŸºäºä¸€ä¸ª <code>LinkedHashMapï¼œK, Vï¼</code> å®ç°çš„</p><p><code>LinkedHashSetï¼œEï¼</code> æ˜¯é€šè¿‡çˆ¶ç±»çš„ <code>HashSetï¼œEï¼-&gt;map</code> æ¥å­˜å‚¨æ•°æ®çš„ï¼Œè€Œå®ƒåˆæ˜¯ <code>HashMapï¼œK, Vï¼</code> ç±»å‹ï¼ˆå®é™…åˆå§‹åŒ–æ—¶å°±æ˜¯ä¸€ä¸ª <code>LinkedHashMapï¼œK, Vï¼</code>ï¼‰</p><hr><h5 id="2-1-5-3-LinkedHashSetï¼œEï¼-é—®é¢˜çˆ†ç ´"><a href="#2-1-5-3-LinkedHashSetï¼œEï¼-é—®é¢˜çˆ†ç ´" class="headerlink" title="2.1.5.3. LinkedHashSetï¼œEï¼ é—®é¢˜çˆ†ç ´"></a>2.1.5.3. LinkedHashSetï¼œEï¼ é—®é¢˜çˆ†ç ´</h5><p>ç”±äº<code>LinkedHashSetï¼œEï¼</code> åº•å±‚æ˜¯åŸºäºä¸€ä¸ª <code>LinkedHashMapï¼œK, Vï¼</code> å®ç°çš„ï¼Œæ‰€ä»¥ <code>LinkedHashMapï¼œK, Vï¼</code> æ‹¥æœ‰çš„é—®é¢˜ï¼Œ<code>LinkedHashSetï¼œEï¼</code> ä¸€èˆ¬éƒ½æœ‰ã€‚è¯¦è§ä¸‹æ–‡ï¼š<code>LinkedHashMapï¼œK, Vï¼</code></p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>è™½ç„¶è¯´ <code>LinkedHashSetï¼œEï¼</code> åº•å±‚æ˜¯åŸºäº <code>LinkedHashMapï¼œK, Vï¼</code> å®ç°çš„ï¼Œä½†æ˜¯åªä½¿ç”¨äº† <code>LinkedHashMapï¼œK, Vï¼</code> çš„ <code>Key</code> æ¥å­˜å‚¨æ•°æ®ã€‚æ‰€ä»¥æˆ‘ä»¬ç€é‡çœ‹ <code>LinkedHashMapï¼œK, Vï¼</code> çš„ <code>Key</code></li><li>ä¸ºäº†è§£å†³ <code>LinkedHashSetï¼œEï¼</code> å¤šçº¿ç¨‹å¹¶å‘å®‰å…¨æ€§é—®é¢˜ï¼Œæˆ‘ä»¬é€šå¸¸ä¸ºå…¶åŠ é”</li></ol></blockquote><hr><h4 id="2-1-6-CopyOnWriteArraySetï¼œEï¼"><a href="#2-1-6-CopyOnWriteArraySetï¼œEï¼" class="headerlink" title="2.1.6. CopyOnWriteArraySetï¼œEï¼"></a>2.1.6. CopyOnWriteArraySetï¼œEï¼</h4><h5 id="2-1-6-1-CopyOnWriteArraySetï¼œEï¼-ä½“ç³»ç»“æ„"><a href="#2-1-6-1-CopyOnWriteArraySetï¼œEï¼-ä½“ç³»ç»“æ„" class="headerlink" title="2.1.6.1. CopyOnWriteArraySetï¼œEï¼ ä½“ç³»ç»“æ„"></a>2.1.6.1. CopyOnWriteArraySetï¼œEï¼ ä½“ç³»ç»“æ„</h5><p><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B-7.png"></p><hr><h5 id="2-1-6-2-CopyOnWriteArraySetï¼œEï¼-åº•å±‚å®ç°"><a href="#2-1-6-2-CopyOnWriteArraySetï¼œEï¼-åº•å±‚å®ç°" class="headerlink" title="2.1.6.2. CopyOnWriteArraySetï¼œEï¼ åº•å±‚å®ç°"></a>2.1.6.2. CopyOnWriteArraySetï¼œEï¼ åº•å±‚å®ç°</h5><p><code>CopyOnWriteArraySetï¼œEï¼</code> åº•å±‚æ˜¯åŸºäºä¸€ä¸ª <code>CopyOnWriteArrayListï¼œEï¼</code> å®ç°çš„</p><p><code>CopyOnWriteArraySetï¼œEï¼</code> æ˜¯é€šè¿‡ <code>CopyOnWriteArraySetï¼œEï¼â”al</code> å­˜å‚¨æ•°æ®çš„ï¼Œè€Œå®ƒåˆæ˜¯ <code>CopyOnWriteArrayListï¼œEï¼</code> ç±»å‹</p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li><code>CopyOnWriteArraySetï¼œEï¼</code> æœ¬è´¨ä¸Šå°±æ˜¯ <code>CopyOnWriteArrayListï¼œEï¼</code> çš„ä¸€ä¸ªè£…é¥°å™¨ï¼Œå®ƒæ‰€æœ‰çš„æ“ä½œæœ€ç»ˆéƒ½æ˜¯å§”æ‰˜ç»™  <code>CopyOnWriteArrayListï¼œEï¼</code> å»æ‰§è¡Œçš„ï¼Œåªä¸è¿‡åœ¨ â€œå¢â€ æ“ä½œçš„æ—¶å€™å¤šåšäº†ä¸€ä¸ª â€œå»é‡â€ æ“ä½œã€‚å³åœ¨ â€œå¢â€ æ“ä½œæ—¶ï¼Œä¼šå…ˆéå†æ•´ä¸ªæ•°ç»„ï¼Œå‘ç°è¯¥å…ƒç´ ä¸å­˜åœ¨åï¼Œå†åˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„ï¼Œå¹¶åœ¨è¿™ä¸ªæ–°æ•°ç»„ä¸Šæ‰§è¡Œ â€œå†™â€ æ“ä½œ</li></ol></blockquote><hr><h5 id="2-1-6-3-CopyOnWriteArraySetï¼œEï¼-é—®é¢˜çˆ†ç ´"><a href="#2-1-6-3-CopyOnWriteArraySetï¼œEï¼-é—®é¢˜çˆ†ç ´" class="headerlink" title="2.1.6.3. CopyOnWriteArraySetï¼œEï¼ é—®é¢˜çˆ†ç ´"></a>2.1.6.3. CopyOnWriteArraySetï¼œEï¼ é—®é¢˜çˆ†ç ´</h5><p>ç”±äº<code>CopyOnWriteArraySetï¼œEï¼</code> åº•å±‚æ˜¯åŸºäºä¸€ä¸ª <code>CopyOnWriteArrayListï¼œK, Vï¼</code> å®ç°çš„ï¼Œæ‰€ä»¥ <code>CopyOnWriteArrayListï¼œK, Vï¼</code> æ‹¥æœ‰çš„é—®é¢˜ï¼Œ<code>CopyOnWriteArraySetï¼œEï¼</code> ä¸€èˆ¬éƒ½æœ‰ã€‚è¯¦è§ä¸Šæ–‡ï¼š<code>CopyOnWriteArrayListï¼œK, Vï¼</code></p><hr><h4 id="2-1-7-ConcurrentSkipListSetï¼œEï¼"><a href="#2-1-7-ConcurrentSkipListSetï¼œEï¼" class="headerlink" title="2.1.7. ConcurrentSkipListSetï¼œEï¼"></a>2.1.7. ConcurrentSkipListSetï¼œEï¼</h4><h5 id="2-1-7-1-ConcurrentSkipListSetï¼œEï¼-ä½“ç³»ç»“æ„"><a href="#2-1-7-1-ConcurrentSkipListSetï¼œEï¼-ä½“ç³»ç»“æ„" class="headerlink" title="2.1.7.1. ConcurrentSkipListSetï¼œEï¼ ä½“ç³»ç»“æ„"></a>2.1.7.1. ConcurrentSkipListSetï¼œEï¼ ä½“ç³»ç»“æ„</h5><p><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B-28.png"></p><hr><h5 id="2-1-7-2-ConcurrentSkipListSetï¼œEï¼-åº•å±‚å®ç°"><a href="#2-1-7-2-ConcurrentSkipListSetï¼œEï¼-åº•å±‚å®ç°" class="headerlink" title="2.1.7.2. ConcurrentSkipListSetï¼œEï¼ åº•å±‚å®ç°"></a>2.1.7.2. ConcurrentSkipListSetï¼œEï¼ åº•å±‚å®ç°</h5><p><code>ConcurrentSkipListSetï¼œEï¼</code> åº•å±‚æ˜¯åŸºäºä¸€ä¸ª <code>ConcurrentSkipListMapï¼œK, Vï¼</code> å®ç°çš„</p><p><code>ConcurrentSkipListSetï¼œEï¼</code> æ˜¯é€šè¿‡ <code>ConcurrentSkipListSetï¼œEï¼â”m</code> å­˜å‚¨æ•°æ®çš„ï¼Œè€Œå®ƒåˆæ˜¯ <code>ConcurrentNavigableMapï¼œK, Vï¼</code> ç±»å‹ï¼ˆå®é™…åˆå§‹åŒ–æ—¶å°±æ˜¯ä¸€ä¸ª <code>ConcurrentSkipListMapï¼œK, Vï¼</code>ï¼‰</p><hr><h5 id="2-1-7-3-ConcurrentSkipListSetï¼œEï¼-é—®é¢˜çˆ†ç ´"><a href="#2-1-7-3-ConcurrentSkipListSetï¼œEï¼-é—®é¢˜çˆ†ç ´" class="headerlink" title="2.1.7.3. ConcurrentSkipListSetï¼œEï¼ é—®é¢˜çˆ†ç ´"></a>2.1.7.3. ConcurrentSkipListSetï¼œEï¼ é—®é¢˜çˆ†ç ´</h5><p>ç”±äº<code>ConcurrentSkipListSetï¼œEï¼</code> åº•å±‚æ˜¯åŸºäºä¸€ä¸ª <code>ConcurrentSkipListMapï¼œK, Vï¼</code> å®ç°çš„ï¼Œæ‰€ä»¥ <code>ConcurrentSkipListMapï¼œK, Vï¼</code> æ‹¥æœ‰çš„é—®é¢˜ï¼Œ<code>ConcurrentSkipListSetï¼œEï¼</code> ä¸€èˆ¬éƒ½æœ‰ã€‚è¯¦è§ä¸‹æ–‡ï¼š<code>ConcurrentSkipListMapï¼œK, Vï¼</code></p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>è™½ç„¶è¯´ <code>ConcurrentSkipListSetï¼œEï¼</code> åº•å±‚æ˜¯åŸºäº <code>ConcurrentSkipListMapï¼œK, Vï¼</code> å®ç°çš„ï¼Œä½†æ˜¯åªä½¿ç”¨äº† <code>ConcurrentSkipListMapï¼œK, Vï¼</code> çš„ <code>Key</code> æ¥å­˜å‚¨æ•°æ®ã€‚æ‰€ä»¥æˆ‘ä»¬ç€é‡çœ‹ <code>ConcurrentSkipListMapï¼œK, Vï¼</code> çš„ <code>Key</code></li></ol></blockquote><hr><h4 id="2-1-8-ConcurrentHashMapï¼œK-Vï¼-KeySetView"><a href="#2-1-8-ConcurrentHashMapï¼œK-Vï¼-KeySetView" class="headerlink" title="2.1.8. ConcurrentHashMapï¼œK, Vï¼.KeySetView&lt;K,V&gt;"></a>2.1.8. ConcurrentHashMapï¼œK, Vï¼.KeySetView&lt;K,V&gt;</h4><h5 id="2-1-8-1-ConcurrentHashMapï¼œK-Vï¼-KeySetView-ä½“ç³»ç»“æ„"><a href="#2-1-8-1-ConcurrentHashMapï¼œK-Vï¼-KeySetView-ä½“ç³»ç»“æ„" class="headerlink" title="2.1.8.1. ConcurrentHashMapï¼œK, Vï¼.KeySetView&lt;K,V&gt; ä½“ç³»ç»“æ„"></a>2.1.8.1. ConcurrentHashMapï¼œK, Vï¼.KeySetView&lt;K,V&gt; ä½“ç³»ç»“æ„</h5><p><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B-29.png"></p><hr><h5 id="2-1-8-2-ConcurrentHashMapï¼œK-Vï¼-KeySetView-åº•å±‚å®ç°"><a href="#2-1-8-2-ConcurrentHashMapï¼œK-Vï¼-KeySetView-åº•å±‚å®ç°" class="headerlink" title="2.1.8.2. ConcurrentHashMapï¼œK, Vï¼.KeySetView&lt;K,V&gt; åº•å±‚å®ç°"></a>2.1.8.2. ConcurrentHashMapï¼œK, Vï¼.KeySetView&lt;K,V&gt; åº•å±‚å®ç°</h5><p><code>ConcurrentHashMapï¼œK, Vï¼.KeySetViewï¼œK, Vï¼</code> åº•å±‚æ˜¯åŸºäºä¸€ä¸ª <code>ConcurrentHashMapï¼œK, Vï¼</code> å®ç°çš„</p><p><code>ConcurrentHashMapï¼œK, Vï¼.KeySetView&lt;K,V&gt;</code> æ˜¯é€šè¿‡çˆ¶ç±»çš„ <code>CollectionViewï¼œK, V, Eï¼-&gt;map</code> æ¥å­˜å‚¨æ•°æ®çš„ï¼Œè€Œå®ƒåˆæ˜¯ <code>ConcurrentHashMapï¼œK, Vï¼</code> ç±»å‹</p><hr><h5 id="2-1-8-3-ConcurrentHashMapï¼œK-Vï¼-KeySetView-é—®é¢˜çˆ†ç ´"><a href="#2-1-8-3-ConcurrentHashMapï¼œK-Vï¼-KeySetView-é—®é¢˜çˆ†ç ´" class="headerlink" title="2.1.8.3. ConcurrentHashMapï¼œK, Vï¼.KeySetView&lt;K,V&gt; é—®é¢˜çˆ†ç ´"></a>2.1.8.3. ConcurrentHashMapï¼œK, Vï¼.KeySetView&lt;K,V&gt; é—®é¢˜çˆ†ç ´</h5><p>ç”±äº <code>ConcurrentHashMapï¼œK, Vï¼.KeySetViewï¼œK, Vï¼</code> åº•å±‚æ˜¯åŸºäºä¸€ä¸ª <code>ConcurrentHashMapï¼œK, Vï¼</code> å®ç°çš„ï¼Œæ‰€ä»¥ <code>ConcurrentHashMapï¼œK, Vï¼</code> æ‹¥æœ‰çš„é—®é¢˜ï¼Œ<code>ConcurrentHashMapï¼œK, Vï¼.KeySetViewï¼œK, Vï¼</code> ä¸€èˆ¬éƒ½æœ‰ã€‚è¯¦è§ä¸‹æ–‡ï¼š<code>ConcurrentHashMapï¼œK, Vï¼</code></p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>è™½ç„¶è¯´ <code>ConcurrentHashMapï¼œK, Vï¼.KeySetViewï¼œK, Vï¼</code> åº•å±‚æ˜¯åŸºäº <code>ConcurrentHashMapï¼œK, Vï¼</code> å®ç°çš„ï¼Œä½†æ˜¯åªä½¿ç”¨äº† <code>ConcurrentHashMapï¼œK, Vï¼</code> çš„ <code>Key</code> æ¥å­˜å‚¨æ•°æ®ã€‚æ‰€ä»¥æˆ‘ä»¬ç€é‡çœ‹ <code>ConcurrentHashMapï¼œK, Vï¼</code> çš„ <code>Key</code></li></ol></blockquote><hr><h3 id="2-2-Listï¼œEï¼"><a href="#2-2-Listï¼œEï¼" class="headerlink" title="2.2. Listï¼œEï¼"></a>2.2. Listï¼œEï¼</h3><h4 id="2-2-1-Listï¼œEï¼-åŸºç¡€ä½“ç³»"><a href="#2-2-1-Listï¼œEï¼-åŸºç¡€ä½“ç³»" class="headerlink" title="2.2.1. Listï¼œEï¼ åŸºç¡€ä½“ç³»"></a>2.2.1. Listï¼œEï¼ åŸºç¡€ä½“ç³»</h4><p><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B-4.png"></p><ol><li>è¯¦è§æºç ï¼š<code>Serializable</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.io.Serializable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.io.Serializableæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/10/28/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.io.Serializable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/10/28/æºç ï¼šjava.io.Serializableæºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>Cloneable</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.Cloneable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.lang.Cloneableæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/11/06/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.Cloneable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/06/æºç ï¼šjava.lang.Cloneableæºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>RandomAccess</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.RandomAccess%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.RandomAccessæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/11/30/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.RandomAccess%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/30/æºç ï¼šjava.util.RandomAccessæºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>Iterableï¼œEï¼</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<br> 1. <a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.Iterable%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.lang.Iterableï¼œTï¼æºç è§£æ</a></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/08/25/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.Iterable%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/08/25/æºç ï¼šjava.lang.Iterableï¼œTï¼æºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>Collectionï¼œEï¼</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.Collection%EF%BC%9CE%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.Collectionï¼œEï¼æºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/08/25/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.Collection%EF%BC%9CE%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/08/25/æºç ï¼šjava.util.Collectionï¼œEï¼æºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>Listï¼œEï¼</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.List%EF%BC%9CE%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.Listï¼œEï¼æºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/12/01/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.io.Serializable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/12/01/æºç ï¼šjava.io.Serializableæºç è§£æ/</a></li></ol></li></ol></li></ol><hr><h4 id="2-2-2-Listï¼œEï¼-ç›¸å…³åˆ†ç±»"><a href="#2-2-2-Listï¼œEï¼-ç›¸å…³åˆ†ç±»" class="headerlink" title="2.2.2. Listï¼œEï¼ ç›¸å…³åˆ†ç±»"></a>2.2.2. Listï¼œEï¼ ç›¸å…³åˆ†ç±»</h4><ol><li><code>ArrayListï¼œEï¼</code></li><li><code>LinkedListï¼œEï¼</code></li><li><code>CopyOnWriteArrayListï¼œEï¼</code></li></ol><table><thead><tr><th>ç‰¹æ€§</th><th>ArrayListï¼œEï¼</th><th>LinkedListï¼œEï¼</th><th>CopyOnWriteArrayListï¼œEï¼</th></tr></thead><tbody><tr><td><strong>é¡ºåºæ€§</strong></td><td>âœ…ï¼ˆ<code>FIFO</code> é¡ºåºï¼Œå¯æ‰‹åŠ¨æ’åºï¼‰</td><td>âœ…ï¼ˆ<code>FIFO</code> é¡ºåºã€<code>LIFO</code> é¡ºåºï¼Œå¯æ‰‹åŠ¨æ’åºï¼‰</td><td>âœ…ï¼ˆ<code>FIFO </code>é¡ºåºã€å¯æ‰‹åŠ¨æ’åºï¼‰</td></tr><tr><td><strong>æœ‰ç•Œæ€§</strong></td><td>âŒï¼ˆéœ€è¦æ‰©å®¹ï¼‰</td><td>â€”</td><td>âŒï¼ˆéœ€è¦æ‰©å®¹ï¼‰</td></tr><tr><td><strong>æ”¯æŒæ‰©å®¹</strong></td><td>âœ…</td><td>â€”</td><td>âœ…</td></tr><tr><td><strong>åº•å±‚å®ç°</strong></td><td>ä¸€ä¸ªæ•°ç»„</td><td>ä¸€æ¡åŒå‘é“¾è¡¨</td><td>1. <code>Java11</code> ä¹‹å‰ï¼šä¸€ä¸ªæ•°ç»„ + ä¸€ä¸ª <code>ReentrantLock</code>ï¼ˆæ— æ¡ä»¶é˜Ÿåˆ—ï¼‰<br>2. <code>Java11</code> ä¹‹åï¼šä¸€ä¸ªæ•°ç»„ + <code>synchronized</code></td></tr><tr><td><strong>å…è®¸å…ƒç´ é‡å¤</strong></td><td>âœ…</td><td>âœ…</td><td>âœ…</td></tr><tr><td><strong>å…è®¸å…ƒç´ ä¸º null</strong></td><td>âœ…</td><td>âœ…</td><td>âœ…</td></tr><tr><td><strong>å¤šçº¿ç¨‹å¹¶å‘å®‰å…¨æ€§</strong></td><td>âŒ</td><td>âŒ</td><td>âœ…</td></tr></tbody></table><hr><h4 id="2-2-3-ArrayListï¼œEï¼"><a href="#2-2-3-ArrayListï¼œEï¼" class="headerlink" title="2.2.3. ArrayListï¼œEï¼"></a>2.2.3. ArrayListï¼œEï¼</h4><h5 id="2-2-3-1-ArrayListï¼œEï¼-ä½“ç³»ç»“æ„"><a href="#2-2-3-1-ArrayListï¼œEï¼-ä½“ç³»ç»“æ„" class="headerlink" title="2.2.3.1. ArrayListï¼œEï¼ ä½“ç³»ç»“æ„"></a>2.2.3.1. ArrayListï¼œEï¼ ä½“ç³»ç»“æ„</h5><p><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B.png"></p><hr><h5 id="2-2-3-2-ArrayListï¼œEï¼-åº•å±‚å®ç°"><a href="#2-2-3-2-ArrayListï¼œEï¼-åº•å±‚å®ç°" class="headerlink" title="2.2.3.2. ArrayListï¼œEï¼ åº•å±‚å®ç°"></a>2.2.3.2. ArrayListï¼œEï¼ åº•å±‚å®ç°</h5><p><code>ArrayListï¼œEï¼</code> åº•å±‚æ˜¯åŸºäºä¸€ä¸ªæ•°ç»„å®ç°çš„</p><p><code>ArrayListï¼œEï¼</code> æ˜¯é€šè¿‡ <code>ArrayListï¼œEï¼-&gt;elementData</code> å­˜å‚¨æ•°æ®çš„ï¼Œè€Œå®ƒåˆæ˜¯ä¸€ä¸ªç”± <code>Object</code> æ„å»ºçš„æ•°ç»„</p><hr><h5 id="2-2-3-3-ArrayListï¼œEï¼-æ‰©å®¹æœºåˆ¶"><a href="#2-2-3-3-ArrayListï¼œEï¼-æ‰©å®¹æœºåˆ¶" class="headerlink" title="2.2.3.3. ArrayListï¼œEï¼ æ‰©å®¹æœºåˆ¶"></a>2.2.3.3. ArrayListï¼œEï¼ æ‰©å®¹æœºåˆ¶</h5><p>åœ¨ <code>Java8</code> ä¹‹åï¼Œ<code>ArrayListï¼œEï¼</code> é‡‡ç”¨äº†æ‡’åŠ è½½ç­–ç•¥ã€‚å¦‚æœæˆ‘ä»¬ä½¿ç”¨æ— å‚æ„é€ æ–¹æ³•åˆ›å»º <code>ArrayListï¼œEï¼</code> å®ä¾‹ï¼Œåº•å±‚æ•°ç»„å…¶å®æ˜¯ä¸€ä¸ªç©ºæ•°ç»„ï¼Œåªæœ‰åœ¨ç¬¬ä¸€æ¬¡æ‰§è¡Œ â€œå¢â€ æ“ä½œæ—¶æ‰ä¼šçœŸæ­£åˆ†é…å†…å­˜ç©ºé—´</p><p>å½“æ•°ç»„å·²æ»¡æ—¶å°±ä¼šè§¦å‘æ‰©å®¹ï¼ˆæ•°ç»„å·²æ»¡åï¼Œåœ¨ä¸‹ä¸€æ¬¡ â€œå¢â€ æ“ä½œæ—¶å…ˆæ‰©å®¹å† â€œå¢â€ å…ƒç´ ï¼‰ã€‚<code>ArrayListï¼œEï¼</code> æ‰©å®¹æ—¶ä¼šåˆ›å»ºä¸€ä¸ªå®¹é‡ä¸ºåŸæ¥ <code>1.5</code> å€çš„æ–°æ•°ç»„ï¼Œå¹¶è°ƒç”¨ <code>Arrays#copyOf</code> å°†æ—§æ•°ç»„ä¸­çš„å…ƒç´ æ‹·è´åˆ°æ–°æ•°ç»„ä¸­ï¼ˆè¿™é‡Œå¹¶ä¸æ˜¯éå†ï¼Œè€Œæ˜¯è°ƒç”¨äº† <code>native</code> æ–¹æ³•ï¼Œå®ç°æ•´ä¸ªå†…å­˜å—çš„æ‹·è´ï¼‰</p><hr><h5 id="2-2-3-4-ArrayListï¼œEï¼-é—®é¢˜çˆ†ç ´"><a href="#2-2-3-4-ArrayListï¼œEï¼-é—®é¢˜çˆ†ç ´" class="headerlink" title="2.2.3.4. ArrayListï¼œEï¼ é—®é¢˜çˆ†ç ´"></a>2.2.3.4. ArrayListï¼œEï¼ é—®é¢˜çˆ†ç ´</h5><h6 id="2-2-3-4-1-å…ƒç´ ç±»å‹é—®é¢˜"><a href="#2-2-3-4-1-å…ƒç´ ç±»å‹é—®é¢˜" class="headerlink" title="2.2.3.4.1. å…ƒç´ ç±»å‹é—®é¢˜"></a>2.2.3.4.1. å…ƒç´ ç±»å‹é—®é¢˜</h6><p>ç”±äº<code>ArrayListï¼œEï¼</code> æ˜¯é€šè¿‡ <code>ArrayListï¼œEï¼-&gt;elementData</code> å­˜å‚¨æ•°æ®çš„ï¼Œè€Œå®ƒåˆæ˜¯ä¸€ä¸ªç”± <code>Object</code> æ„å»ºçš„æ•°ç»„ã€‚æ‰€ä»¥ <code>ArrayListï¼œEï¼</code> åªèƒ½å­˜å‚¨ <code>Object</code> ç±»å‹çš„å…ƒç´ </p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>çŒ´å“¥çš„çƒ¦æ¼ç®± <code>(ï½¡â€¢Ìï¸¿â€¢Ì€ï½¡)</code>ï¼š<ol><li>ä¸æ˜¯è¯´  <code>ArrayListï¼œEï¼</code> åªèƒ½å­˜å‚¨ <code>Object</code> ç±»å‹çš„å…ƒç´ å—ï¼Ÿä¸ºä»€ä¹ˆæˆ‘ä»¬è¿˜å¯ä»¥æ‰§è¡Œä¾‹å¦‚ <code>ArrayListï¼œEï¼.add(10)</code> çš„æ“ä½œï¼Ÿ<ol><li>å…¶å®è¿™å’Œ <code>ArrayListï¼œEï¼</code> æ²¡å¤šå¤§å…³ç³»ï¼Œè€Œæ˜¯æ¶‰åŠåˆ° <code>Java</code> åº”ç”¨ä¸­ä¸€ä¸ªé€šç”¨çš„æœºåˆ¶ï¼Œå³è£…ç®±æœºåˆ¶ï¼šåœ¨ç¼–è¯‘é˜¶æ®µï¼Œå¦‚æœç¼–è¯‘å™¨å‘ç°ä½ ä¼ å…¥çš„æ˜¯åŸºæœ¬æ•°æ®ç±»å‹çš„æ–¹æ³•å‚æ•°ï¼Œä½†æ˜¯æ–¹æ³•å‚æ•°è¦æ±‚çš„ç±»å‹æ˜¯å¼•ç”¨æ•°æ®ç±»å‹ï¼Œå°±ä¼šè§¦å‘è£…ç®±æœºåˆ¶ï¼ˆä¾‹å¦‚å°†è¿™ä¸ª <code>int</code> è£…ç®±ä¸º <code>Integer</code>ï¼‰</li><li>éœ€è¦æ³¨æ„çš„æ˜¯ï¼šè£…ç®±æœºåˆ¶ä»…é€‚ç”¨äºåŸºæœ¬æ•°æ®ç±»å‹</li></ol></li><li><code>Java</code> æ³›å‹æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ<ol><li><code>Java</code> æ³›å‹çš„å·¥ä½œæœºåˆ¶æ¶‰åŠåˆ°ç¼–è¯‘é˜¶æ®µçš„æ•°æ®ç±»å‹æ£€æŸ¥ä»¥åŠç±»å‹æ“¦é™¤</li><li>ç¼–è¯‘é˜¶æ®µçš„æ•°æ®ç±»å‹æ£€æŸ¥ï¼š<ol><li>å¦‚æœæˆ‘ä»¬æ­£å¸¸ä½¿ç”¨ç¼–è¯‘é˜¶æ®µçš„æ•°æ®ç±»å‹æ£€æŸ¥ï¼ˆä¾‹å¦‚ <code>List&lt;String&gt; myList = new ArrayList&lt;&gt;()</code>ï¼Œä½¿ç”¨ <code>Java</code> æ³›å‹çº¦æŸæ•°æ®ç±»å‹ï¼‰<ol><li>åœ¨ç¼–è¯‘é˜¶æ®µä¼šè¿›è¡Œæ•°æ®ç±»å‹æ£€æŸ¥ï¼Œå¦‚æœæ•°æ®ç±»å‹æ£€æŸ¥æœªé€šè¿‡ä¼šå¯¼è‡´ç¼–è¯‘å¤±è´¥ï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼šå¯¹äºåŸºæœ¬æ•°æ®ç±»å‹ï¼Œä¼šå…ˆå¯¹å…¶è¿›è¡Œè£…ç®±ï¼Œç„¶åå†å¯¹å…¶è¿›è¡Œæ•°æ®ç±»å‹æ£€æŸ¥ï¼‰</li><li>å¦‚æœæˆ‘ä»¬æƒ³ç»•è¿‡ç¼–è¯‘é˜¶æ®µçš„æ•°æ®ç±»å‹æ£€æŸ¥ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åå°„æœºåˆ¶æˆ– â€œèµ°åé—¨â€ çš„æ–¹å¼ï¼Œå¼ºè¡Œå°†ä¸é¢„æœŸä¸ç¬¦çš„ç±»å‹çš„å…ƒç´  â€œå¢â€ è¿›å»ã€‚è¿™äº›æ–¹æ³•å¹¶ä¸ä¼šå¯¼è‡´ç¼–è¯‘å¤±è´¥ï¼Œä½†æ˜¯å¯èƒ½ä¼šå› ä¸ºç±»å‹æ“¦é™¤è€Œå¯¼è‡´çš„æ•°æ®ç±»å‹è½¬æ¢ï¼Œåœ¨è°ƒç”¨è¿™äº›æ–¹æ³•æ—¶æŠ›å‡º <code>ClassCastException</code> éå—æ£€å¼‚å¸¸</li><li>æ‰€è°“çš„ â€œèµ°åé—¨â€ æ˜¯æŒ‡ï¼šä½ åŸæœ¬ <code>List&lt;String&gt; myList = new ArrayList&lt;&gt;()</code> çš„ <code>myList</code> æ­£å¸¸è¿›è¡Œç±»å‹æ£€æŸ¥çš„ã€‚ä½†æ˜¯å¦‚æœä½ å†  <code>List rawList = myList</code> çš„ <code>rawList</code> æ˜¯æ”¾å¼ƒç±»å‹æ£€æŸ¥çš„ã€‚ä½†æ˜¯ <code>rawList</code> å’Œ <code>myList</code> å®é™…ä¸ŠæŒ‡å‘åŒä¸€å—å†…å­˜åœ°å€ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>rawList</code>  â€œå¢â€ ä¸€äº›ä¸é¢„æœŸä¸ç¬¦çš„ç±»å‹çš„å…ƒç´ ï¼ˆè¿™æ˜¯ä¸€ä¸ªå†å²åŒ…è¢±ï¼‰</li></ol></li><li>å¦‚æœæˆ‘ä»¬æ”¾å¼ƒä½¿ç”¨ç¼–è¯‘é˜¶æ®µçš„æ•°æ®ç±»å‹æ£€æŸ¥ï¼ˆä¾‹å¦‚ <code>List myList = new ArrayList&lt;&gt;()</code>ï¼Œè™½ç„¶å®ƒæä¾›äº† <code>Java</code> æ³›å‹ï¼Œä½†æ˜¯æˆ‘ä»¬å¹¶æ²¡æœ‰æŒ‡å®šæ•°æ®ç±»å‹ï¼‰<ol><li>åœ¨ç¼–è¯‘é˜¶æ®µå¹¶ä¸ä¼šè¿›è¡Œæ•°æ®ç±»å‹æ£€æŸ¥</li></ol></li></ol></li><li>ç±»å‹æ“¦é™¤ï¼š<ol><li>æˆ‘ä»¬å¯ä»¥ç®€å•ç†è§£ä¸ºï¼šåœ¨ç¼–è¯‘ä¹‹åï¼Œæ•°æ®ç±»å‹ä¼šè¢«æ“¦é™¤ä¸ºæ³›å‹å‚æ•°çš„æ•°æ®ç±»å‹çš„ä¸Šç•Œæ•°æ®ç±»å‹ï¼ˆä¾‹å¦‚ <code>E</code> çš„ä¸Šç•Œæ•°æ®ç±»å‹æ˜¯ <code>Object</code>ã€<code>? extends MyClass</code> çš„ä¸Šç•Œæ•°æ®ç±»å‹æ˜¯ <code>MyClass</code>ï¼‰ã€‚ä»¥ <code>ArrayList&lt;E&gt;#add(E e)</code> ä¸ºä¾‹ï¼Œæœ¬æ¥æˆ‘ä»¬å†™çš„æ˜¯ï¼š<code>List&lt;String&gt; myList = new ArrayList&lt;&gt;()</code>ã€‚æŒ‰ç…§è¯­ä¹‰ï¼Œå®ƒåº”è¯¥æ˜¯ <code>myList#add(String E)</code>ï¼Œä½†æ˜¯åœ¨ç¼–è¯‘ä¹‹åï¼Œå®é™…åº”è¯¥æ˜¯ <code>myList#add(Object E)</code></li><li>é‚£ä¹ˆè¿™å°±æœ‰ä¸€ä¸ªé—®é¢˜ï¼š<code>ArrayListï¼œEï¼#get</code> æŒ‰ç…§è¯­ä¹‰åº”è¯¥è¿”å› <code>String</code> ç±»å‹çš„æ•°æ®ï¼Œä½†æ˜¯åœ¨ç¼–è¯‘åï¼Œå®é™…åº”è¯¥è¿”å› <code>Object</code> ç±»å‹çš„æ•°æ®ã€‚ä½†æ˜¯æˆ‘ä»¬çš„æ–¹æ³•çš„å…·ä½“é€»è¾‘æœ¬èº«æ˜¯æŒ‰ç…§è¿”å› <code>String</code> ç±»å‹çš„æ•°æ®æ‰€å†™çš„ï¼Œæ˜¯è¿”å›ä¸€ä¸ª <code>String</code> ç±»å‹çš„ç»“æœï¼Œè€Œè¿™å’Œè¿”å›ä¸€ä¸ª <code>Object</code> ç±»å‹çš„æ•°æ®ä¸ç¬¦ã€‚æ‰€ä»¥ç¼–è¯‘å™¨ä¼šåœ¨è¿”å›å€¼å¤„è‡ªåŠ¨æ’å…¥ä¸€ä¸ªæ•°æ®ç±»å‹è½¬æ¢ï¼ˆä¾‹å¦‚  <code>String str = (String) myList.get(0)</code>ï¼‰ã€‚æ‰€ä»¥åœ¨è°ƒç”¨è¿™äº›æ–¹æ³•æ—¶ï¼Œå°±æœ‰å¯èƒ½å› ä¸ºæ•°æ®ç±»å‹è½¬æ¢è€ŒæŠ›å‡º <code>ClassCastException</code> éå—æ£€å¼‚å¸¸ï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼šå¯¹äºåŸºæœ¬æ•°æ®ç±»å‹ï¼Œä¼šå…ˆå¯¹å…¶è¿›è¡Œè£…ç®±ï¼Œç„¶åå†å¯¹å…¶è¿›è¡Œæ•°æ®ç±»å‹è½¬æ¢ï¼‰</li></ol></li></ol></li><li>ç«™åœ¨æŠ€æœ¯è§’åº¦ï¼Œä¸ç±»å‹æ“¦é™¤ç»å¯¹æ¯”ç±»å‹æ“¦é™¤å¥½ï¼Œé‚£ä¹ˆ <code>Java</code> æ³›å‹ä¸ºä»€ä¹ˆè¿˜è¦è¿›è¡Œç±»å‹æ“¦é™¤ï¼Ÿ<ol><li>å†å²åŒ…è¢±ï¼Œæ²¡æœ‰åŠæ³•</li></ol></li><li>ä¸ºä»€ä¹ˆ <code>Java</code> æ³›å‹ä¸èƒ½çº¦æŸæ•°æ®ç±»å‹ä¸ºåŸºæœ¬æ•°æ®ç±»å‹ï¼Œå¯¼è‡´æˆ‘ä»¬å¤„ç†åŸºæœ¬æ•°æ®ç±»å‹æ—¶ï¼Œè¦å…ˆå¯¹å…¶è¿›è¡Œè£…ç®±ï¼Ÿ<ol><li>å› ä¸ºåœ¨ç±»å‹æ“¦é™¤åï¼Œä¼šè¢«æ“¦é™¤ä¸ºå¼•ç”¨æ•°æ®ç±»å‹</li></ol></li><li><code>Java</code> æ³›å‹ä¸ºä»€ä¹ˆä¼šå¯¼è‡´é¢‘ç¹çš„è‡ªåŠ¨è£…ç®±ã€è‡ªåŠ¨æ‹†ç®±ï¼Ÿ<ol><li>æˆ‘ä»¬çŸ¥é“ï¼šç”±äº <code>Java</code> æ³›å‹ä¸èƒ½çº¦æŸæ•°æ®ç±»å‹ä¸ºåŸºæœ¬æ•°æ®ç±»å‹ï¼Œå¯¼è‡´æˆ‘ä»¬å¤„ç†åŸºæœ¬æ•°æ®ç±»å‹æ—¶ï¼Œè¦å…ˆå¯¹å…¶è¿›è¡Œè£…ç®±</li><li>ä½†æ˜¯åœ¨è¿ç®—æ—¶ï¼ŒåŒ…è£…ç±»æœ¬èº«å¹¶ä¸èƒ½ç›´æ¥å‚ä¸è®¡ç®—ã€‚æ‰€ä»¥è¦å…ˆå¯¹å…¶è¿›è¡Œæ‹†ç®±ï¼Œå®Œæˆè®¡ç®—åå†è£…ç®±</li></ol></li></ol></li></ol></blockquote><hr><h6 id="2-2-3-4-2-å¤šçº¿ç¨‹å¹¶å‘å®‰å…¨é—®é¢˜"><a href="#2-2-3-4-2-å¤šçº¿ç¨‹å¹¶å‘å®‰å…¨é—®é¢˜" class="headerlink" title="2.2.3.4.2. å¤šçº¿ç¨‹å¹¶å‘å®‰å…¨é—®é¢˜"></a>2.2.3.4.2. å¤šçº¿ç¨‹å¹¶å‘å®‰å…¨é—®é¢˜</h6><p>ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼Œæˆ‘ä»¬é€šå¸¸ä¸ºå…¶åŠ é”æˆ–è€…ä½¿ç”¨å¦å¤–ä¸€ç§æ•°æ®ç»“æ„ï¼š<code>CopyOnWriteArrayListï¼œEï¼</code></p><hr><h6 id="2-2-3-4-3-è¿­ä»£å™¨çš„-â€œå¢â€ã€â€œåˆ â€-å¼‚å¸¸é—®é¢˜"><a href="#2-2-3-4-3-è¿­ä»£å™¨çš„-â€œå¢â€ã€â€œåˆ â€-å¼‚å¸¸é—®é¢˜" class="headerlink" title="2.2.3.4.3. è¿­ä»£å™¨çš„ â€œå¢â€ã€â€œåˆ â€ å¼‚å¸¸é—®é¢˜"></a>2.2.3.4.3. è¿­ä»£å™¨çš„ â€œå¢â€ã€â€œåˆ â€ å¼‚å¸¸é—®é¢˜</h6><p>å› ä¸º <code>ArrayListï¼œEï¼</code> çš„è¿­ä»£å™¨æœ¬è´¨ä¸Šæ˜¯æŒ‰ç…§æ•°ç»„ç´¢å¼•è¿›è¡Œéå†çš„ï¼ˆä¾‹å¦‚ <code>0 â” 1 â” 2 â” â€¦</code>ï¼‰ã€‚å¦‚æœåœ¨éå†è¿‡ç¨‹ä¸­è¿›è¡Œäº† â€œå¢â€ æˆ– â€œåˆ â€ æ“ä½œï¼Œä¼šå¯¼è‡´æ•°ç»„ä¸­åç»­å…ƒç´ å‘ç”Ÿä½ç½®å˜åŒ–ï¼Œä½†æ˜¯è¿­ä»£å™¨ä»ä¼šæŒ‰ç…§åŸå…ˆçš„æ•°ç»„ç´¢å¼•å¾€åèµ°ã€‚è¿™ä¸¤ä¸ªåŠ¨ä½œå åŠ ï¼Œå°±å¯èƒ½é€ æˆæ¼è¯»æˆ–é‡å¤è¯»çš„é—®é¢˜</p><p>ä¾‹å¦‚ <code>ArrayListï¼œEï¼</code> æœ‰ <code>A</code>ã€<code>B</code>ã€<code>C</code> ä¸‰ä¸ªå…ƒç´ ï¼Œè¿­ä»£å™¨æŒ‰ç…§æ•°ç»„ç´¢å¼•è¿›è¡Œéå†ã€‚å¦‚æœæˆ‘ä»¬è®©è¿­ä»£å™¨èµ°åˆ° <code>A</code> æ—¶æ‰§è¡Œ â€œåˆ â€ æ“ä½œï¼Œè®©åé¢çš„å…ƒç´ æ•´ä½“å·¦ç§»ã€‚æ­¤æ—¶ <code>B</code> å…ƒç´ çš„æ•°ç»„ç´¢å¼•ä¸º <code>0</code>ï¼Œ<code>C</code> å…ƒç´ çš„æ•°ç»„ç´¢å¼•ä¸º <code>1</code>ã€‚è¿­ä»£å™¨ä¼šæŒ‰ç…§åŸå…ˆçš„æ•°ç»„ç´¢å¼•å¾€åèµ°ï¼Œäºæ˜¯å°±èµ°åˆ°æ•°ç»„ç´¢å¼• <code>1</code> å¯¹åº”çš„ä½ç½®ï¼ˆå³ <code>C</code>ï¼‰ï¼Œè¿™å°±å‡ºç°äº†æ¼è¯»çš„é—®é¢˜</p><p>åœ¨ä¾‹å¦‚ <code>ArrayListï¼œEï¼</code> æœ‰ <code>A</code> ä¸€ä¸ªå…ƒç´ ï¼Œè¿­ä»£å™¨æŒ‰ç…§æ•°ç»„ç´¢å¼•è¿›è¡Œéå†ã€‚å¦‚æœæˆ‘ä»¬è®©è¿­ä»£å™¨éå†åˆ° <code>A</code> å…ƒç´ æ—¶ï¼Œå°±åœ¨ <code>A</code> å…ƒç´ çš„æ•°ç»„ä½ç½® â€œå¢â€ ä¸€ä¸ªæ–°å…ƒç´ ï¼ˆä¾‹å¦‚ <code>temp</code>ï¼‰ï¼Œè®© <code>A</code> å…ƒç´ å³ç§»åŠ¨ã€‚æ­¤æ—¶ <code>temp</code> å…ƒç´ çš„æ•°ç»„ç´¢å¼•ä¸º <code>0</code>ï¼Œ<code>A</code> å…ƒç´ çš„æ•°ç»„ç´¢å¼•ä¸º <code>1</code>ã€‚è¿­ä»£å™¨ä¼šæŒ‰ç…§åŸå…ˆçš„æ•°ç»„ç´¢å¼•å¾€åèµ°ï¼Œäºæ˜¯å°±èµ°åˆ°æ•°ç»„ç´¢å¼• <code>1</code> å¯¹åº”çš„ä½ç½®ï¼ˆå³ <code>A</code>ï¼‰ï¼Œå°±åˆ â€œå¢â€ äº†ä¸€ä¸ªæ–°å…ƒç´ ï¼ˆ<code>temp</code>ï¼‰ï¼Œäºæ˜¯å°±å‡ºç° <code>temp</code>ã€<code>temp</code>ã€<code>temp</code>ã€<code>...</code>ã€<code>A</code> çš„æƒ…å†µï¼Œè¿™å°±å‡ºç°äº†é‡å¤è¯»çš„é—®é¢˜</p><p>ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼Œ<code>ArrayListï¼œEï¼</code> é‡‡å–äº†å¿«é€Ÿå¤±è´¥ï¼ˆ<code>Fail-fast</code>ï¼‰ç­–ç•¥ã€‚å½“ <code>ArrayListï¼œEï¼</code> å¼€å§‹éå†æ—¶ï¼Œä¼šè®°ä¸‹ä¸€ä¸ªç‰ˆæœ¬å·ï¼ˆå³ <code>Itr-&gt;expectedModCount</code>ï¼‰ï¼Œå½“ <code>ArrayListï¼œEï¼</code> è°ƒç”¨ <code>Iteratorï¼œEï¼#next</code> åï¼Œä¼šå…ˆæ£€æŸ¥è¿™ä¸ªç‰ˆæœ¬å·ã€‚å¦‚æœç‰ˆæœ¬å·å¯¹ä¸ä¸Šï¼Œè¯´æ˜åœ¨éå†è¿‡ç¨‹ä¸­è¿›è¡Œäº† â€œå¢â€ æˆ– â€œåˆ â€ æ“ä½œï¼Œä¼šæŠ›å‡º <code>ConcurrentModificationException</code> éå—æ£€å¼‚å¸¸</p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>å¯¹äº <code>Fail-fast</code> ç­–ç•¥ï¼Œæˆ‘ä»¬æ˜¯ä¸èƒ½è°ƒç”¨ <code>ArrayListï¼œEï¼</code> çš„ç›¸å…³æ–¹æ³•è¿›è¡Œ â€œå¢â€ æˆ– â€œåˆ â€ æ“ä½œçš„ã€‚å¦‚æœæˆ‘ä»¬çœŸçš„æœ‰è¿™æ–¹é¢çš„éœ€æ±‚ï¼Œå¯ä»¥è°ƒç”¨ <code>Iteratorï¼œEï¼</code> çš„ç›¸å…³æ–¹æ³•æˆ– <code>ListIteratorï¼œEï¼</code> çš„ç›¸å…³æ–¹æ³•</li><li><code>Iteratorï¼œEï¼</code> æ˜¯ <code>Listï¼œEï¼</code>ã€<code>Setï¼œEï¼</code>ã€<code>Mapï¼œK, Vï¼</code>ã€<code>Queueï¼œEï¼</code> é€šç”¨çš„è¿­ä»£å™¨ï¼Œè€Œ <code>ListIteratorï¼œEï¼</code> æ˜¯ä¸“é—¨ä¸º <code>Listï¼œEï¼</code> æä¾›çš„è¿­ä»£å™¨ï¼Œæä¾›äº†æ›´å¤šçš„æ–¹æ³•</li></ol></blockquote><hr><h6 id="2-2-3-4-4-é¢‘ç¹æ‰©å®¹å¯¼è‡´çš„æ€§èƒ½æŠ–åŠ¨é—®é¢˜"><a href="#2-2-3-4-4-é¢‘ç¹æ‰©å®¹å¯¼è‡´çš„æ€§èƒ½æŠ–åŠ¨é—®é¢˜" class="headerlink" title="2.2.3.4.4. é¢‘ç¹æ‰©å®¹å¯¼è‡´çš„æ€§èƒ½æŠ–åŠ¨é—®é¢˜"></a>2.2.3.4.4. é¢‘ç¹æ‰©å®¹å¯¼è‡´çš„æ€§èƒ½æŠ–åŠ¨é—®é¢˜</h6><p>ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼Œæˆ‘ä»¬åœ¨å·²çŸ¥è¦å­˜å‚¨å¤§é‡æ•°æ®çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥åœ¨åˆ›å»º <code>ArrayListï¼œEï¼</code> å®ä¾‹çš„æ—¶å€™ï¼ŒæŒ‡å®šä¸€ä¸ªè¾ƒå¤§çš„åˆå§‹å®¹é‡ï¼Œé¿å…é¢‘ç¹æ‰©å®¹</p><hr><h4 id="2-2-4-LinkedListï¼œEï¼"><a href="#2-2-4-LinkedListï¼œEï¼" class="headerlink" title="2.2.4. LinkedListï¼œEï¼"></a>2.2.4. LinkedListï¼œEï¼</h4><h5 id="2-2-4-1-LinkedListï¼œEï¼-ä½“ç³»ç»“æ„"><a href="#2-2-4-1-LinkedListï¼œEï¼-ä½“ç³»ç»“æ„" class="headerlink" title="2.2.4.1. LinkedListï¼œEï¼ ä½“ç³»ç»“æ„"></a>2.2.4.1. LinkedListï¼œEï¼ ä½“ç³»ç»“æ„</h5><p><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B-1.png"></p><hr><h5 id="2-2-4-2-LinkedList-åº•å±‚å®ç°"><a href="#2-2-4-2-LinkedList-åº•å±‚å®ç°" class="headerlink" title="2.2.4.2. LinkedList åº•å±‚å®ç°"></a>2.2.4.2. LinkedList åº•å±‚å®ç°</h5><p><code>LinkedListï¼œEï¼</code> åº•å±‚æ˜¯åŸºäºä¸€æ¡åŒå‘é“¾è¡¨å®ç°çš„</p><p><code>LinkedListï¼œEï¼</code> æ˜¯é€šè¿‡ä¸€æ¡ç”± <code>LinkedListï¼œEï¼.Nodeï¼œEï¼</code> æ„å»ºçš„åŒå‘é“¾è¡¨å­˜å‚¨æ•°æ®çš„ï¼Œå…¶åŸºæœ¬å±æ€§å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Node</span>&lt;E&gt; &#123;<br><br>E item;<br><br>Node&lt;E&gt; next;<br><br>Node&lt;E&gt; prev;<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h5 id="2-2-4-3-LinkedListï¼œEï¼-é—®é¢˜çˆ†ç ´"><a href="#2-2-4-3-LinkedListï¼œEï¼-é—®é¢˜çˆ†ç ´" class="headerlink" title="2.2.4.3. LinkedListï¼œEï¼ é—®é¢˜çˆ†ç ´"></a>2.2.4.3. LinkedListï¼œEï¼ é—®é¢˜çˆ†ç ´</h5><h6 id="2-2-4-3-1-å…ƒç´ ç±»å‹é—®é¢˜"><a href="#2-2-4-3-1-å…ƒç´ ç±»å‹é—®é¢˜" class="headerlink" title="2.2.4.3.1. å…ƒç´ ç±»å‹é—®é¢˜"></a>2.2.4.3.1. å…ƒç´ ç±»å‹é—®é¢˜</h6><p>ç”±äº <code>LinkedListï¼œEï¼</code> æ˜¯é€šè¿‡ä¸€æ¡ç”± <code>LinkedListï¼œEï¼.Nodeï¼œEï¼</code> æ„å»ºçš„åŒå‘é“¾è¡¨å­˜å‚¨æ•°æ®çš„ï¼Œå…¶åŸºæœ¬å±æ€§å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Node</span>&lt;E&gt; &#123;<br><br>E item;<br><br>Node&lt;E&gt; next;<br><br>Node&lt;E&gt; prev;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>è€Œ <code>E</code> æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå¯¹è±¡å¼•ç”¨ï¼Œæ‰€ä»¥ <code>LinkedListï¼œEï¼</code> åªèƒ½å­˜å‚¨ <code>Object</code> ç±»å‹çš„å…ƒç´ ã€‚</p><hr><h6 id="2-2-4-3-2-å¤šçº¿ç¨‹å¹¶å‘å®‰å…¨é—®é¢˜"><a href="#2-2-4-3-2-å¤šçº¿ç¨‹å¹¶å‘å®‰å…¨é—®é¢˜" class="headerlink" title="2.2.4.3.2. å¤šçº¿ç¨‹å¹¶å‘å®‰å…¨é—®é¢˜"></a>2.2.4.3.2. å¤šçº¿ç¨‹å¹¶å‘å®‰å…¨é—®é¢˜</h6><p>ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼Œæˆ‘ä»¬é€šå¸¸ä¸ºå…¶åŠ é”</p><hr><h6 id="2-2-4-3-3-è¿­ä»£å™¨çš„-â€œå¢â€ã€â€œåˆ â€-å¼‚å¸¸é—®é¢˜"><a href="#2-2-4-3-3-è¿­ä»£å™¨çš„-â€œå¢â€ã€â€œåˆ â€-å¼‚å¸¸é—®é¢˜" class="headerlink" title="2.2.4.3.3. è¿­ä»£å™¨çš„ â€œå¢â€ã€â€œåˆ â€ å¼‚å¸¸é—®é¢˜"></a>2.2.4.3.3. è¿­ä»£å™¨çš„ â€œå¢â€ã€â€œåˆ â€ å¼‚å¸¸é—®é¢˜</h6><p>ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼Œ<code>LinkedListï¼œEï¼</code> é‡‡å–äº†å¿«é€Ÿå¤±è´¥ï¼ˆ<code>Fail-fast</code>ï¼‰ç­–ç•¥ã€‚</p><hr><h4 id="2-2-5-CopyOnWriteArrayList"><a href="#2-2-5-CopyOnWriteArrayList" class="headerlink" title="2.2.5. CopyOnWriteArrayList"></a>2.2.5. CopyOnWriteArrayList</h4><h5 id="2-2-5-1-CopyOnWriteArrayList-ä½“ç³»ç»“æ„"><a href="#2-2-5-1-CopyOnWriteArrayList-ä½“ç³»ç»“æ„" class="headerlink" title="2.2.5.1. CopyOnWriteArrayList ä½“ç³»ç»“æ„"></a>2.2.5.1. CopyOnWriteArrayList ä½“ç³»ç»“æ„</h5><p><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B-2.png"></p><hr><h5 id="2-2-5-2-CopyOnWriteArrayListï¼œEï¼-åº•å±‚å®ç°"><a href="#2-2-5-2-CopyOnWriteArrayListï¼œEï¼-åº•å±‚å®ç°" class="headerlink" title="2.2.5.2. CopyOnWriteArrayListï¼œEï¼ åº•å±‚å®ç°"></a>2.2.5.2. CopyOnWriteArrayListï¼œEï¼ åº•å±‚å®ç°</h5><p>åœ¨ <code>Java11</code> ä¹‹å‰ï¼Œ<code>CopyOnWriteArrayListï¼œEï¼</code> åº•å±‚æ˜¯åŸºäºä¸€ä¸ªæ•°ç»„ + ä¸€ä¸ª <code>ReentrantLock</code>ï¼ˆæ— æ¡ä»¶é˜Ÿåˆ—ï¼‰å®ç°çš„ã€‚åœ¨ <code>Jav11</code> ä¹‹åï¼Œ<code>CopyOnWriteArrayListï¼œEï¼</code> åº•å±‚æ˜¯åŸºäºä¸€ä¸ªæ•°ç»„ +<code>synchronized</code> å®ç°çš„</p><p><code>CopyOnWriteArrayListï¼œEï¼</code> æ˜¯é€šè¿‡ <code>CopyOnWriteArrayListï¼œEï¼-&gt;array</code> å­˜å‚¨æ•°æ®çš„ï¼Œè€Œå®ƒåˆæ˜¯ä¸€ä¸ªç”± <code>Object</code> æ„å»ºçš„æ•°ç»„</p><hr><h5 id="2-2-5-3-CopyOnWriteArrayListï¼œEï¼-ç›¸å…³æµç¨‹"><a href="#2-2-5-3-CopyOnWriteArrayListï¼œEï¼-ç›¸å…³æµç¨‹" class="headerlink" title="2.2.5.3. CopyOnWriteArrayListï¼œEï¼ ç›¸å…³æµç¨‹"></a>2.2.5.3. CopyOnWriteArrayListï¼œEï¼ ç›¸å…³æµç¨‹</h5><h6 id="2-2-5-3-1-è¯»æ“ä½œç›¸å…³æµç¨‹"><a href="#2-2-5-3-1-è¯»æ“ä½œç›¸å…³æµç¨‹" class="headerlink" title="2.2.5.3.1. è¯»æ“ä½œç›¸å…³æµç¨‹"></a>2.2.5.3.1. è¯»æ“ä½œç›¸å…³æµç¨‹</h6><p>è™½ç„¶ <code>CopyOnWriteArrayListï¼œEï¼</code> æ˜¯ä¸€ä¸ªå¤šçº¿ç¨‹å¹¶å‘å®‰å…¨çš„æ•°æ®ç»“æ„ï¼Œä½†æ˜¯è¯»æ“ä½œå®Œå…¨ä¸åŠ é”</p><hr><h6 id="2-2-5-3-2-å†™æ“ä½œç›¸å…³æµç¨‹"><a href="#2-2-5-3-2-å†™æ“ä½œç›¸å…³æµç¨‹" class="headerlink" title="2.2.5.3.2. å†™æ“ä½œç›¸å…³æµç¨‹"></a>2.2.5.3.2. å†™æ“ä½œç›¸å…³æµç¨‹</h6><p>ä½†æ˜¯ <code>CopyOnWriteArrayListï¼œEï¼</code> çš„å†™æ“ä½œä¼šåŠ é”ã€‚åœ¨ <code>Java11</code> ä¹‹å‰ï¼Œ<code>CopyOnWriteArrayListï¼œEï¼</code> æ˜¯ä½¿ç”¨ <code>ReentrantLock</code>ã€‚åœ¨ <code>Java11</code> ä¹‹åï¼Œ<code>CopyOnWriteArrayListï¼œEï¼</code> æ˜¯ä½¿ç”¨ <code>synchronized</code></p><p>å½“æ‰§è¡Œ <code>CopyOnWriteArrayListï¼œEï¼</code> çš„å†™æ“ä½œçš„çº¿ç¨‹ç«äº‰åˆ°é”åï¼Œä¼šåˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„ï¼Œå¹¶è°ƒç”¨ <code>Arrays#copyOf</code> å°†æ—§æ•°ç»„ä¸­çš„å…ƒç´ æ‹·è´åˆ°æ–°æ•°ç»„ä¸­ï¼ˆè¿™é‡Œå¹¶ä¸æ˜¯éå†ï¼Œè€Œæ˜¯è°ƒç”¨äº† <code>native</code> æ–¹æ³•ï¼Œå®ç°æ•´ä¸ªå†…å­˜å—çš„æ‹·è´ï¼‰ã€‚ç„¶åçº¿ç¨‹å°±ä¼šåœ¨è¿™ä¸ªæ–°æ•°ç»„ä¸Šæ‰§è¡Œå†™æ“ä½œã€‚å½“çº¿ç¨‹æ‰§è¡Œå®Œå†™æ“ä½œåï¼Œå°±ä¼šå°†æ—§æ•°ç»„çš„å¼•ç”¨æ›¿æ¢æˆæ–°æ•°ç»„çš„å¼•ç”¨</p><hr><h5 id="2-2-5-4-CopyOnWriteArrayList-é—®é¢˜çˆ†ç ´"><a href="#2-2-5-4-CopyOnWriteArrayList-é—®é¢˜çˆ†ç ´" class="headerlink" title="2.2.5.4. CopyOnWriteArrayList é—®é¢˜çˆ†ç ´"></a>2.2.5.4. CopyOnWriteArrayList é—®é¢˜çˆ†ç ´</h5><h6 id="2-2-5-4-1-å…ƒç´ ç±»å‹é—®é¢˜"><a href="#2-2-5-4-1-å…ƒç´ ç±»å‹é—®é¢˜" class="headerlink" title="2.2.5.4.1. å…ƒç´ ç±»å‹é—®é¢˜"></a>2.2.5.4.1. å…ƒç´ ç±»å‹é—®é¢˜</h6><p>ç”±äº<code>CopyOnWriteArrayListï¼œEï¼</code> æ˜¯é€šè¿‡ <code>CopyOnWriteArrayListï¼œEï¼-&gt;array</code> å­˜å‚¨æ•°æ®çš„ï¼Œè€Œå®ƒåˆæ˜¯ä¸€ä¸ªç”± <code>Object</code> æ„å»ºçš„æ•°ç»„ã€‚æ‰€ä»¥ <code>ArrayListï¼œEï¼</code> åªèƒ½å­˜å‚¨ <code>Object</code> ç±»å‹çš„å…ƒç´ </p><hr><h6 id="2-2-5-4-2-è¿­ä»£å™¨çš„-â€œå¢â€ã€â€œåˆ â€-å¼‚å¸¸é—®é¢˜"><a href="#2-2-5-4-2-è¿­ä»£å™¨çš„-â€œå¢â€ã€â€œåˆ â€-å¼‚å¸¸é—®é¢˜" class="headerlink" title="2.2.5.4.2. è¿­ä»£å™¨çš„ â€œå¢â€ã€â€œåˆ â€ å¼‚å¸¸é—®é¢˜"></a>2.2.5.4.2. è¿­ä»£å™¨çš„ â€œå¢â€ã€â€œåˆ â€ å¼‚å¸¸é—®é¢˜</h6><p>ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼Œ<code>CopyOnWriteArrayListï¼œEï¼</code> é‡‡å–äº†å®‰å…¨å¤±è´¥ï¼ˆ<code>Fail-safe</code>ï¼‰ç­–ç•¥ã€‚æˆ‘ä»¬çŸ¥é“ â€œçº¿ç¨‹ä¼šåœ¨åˆ›å»ºçš„æ–°æ•°ç»„ä¸Šæ‰§è¡Œå†™æ“ä½œï¼Œå½“çº¿ç¨‹æ‰§è¡Œå®Œå†™æ“ä½œåï¼Œå°±ä¼šå°†æ—§æ•°ç»„çš„å¼•ç”¨æ›¿æ¢æˆæ–°æ•°ç»„çš„å¼•ç”¨â€ã€‚æ‰€ä»¥ <code>CopyOnWriteArrayListï¼œEï¼</code> éå†çš„æ°¸è¿œæ˜¯é‚£ä¸ªæ—§æ•°ç»„ï¼Œä¸å—åç»­ â€œå¢â€ã€â€œåˆ â€ æ“ä½œçš„å½±å“ï¼ˆå³ä¾¿ä¸»å†…å­˜ä¸­çš„æ•°ç»„å·²ç»è¢«å†™å¥½å‡ è½®äº†ï¼Œä½†æ˜¯è¿­ä»£å™¨çœ‹åˆ°çš„ä»ç„¶æ˜¯æœ€åˆçš„é‚£ä¸€ä¸ªæ—§æ•°ç»„ï¼‰</p><hr><h3 id="2-3-Mapï¼œK-Vï¼"><a href="#2-3-Mapï¼œK-Vï¼" class="headerlink" title="2.3. Mapï¼œK, Vï¼"></a>2.3. Mapï¼œK, Vï¼</h3><h4 id="2-3-1-Mapï¼œK-Vï¼-åŸºç¡€ä½“ç³»"><a href="#2-3-1-Mapï¼œK-Vï¼-åŸºç¡€ä½“ç³»" class="headerlink" title="2.3.1. Mapï¼œK, Vï¼ åŸºç¡€ä½“ç³»"></a>2.3.1. Mapï¼œK, Vï¼ åŸºç¡€ä½“ç³»</h4><p><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B-26.png"></p><hr><h4 id="2-3-2-Mapï¼œK-Vï¼-ç›¸å…³åˆ†ç±»"><a href="#2-3-2-Mapï¼œK-Vï¼-ç›¸å…³åˆ†ç±»" class="headerlink" title="2.3.2. Mapï¼œK, Vï¼ ç›¸å…³åˆ†ç±»"></a>2.3.2. Mapï¼œK, Vï¼ ç›¸å…³åˆ†ç±»</h4><ol><li><code>TreeMapï¼œK, Vï¼</code></li><li><code>HashMapï¼œK, Vï¼</code></li><li><code>EnumMapï¼œK, Vï¼</code></li><li><code>WeakHashMapï¼œK, Vï¼</code></li><li><code>LinkedHashMapï¼œK, Vï¼</code></li><li><code>ConcurrentHashMapï¼œK, Vï¼</code></li><li><code>ConcurrentSkipListMapï¼œK, Vï¼</code></li></ol><hr><h4 id="2-3-3-TreeMapï¼œK-Vï¼"><a href="#2-3-3-TreeMapï¼œK-Vï¼" class="headerlink" title="2.3.3. TreeMapï¼œK, Vï¼"></a>2.3.3. TreeMapï¼œK, Vï¼</h4><h5 id="2-3-3-1-TreeMapï¼œK-Vï¼-ä½“ç³»ç»“æ„"><a href="#2-3-3-1-TreeMapï¼œK-Vï¼-ä½“ç³»ç»“æ„" class="headerlink" title="2.3.3.1. TreeMapï¼œK, Vï¼ ä½“ç³»ç»“æ„"></a>2.3.3.1. TreeMapï¼œK, Vï¼ ä½“ç³»ç»“æ„</h5><p><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B-8.png"></p><hr><h5 id="2-3-3-2-TreeMapï¼œK-Vï¼-åº•å±‚å®ç°"><a href="#2-3-3-2-TreeMapï¼œK-Vï¼-åº•å±‚å®ç°" class="headerlink" title="2.3.3.2. TreeMapï¼œK, Vï¼ åº•å±‚å®ç°"></a>2.3.3.2. TreeMapï¼œK, Vï¼ åº•å±‚å®ç°</h5><p><code>TreeMapï¼œK, Vï¼</code> åº•å±‚æ˜¯åŸºäºä¸€ä¸ªçº¢é»‘æ ‘å®ç°çš„</p><p><code>TreeMapï¼œK, Vï¼</code> æ˜¯é€šè¿‡ä¸€ä¸ªç”± <code>TreeMapï¼œK, Vï¼.Entryï¼œK, Vï¼</code> æ„å»ºçš„çº¢é»‘æ ‘å­˜å‚¨æ•°æ®çš„ï¼Œå…¶åŸºæœ¬å±æ€§å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Entry</span>&lt;K,V&gt; <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Map</span>.Entry&lt;K,V&gt; &#123;<br><br>K key;<br><br>V value;<br><br>Entry&lt;K,V&gt; left;<br><br>Entry&lt;K,V&gt; right;<br><br>Entry&lt;K,V&gt; parent;<br><br><span class="hljs-type">boolean</span> <span class="hljs-variable">color</span> <span class="hljs-operator">=</span> BLACK;<br><br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>ç”±äº <code>TreeMapï¼œK, Vï¼</code> åº•å±‚æ˜¯åŸºäºçº¢é»‘æ ‘å®ç°çš„ï¼Œè€Œçº¢é»‘æ ‘æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªè‡ªå¹³è¡¡çš„äºŒå‰æŸ¥æ‰¾æ ‘ï¼Œæ‰€ä»¥ <code>TreeMapï¼œK, Vï¼</code> èƒ½å¤Ÿè‡ªåŠ¨å¯¹å…ƒç´ è¿›è¡Œæ’åºï¼ˆè‡ªç„¶æ’åºã€å®šåˆ¶æ’åºï¼‰</li><li>é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>TreeMapï¼œK, Vï¼</code> é‡‡ç”¨è‡ªç„¶æ’åºã€‚å³æ ¹æ® <code>Key</code> å®ä¾‹æ‰€å±ç±»å®ç°çš„ <code>Comparableï¼œTï¼#compareTo</code> å¯¹å…ƒç´ è¿›è¡Œæ’åºã€‚è¯¦è§æºç ï¼š<code>Comparable&lt;T&gt;</code>ï¼ˆ<code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.Comparable%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.lang.Comparableï¼œTï¼æºç è§£æ</a>ï¼Œ<code>Hexo</code> é“¾æ¥ï¼š <a href="http://blog.wangjia.ink/2025/11/06/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.Comparable%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/06/æºç ï¼šjava.lang.Comparableï¼œTï¼æºç è§£æ/</a> ï¼‰</li><li>é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é‡‡ç”¨å®šåˆ¶æ’åºã€‚å³åœ¨åˆ›å»º <code>TreeMapï¼œK, Vï¼</code> å®ä¾‹æ—¶ï¼Œä¼ å…¥ä¸€ä¸ª <code>Comparatorï¼œTï¼</code> æ¥å£çš„å…·ä½“å®ç°ç±»å®ä¾‹ï¼Œç„¶å <code>TreeMapï¼œK, Vï¼</code> ä¼šæ ¹æ® <code>Comparatorï¼œTï¼#compare</code> å¯¹å…ƒç´ è¿›è¡Œæ’åºã€‚è¯¦è§æºç ï¼š<code>Comparator&lt;T&gt;</code>ï¼ˆ<code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼šï¼Œ<code>Hexo</code> é“¾æ¥ï¼šï¼‰</li></ol></blockquote><hr><h5 id="2-3-3-3-TreeMapï¼œK-Vï¼-é—®é¢˜çˆ†ç ´"><a href="#2-3-3-3-TreeMapï¼œK-Vï¼-é—®é¢˜çˆ†ç ´" class="headerlink" title="2.3.3.3. TreeMapï¼œK, Vï¼ é—®é¢˜çˆ†ç ´"></a>2.3.3.3. TreeMapï¼œK, Vï¼ é—®é¢˜çˆ†ç ´</h5><h6 id="2-3-3-3-1-Key-ç±»å‹é—®é¢˜"><a href="#2-3-3-3-1-Key-ç±»å‹é—®é¢˜" class="headerlink" title="2.3.3.3.1. Key ç±»å‹é—®é¢˜"></a>2.3.3.3.1. Key ç±»å‹é—®é¢˜</h6><p>ç”±äº <code>TreeMapï¼œK, Vï¼</code> æ˜¯é€šè¿‡ä¸€ä¸ªç”± <code>TreeMapï¼œK, Vï¼.Entryï¼œK, Vï¼</code> æ„å»ºçš„çº¢é»‘æ ‘å­˜å‚¨æ•°æ®çš„ï¼Œå…¶åŸºæœ¬å±æ€§å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Entry</span>&lt;K,V&gt; <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Map</span>.Entry&lt;K,V&gt; &#123;<br><br>K key;<br><br>V value;<br><br>Entry&lt;K,V&gt; left;<br><br>Entry&lt;K,V&gt; right;<br><br>Entry&lt;K,V&gt; parent;<br><br><span class="hljs-type">boolean</span> <span class="hljs-variable">color</span> <span class="hljs-operator">=</span> BLACK;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>è€Œ <code>K</code> æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå¯¹è±¡å¼•ç”¨ï¼Œæ‰€ä»¥ <code>TreeMapï¼œK, Vï¼</code> åªèƒ½å­˜å‚¨ <code>Key</code> ä¸º <code>Object</code> ç±»å‹çš„å…ƒç´ </p><p>é™¤æ­¤ä¹‹å¤–ï¼Œ<code>TreeMapï¼œK, Vï¼</code> åœ¨è‡ªç„¶æ’åºä¸‹æ˜¯é€šè¿‡ <code>Comparableï¼œTï¼#compareTo</code> æ¥åˆ¤æ–­å…ƒç´ çš„ <code>Key</code> æ˜¯å¦é‡å¤çš„ï¼Œæ‰€ä»¥å…ƒç´ çš„ <code>Key</code> å¿…é¡»æ˜¯ <code>Comparable</code> ç±»å‹çš„</p><hr><h6 id="2-3-3-3-2-å¤šçº¿ç¨‹å¹¶å‘å®‰å…¨æ€§é—®é¢˜"><a href="#2-3-3-3-2-å¤šçº¿ç¨‹å¹¶å‘å®‰å…¨æ€§é—®é¢˜" class="headerlink" title="2.3.3.3.2. å¤šçº¿ç¨‹å¹¶å‘å®‰å…¨æ€§é—®é¢˜"></a>2.3.3.3.2. å¤šçº¿ç¨‹å¹¶å‘å®‰å…¨æ€§é—®é¢˜</h6><p>ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼Œæˆ‘ä»¬é€šå¸¸ä¸ºå…¶åŠ é”æˆ–è€…ä½¿ç”¨å¦å¤–ä¸€ç§æ•°æ®ç»“æ„ï¼š<code>ConcurrentSkipListMapï¼œK, Vï¼</code></p><hr><h6 id="2-3-3-3-3-è¿­ä»£å™¨çš„-â€œå¢â€ã€â€œåˆ â€-å¼‚å¸¸é—®é¢˜"><a href="#2-3-3-3-3-è¿­ä»£å™¨çš„-â€œå¢â€ã€â€œåˆ â€-å¼‚å¸¸é—®é¢˜" class="headerlink" title="2.3.3.3.3. è¿­ä»£å™¨çš„ â€œå¢â€ã€â€œåˆ â€ å¼‚å¸¸é—®é¢˜"></a>2.3.3.3.3. è¿­ä»£å™¨çš„ â€œå¢â€ã€â€œåˆ â€ å¼‚å¸¸é—®é¢˜</h6><p>ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼Œ<code>TreeMapï¼œK, Vï¼</code> é‡‡å–äº†å¿«é€Ÿå¤±è´¥ï¼ˆ<code>Fail-fast</code>ï¼‰ç­–ç•¥ã€‚</p><hr><h6 id="2-3-3-3-4-Key-Value-é‡å¤é—®é¢˜"><a href="#2-3-3-3-4-Key-Value-é‡å¤é—®é¢˜" class="headerlink" title="2.3.3.3.4. Key-Value é‡å¤é—®é¢˜"></a>2.3.3.3.4. Key-Value é‡å¤é—®é¢˜</h6><p><code>TreeMapï¼œK, Vï¼</code> ä¸¥ç¦å…ƒç´ çš„ <code>Key</code> é‡å¤ï¼Œå®ƒæ˜¯é€šè¿‡ <code>Comparableï¼œTï¼#compareTo</code> æˆ– <code>Comparatorï¼œTï¼#compare</code> æ¥åˆ¤æ–­å…ƒç´ çš„ <code>Key</code> æ˜¯å¦é‡å¤çš„</p><p><code>TreeMapï¼œK, Vï¼</code> å…è®¸å…ƒç´ çš„ <code>Value</code> é‡å¤</p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>ç”±äº <code>TreeMapï¼œK, Vï¼</code> æ˜¯é€šè¿‡ <code>Comparableï¼œTï¼#compareTo</code> æˆ– <code>Comparatorï¼œTï¼#compare</code> æ¥åˆ¤æ–­å…ƒç´ çš„ <code>Key</code> æ˜¯å¦é‡å¤çš„ã€‚å¦‚æœä¸¤ä¸ªå®ä¾‹çš„ <code>Object#equals</code> ä¸º <code>false</code>ï¼ˆå³é€»è¾‘ä¸Šä¸ç›¸ç­‰ï¼‰ï¼Œä½†æ˜¯ <code>TreeMapï¼œK, Vï¼</code> ä¹Ÿæœ‰å¯èƒ½è®¤ä¸ºå®ƒä»¬ç›¸ç­‰ï¼Œä»è€Œäº§ç”Ÿè¦†ç›–</li><li>ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦åœ¨å®šä¹‰ <code>Key</code> çš„ä¿è¯ï¼šå½“ä¸”ä»…å½“ <code>Object#euqals</code> è¿”å› <code>true</code> æ—¶ï¼Œ<code>Comparableï¼œTï¼#compareTo</code> æˆ– <code>Comparatorï¼œTï¼#compare</code> æ‰è¿”å› <code>0</code></li></ol></blockquote><hr><h6 id="2-3-3-3-5-Key-Value-ä¸º-null-é—®é¢˜"><a href="#2-3-3-3-5-Key-Value-ä¸º-null-é—®é¢˜" class="headerlink" title="2.3.3.3.5. Key-Value ä¸º null é—®é¢˜"></a>2.3.3.3.5. Key-Value ä¸º null é—®é¢˜</h6><p>å¦‚æœé‡‡ç”¨çš„æ˜¯è‡ªç„¶æ’åºï¼Œ<code>TreeMapï¼œK, Vï¼</code> ä¸å…è®¸å…ƒç´ çš„ <code>Key</code> ä¸º <code>null</code>ï¼Œå› ä¸ºè°ƒç”¨ <code>Comparableï¼œTï¼#compareTo</code> æ—¶å°±ç›´æ¥æŠ›å‡º <code>NullPointerException</code> éå—æ£€å¼‚å¸¸äº†</p><p>ä½†æ˜¯å¦‚æœé‡‡ç”¨çš„æ˜¯å®šåˆ¶æ’åºï¼Œ<code>TreeMapï¼œK, Vï¼</code> å…ä¸å…è®¸å…ƒç´ çš„ <code>Key</code> ä¸º <code>null</code>ï¼Œå°±è¦çœ‹æˆ‘ä»¬ä¼ å…¥çš„ <code>Comparatorï¼œTï¼</code> æ¥å£çš„å…·ä½“å®ç°ç±»å®ä¾‹ã€‚å¦‚æœ <code>Comparatorï¼œTï¼#compare</code> å¤„ç†äº†å…ƒç´ çš„ <code>Key</code> ä¸º <code>null</code> çš„æƒ…å†µï¼Œé‚£ä¹ˆ <code>TreeMapï¼œK, Vï¼</code> æ˜¯å…è®¸å…ƒç´ çš„ <code>Key</code> ä¸º <code>null</code> çš„</p><p><code>TreeMapï¼œK, Vï¼</code> å…è®¸å…ƒç´ çš„ <code>Value</code> ä¸º <code>null</code>ï¼Œå¹¶ä¸”æ•°é‡ä¸é™åˆ¶</p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>ç”±äº <code>TreeMapï¼œK, Vï¼</code> åœ¨è‡ªç„¶æ’åºä¸‹ä¸å…è®¸å…ƒç´ çš„ <code>Key</code> ä¸º <code>null</code>ï¼Œæ‰€ä»¥åœ¨å¯¹ <code>TreeMapï¼œK, Vï¼</code> è¿›è¡Œ â€œå¢â€ æ“ä½œä¹‹å‰è¦è¿›è¡Œéç©ºåˆ¤æ–­</li></ol></blockquote><hr><h6 id="2-3-3-3-6-çº¢é»‘æ ‘è¯»æ“ä½œå¤±æ•ˆé—®é¢˜"><a href="#2-3-3-3-6-çº¢é»‘æ ‘è¯»æ“ä½œå¤±æ•ˆé—®é¢˜" class="headerlink" title="2.3.3.3.6. çº¢é»‘æ ‘è¯»æ“ä½œå¤±æ•ˆé—®é¢˜"></a>2.3.3.3.6. çº¢é»‘æ ‘è¯»æ“ä½œå¤±æ•ˆé—®é¢˜</h6><p>è¿™æ˜¯çº¢é»‘æ ‘ä¸€ä¸ªéå¸¸å…¸å‹çš„é—®é¢˜ï¼šå½“ä½ æŠŠä¸€ä¸ªå…ƒç´  â€œå¢â€ åˆ° <code>TreeMapï¼œK, Vï¼</code> ä¸­ï¼Œå®ƒä¼šè¢« TreeMapï¼œK, Vï¼ è°ƒæ•´åˆ°çº¢é»‘æ ‘çš„æŸä¸ªä½ç½®ã€‚å¦‚æœä½ åœ¨ â€œå¢â€ ä¹‹åï¼Œâ€œæ”¹â€ äº†å…ƒç´ çš„ <code>Key</code>ï¼Œå½±å“åˆ°äº† <code>Comparableï¼œTï¼#compareTo</code> æˆ– <code>Comparatorï¼œTï¼#compare</code>ï¼Œ<code>TreeMapï¼œK, Vï¼</code> å¹¶ä¸ä¼šå†è°ƒæ•´å®ƒçš„ä½ç½®äº†ã€‚</p><p>æ‰€ä»¥å½“ä½ å»è¯»è¯¥å…ƒç´ æ—¶ï¼Œ<code>TreeMapï¼œK, Vï¼</code> ä¼šæ ¹æ®å…ƒç´ çš„æ–° <code>Key</code> å¯¹åº”çš„çº¢é»‘æ ‘è·¯å¾„å»è¯»æ•°æ®ã€‚ä½†æ˜¯è¯¥å…ƒç´ ä»ç„¶åœ¨å…ƒç´ çš„æ—§ <code>Key</code> å¯¹åº”çš„çº¢é»‘æ ‘è·¯å¾„ï¼Œæ‰€ä»¥æ ¹æœ¬æ— æ³•è¢«æ­£ç¡®è¯»åˆ°ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿™ä¹Ÿé€ æˆäº†ä¸€ä¸ªå†…å­˜æ³„æ¼é—®é¢˜</p><p>ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼Œæˆ‘ä»¬å…ƒç´ çš„ <code>Key</code> å¿…é¡»æ˜¯ä¸å¯å˜çš„ï¼ˆå³ä¸å¯å˜ç±»ï¼‰</p><hr><h4 id="2-3-4-HashMapï¼œK-Vï¼"><a href="#2-3-4-HashMapï¼œK-Vï¼" class="headerlink" title="2.3.4. HashMapï¼œK, Vï¼"></a>2.3.4. HashMapï¼œK, Vï¼</h4><h5 id="2-3-4-1-HashMapï¼œK-Vï¼-ä½“ç³»ç»“æ„"><a href="#2-3-4-1-HashMapï¼œK-Vï¼-ä½“ç³»ç»“æ„" class="headerlink" title="2.3.4.1. HashMapï¼œK, Vï¼ ä½“ç³»ç»“æ„"></a>2.3.4.1. HashMapï¼œK, Vï¼ ä½“ç³»ç»“æ„</h5><p><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B-11.png"></p><hr><h5 id="2-3-4-2-HashMapï¼œK-Vï¼-åº•å±‚å®ç°"><a href="#2-3-4-2-HashMapï¼œK-Vï¼-åº•å±‚å®ç°" class="headerlink" title="2.3.4.2. HashMapï¼œK, Vï¼ åº•å±‚å®ç°"></a>2.3.4.2. HashMapï¼œK, Vï¼ åº•å±‚å®ç°</h5><p>åœ¨ <code>Java8</code> ä¹‹å‰ï¼Œ<code>HashMapï¼œK, Vï¼</code> åº•å±‚æ˜¯åŸºäºä¸€ä¸ªæ•°ç»„ + å¤šæ¡å•å‘é“¾è¡¨å®ç°çš„ã€‚åœ¨ <code>Java8</code> ä¹‹åï¼Œ<code>HashMapï¼œK, Vï¼</code> åº•å±‚æ˜¯åŸºäºä¸€ä¸ªæ•°ç»„ + å¤šæ¡å•å‘é“¾è¡¨ + å¤šä¸ªçº¢é»‘æ ‘å®ç°çš„</p><p><code>HashMapï¼œK, Vï¼</code> æ˜¯é€šè¿‡ <code>HashMapï¼œK, Vï¼â”table</code> å­˜å‚¨æ•°æ®çš„ï¼Œè€Œå®ƒåˆæ˜¯ä¸€ä¸ªç”± <code>HashMapï¼œK, Vï¼.Nodeï¼œK, Vï¼</code> æ„å»ºçš„æ•°ç»„ï¼Œå…¶åŸºæœ¬å±æ€§å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Node</span>&lt;K,V&gt; <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Map</span>.Entry&lt;K,V&gt; &#123;<br><br><span class="hljs-keyword">final</span> <span class="hljs-type">int</span> hash;<br><br><span class="hljs-keyword">final</span> K key;<br><br>V value;<br><br>Node&lt;K,V&gt; next;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>é™¤æ­¤ä¹‹å¤–ï¼Œæ¯ä¸€ä¸ª <code>HashMapï¼œK, Vï¼.Nodeï¼œK, Vï¼</code> è¿˜ç»´æŠ¤äº†ä¸€æ¡ç”± <code>HashMapï¼œK, Vï¼.Nodeï¼œK, Vï¼</code> æ„å»ºçš„å•å‘é“¾è¡¨</p><hr><h5 id="2-3-4-3-HashMapï¼œK-Vï¼-ç›¸å…³æµç¨‹"><a href="#2-3-4-3-HashMapï¼œK-Vï¼-ç›¸å…³æµç¨‹" class="headerlink" title="2.3.4.3. HashMapï¼œK, Vï¼ ç›¸å…³æµç¨‹"></a>2.3.4.3. HashMapï¼œK, Vï¼ ç›¸å…³æµç¨‹</h5><p>ç”±äº <code>HashMapï¼œK, Vï¼</code> åº•å±‚åŸºäºä¸€ä¸ªæ•°ç»„ + å¤šæ¡å•å‘é“¾è¡¨æˆ–è€…ä¸€ä¸ªæ•°ç»„ + å¤šæ¡å•å‘é“¾è¡¨ + å¤šä¸ªçº¢é»‘æ ‘ã€‚æ‰€ä»¥æˆ‘ä»¬è¦äº†è§£ <code>HashMapï¼œK, Vï¼</code>ï¼Œå°±å¿…é¡»è¦å…ˆäº†è§£ä¸€ä¸‹å“ˆå¸Œè¡¨ï¼š</p><ol><li>å†™æ“ä½œç›¸å…³æµç¨‹<ol><li>å½“æˆ‘ä»¬å‘æ•°ç»„ä¸­ â€œå¢â€ å…ƒç´ ï¼ˆä¾‹å¦‚ <code>apple:1</code>ï¼‰æ—¶ï¼Œ<code>HashMapï¼œK, Vï¼</code> é¦–å…ˆä¼šæ ¹æ®å…ƒç´ çš„ <code>Key</code> é€šè¿‡å“ˆå¸Œå‡½æ•°ï¼ˆå³ <code>Object#hashCode</code>ï¼‰è®¡ç®—å‡ºå“ˆå¸Œå€¼ï¼ˆå³ <code>Hash</code>ï¼‰ï¼Œå¹¶å°†å…¶è½¬æ¢æˆæ•°ç»„ç´¢å¼•ï¼ˆä½¿ç”¨ <code>Hash &amp; (Capacity - 1)</code>ï¼‰ï¼Œç„¶åå®šä½åˆ°æ•°ç»„ç´¢å¼•å¯¹åº”çš„ä½ç½®ï¼Œå¹¶å°†è¯¥å…ƒç´  â€œå¢â€ åˆ°è¯¥ä½ç½®</li></ol></li><li>è¯»æ“ä½œç›¸å…³æµç¨‹<ol><li>å½“æˆ‘ä»¬å‘æ•°ç»„è¯»æŸå…ƒç´ ï¼ˆä¾‹å¦‚ <code>Key = apple</code>ï¼‰æ—¶ï¼Œ<code>HashMapï¼œK, Vï¼</code> åŒæ ·ä¼šæ ¹æ®å…ƒç´ çš„ <code>Key</code> é€šè¿‡å“ˆå¸Œå‡½æ•°ï¼ˆå³ <code>Object#hashCode</code>ï¼‰è®¡ç®—å‡ºå“ˆå¸Œå€¼ï¼ˆå³ <code>Hash</code>ï¼‰ï¼Œå¹¶å°†å…¶è½¬æ¢æˆæ•°ç»„ç´¢å¼•ï¼ˆä½¿ç”¨ <code>Hash &amp; (Capacity - 1)</code>ï¼‰ï¼Œç„¶åå®šä½åˆ°æ•°ç»„ç´¢å¼•å¯¹åº”çš„ä½ç½®ï¼Œå¹¶å°†è¯¥å…ƒç´ è¯»å‡º</li></ol></li></ol><p>ç†æƒ³çŠ¶æ€ä¸‹ï¼Œæ— è®º <code>HashMapï¼œK, Vï¼</code> ä¸­æœ‰å¤šå°‘å…ƒç´ ï¼ˆ<code>10</code> ä¸ªæˆ– <code>1000</code> ä¸‡ä¸ªï¼‰ï¼Œæˆ‘ä»¬ â€œæŸ¥â€ æ“ä½œçš„å¹³å‡æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯ $O(1)$</p><p>ä½†æ˜¯å¦‚æœå‘ç”Ÿå“ˆå¸Œå†²çªï¼ˆä¾‹å¦‚ <code>banana:555</code> ä¹Ÿè¢«å†™åˆ°æ•°ç»„ç´¢å¼• <code>5</code> å¯¹åº”çš„ä½ç½®ï¼‰æ—¶ï¼Œé‚£ä¹ˆæ•°ç»„ç´¢å¼• <code>5</code> å¯¹åº”çš„ä½ç½®ä¸ä»…ä»…è¦å­˜æ”¾ <code>apple</code>ï¼Œè¿˜è¦å­˜æ”¾ <code>banana</code>ï¼Œæˆ‘ä»¬é€šå¸¸æ˜¯ä½¿ç”¨é“¾è¡¨æ¥è§£å†³è¿™ä¸ªé—®é¢˜</p><p>ä½†æ˜¯è¿™ä¹Ÿå¸¦æ¥ä¸€ä¸ªé—®é¢˜ï¼šæˆ‘ä»¬éœ€è¦éå†è¿™ä¸ªé“¾è¡¨ï¼Œç›´åˆ°æ‰¾åˆ°æˆ‘ä»¬éœ€è¦çš„å€¼ã€‚å¦‚æœå“ˆå¸Œå†²çªéå¸¸ä¸¥é‡ï¼Œå³åŒä¸€ä¸ªç´¢å¼•ä½ç½®çš„é“¾è¡¨å˜å¾—éå¸¸é•¿ï¼Œæˆ‘ä»¬éå†çš„æ—¶é—´ä¹Ÿä¼šå˜çš„éå¸¸é•¿</p><p>æˆ‘ä»¬åœ¨ <code>MySQL</code> ä¸­ä¹Ÿæ¥è§¦è¿‡ï¼Œä¸€ä¸ªé“¾è¡¨å¦‚æœéå¸¸é•¿ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡çº¢é»‘æ ‘æ¥ä¼˜åŒ–è¿™ä¸ªé—®é¢˜ï¼Œäºæ˜¯ <code>Java8</code> å¼•å…¥äº†ä¸€ä¸ªé‡å¤§ä¼˜åŒ–ï¼šå½“åŒä¸€ä¸ªç´¢å¼•ä½ç½®çš„é“¾è¡¨é•¿åº¦è¾¾åˆ°ä¸€å®šé˜ˆå€¼ï¼ˆé»˜è®¤ä¸º <code>8</code>ï¼‰ï¼Œå¹¶ä¸”æ•´ä¸ªå“ˆå¸Œè¡¨çš„å¤§å°ï¼ˆå³æ•°ç»„é•¿åº¦ï¼‰ä¹Ÿè¾¾åˆ°ä¸€å®šé˜ˆå€¼ï¼ˆé»˜è®¤ä¸º <code>64</code>ï¼‰æ—¶ï¼Œè¿™ä¸ªé“¾è¡¨ä¼šè‡ªåŠ¨è½¬æ¢æˆä¸€æ£µçº¢é»‘æ ‘</p><hr><h5 id="2-3-4-4-HashMapï¼œK-Vï¼-æ‰©å®¹æœºåˆ¶"><a href="#2-3-4-4-HashMapï¼œK-Vï¼-æ‰©å®¹æœºåˆ¶" class="headerlink" title="2.3.4.4. HashMapï¼œK, Vï¼ æ‰©å®¹æœºåˆ¶"></a>2.3.4.4. HashMapï¼œK, Vï¼ æ‰©å®¹æœºåˆ¶</h5><p>å½“æ•°ç»„ä¸­çš„å…ƒç´ çš„æ•°é‡è¾¾åˆ° â€œæ•°ç»„å®¹é‡ * è´Ÿè½½å› å­â€ æ—¶å°±ä¼šè§¦å‘æ‰©å®¹ã€‚ä¾‹å¦‚é»˜è®¤çš„æ•°ç»„å®¹é‡æ˜¯ <code>16</code>ï¼Œé»˜è®¤çš„è´Ÿè½½å› å­æ˜¯ <code>0.75</code>ï¼Œé‚£ä¹ˆå…ƒç´ æ•°é‡è¾¾åˆ° <code>12</code> æ—¶ä¾¿ä¼šå¼€å§‹æ‰©å®¹</p><p>åœ¨ <code>Java8</code> ä¹‹å‰ï¼Œ<code>HashMapï¼œK, Vï¼</code> æ‰©å®¹æ—¶ä¼šåˆ›å»ºä¸€ä¸ªå®¹é‡ä¸ºåŸæ¥ <code>2</code> å€çš„æ–°æ•°ç»„ã€‚<code>HashMapï¼œK, Vï¼</code> ä¼šéå†æ—§æ•°ç»„ï¼Œå¦‚æœæŸæ•°ç»„ä½ç½®ä¸Šæœ‰å…ƒç´ ï¼ˆä¾‹å¦‚æ˜¯é“¾è¡¨ï¼‰ï¼Œ<code>HashMapï¼œK, Vï¼</code> ä¼šéå†é“¾è¡¨ï¼Œå¹¶å°†æ¯ä¸ªå…ƒç´ çš„å“ˆå¸Œå€¼é‡æ–°è½¬æ¢æˆæ–°æ•°ç»„çš„æ•°ç»„ç´¢å¼•ï¼Œç„¶åå®šä½åˆ°æ•°ç»„ç´¢å¼•å¯¹åº”çš„æ–°æ•°ç»„ä½ç½®ï¼Œå¹¶å°†å…ƒç´ æ‹·è´åˆ°è¯¥ä½ç½®ï¼ˆå¹¶ä¸æ˜¯è°ƒç”¨ <code>Arrays#copyOf</code>ï¼‰ã€‚ä½†æ˜¯ç”±äºéå†çš„é¡ºåºæ˜¯ <code>A â” B â” C</code>ï¼ˆ<code>C</code> å…ˆ â€œå¢â€ è¿›æ¥çš„ï¼‰ï¼Œæ‰€ä»¥åœ¨æ–°æ•°ç»„ä½ç½®ä¸Šå®ƒä»¬çš„é¡ºåºå¯èƒ½å°±å˜æˆäº† <code>C â” B â” A</code>ï¼ˆ<code>A</code> å…ˆ â€œå¢â€ è¿›æ¥çš„ï¼‰ï¼Œè¿™å°±æ˜¯å¤§åé¼é¼çš„ â€œå¤´æ’æ³•â€ï¼ˆï¼‰</p><p>åœ¨ <code>Java8</code> ä¹‹åï¼Œ<code>HashMapï¼œK, Vï¼</code> æ‰©å®¹æ—¶åŒæ ·ä¼šåˆ›å»ºä¸€ä¸ªå®¹é‡ä¸ºåŸæ¥ <code>2</code> å€çš„æ–°æ•°ç»„ã€‚<code>HashMapï¼œK, Vï¼</code> åŒæ ·ä¼šéå†æ—§æ•°ç»„ï¼Œå¦‚æœæŸæ•°ç»„ä½ç½®ä¸Šæœ‰å…ƒç´ ï¼ˆä¾‹å¦‚æ˜¯é“¾è¡¨ï¼‰ï¼Œ<code>HashMapï¼œK, Vï¼</code> ä¼šéå†é“¾è¡¨ï¼Œä½†æ˜¯å¹¶ä¸ä¼šå°†æ¯ä¸ªå…ƒç´ çš„å“ˆå¸Œå€¼é‡æ–°è½¬æ¢æˆæ–°æ•°ç»„çš„æ•°ç»„ç´¢å¼•ï¼Œè€Œæ˜¯åˆ©ç”¨äº†ä¸€ç§åŸºäºä½è¿ç®—çš„ä¼˜åŒ–</p><p>è¿™ä¸ªä½è¿ç®—çš„ä¼˜åŒ–æ˜¯æŒ‡ï¼šç”±äºæ•°ç»„çš„é•¿åº¦å§‹ç»ˆæ˜¯ <code>2</code> çš„å¹‚ï¼ˆä¾‹å¦‚ä» <code>16</code>ï¼ˆ<code>10000</code>ï¼‰ æ‰©åˆ° <code>32</code>ï¼ˆ<code>100000</code>ï¼‰ï¼‰ï¼Œæ–°é•¿åº¦ç›¸æ¯”æ—§é•¿åº¦ä»…å¤šå‡ºä¸€ä½é«˜ä½ã€‚<code>HashMapï¼œK, Vï¼</code> åªéœ€è¦æ£€æŸ¥å…ƒç´ çš„å“ˆå¸Œå€¼åœ¨è¿™ä¸€æ–°å¢é«˜ä½ä¸Šçš„å€¼ï¼ˆä½¿ç”¨ <code>Hash &amp; OldCapacity</code>ï¼Œè€Œä¸æ˜¯ <code>Hash &amp; (OldCapacity - 1)</code>ï¼‰ï¼š</p><ol><li>å¦‚æœè¯¥ä½ä¸º <code>0</code><ol><li>è¯¥å…ƒç´ åœ¨æ–°æ•°ç»„ä¸­çš„æ•°ç»„ç´¢å¼•ä¿æŒä¸å˜</li></ol></li><li>å¦‚æœè¯¥ä½ä¸º <code>1</code><ol><li>è¯¥å…ƒç´ åœ¨æ–°æ•°ç»„ä¸­çš„æ•°ç»„ç´¢å¼• &#x3D; å…ƒç´ åœ¨æ—§æ•°ç»„ä¸Šçš„æ•°ç»„ç´¢å¼• + æ—§æ•°ç»„çš„æ•°ç»„é•¿åº¦</li></ol></li></ol><p>é™¤æ­¤ä¹‹å¤–ï¼Œä¸ºäº†è§£å†³ â€œå¤´æ’æ³•â€ åœ¨å¤šçº¿ç¨‹å¹¶å‘æƒ…å†µä¸‹å‡ºç°çš„ä¸¥é‡é—®é¢˜ï¼Œ<code>HashMapï¼œK, Vï¼</code> è¿˜å¼•å…¥äº†ä¸¤æ¡é“¾è¡¨ï¼Œè¿™é‡Œç®€ç§°ä¸º â€œä½ä½é“¾è¡¨â€ã€â€œé«˜ä½é“¾è¡¨â€ã€‚å½“ <code>HashMapï¼œK, Vï¼</code> æ£€æŸ¥å…ƒç´ çš„å“ˆå¸Œå€¼åœ¨è¿™ä¸€æ–°å¢é«˜ä½ä¸Šçš„å€¼ä¸º <code>0</code> æ—¶ï¼Œå°±ä¼šæŠŠå…ƒç´ é“¾æ¥åˆ°ä½ä½é“¾è¡¨ã€‚å¦‚æœä¸º <code>1</code> æ—¶ï¼Œå°±ä¼šæŠŠå…ƒç´ é“¾æ¥åˆ°é«˜ä½é“¾è¡¨ã€‚ç„¶åå½“æˆ‘ä»¬éå†å®Œè¿™ä¸ªé“¾è¡¨åï¼Œå°±æŠŠä½ä½é“¾è¡¨å’Œé«˜ä½é“¾è¡¨æ”¾åˆ°æ–°æ•°ç»„å¯¹åº”çš„ä½ç½®ã€‚ç”±äºéå†çš„é¡ºåºæ˜¯ <code>A â” B â” C</code>ï¼Œè€Œåœ¨ä½ä½é“¾è¡¨æˆ–é«˜ä½é“¾è¡¨ä¸­å¯èƒ½ä»ç„¶æ˜¯ <code>A â” B â” C</code>ï¼Œè¿™å°±æ˜¯å¤§åé¼é¼çš„ â€œå°¾æ’æ³•â€</p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>æ‰€è°“çš„ â€œå¯èƒ½â€ æ˜¯æŒ‡ï¼šå®ƒä»¬æœªå¿…è¿˜ä¼šåœ¨åŒä¸€ä¸ªæ•°ç»„ä½ç½®ä¸Š</li><li>å“ˆå¸Œå†²çªæ˜¯æŒ‡ï¼šå¯èƒ½æ˜¯ <code>Key</code> ä¸åŒï¼Œä¹Ÿå¯èƒ½æ˜¯è®¡ç®—å‡ºçš„å“ˆå¸Œå€¼ä¸åŒï¼Œä½†æ˜¯è½¬æ¢æˆçš„æ•°ç»„ç´¢å¼•æ˜¯ç›¸åŒçš„</li></ol></blockquote><hr><h5 id="2-3-4-5-HashMap-é—®é¢˜çˆ†ç ´"><a href="#2-3-4-5-HashMap-é—®é¢˜çˆ†ç ´" class="headerlink" title="2.3.4.5. HashMap é—®é¢˜çˆ†ç ´"></a>2.3.4.5. HashMap é—®é¢˜çˆ†ç ´</h5><h6 id="2-3-4-5-1-å¤šçº¿ç¨‹å¹¶å‘å®‰å…¨æ€§é—®é¢˜"><a href="#2-3-4-5-1-å¤šçº¿ç¨‹å¹¶å‘å®‰å…¨æ€§é—®é¢˜" class="headerlink" title="2.3.4.5.1. å¤šçº¿ç¨‹å¹¶å‘å®‰å…¨æ€§é—®é¢˜"></a>2.3.4.5.1. å¤šçº¿ç¨‹å¹¶å‘å®‰å…¨æ€§é—®é¢˜</h6><p>ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼Œæˆ‘ä»¬é€šå¸¸ä¸ºå…¶åŠ é”æˆ–è€…ä½¿ç”¨å¦å¤–ä¸€ç§æ•°æ®ç»“æ„ï¼š<code>ConcurrentHashMapï¼œK, Vï¼</code></p><hr><h6 id="2-3-4-5-2-è¿­ä»£å™¨çš„-â€œå¢â€ã€â€œåˆ â€-å¼‚å¸¸é—®é¢˜"><a href="#2-3-4-5-2-è¿­ä»£å™¨çš„-â€œå¢â€ã€â€œåˆ â€-å¼‚å¸¸é—®é¢˜" class="headerlink" title="2.3.4.5.2. è¿­ä»£å™¨çš„ â€œå¢â€ã€â€œåˆ â€ å¼‚å¸¸é—®é¢˜"></a>2.3.4.5.2. è¿­ä»£å™¨çš„ â€œå¢â€ã€â€œåˆ â€ å¼‚å¸¸é—®é¢˜</h6><p>ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼Œ<code>HashMapï¼œK, Vï¼</code> é‡‡å–äº†å¿«é€Ÿå¤±è´¥ï¼ˆ<code>Fail-fast</code>ï¼‰ç­–ç•¥ã€‚</p><hr><h6 id="2-3-4-5-3-Key-Value-é‡å¤é—®é¢˜"><a href="#2-3-4-5-3-Key-Value-é‡å¤é—®é¢˜" class="headerlink" title="2.3.4.5.3. Key-Value é‡å¤é—®é¢˜"></a>2.3.4.5.3. Key-Value é‡å¤é—®é¢˜</h6><p><code>HashMapï¼œK, Vï¼</code> ä¸¥ç¦å…ƒç´ çš„ <code>Key</code> é‡å¤ï¼Œå®ƒæ˜¯é€šè¿‡ <code>ï¼ˆå…ƒç´ çš„ Key çš„ Hash ç›¸ç­‰ï¼‰ &amp;&amp; ï¼ˆå…ƒç´ çš„ Key ç›¸ç­‰ï¼‰</code>æ¥åˆ¤æ–­å…ƒç´ çš„ <code>Key</code> æ˜¯å¦é‡å¤çš„</p><p><code>HashMapï¼œK, Vï¼</code> å…è®¸å…ƒç´ çš„ <code>Value</code> é‡å¤</p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>è¦åˆ¤æ–­ä¸¤ä¸ªå…ƒç´ çš„ <code>Key</code> çš„ <code>Hash</code> æ˜¯å¦ç›¸ç­‰ï¼Œå‰ææ˜¯æˆ‘ä»¬å¿…é¡»èƒ½è®¡ç®—å‡º <code>Key</code> çš„ <code>Hash</code>ã€‚å› æ­¤æˆ‘ä»¬çš„ <code>Key</code> å¿…é¡»é‡å†™ <code>Object#hashCode</code>ï¼ˆ<code>Object#hashCode</code> é»˜è®¤åŸºäºå®ä¾‹çš„å†…å­˜åœ°å€è®¡ç®—ï¼‰</li><li>åŒæ ·çš„ï¼Œè¦åˆ¤æ–­ä¸¤ä¸ªå…ƒç´ çš„ <code>Key</code> æ˜¯å¦ç›¸ç­‰ï¼Œæˆ‘ä»¬çš„ <code>Key</code> å¿…é¡»é‡å†™ <code>Object#equals</code>ï¼ˆ<code>Object#equals</code> é»˜è®¤æ¯”è¾ƒçš„æ˜¯å®ä¾‹çš„å†…å­˜åœ°å€ï¼‰</li></ol></blockquote><hr><h6 id="2-3-4-5-4-Key-Value-ä¸º-null-é—®é¢˜"><a href="#2-3-4-5-4-Key-Value-ä¸º-null-é—®é¢˜" class="headerlink" title="2.3.4.5.4. Key-Value ä¸º null é—®é¢˜"></a>2.3.4.5.4. Key-Value ä¸º null é—®é¢˜</h6><p><code>HashMapï¼œK, Vï¼</code> å…è®¸å…ƒç´ çš„ <code>Key</code> ä¸º <code>null</code>ï¼Œä½†æ˜¯ç”±äºå…ƒç´ çš„ <code>Key</code> ä¸å¯é‡å¤ï¼Œæ‰€ä»¥ <code>HashMapï¼œK, Vï¼</code> ä¸­æœ€å¤šåªèƒ½æœ‰ä¸€ä¸ªå…ƒç´ çš„ <code>Key</code> ä¸º <code>null</code>ã€‚å¦‚æœæŸå…ƒç´ çš„å…ƒç´ çš„ <code>Key</code> ä¸º <code>null</code>ï¼Œ<code>HashMapï¼œK, Vï¼</code> å¹¶ä¸ä¼šè®¡ç®—å®ƒçš„ <code>Key</code> çš„å“ˆå¸Œå€¼ï¼Œè€Œæ˜¯å¼ºåˆ¶å°†å…¶å“ˆå¸Œå€¼è§†ä¸º <code>0</code>ã€‚å› æ­¤ï¼Œ<code>Key</code> ä¸º <code>null</code> çš„å…ƒç´ çš„æ•°ç»„ç´¢å¼•æ€»æ˜¯ä¸º <code>0</code></p><p><code>HashMapï¼œK, Vï¼</code> å…è®¸å…ƒç´ çš„ <code>Value</code> ä¸º <code>null</code>ï¼Œå¹¶ä¸”æ•°é‡ä¸é™åˆ¶</p><hr><h6 id="2-3-4-5-5-é¢‘ç¹æ‰©å®¹å¯¼è‡´çš„æ€§èƒ½æŠ–åŠ¨é—®é¢˜"><a href="#2-3-4-5-5-é¢‘ç¹æ‰©å®¹å¯¼è‡´çš„æ€§èƒ½æŠ–åŠ¨é—®é¢˜" class="headerlink" title="2.3.4.5.5. é¢‘ç¹æ‰©å®¹å¯¼è‡´çš„æ€§èƒ½æŠ–åŠ¨é—®é¢˜"></a>2.3.4.5.5. é¢‘ç¹æ‰©å®¹å¯¼è‡´çš„æ€§èƒ½æŠ–åŠ¨é—®é¢˜</h6><p>ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼Œæˆ‘ä»¬åœ¨å·²çŸ¥è¦å­˜å‚¨å¤§é‡æ•°æ®çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥åœ¨åˆ›å»º <code>HashMapï¼œK, Vï¼</code> å®ä¾‹çš„æ—¶å€™ï¼ŒæŒ‡å®šä¸€ä¸ªè¾ƒå¤§çš„åˆå§‹å®¹é‡ï¼Œé¿å…é¢‘ç¹æ‰©å®¹</p><hr><h6 id="2-3-4-5-6-å“ˆå¸Œè¡¨è¯»æ“ä½œå¤±æ•ˆé—®é¢˜"><a href="#2-3-4-5-6-å“ˆå¸Œè¡¨è¯»æ“ä½œå¤±æ•ˆé—®é¢˜" class="headerlink" title="2.3.4.5.6. å“ˆå¸Œè¡¨è¯»æ“ä½œå¤±æ•ˆé—®é¢˜"></a>2.3.4.5.6. å“ˆå¸Œè¡¨è¯»æ“ä½œå¤±æ•ˆé—®é¢˜</h6><p>è¿™æ˜¯å“ˆå¸Œè¡¨ä¸€ä¸ªéå¸¸å…¸å‹çš„é—®é¢˜ï¼šå½“ä½ æŠŠä¸€ä¸ªå…ƒç´  â€œå¢â€ åˆ°äº† <code>HashMapï¼œK, Vï¼</code> ä¸­ï¼Œå®ƒä¼šè¢« <code>HashMapï¼œK, Vï¼</code> â€œå¢â€ åˆ°æ•°ç»„çš„æŸä¸ªä½ç½®ã€‚å¦‚æœä½ åœ¨ â€œå¢â€ ä¹‹åï¼Œâ€œæ”¹â€ äº†å…ƒç´ çš„ <code>Key</code>ï¼Œå½±å“åˆ°äº†å“ˆå¸Œå€¼çš„è®¡ç®—ï¼Œä½†æ˜¯ <code>HashMapï¼œK, Vï¼</code> å¹¶ä¸ä¼šå†è°ƒæ•´å®ƒçš„ä½ç½®äº†</p><p>æ‰€ä»¥å½“ä½ å»è¯»è¯¥å…ƒç´ æ—¶ï¼Œ<code>HashMapï¼œK, Vï¼</code> ä¼šæ ¹æ®å…ƒç´ çš„æ–° <code>Key</code> é€šè¿‡å“ˆå¸Œå‡½æ•°è®¡ç®—å‡ºå“ˆå¸Œå€¼ï¼Œå¹¶å°†å…¶è½¬æ¢æˆæ•°ç»„ç´¢å¼•ï¼Œç„¶åå®šä½åˆ°æ•°ç»„ç´¢å¼•å¯¹åº”çš„ä½ç½®ã€‚ä½†æ˜¯è¯¥å…ƒç´ ä»ç„¶åœ¨å…ƒç´ çš„æ—§ <code>Key</code> å¯¹åº”çš„æ•°ç»„ä½ç½®ï¼Œæ‰€ä»¥æ ¹æœ¬æ— æ³•è¢«æ­£ç¡®è¯»åˆ°ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿™ä¹Ÿé€ æˆäº†ä¸€ä¸ªå†…å­˜æ³„æ¼é—®é¢˜</p><p>ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼Œæˆ‘ä»¬å…ƒç´ çš„ <code>Key</code> å¿…é¡»æ˜¯ä¸å¯å˜çš„ï¼ˆå³ä¸å¯å˜ç±»ï¼‰</p><hr><h4 id="2-3-5-WeakHashMapï¼œK-Vï¼"><a href="#2-3-5-WeakHashMapï¼œK-Vï¼" class="headerlink" title="2.3.5. WeakHashMapï¼œK, Vï¼"></a>2.3.5. WeakHashMapï¼œK, Vï¼</h4><h5 id="2-3-5-1-WeakHashMapï¼œK-Vï¼-ä½“ç³»ç»“æ„"><a href="#2-3-5-1-WeakHashMapï¼œK-Vï¼-ä½“ç³»ç»“æ„" class="headerlink" title="2.3.5.1. WeakHashMapï¼œK, Vï¼ ä½“ç³»ç»“æ„"></a>2.3.5.1. WeakHashMapï¼œK, Vï¼ ä½“ç³»ç»“æ„</h5><p><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B-9.png"></p><hr><h5 id="2-3-5-2-WeakHashMapï¼œK-Vï¼-åº•å±‚å®ç°"><a href="#2-3-5-2-WeakHashMapï¼œK-Vï¼-åº•å±‚å®ç°" class="headerlink" title="2.3.5.2. WeakHashMapï¼œK, Vï¼ åº•å±‚å®ç°"></a>2.3.5.2. WeakHashMapï¼œK, Vï¼ åº•å±‚å®ç°</h5><p><code>WeakHashMapï¼œK, Vï¼</code> åº•å±‚æ˜¯åŸºäºä¸€ä¸ªæ•°ç»„ + å¤šæ¡å•å‘é“¾è¡¨å®ç°çš„ï¼ˆç±»ä¼¼äº <code>Java8</code> ä¹‹å‰çš„ <code>HashMapï¼œK, Vï¼</code> çš„åº•å±‚å®ç°ï¼Œæ²¡æœ‰çº¢é»‘æ ‘ï¼‰</p><p><code>WeakHashMapï¼œK, Vï¼</code> æ˜¯é€šè¿‡ <code>HashMapï¼œK, Vï¼â”table</code> å­˜å‚¨æ•°æ®çš„ï¼Œè€Œå®ƒåˆæ˜¯ä¸€ä¸ªç”± <code>WeakHashMapï¼œK, Vï¼.Entryï¼œK, Vï¼</code> æ„å»ºçš„æ•°ç»„ï¼Œå…¶åŸºæœ¬å±æ€§å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Entry</span>&lt;K,V&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title class_">WeakReference</span>&lt;Object&gt; <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Map</span>.Entry&lt;K,V&gt; &#123;<br><br>V value;<br><br><span class="hljs-keyword">final</span> <span class="hljs-type">int</span> hash;<br><br>Entry&lt;K,V&gt; next;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>é™¤æ­¤ä¹‹å¤–ï¼Œæ¯ä¸€ä¸ª <code>WeakHashMapï¼œK, Vï¼.Entryï¼œK, Vï¼</code> è¿˜ç»´æŠ¤äº†ä¸€æ¡ç”± <code>WeakHashMapï¼œK, Vï¼.Entryï¼œK, Vï¼</code> æ„å»ºçš„å•å‘é“¾è¡¨</p><hr><h5 id="2-3-5-3-WeakHashMapï¼œK-Vï¼-æ‰©å®¹æœºåˆ¶"><a href="#2-3-5-3-WeakHashMapï¼œK-Vï¼-æ‰©å®¹æœºåˆ¶" class="headerlink" title="2.3.5.3. WeakHashMapï¼œK, Vï¼ æ‰©å®¹æœºåˆ¶"></a>2.3.5.3. WeakHashMapï¼œK, Vï¼ æ‰©å®¹æœºåˆ¶</h5><p><code>WeakHashMapï¼œK, Vï¼</code> çš„æ‰©å®¹æœºåˆ¶å’Œ <code>Java8</code> ä¹‹å‰çš„ <code>HashMapï¼œK, Vï¼</code> çš„æ‰©å®¹æœºåˆ¶ç›¸ä¼¼ï¼Œåªä¸è¿‡åœ¨æ‰©å®¹å‰ä¼šè¿›è¡Œä¸€æ¬¡æ¸…ç†ã€‚å¦‚æœæ¸…ç†åå‘ç°åˆä¸è¶…è¿‡ â€æ•°ç»„å®¹é‡ * è´Ÿè½½å› å­â€œ äº†ï¼Œåˆ™ä¸ä¼šå†è¿›è¡Œæ‰©å®¹ã€‚è¯¦è§ä¸Šæ–‡ï¼š<code>HashMapï¼œK, Vï¼</code></p><hr><h5 id="2-3-5-4-WeakHashMapï¼œK-Vï¼-é—®é¢˜çˆ†ç ´"><a href="#2-3-5-4-WeakHashMapï¼œK-Vï¼-é—®é¢˜çˆ†ç ´" class="headerlink" title="2.3.5.4. WeakHashMapï¼œK, Vï¼ é—®é¢˜çˆ†ç ´"></a>2.3.5.4. WeakHashMapï¼œK, Vï¼ é—®é¢˜çˆ†ç ´</h5><p>ç”±äº <code>WeakHashMapï¼œK, Vï¼</code> åº•å±‚å®ç°ç±»ä¼¼äº <code>Java8</code> ä¹‹å‰çš„ <code>HashMapï¼œK, Vï¼</code> çš„åº•å±‚å®ç°ï¼Œæ‰€ä»¥ <code>HashMapï¼œK, Vï¼</code> æ‹¥æœ‰çš„é—®é¢˜ï¼Œ<code>WeakHashMapï¼œK, Vï¼</code> ä¸€èˆ¬éƒ½æœ‰ã€‚è¯¦è§ä¸Šæ–‡ï¼š<code>HashMapï¼œK, Vï¼</code></p><hr><h4 id="2-3-6-LinkedHashMapï¼œK-Vï¼"><a href="#2-3-6-LinkedHashMapï¼œK-Vï¼" class="headerlink" title="2.3.6. LinkedHashMapï¼œK, Vï¼"></a>2.3.6. LinkedHashMapï¼œK, Vï¼</h4><h5 id="2-3-6-1-LinkedHashMapï¼œK-Vï¼-æ¦‚è¿°"><a href="#2-3-6-1-LinkedHashMapï¼œK-Vï¼-æ¦‚è¿°" class="headerlink" title="2.3.6.1. LinkedHashMapï¼œK, Vï¼ æ¦‚è¿°"></a>2.3.6.1. LinkedHashMapï¼œK, Vï¼ æ¦‚è¿°</h5><p>æƒ³è±¡è¿™æ ·å‡ ä¸ªé—®é¢˜ï¼š</p><ol><li>å¦‚æœæˆ‘ä»¬ç”¨ <code>HashMapï¼œK, Vï¼</code> æ¥å®ç°â€œè´­ç‰©è½¦â€ï¼Œç”¨æˆ·æŒ‰é¡ºåºåŠ å…¥äº† <code>A</code>ã€<code>B</code>ã€<code>C</code>ï¼Œä½†ç”±äº <code>HashMapï¼œK, Vï¼</code> æœ¬èº«æ˜¯æ— åºç»“æ„ï¼Œéå†æ—¶å¯èƒ½å¾—åˆ° <code>B</code>ã€<code>C</code>ã€<code>A</code>ã€‚æ›´ç³Ÿç³•çš„æ˜¯ï¼Œä¸€æ—¦ <code>HashMapï¼œK, Vï¼</code> å‘ç”Ÿæ‰©å®¹ï¼Œéå†çš„é¡ºåºè¿˜å¯èƒ½å†æ¬¡å˜åŒ–ï¼ˆç®€å•æ¥è¯´å°±æ˜¯ <code>HashMapï¼œK, Vï¼</code> ä¸æ”¯æŒ <code>FIFO</code> é¡ºåºï¼‰</li><li>ç”±äº <code>HashMapï¼œK, Vï¼</code> åº•å±‚ä½¿ç”¨äº†æ•°ç»„ï¼Œè¿™æ„å‘³ç€å®ƒä¸å¯é¿å…åœ°å…·æœ‰æ•°ç»„çš„å…¸å‹é—®é¢˜ï¼šæ•°ç»„çš„å®¹é‡ä¸º <code>10000</code>ï¼Œä½†å®é™…åªå­˜å‚¨äº† <code>3</code> ä¸ªå…ƒç´ ï¼ˆä½ ä¸çŸ¥é“ç©¶ç«Ÿå­˜å‚¨äº†å¤šå°‘å…ƒç´ ï¼‰ï¼Œè€Œä¸”è¿™ <code>3</code> ä¸ªå…ƒç´ å­˜å‚¨åœ¨å“ªé‡Œä½ ä¸çŸ¥é“ã€‚æ‰€ä»¥åœ¨éå†çš„æ—¶å€™ï¼ˆæ³¨æ„æ˜¯éå†çš„æ—¶å€™ï¼‰åªèƒ½æŠŠ <code>10000</code> ä¸ªä½ç½®éå†ä¸€é</li></ol><p>ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œ<code>LinkedHashMapï¼œK, Vï¼</code> åœ¨ <code>HashMapï¼œK, Vï¼</code> çš„åŸºç¡€ä¸Šï¼Œè¿˜ç»´æŠ¤äº†ä¸€æ¡ç”± <code>LinkedHashMapï¼œK, Vï¼.Entryï¼œK, Vï¼</code> æ„å»ºçš„åŒå‘é“¾è¡¨</p><p>åœ¨æ‰§è¡Œ â€å¢åˆ æ”¹â€œ æ“ä½œæ—¶ï¼Œä¼šåŒæ—¶æ“ä½œ <code>HashMapï¼œK, Vï¼</code> å’ŒåŒå‘é“¾è¡¨ã€‚å¸¸è§„çš„ â€æŸ¥â€œ æ“ä½œä»ç„¶ä¾èµ– <code>HashMapï¼œK, Vï¼</code> æ¥è·å¾—é«˜æ€§èƒ½ï¼Œä½†æ˜¯åªè¦æ¶‰åŠåˆ°éå†ï¼Œæˆ‘ä»¬å°±ä¼šä½¿ç”¨åŒå‘é“¾è¡¨</p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li><code>LinkedHashMapï¼œK, Vï¼</code> é™¤äº†æ”¯æŒæ’å…¥é¡ºåºå¤–ï¼Œè¿˜æ”¯æŒæœ€è¿‘è®¿é—®é¡ºåºï¼Œå¤©ç„¶ç¬¦åˆ <code>LRU</code> å†…å­˜æ·˜æ±°ç­–ç•¥</li></ol></blockquote><hr><h5 id="2-3-6-2-LinkedHashMapï¼œK-Vï¼-ä½“ç³»ç»“æ„"><a href="#2-3-6-2-LinkedHashMapï¼œK-Vï¼-ä½“ç³»ç»“æ„" class="headerlink" title="2.3.6.2. LinkedHashMapï¼œK, Vï¼ ä½“ç³»ç»“æ„"></a>2.3.6.2. LinkedHashMapï¼œK, Vï¼ ä½“ç³»ç»“æ„</h5><p><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B-12.png"></p><hr><h5 id="2-3-6-3-LinkedHashMapï¼œK-Vï¼-åº•å±‚å®ç°"><a href="#2-3-6-3-LinkedHashMapï¼œK-Vï¼-åº•å±‚å®ç°" class="headerlink" title="2.3.6.3. LinkedHashMapï¼œK, Vï¼ åº•å±‚å®ç°"></a>2.3.6.3. LinkedHashMapï¼œK, Vï¼ åº•å±‚å®ç°</h5><p><code>LinkedHashMapï¼œK, Vï¼</code> åº•å±‚æ˜¯åŸºäºä¸€ä¸ª <code>HashMapï¼œK, Vï¼</code> + ä¸€æ¡åŒå‘é“¾è¡¨å®ç°çš„</p><p><code>LinkedHashMapï¼œK, Vï¼</code> æ˜¯é€šè¿‡ä»¥ä¸‹æ–¹å¼å­˜å‚¨æ•°æ®çš„ï¼š</p><ol><li><code>HashMapï¼œK, Vï¼-&gt;table</code>ï¼Œè€Œå®ƒåˆæ˜¯ä¸€ä¸ªç”± <code>HashMapï¼œK, Vï¼.Nodeï¼œK, Vï¼</code> æ„å»ºçš„æ•°ç»„</li><li>ä¸€æ¡ç”± <code>LinkedHashMapï¼œK, Vï¼.Entryï¼œK, Vï¼</code> æ„å»ºçš„åŒå‘é“¾è¡¨</li></ol><p>å®ƒä»¬çš„åŸºæœ¬å±æ€§å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// HashMapï¼œK, Vï¼-&gt;Nodeï¼œK, Vï¼</span><br><span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Node</span>&lt;K,V&gt; <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Map</span>.Entry&lt;K,V&gt; &#123;<br><br><span class="hljs-keyword">final</span> <span class="hljs-type">int</span> hash;<br><br><span class="hljs-keyword">final</span> K key;<br><br>V value;<br><br>Node&lt;K,V&gt; next;<br><br>&#125;<br><br><span class="hljs-comment">// LinkedHashMapï¼œK, Vï¼.Entryï¼œK, Vï¼</span><br><span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Entry</span>&lt;K,V&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title class_">HashMap</span>.Node&lt;K,V&gt; &#123;<br><br>Entry&lt;K,V&gt; before, after;<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h5 id="2-3-6-4-LinkedHashMap-é—®é¢˜çˆ†ç ´"><a href="#2-3-6-4-LinkedHashMap-é—®é¢˜çˆ†ç ´" class="headerlink" title="2.3.6.4. LinkedHashMap é—®é¢˜çˆ†ç ´"></a>2.3.6.4. LinkedHashMap é—®é¢˜çˆ†ç ´</h5><p>ç”±äº<code>LinkedHashMapï¼œK, Vï¼</code> åº•å±‚æ˜¯åŸºäº <code>HashMapï¼œK, Vï¼</code> å®ç°çš„ï¼Œæ‰€ä»¥ <code>HashMapï¼œK, Vï¼</code> æ‹¥æœ‰çš„é—®é¢˜ï¼Œ<code>LinkedHashMapï¼œK, Vï¼</code> ä¸€èˆ¬éƒ½æœ‰ã€‚è¯¦è§ä¸Šæ–‡ï¼š<code>HashMapï¼œK, Vï¼</code></p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>ä¸ºäº†è§£å†³ <code>LinkedHashMapï¼œK, Vï¼</code> å¤šçº¿ç¨‹å¹¶å‘å®‰å…¨æ€§é—®é¢˜ï¼Œæˆ‘ä»¬é€šå¸¸ä¸ºå…¶åŠ é”</li><li><code>LinkedHashMapï¼œK, Vï¼</code> æ¯”è¾ƒå¥‡æ€ªï¼Œå…¶ â€æŸ¥â€œ æ“ä½œä¹Ÿä¼šå¯¼è‡´è¿­ä»£å™¨çš„ â€œå¢â€ã€â€œåˆ â€ å¼‚å¸¸é—®é¢˜</li></ol></blockquote><hr><h4 id="2-3-7-ConcurrentHashMapï¼œK-Vï¼"><a href="#2-3-7-ConcurrentHashMapï¼œK-Vï¼" class="headerlink" title="2.3.7. ConcurrentHashMapï¼œK, Vï¼"></a>2.3.7. ConcurrentHashMapï¼œK, Vï¼</h4><h5 id="2-3-7-1-ConcurrentHashMapï¼œK-Vï¼-ä½“ç³»ç»“æ„"><a href="#2-3-7-1-ConcurrentHashMapï¼œK-Vï¼-ä½“ç³»ç»“æ„" class="headerlink" title="2.3.7.1. ConcurrentHashMapï¼œK, Vï¼ ä½“ç³»ç»“æ„"></a>2.3.7.1. ConcurrentHashMapï¼œK, Vï¼ ä½“ç³»ç»“æ„</h5><p><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B-24.png"></p><hr><h5 id="2-3-7-2-ConcurrentHashMapï¼œK-Vï¼-åº•å±‚å®ç°"><a href="#2-3-7-2-ConcurrentHashMapï¼œK-Vï¼-åº•å±‚å®ç°" class="headerlink" title="2.3.7.2. ConcurrentHashMapï¼œK, Vï¼ åº•å±‚å®ç°"></a>2.3.7.2. ConcurrentHashMapï¼œK, Vï¼ åº•å±‚å®ç°</h5><h6 id="2-3-7-2-1-Java8-ä¹‹å‰"><a href="#2-3-7-2-1-Java8-ä¹‹å‰" class="headerlink" title="2.3.7.2.1. Java8 ä¹‹å‰"></a>2.3.7.2.1. Java8 ä¹‹å‰</h6><p>åœ¨ <code>Java8</code> ä¹‹å‰ï¼Œ<code>ConcurrentHashMapï¼œK, Vï¼</code> åº•å±‚æ˜¯åŸºäºå¤šä¸ªæ•°ç»„ + å¤šæ¡å•å‘é“¾è¡¨ + å¤šä¸ª <code>ReentrantLock</code> ï¼ˆæ— æ¡ä»¶é˜Ÿåˆ—ï¼‰å®ç°çš„</p><p><code>ConcurrentHashMapï¼œK, Vï¼</code> æ˜¯é€šè¿‡ <code>ConcurrentHashMapï¼œK, Vï¼-&gt;segments</code> å­˜å‚¨æ•°æ®çš„ï¼Œè€Œå®ƒåˆæ˜¯ä¸€ä¸ªç”± <code>ConcurrentHashMapï¼œK, Vï¼.Segmentï¼œK, Vï¼</code> æ„å»ºçš„æ•°ç»„ï¼Œå…¶åŸºæœ¬å±æ€§å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Segment</span>&lt;K,V&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ReentrantLock</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Serializable</span> &#123;<br><br>    <span class="hljs-keyword">transient</span> <span class="hljs-keyword">volatile</span> HashEntry&lt;K,V&gt;[] table;<br><br>    <span class="hljs-keyword">transient</span> <span class="hljs-type">int</span> count;<br><br>    <span class="hljs-keyword">transient</span> <span class="hljs-type">int</span> threshold;<br><br>    <span class="hljs-keyword">final</span> <span class="hljs-type">float</span> loadFactor;<br>    <br>&#125;<br></code></pre></td></tr></table></figure><p>æ¯ä¸€ä¸ª <code>ConcurrentHashMapï¼œK, Vï¼.Segmentï¼œK, Vï¼</code> è¿˜ç»´æŠ¤äº†ä¸€ä¸ªç”± <code>ConcurrentHashMapï¼œK, Vï¼.HashEntryï¼œK, Vï¼</code> æ„å»ºçš„æ•°ç»„ï¼Œå…¶åŸºæœ¬å±æ€§å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HashEntry</span>&lt;K,V&gt; &#123;<br><br>    <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> hash;<br><br>    <span class="hljs-keyword">final</span> K key;<br><br>    <span class="hljs-keyword">volatile</span> V value;<br><br>    <span class="hljs-keyword">volatile</span> HashEntry&lt;K,V&gt; next;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>é™¤æ­¤ä¹‹å¤–ï¼Œæ¯ä¸€ä¸ª <code>ConcurrentHashMapï¼œK, Vï¼.HashEntryï¼œK, Vï¼</code> è¿˜ç»´æŠ¤äº†ä¸€æ¡ç”± <code>ConcurrentHashMapï¼œK, Vï¼.HashEntryï¼œK, Vï¼</code> æ„å»ºçš„å•å‘é“¾è¡¨</p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>æ•°æ®çš„å­˜å‚¨å®é™…ä¸Šæ˜¯ç”± <code>ConcurrentHashMapï¼œK, Vï¼.Segmentï¼œK, Vï¼</code> ç»´æŠ¤çš„æ•°ç»„è¿›è¡Œçš„</li></ol></blockquote><hr><h6 id="2-3-7-2-2-Java8-ä¹‹å"><a href="#2-3-7-2-2-Java8-ä¹‹å" class="headerlink" title="2.3.7.2.2. Java8 ä¹‹å"></a>2.3.7.2.2. Java8 ä¹‹å</h6><p>åœ¨ <code>Java8</code> ä¹‹åï¼Œ<code>ConcurrentHashMapï¼œK, Vï¼</code> åº•å±‚æ˜¯åŸºäºä¸€ä¸ªæ•°ç»„ + å¤šæ¡å•å‘é“¾è¡¨ + å¤šä¸ªçº¢é»‘æ ‘ + <code>CAS</code> + <code>synchronized</code> å®ç°çš„ï¼ˆç±»ä¼¼äº <code>Java8</code> ä¹‹åçš„ <code>HashMapï¼œK, Vï¼</code> çš„åº•å±‚å®ç°ï¼‰</p><p><code>ConcurrentHashMapï¼œK, Vï¼</code> æ˜¯é€šè¿‡ <code>ConcurrentHashMapï¼œK, Vï¼â”table</code> å­˜å‚¨æ•°æ®çš„ï¼Œè€Œå®ƒåˆæ˜¯ä¸€ä¸ªç”± <code>ConcurrentHashMapï¼œK, Vï¼.Nodeï¼œK, Vï¼</code> æ„å»ºçš„æ•°ç»„ï¼Œå…¶åŸºæœ¬å±æ€§å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Node</span>&lt;K,V&gt; <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Map</span>.Entry&lt;K,V&gt; &#123;<br><br><span class="hljs-keyword">final</span> <span class="hljs-type">int</span> hash;<br><br><span class="hljs-keyword">final</span> K key;<br><br><span class="hljs-keyword">volatile</span> V val;<br><br><span class="hljs-keyword">volatile</span> Node&lt;K,V&gt; next;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>é™¤æ­¤ä¹‹å¤–ï¼Œæ¯ä¸€ä¸ª <code>ConcurrentHashMapï¼œK, Vï¼.Nodeï¼œK, Vï¼</code> è¿˜ç»´æŠ¤äº†ä¸€æ¡ç”± <code>ConcurrentHashMapï¼œK, Vï¼.Nodeï¼œK, Vï¼</code> æ„å»ºçš„å•å‘é“¾è¡¨</p><hr><h5 id="2-3-7-3-ConcurrentHashMapï¼œK-Vï¼-æ‰©å®¹æœºåˆ¶"><a href="#2-3-7-3-ConcurrentHashMapï¼œK-Vï¼-æ‰©å®¹æœºåˆ¶" class="headerlink" title="2.3.7.3. ConcurrentHashMapï¼œK, Vï¼ æ‰©å®¹æœºåˆ¶"></a>2.3.7.3. ConcurrentHashMapï¼œK, Vï¼ æ‰©å®¹æœºåˆ¶</h5><p><code>ConcurrentHashMapï¼œK, Vï¼</code> çš„æ‰©å®¹æœºåˆ¶å’Œ <code>HashMapï¼œK, Vï¼</code> çš„æ‰©å®¹æœºåˆ¶ç›¸ä¼¼ï¼Œåªä¸è¿‡åœ¨ <code>Java8</code> ä¹‹å‰çš„ <code>ConcurrentHashMapï¼œK, Vï¼</code> åœ¨æ‰©å®¹æ—¶ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„ <code>ConcurrentHashMapï¼œK, Vï¼.Segmentï¼œK, Vï¼</code> ç»´æŠ¤çš„æ•°ç»„éƒ½æ‰©å®¹ï¼Œè€Œæ˜¯æŸä¸ª <code>ConcurrentHashMapï¼œK, Vï¼.Segmentï¼œK, Vï¼</code> ç»´æŠ¤çš„æ•°ç»„åœ¨éœ€è¦æ‰©å®¹æ—¶æ‰æ‰©å®¹ã€‚è¯¦è§ä¸Šæ–‡ï¼š<code>HashMapï¼œK, Vï¼</code></p><hr><h5 id="2-3-7-4-ConcurrentHashMapï¼œK-Vï¼-ç›¸å…³æµç¨‹"><a href="#2-3-7-4-ConcurrentHashMapï¼œK-Vï¼-ç›¸å…³æµç¨‹" class="headerlink" title="2.3.7.4. ConcurrentHashMapï¼œK, Vï¼ ç›¸å…³æµç¨‹"></a>2.3.7.4. ConcurrentHashMapï¼œK, Vï¼ ç›¸å…³æµç¨‹</h5><h6 id="2-3-7-4-1-Java8-ä¹‹å‰"><a href="#2-3-7-4-1-Java8-ä¹‹å‰" class="headerlink" title="2.3.7.4.1. Java8 ä¹‹å‰"></a>2.3.7.4.1. Java8 ä¹‹å‰</h6><p><font color="#92d050">1. è¯»æ“ä½œç›¸å…³æµç¨‹</font><br><code>ConcurrentHashMapï¼œK, Vï¼</code> çš„è¯»æ“ä½œå…¨ç¨‹ä¸åŠ é”</p><p><font color="#92d050">2. å†™æ“ä½œç›¸å…³æµç¨‹</font><br>åœ¨ <code>Java8</code> ä¹‹å‰ï¼Œ<code>ConcurrentHashMapï¼œK, Vï¼</code> çš„è¯»æ“ä½œçš„æ ¸å¿ƒç†å¿µæ˜¯ â€œåˆ†æ®µé”â€</p><p>å½“çº¿ç¨‹æ‰§è¡Œå†™æ“ä½œæ—¶ï¼Œä¼šå…ˆæ ¹æ®å…ƒç´ çš„ <code>Key</code> é€šè¿‡å“ˆå¸Œå‡½æ•°è®¡ç®—å‡ºå“ˆå¸Œå€¼ï¼Œå¹¶å°†å…¶è½¬æ¢æˆæ•°ç»„ç´¢å¼•ï¼Œç„¶åå®šä½çš„æ•°ç»„ç´¢å¼•å¯¹åº”çš„ <code>ConcurrentHashMapï¼œK, Vï¼-&gt;segments</code> ä½ç½®ï¼ˆæŸä¸ª <code>ConcurrentHashMapï¼œK, Vï¼.Segmentï¼œK, Vï¼</code>ï¼‰</p><p>æ¥ç€çº¿ç¨‹ä¼šç«äº‰è¯¥ <code>ConcurrentHashMapï¼œK, Vï¼.Segmentï¼œK, Vï¼</code> çš„ <code>Lock</code> é”ã€‚å½“çº¿ç¨‹æŒæœ‰é”åï¼Œä¼šå†å°† <code>Key</code> çš„å“ˆå¸Œå€¼è½¬æ¢æˆ <code>ConcurrentHashMapï¼œK, Vï¼.Segmentï¼œK, Vï¼</code> çš„æ•°ç»„ç´¢å¼•ï¼Œç„¶åå®šä½åˆ°æ•°ç»„ç´¢å¼•å¯¹åº”çš„ä½ç½®ï¼Œå¹¶å¯¹å…¶è¿›è¡Œå†™æ“ä½œ</p><hr><h6 id="2-3-7-4-2-Java8-ä¹‹å"><a href="#2-3-7-4-2-Java8-ä¹‹å" class="headerlink" title="2.3.7.4.2. Java8 ä¹‹å"></a>2.3.7.4.2. Java8 ä¹‹å</h6><p><font color="#92d050">1. è¯»æ“ä½œç›¸å…³æµç¨‹</font><br><code>ConcurrentHashMapï¼œK, Vï¼</code> çš„è¯»æ“ä½œå…¨ç¨‹ä¸åŠ é”</p><p><font color="#92d050">2. å†™æ“ä½œç›¸å…³æµç¨‹</font><br>åœ¨ <code>Java8</code> ä¹‹å‰ï¼Œæˆ‘ä»¬è¦ç«äº‰ä¸€ä¸ª <code>ConcurrentHashMapï¼œK, Vï¼.Segmentï¼œK, Vï¼</code> çš„ <code>Lock</code> é”ï¼Œé”çš„èŒƒå›´éå¸¸å¤§ã€‚åœ¨ <code>Java8</code> ä¹‹åï¼Œå½“çº¿ç¨‹æ‰§è¡Œå†™æ“ä½œæ—¶ï¼Œä¼šå…ˆæ ¹æ®å…ƒç´ çš„ <code>Key</code> é€šè¿‡å“ˆå¸Œå‡½æ•°è®¡ç®—å‡ºå“ˆå¸Œå€¼ï¼Œå¹¶å°†å…¶è½¬æ¢æˆæ•°ç»„ç´¢å¼•ï¼Œç„¶åå®šä½åˆ°æ•°ç»„ç´¢å¼•å¯¹åº”çš„ä½ç½®ã€‚å¦‚æœè¯¥æ•°ç»„ä½ç½®ä¸Šæ²¡æœ‰å…ƒç´ ï¼Œå°±ä½¿ç”¨ <code>CAS</code> å¯¹å…¶è¿›è¡Œå†™æ“ä½œã€‚å¦‚æœè¯¥æ•°ç»„ä½ç½®ä¸Šå·²æœ‰å…ƒç´ ï¼Œå°±å¯¹è¯¥æ•°ç»„ä½ç½®çš„é¦–ä¸ªå…ƒç´ åŠ  <code>synchronized</code> é”ï¼Œç„¶åå†è¿›è¡Œå†™æ“ä½œ</p><hr><h5 id="2-3-7-5-ConcurrentHashMapï¼œK-Vï¼-é—®é¢˜çˆ†ç ´"><a href="#2-3-7-5-ConcurrentHashMapï¼œK-Vï¼-é—®é¢˜çˆ†ç ´" class="headerlink" title="2.3.7.5. ConcurrentHashMapï¼œK, Vï¼ é—®é¢˜çˆ†ç ´"></a>2.3.7.5. ConcurrentHashMapï¼œK, Vï¼ é—®é¢˜çˆ†ç ´</h5><h6 id="2-3-7-5-1-è¿­ä»£å™¨çš„-â€œå¢â€ã€â€œåˆ â€-å¼‚å¸¸é—®é¢˜"><a href="#2-3-7-5-1-è¿­ä»£å™¨çš„-â€œå¢â€ã€â€œåˆ â€-å¼‚å¸¸é—®é¢˜" class="headerlink" title="2.3.7.5.1. è¿­ä»£å™¨çš„ â€œå¢â€ã€â€œåˆ â€ å¼‚å¸¸é—®é¢˜"></a>2.3.7.5.1. è¿­ä»£å™¨çš„ â€œå¢â€ã€â€œåˆ â€ å¼‚å¸¸é—®é¢˜</h6><p>ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼Œ<code>ConcurrentHashMapï¼œK, Vï¼</code> é‡‡å–äº†å¼±ä¸€è‡´æ€§ï¼ˆ<code>Weakly Consistent</code>ï¼‰ç­–ç•¥ã€‚åœ¨éå†è¿‡ç¨‹ä¸­è¿›è¡Œäº† â€œå¢â€ æˆ– â€œåˆ â€ æ“ä½œï¼Œä¸ä¼šæŠ›å‡ºä»»ä½•å¼‚å¸¸ï¼Œè€Œæ˜¯ç»§ç»­å‘ä¸‹éå†</p><hr><h4 id="2-3-8-ConcurrentSkipListMapï¼œK-Vï¼"><a href="#2-3-8-ConcurrentSkipListMapï¼œK-Vï¼" class="headerlink" title="2.3.8. ConcurrentSkipListMapï¼œK, Vï¼"></a>2.3.8. ConcurrentSkipListMapï¼œK, Vï¼</h4><h5 id="2-3-8-1-ConcurrentSkipListMapï¼œK-Vï¼-ä½“ç³»ç»“æ„"><a href="#2-3-8-1-ConcurrentSkipListMapï¼œK-Vï¼-ä½“ç³»ç»“æ„" class="headerlink" title="2.3.8.1. ConcurrentSkipListMapï¼œK, Vï¼ ä½“ç³»ç»“æ„"></a>2.3.8.1. ConcurrentSkipListMapï¼œK, Vï¼ ä½“ç³»ç»“æ„</h5><p><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B-25.png"></p><hr><h5 id="2-3-8-2-ConcurrentSkipListMapï¼œK-Vï¼-åº•å±‚å®ç°"><a href="#2-3-8-2-ConcurrentSkipListMapï¼œK-Vï¼-åº•å±‚å®ç°" class="headerlink" title="2.3.8.2. ConcurrentSkipListMapï¼œK, Vï¼ åº•å±‚å®ç°"></a>2.3.8.2. ConcurrentSkipListMapï¼œK, Vï¼ åº•å±‚å®ç°</h5><p><code>ConcurrentSkipListMapï¼œK, Vï¼</code> åº•å±‚æ˜¯åŸºäºä¸€ä¸ªè·³è¡¨ + <code>CAS</code> å®ç°çš„</p><p><code>ConcurrentSkipListMapï¼œK, Vï¼</code> æ˜¯é€šè¿‡ä¸€ä¸ªç”± <code>ConcurrentSkipListMapï¼œK, Vï¼.Nodeï¼œK, Vï¼</code> æ„å»ºçš„ï¼ŒåŸºäºå•å‘é“¾è¡¨çš„è·³è¡¨å­˜å‚¨æ•°æ®çš„ï¼Œå…¶åŸºæœ¬å±æ€§å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Node</span>&lt;K,V&gt; &#123;<br><br><span class="hljs-keyword">final</span> K key; <br><br>V val;<br><br>Node&lt;K,V&gt; next;<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h5 id="2-3-8-3-ConcurrentSkipListMapï¼œK-Vï¼-é—®é¢˜çˆ†ç ´"><a href="#2-3-8-3-ConcurrentSkipListMapï¼œK-Vï¼-é—®é¢˜çˆ†ç ´" class="headerlink" title="2.3.8.3. ConcurrentSkipListMapï¼œK, Vï¼ é—®é¢˜çˆ†ç ´"></a>2.3.8.3. ConcurrentSkipListMapï¼œK, Vï¼ é—®é¢˜çˆ†ç ´</h5><h6 id="2-3-8-3-1-è¿­ä»£å™¨çš„-â€œå¢â€ã€â€œåˆ â€-å¼‚å¸¸é—®é¢˜"><a href="#2-3-8-3-1-è¿­ä»£å™¨çš„-â€œå¢â€ã€â€œåˆ â€-å¼‚å¸¸é—®é¢˜" class="headerlink" title="2.3.8.3.1. è¿­ä»£å™¨çš„ â€œå¢â€ã€â€œåˆ â€ å¼‚å¸¸é—®é¢˜"></a>2.3.8.3.1. è¿­ä»£å™¨çš„ â€œå¢â€ã€â€œåˆ â€ å¼‚å¸¸é—®é¢˜</h6><p>ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼Œ<code>ConcurrentSkipListMapï¼œK, Vï¼</code> é‡‡å–äº†å¼±ä¸€è‡´æ€§ï¼ˆ<code>Weakly Consistent</code>ï¼‰ç­–ç•¥ã€‚åœ¨éå†è¿‡ç¨‹ä¸­è¿›è¡Œäº† â€œå¢â€ æˆ– â€œåˆ â€ æ“ä½œï¼Œä¸ä¼šæŠ›å‡ºä»»ä½•å¼‚å¸¸ï¼Œè€Œæ˜¯ç»§ç»­å‘ä¸‹éå†</p><hr><h3 id="2-4-Queueï¼œEï¼"><a href="#2-4-Queueï¼œEï¼" class="headerlink" title="2.4. Queueï¼œEï¼"></a>2.4. Queueï¼œEï¼</h3><h4 id="2-4-1-Queueï¼œEï¼-åŸºç¡€ä½“ç³»"><a href="#2-4-1-Queueï¼œEï¼-åŸºç¡€ä½“ç³»" class="headerlink" title="2.4.1. Queueï¼œEï¼ åŸºç¡€ä½“ç³»"></a>2.4.1. Queueï¼œEï¼ åŸºç¡€ä½“ç³»</h4><p><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B-10.png"></p><ol><li>è¯¦è§æºç ï¼š<code>Serializable</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.io.Serializable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.io.Serializableæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>Cloneable</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.Cloneable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.lang.Cloneableæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>Comparable&lt;T&gt;</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.Comparable%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.lang.Comparableï¼œTï¼æºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>Delayed</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.Delayed%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.Delayedæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>Iterableï¼œEï¼</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.Iterable%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.lang.Iterableï¼œTï¼æºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li></li></ol></li></ol></li></ol><hr><h4 id="2-4-2-Queueï¼œEï¼-ç›¸å…³åˆ†ç±»"><a href="#2-4-2-Queueï¼œEï¼-ç›¸å…³åˆ†ç±»" class="headerlink" title="2.4.2. Queueï¼œEï¼ ç›¸å…³åˆ†ç±»"></a>2.4.2. Queueï¼œEï¼ ç›¸å…³åˆ†ç±»</h4><ol><li><code>LinkedListï¼œEï¼</code></li><li><code>DelayQueueï¼œEï¼</code></li><li><code>PriorityQueueï¼œEï¼</code></li><li><code>SynchronousQueueï¼œEï¼</code></li><li><code>ArrayBlockingQueueï¼œEï¼</code></li><li><code>LinkedTransferQueueï¼œEï¼</code></li><li><code>LinkedBlockingQueueï¼œEï¼</code></li><li><code>PriorityBlockingQueueï¼œEï¼</code></li><li><code>ConcurrentLinkedQueueï¼œEï¼</code></li><li><code>ForkJoinPool.WorkQueueï¼œEï¼</code></li><li><code>ScheduledThreadPoolExecutor.DelayedWorkQueueï¼œEï¼</code></li><li><code>ArrayDequeï¼œEï¼</code></li><li><code>LinkedBlockingDequeï¼œEï¼</code></li><li><code>ConcurrentLinkedDequeï¼œEï¼</code></li></ol><table><thead><tr><th>ç‰¹æ€§</th><th>LinkedListï¼œEï¼</th><th>DelayQueueï¼œEï¼</th><th>PriorityQueueï¼œEï¼</th></tr></thead><tbody><tr><td><strong>é¡ºåºæ€§</strong></td><td>âœ…ï¼ˆ<code>FIFO</code> é¡ºåºã€<code>LIFO</code> é¡ºåºï¼‰</td><td>âœ…ï¼ˆ<code>TTL</code> é¡ºåºï¼‰</td><td>âœ…ï¼ˆä¼˜å…ˆçº§é¡ºåºï¼‰</td></tr><tr><td><strong>æœ‰ç•Œæ€§</strong></td><td>â€”</td><td>âŒ</td><td>âŒï¼ˆéœ€è¦æ‰©å®¹ï¼‰</td></tr><tr><td><strong>æ”¯æŒæ‰©å®¹</strong></td><td>â€”</td><td>âœ…</td><td>âœ…</td></tr><tr><td><strong>æ”¯æŒåŒç«¯</strong></td><td>âœ…</td><td>âŒ</td><td>âŒ</td></tr><tr><td><strong>æ”¯æŒå»¶è¿Ÿ</strong></td><td>âŒ</td><td>âœ…</td><td>âŒ</td></tr><tr><td><strong>æ”¯æŒä¼˜å…ˆçº§</strong></td><td>âŒ</td><td>âœ…</td><td>âœ…</td></tr><tr><td><strong>åº•å±‚å®ç°</strong></td><td>ä¸€æ¡åŒå‘é“¾è¡¨</td><td>ä¸€ä¸ª <code>PriorityQueue</code> + ä¸€ä¸ª <code>ReentrantLock</code>ï¼ˆä¸€ä¸ªæ¡ä»¶é˜Ÿåˆ—ï¼‰</td><td>ä¸€ä¸ªäºŒå‰å †</td></tr><tr><td><strong>å…è®¸å…ƒç´ é‡å¤</strong></td><td>âœ…</td><td>âœ…</td><td>âœ…</td></tr><tr><td><strong>å…è®¸å…ƒç´ ä¸º null</strong></td><td>âœ…</td><td>âŒ</td><td>âŒ</td></tr><tr><td><strong>å¤šçº¿ç¨‹å¹¶å‘å®‰å…¨æ€§</strong></td><td>âŒ</td><td>âœ…</td><td>âŒ</td></tr></tbody></table><table><thead><tr><th>ç‰¹æ€§</th><th>synchronousQueueï¼œEï¼</th><th>ArrayBlockingQueueï¼œEï¼</th><th>LinkedTransferQueueï¼œEï¼</th></tr></thead><tbody><tr><td><strong>é¡ºåºæ€§</strong></td><td>â€”</td><td>âœ…ï¼ˆ<code>FIFO</code> é¡ºåºï¼‰</td><td>âœ…ï¼ˆ<code>FIFO</code> é¡ºåºï¼‰</td></tr><tr><td><strong>æœ‰ç•Œæ€§</strong></td><td>â€”</td><td>âœ…</td><td>â€”</td></tr><tr><td><strong>æ”¯æŒæ‰©å®¹</strong></td><td>â€”</td><td>âŒ</td><td>â€”</td></tr><tr><td><strong>æ”¯æŒåŒç«¯</strong></td><td>â€”</td><td>âŒ</td><td>âŒ</td></tr><tr><td><strong>æ”¯æŒå»¶è¿Ÿ</strong></td><td>â€”</td><td>âŒ</td><td>âŒ</td></tr><tr><td><strong>æ”¯æŒä¼˜å…ˆçº§</strong></td><td>â€”</td><td>âŒ</td><td>âŒ</td></tr><tr><td><strong>åº•å±‚å®ç°</strong></td><td>â€”</td><td>ä¸€ä¸ªæ•°ç»„ + ä¸€ä¸ª <code>ReentrantLock</code>ï¼ˆä¸¤ä¸ªæ¡ä»¶é˜Ÿåˆ—ï¼‰</td><td>ä¸€æ¡å•å‘é“¾è¡¨ + <code>CAS</code></td></tr><tr><td><strong>å…è®¸å…ƒç´ é‡å¤</strong></td><td>â€”</td><td>âœ…</td><td>âœ…</td></tr><tr><td><strong>å…è®¸å…ƒç´ ä¸º null</strong></td><td>âŒ</td><td>âŒ</td><td>âŒ</td></tr><tr><td><strong>å¤šçº¿ç¨‹å¹¶å‘å®‰å…¨æ€§</strong></td><td>âœ…</td><td>âœ…</td><td>âœ…</td></tr></tbody></table><table><thead><tr><th>ç‰¹æ€§</th><th>LinkedBlockingQueueï¼œEï¼</th><th>PriorityBlockingQueueï¼œEï¼</th><th>ConcurrentLinkedQueueï¼œEï¼</th></tr></thead><tbody><tr><td><strong>é¡ºåºæ€§</strong></td><td>âœ…ï¼ˆ<code>FIFO</code> é¡ºåºï¼‰</td><td>âœ…ï¼ˆä¼˜å…ˆçº§é¡ºåºï¼‰</td><td>âœ…ï¼ˆ<code>FIFO</code> é¡ºåºï¼‰</td></tr><tr><td><strong>æœ‰ç•Œæ€§</strong></td><td>âœ…ï¼ˆäººä¸ºé™åˆ¶ï¼‰</td><td>âŒï¼ˆéœ€è¦æ‰©å®¹ï¼‰</td><td>â€”</td></tr><tr><td><strong>æ”¯æŒæ‰©å®¹</strong></td><td>â€”</td><td>âœ…</td><td>â€”</td></tr><tr><td><strong>æ”¯æŒåŒç«¯</strong></td><td>âŒ</td><td>âŒ</td><td>âŒ</td></tr><tr><td><strong>æ”¯æŒå»¶è¿Ÿ</strong></td><td>âŒ</td><td>âŒ</td><td>âŒ</td></tr><tr><td><strong>æ”¯æŒä¼˜å…ˆçº§</strong></td><td>âŒ</td><td>âœ…</td><td>âŒ</td></tr><tr><td><strong>åº•å±‚å®ç°</strong></td><td>ä¸€æ¡å•å‘é“¾è¡¨ + ä¸¤ä¸ª <code>ReentrantLock</code>ï¼ˆå„ä¸€ä¸ªæ¡ä»¶é˜Ÿåˆ—ï¼‰</td><td>ä¸€ä¸ªäºŒå‰å † + ä¸€ä¸ª <code>ReentrantLock</code>ï¼ˆä¸€ä¸ªæ¡ä»¶é˜Ÿåˆ—ï¼‰</td><td>ä¸€æ¡å•å‘é“¾è¡¨ + <code>CAS</code></td></tr><tr><td><strong>å…è®¸å…ƒç´ é‡å¤</strong></td><td>âœ…</td><td>âœ…</td><td>âœ…</td></tr><tr><td><strong>å…è®¸å…ƒç´ ä¸º null</strong></td><td>âŒ</td><td>âŒ</td><td>âŒ</td></tr><tr><td><strong>å¤šçº¿ç¨‹å¹¶å‘å®‰å…¨æ€§</strong></td><td>âœ…</td><td>âœ…</td><td>âœ…</td></tr></tbody></table><table><thead><tr><th>ç‰¹æ€§</th><th>ForkJoinPool.WorkQueueï¼œEï¼</th><th>ScheduledThreadPoolExecutor.DelayedWorkQueueï¼œEï¼</th><th>ArrayDequeï¼œEï¼</th></tr></thead><tbody><tr><td><strong>é¡ºåºæ€§</strong></td><td></td><td></td><td>âœ…ï¼ˆ<code>FIFO</code> é¡ºåºã€<code>LIFO</code> é¡ºåºï¼‰</td></tr><tr><td><strong>æœ‰ç•Œæ€§</strong></td><td></td><td></td><td>âŒï¼ˆéœ€è¦æ‰©å®¹ï¼‰</td></tr><tr><td><strong>æ”¯æŒæ‰©å®¹</strong></td><td></td><td></td><td>âœ…</td></tr><tr><td><strong>æ”¯æŒåŒç«¯</strong></td><td></td><td></td><td>âœ…</td></tr><tr><td><strong>æ”¯æŒå»¶è¿Ÿ</strong></td><td></td><td></td><td>âŒ</td></tr><tr><td><strong>æ”¯æŒä¼˜å…ˆçº§</strong></td><td></td><td></td><td>âŒ</td></tr><tr><td><strong>åº•å±‚å®ç°</strong></td><td></td><td></td><td>ä¸€ä¸ªæ•°ç»„</td></tr><tr><td><strong>å…è®¸å…ƒç´ é‡å¤</strong></td><td></td><td></td><td>âœ…</td></tr><tr><td><strong>å…è®¸å…ƒç´ ä¸º null</strong></td><td></td><td></td><td>âŒ</td></tr><tr><td><strong>å¤šçº¿ç¨‹å¹¶å‘å®‰å…¨æ€§</strong></td><td></td><td></td><td>âŒ</td></tr></tbody></table><table><thead><tr><th>ç‰¹æ€§</th><th>LinkedBlockingDequeï¼œEï¼</th><th>ConcurrentLinkedDequeï¼œEï¼</th></tr></thead><tbody><tr><td><strong>é¡ºåºæ€§</strong></td><td>âœ…ï¼ˆ<code>FIFO</code> é¡ºåºã€<code>LIFO</code> é¡ºåºï¼‰</td><td>âœ…ï¼ˆ<code>FIFO</code> é¡ºåºã€<code>LIFO</code> é¡ºåºï¼‰</td></tr><tr><td><strong>æœ‰ç•Œæ€§</strong></td><td>âœ…ï¼ˆäººä¸ºé™åˆ¶ï¼‰</td><td>â€”</td></tr><tr><td><strong>æ”¯æŒæ‰©å®¹</strong></td><td>â€”</td><td>â€”</td></tr><tr><td><strong>æ”¯æŒåŒç«¯</strong></td><td>âœ…</td><td>âœ…</td></tr><tr><td><strong>æ”¯æŒå»¶è¿Ÿ</strong></td><td>âŒ</td><td>âŒ</td></tr><tr><td><strong>æ”¯æŒä¼˜å…ˆçº§</strong></td><td>âŒ</td><td>âŒ</td></tr><tr><td><strong>åº•å±‚å®ç°</strong></td><td>ä¸€æ¡åŒå‘é“¾è¡¨ + ä¸€ä¸ª <code>ReentrantLock</code>ï¼ˆä¸¤ä¸ªæ¡ä»¶é˜Ÿåˆ—ï¼‰</td><td>ä¸€æ¡åŒå‘é“¾è¡¨ + <code>CAS</code></td></tr><tr><td><strong>å…è®¸å…ƒç´ é‡å¤</strong></td><td>âœ…</td><td>âœ…</td></tr><tr><td><strong>å…è®¸å…ƒç´ ä¸º null</strong></td><td>âŒ</td><td>âŒ</td></tr><tr><td><strong>å¤šçº¿ç¨‹å¹¶å‘å®‰å…¨æ€§</strong></td><td>âœ…</td><td>âœ…</td></tr></tbody></table><hr><h4 id="2-4-2-1-LinkedListï¼œEï¼"><a href="#2-4-2-1-LinkedListï¼œEï¼" class="headerlink" title="2.4.2.1. LinkedListï¼œEï¼"></a>2.4.2.1. LinkedListï¼œEï¼</h4><p>è¯¦è§ä¸Šæ–‡ï¼š<code>LinkedListï¼œEï¼</code></p><hr><h4 id="2-4-3-DelayQueueï¼œEï¼"><a href="#2-4-3-DelayQueueï¼œEï¼" class="headerlink" title="2.4.3. DelayQueueï¼œEï¼"></a>2.4.3. DelayQueueï¼œEï¼</h4><h5 id="2-4-3-1-DelayQueueï¼œEï¼-ä½“ç³»ç»“æ„"><a href="#2-4-3-1-DelayQueueï¼œEï¼-ä½“ç³»ç»“æ„" class="headerlink" title="2.4.3.1. DelayQueueï¼œEï¼ ä½“ç³»ç»“æ„"></a>2.4.3.1. DelayQueueï¼œEï¼ ä½“ç³»ç»“æ„</h5><p><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B-13.png"></p><hr><h4 id="2-4-4-PriorityQueueï¼œEï¼"><a href="#2-4-4-PriorityQueueï¼œEï¼" class="headerlink" title="2.4.4. PriorityQueueï¼œEï¼"></a>2.4.4. PriorityQueueï¼œEï¼</h4><h5 id="2-4-4-1-PriorityQueueï¼œEï¼-ä½“ç³»ç»“æ„"><a href="#2-4-4-1-PriorityQueueï¼œEï¼-ä½“ç³»ç»“æ„" class="headerlink" title="2.4.4.1. PriorityQueueï¼œEï¼ ä½“ç³»ç»“æ„"></a>2.4.4.1. PriorityQueueï¼œEï¼ ä½“ç³»ç»“æ„</h5><p><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B-14.png"></p><hr><h4 id="2-4-5-SynchronousQueueï¼œEï¼"><a href="#2-4-5-SynchronousQueueï¼œEï¼" class="headerlink" title="2.4.5. SynchronousQueueï¼œEï¼"></a>2.4.5. SynchronousQueueï¼œEï¼</h4><h5 id="2-4-5-1-SynchronousQueueï¼œEï¼-ä½“ç³»ç»“æ„"><a href="#2-4-5-1-SynchronousQueueï¼œEï¼-ä½“ç³»ç»“æ„" class="headerlink" title="2.4.5.1. SynchronousQueueï¼œEï¼ ä½“ç³»ç»“æ„"></a>2.4.5.1. SynchronousQueueï¼œEï¼ ä½“ç³»ç»“æ„</h5><p><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B-15.png"></p><hr><h4 id="2-4-6-ArrayBlockingQueueï¼œEï¼"><a href="#2-4-6-ArrayBlockingQueueï¼œEï¼" class="headerlink" title="2.4.6. ArrayBlockingQueueï¼œEï¼"></a>2.4.6. ArrayBlockingQueueï¼œEï¼</h4><h5 id="2-4-6-1-ArrayBlockingQueueï¼œEï¼-ä½“ç³»ç»“æ„"><a href="#2-4-6-1-ArrayBlockingQueueï¼œEï¼-ä½“ç³»ç»“æ„" class="headerlink" title="2.4.6.1. ArrayBlockingQueueï¼œEï¼ ä½“ç³»ç»“æ„"></a>2.4.6.1. ArrayBlockingQueueï¼œEï¼ ä½“ç³»ç»“æ„</h5><p><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B-16.png"></p><hr><h4 id="2-4-7-LinkedTransferQueueï¼œEï¼"><a href="#2-4-7-LinkedTransferQueueï¼œEï¼" class="headerlink" title="2.4.7. LinkedTransferQueueï¼œEï¼"></a>2.4.7. LinkedTransferQueueï¼œEï¼</h4><h5 id="2-4-7-1-LinkedTransferQueueï¼œEï¼-ä½“ç³»ç»“æ„"><a href="#2-4-7-1-LinkedTransferQueueï¼œEï¼-ä½“ç³»ç»“æ„" class="headerlink" title="2.4.7.1. LinkedTransferQueueï¼œEï¼ ä½“ç³»ç»“æ„"></a>2.4.7.1. LinkedTransferQueueï¼œEï¼ ä½“ç³»ç»“æ„</h5><p><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B-17.png"></p><hr><h4 id="2-4-8-LinkedBlockingQueueï¼œEï¼"><a href="#2-4-8-LinkedBlockingQueueï¼œEï¼" class="headerlink" title="2.4.8. LinkedBlockingQueueï¼œEï¼"></a>2.4.8. LinkedBlockingQueueï¼œEï¼</h4><h5 id="2-4-8-1-LinkedBlockingQueueï¼œEï¼-ä½“ç³»ç»“æ„"><a href="#2-4-8-1-LinkedBlockingQueueï¼œEï¼-ä½“ç³»ç»“æ„" class="headerlink" title="2.4.8.1. LinkedBlockingQueueï¼œEï¼ ä½“ç³»ç»“æ„"></a>2.4.8.1. LinkedBlockingQueueï¼œEï¼ ä½“ç³»ç»“æ„</h5><p><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B-18.png"></p><hr><h4 id="2-4-9-PriorityBlockingQueueï¼œEï¼"><a href="#2-4-9-PriorityBlockingQueueï¼œEï¼" class="headerlink" title="2.4.9. PriorityBlockingQueueï¼œEï¼"></a>2.4.9. PriorityBlockingQueueï¼œEï¼</h4><h5 id="2-4-9-1-PriorityBlockingQueueï¼œEï¼-ä½“ç³»ç»“æ„"><a href="#2-4-9-1-PriorityBlockingQueueï¼œEï¼-ä½“ç³»ç»“æ„" class="headerlink" title="2.4.9.1. PriorityBlockingQueueï¼œEï¼ ä½“ç³»ç»“æ„"></a>2.4.9.1. PriorityBlockingQueueï¼œEï¼ ä½“ç³»ç»“æ„</h5><p><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B-19.png"></p><hr><h4 id="2-4-10-ConcurrentLinkedQueueï¼œEï¼"><a href="#2-4-10-ConcurrentLinkedQueueï¼œEï¼" class="headerlink" title="2.4.10. ConcurrentLinkedQueueï¼œEï¼"></a>2.4.10. ConcurrentLinkedQueueï¼œEï¼</h4><h5 id="2-4-10-1-ConcurrentLinkedQueueï¼œEï¼-ä½“ç³»ç»“æ„"><a href="#2-4-10-1-ConcurrentLinkedQueueï¼œEï¼-ä½“ç³»ç»“æ„" class="headerlink" title="2.4.10.1. ConcurrentLinkedQueueï¼œEï¼ ä½“ç³»ç»“æ„"></a>2.4.10.1. ConcurrentLinkedQueueï¼œEï¼ ä½“ç³»ç»“æ„</h5><p><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B-20.png"></p><hr><h4 id="2-4-11-ArrayDequeï¼œEï¼"><a href="#2-4-11-ArrayDequeï¼œEï¼" class="headerlink" title="2.4.11. ArrayDequeï¼œEï¼"></a>2.4.11. ArrayDequeï¼œEï¼</h4><h5 id="2-4-11-1-ArrayDequeï¼œEï¼-ä½“ç³»ç»“æ„"><a href="#2-4-11-1-ArrayDequeï¼œEï¼-ä½“ç³»ç»“æ„" class="headerlink" title="2.4.11.1. ArrayDequeï¼œEï¼ ä½“ç³»ç»“æ„"></a>2.4.11.1. ArrayDequeï¼œEï¼ ä½“ç³»ç»“æ„</h5><p><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B-21.png"></p><hr><h4 id="2-4-12-LinkedBlockingDequeï¼œEï¼"><a href="#2-4-12-LinkedBlockingDequeï¼œEï¼" class="headerlink" title="2.4.12. LinkedBlockingDequeï¼œEï¼"></a>2.4.12. LinkedBlockingDequeï¼œEï¼</h4><h5 id="2-4-12-1-LinkedBlockingDequeï¼œEï¼-ä½“ç³»ç»“æ„"><a href="#2-4-12-1-LinkedBlockingDequeï¼œEï¼-ä½“ç³»ç»“æ„" class="headerlink" title="2.4.12.1. LinkedBlockingDequeï¼œEï¼ ä½“ç³»ç»“æ„"></a>2.4.12.1. LinkedBlockingDequeï¼œEï¼ ä½“ç³»ç»“æ„</h5><p><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B-22.png"></p><hr><h4 id="2-4-13-ConcurrentLinkedDequeï¼œEï¼"><a href="#2-4-13-ConcurrentLinkedDequeï¼œEï¼" class="headerlink" title="2.4.13. ConcurrentLinkedDequeï¼œEï¼"></a>2.4.13. ConcurrentLinkedDequeï¼œEï¼</h4><h5 id="2-4-13-1-ConcurrentLinkedDequeï¼œEï¼-ä½“ç³»ç»“æ„"><a href="#2-4-13-1-ConcurrentLinkedDequeï¼œEï¼-ä½“ç³»ç»“æ„" class="headerlink" title="2.4.13.1. ConcurrentLinkedDequeï¼œEï¼ ä½“ç³»ç»“æ„"></a>2.4.13.1. ConcurrentLinkedDequeï¼œEï¼ ä½“ç³»ç»“æ„</h5><p><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B-23.png"></p><hr>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
      <category>Java æ•°æ®ç±»å‹</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>ç¬”è®°ï¼šJavaæ—¥å¿—æ¡†æ¶</title>
    <link href="/2025/11/24/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%97%A5%E5%BF%97%E6%A1%86%E6%9E%B6/"/>
    <url>/2025/11/24/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%97%A5%E5%BF%97%E6%A1%86%E6%9E%B6/</url>
    
    <content type="html"><![CDATA[<h1 id="ä¸€ã€TODO"><a href="#ä¸€ã€TODO" class="headerlink" title="ä¸€ã€TODO"></a>ä¸€ã€TODO</h1><hr><h1 id="äºŒã€è„‘å›¾"><a href="#äºŒã€è„‘å›¾" class="headerlink" title="äºŒã€è„‘å›¾"></a>äºŒã€è„‘å›¾</h1><ol><li><p>Xmind</p></li><li><p>Edraw<br><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%97%A5%E5%BF%97%E6%A1%86%E6%9E%B6/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%97%A5%E5%BF%97%E6%A1%86%E6%9E%B6.eddx"></p></li><li><p>ä»£ç æ´ªè’ï¼ˆé¢è¯•å®å…¸ï¼‰<br>ğŸ‘‰ <a href="https://www.notion.so/Java-2b5974fbda5e806899f7fa6b19c61c04?source=copy_link">https://www.notion.so/Java-2b5974fbda5e806899f7fa6b19c61c04?source=copy_link</a></p></li></ol><hr><h1 id="ä¸‰ã€Java-æ—¥å¿—æ¡†æ¶å‰ç½®åŸºç¡€"><a href="#ä¸‰ã€Java-æ—¥å¿—æ¡†æ¶å‰ç½®åŸºç¡€" class="headerlink" title="ä¸‰ã€Java æ—¥å¿—æ¡†æ¶å‰ç½®åŸºç¡€"></a>ä¸‰ã€Java æ—¥å¿—æ¡†æ¶å‰ç½®åŸºç¡€</h1><h2 id="1-Java-æ—¥å¿—æ¡†æ¶çš„å‘å±•å²"><a href="#1-Java-æ—¥å¿—æ¡†æ¶çš„å‘å±•å²" class="headerlink" title="1. Java æ—¥å¿—æ¡†æ¶çš„å‘å±•å²"></a>1. Java æ—¥å¿—æ¡†æ¶çš„å‘å±•å²</h2><p><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%97%A5%E5%BF%97%E6%A1%86%E6%9E%B6/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%97%A5%E5%BF%97%E6%A1%86%E6%9E%B6.png"></p><hr><h1 id="å››ã€JUL"><a href="#å››ã€JUL" class="headerlink" title="å››ã€JUL"></a>å››ã€JUL</h1><h2 id="1-JUL-æ¦‚è¿°"><a href="#1-JUL-æ¦‚è¿°" class="headerlink" title="1. JUL æ¦‚è¿°"></a>1. JUL æ¦‚è¿°</h2><p><code>JUL</code>ï¼ˆ<code>Java Util Logging</code>ï¼‰ï¼Œæ˜¯ <code>JDK</code> å†…ç½®çš„æ—¥å¿—è®°å½•æ¡†æ¶ï¼Œä½¿ç”¨æ—¶æ— éœ€é¢å¤–å¼•å…¥ç¬¬ä¸‰æ–¹åº“ï¼Œä½¿ç”¨ç›¸å¯¹ç®€å•ã€‚</p><p><code>JUL</code> è™½ç„¶èƒ½æ»¡è¶³ä¸€èˆ¬åº”ç”¨çš„æ—¥å¿—éœ€æ±‚ï¼Œä½†ç›¸æ¯” <code>Log4j</code>ã€<code>SLF4J</code> ç­‰ç¬¬ä¸‰æ–¹æ¡†æ¶ï¼Œå…¶æ‰©å±•æ€§å’Œé«˜çº§ç‰¹æ€§è¾ƒä¸ºæœ‰é™ã€‚</p><hr><h2 id="2-JUL-æ ¸å¿ƒç»„ä»¶"><a href="#2-JUL-æ ¸å¿ƒç»„ä»¶" class="headerlink" title="2. JUL æ ¸å¿ƒç»„ä»¶"></a>2. JUL æ ¸å¿ƒç»„ä»¶</h2><p><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%97%A5%E5%BF%97%E6%A1%86%E6%9E%B6/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%97%A5%E5%BF%97%E6%A1%86%E6%9E%B6-1.png"></p><ol><li><code>Logger</code><ol><li><code>Logger</code>ï¼ˆè®°å½•å™¨ï¼‰æ˜¯æ—¥å¿—æ¡†æ¶çš„å…¥å£ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è°ƒç”¨ <code>Logger.getLogger(String name)</code> è·å– <code>Logger</code> å®ä¾‹ï¼Œå¹¶è°ƒç”¨å…¶æ–¹æ³•è®°å½•æ—¥å¿—ä¿¡æ¯ã€‚</li><li>éœ€è¦æ³¨æ„çš„æ˜¯ï¼š<ol><li><code>Logger</code> ä¼šæ ¹æ®æˆ‘ä»¬è®¾ç½®çš„ <code>Logger</code> æ—¥å¿—çº§åˆ«æ¥è®°å½•éœ€è¦çš„æ—¥å¿—ï¼Œå¯¹äºä½äºæˆ‘ä»¬è®¾å®šçº§åˆ«çš„æ—¥å¿—ï¼Œå³ä½¿æˆ‘ä»¬è°ƒç”¨äº†æ—¥å¿—çš„è®°å½•æ–¹æ³•ï¼ˆå¦‚ <code>logger.config(xxx)</code>ï¼‰ï¼Œè¿™äº›æ—¥å¿—ä¹Ÿä¸ä¼šè¢« <code>Logger</code> è®°å½•ï¼ˆå¯ä»¥ç†è§£ä¸ºï¼šæ—¥å¿—çš„ç¬¬ä¸€å±‚è¿‡æ»¤ï¼‰</li><li><code>Logger</code> é€šå¸¸æ­é… <code>Level</code> å’Œ <code>Filter</code> ä½¿ç”¨</li></ol></li></ol></li><li><code>Filter</code><ol><li><code>Filter</code>ï¼ˆè¿‡æ»¤å™¨ï¼‰ ç”¨äºåœ¨æ—¥å¿—è®°å½•è¢«å‘é€åˆ° <code>Handler</code> ä¹‹å‰è¿›è¡Œç­›é€‰ï¼Œå¯ä»¥è¿›è¡Œå®šåˆ¶ï¼Œå†³å®šå“ªäº›æ—¥å¿—ä¿¡æ¯åº”è¯¥è¢«æ¥å—ï¼Œå“ªäº›åº”è¢«è¿‡æ»¤æ‰ï¼ˆå¯ä»¥ç†è§£ä¸ºï¼šæ—¥å¿—çš„ç¬¬äºŒå±‚è¿‡æ»¤ï¼‰</li></ol></li><li><code>Handler</code><ol><li><code>Handler</code>ï¼ˆå¤„ç†å™¨ï¼‰ï¼Œè´Ÿè´£æ¥æ”¶ <code>Logger</code> è®°å½•çš„æ—¥å¿—ï¼Œå¹¶å°†æ—¥å¿—æ¶ˆæ¯è¾“å‡ºåˆ°æŒ‡å®šç›®æ ‡</li><li><code>Handler</code> åˆ†åˆ«æœ‰ï¼š<ol><li><code>ConsoleHandler</code><ol><li>æ—¥å¿—è¾“å‡ºåˆ°æ§åˆ¶å°</li></ol></li><li><code>FileHandler</code><ol><li>æ—¥å¿—è¾“å‡ºåˆ°æ–‡ä»¶</li></ol></li><li><code>SocketHandler</code><ol><li>æ—¥å¿—è¾“å‡ºåˆ°ç½‘ç»œç«¯ç‚¹</li></ol></li><li><code>MemoryHandler</code><ol><li>æ—¥å¿—æš‚å­˜äºå†…å­˜ï¼Œæ»¡è¶³æ¡ä»¶æ—¶æ‰¹é‡è¾“å‡º</li></ol></li></ol></li><li>éœ€è¦æ³¨æ„çš„æ˜¯ï¼š<ol><li>ä¸€ä¸ª <code>Logger</code> å¯ä»¥å…³è”å¤šä¸ª <code>Handler</code>ï¼Œä»¥ä¾¿å°†æ—¥å¿—æ¶ˆæ¯è¾“å‡ºåˆ°ä¸åŒçš„ç›®æ ‡ã€‚</li><li><code>Handler</code> ä¼šæ ¹æ®æˆ‘ä»¬è®¾ç½®çš„ <code>Handler</code> æ—¥å¿—çº§åˆ«æ¥è¾“å‡ºéœ€è¦çš„æ—¥å¿—ï¼Œå¯¹äºä½äºè®¾å®šçº§åˆ«çš„æ—¥å¿—ï¼Œå³ä½¿ <code>Logger</code> å°†å…¶ä¼ é€’è¿‡æ¥ï¼Œè¿™äº›æ—¥å¿—ä¹Ÿä¸ä¼šè¢«è¾“å‡ºï¼ˆå¯ä»¥ç†è§£ä¸ºï¼šæ—¥å¿—çš„ç¬¬ä¸‰å±‚è¿‡æ»¤ï¼‰</li><li><code>Handler</code> é€šå¸¸æ­é… <code>Level</code> å’Œ <code>Formatter</code> ä½¿ç”¨</li></ol></li></ol></li><li><code>Formatter</code><ol><li><code>Formatter</code>ï¼ˆæ ¼å¼åŒ–ç»„ä»¶ï¼‰ å®šä¹‰äº†æ—¥å¿—æ¶ˆæ¯çš„è¾“å‡ºæ ¼å¼ã€‚</li><li><code>Formatter</code> åˆ†åˆ«æœ‰ï¼š<ol><li><code>SimpleFormatter</code><ol><li>ç®€å•ã€æ˜“è¯»çš„æ–‡æœ¬æ ¼å¼</li></ol></li><li><code>XMLFormatter</code><ol><li>ä»¥ <code>XML</code> æ ¼å¼è¾“å‡ºæ—¥å¿—</li></ol></li><li>éœ€è¦æ³¨æ„çš„æ˜¯ï¼š<ol><li>åŸç”Ÿ <code>Java</code> å¹¶æ²¡æœ‰æä¾› <code>JSON</code> æ ¼å¼çš„æ ¼å¼åŒ–ç»„ä»¶</li><li>ä½†æ˜¯ä»¬å¯ä»¥é€šè¿‡è‡ªå®šä¹‰ <code>Formatter</code> ç±»æ¥è‡ªå®šä¹‰è¾“å‡ºæ ¼å¼</li></ol></li></ol></li></ol></li><li><code>Level</code><ol><li><code>Level</code>ï¼ˆéªŒè¯çº§åˆ«ï¼‰å®šä¹‰äº†æ—¥å¿—çº§åˆ«</li><li><code>Level</code> çš„çº§åˆ«é¡ºåºä¸ºï¼š<ol><li><code>OFF</code><ol><li>ç¦æ­¢æ•è·æ‰€æœ‰çº§åˆ«çš„æ—¥å¿—ä¿¡æ¯</li></ol></li><li><code>SEVERE</code><ol><li>é”™è¯¯ä¿¡æ¯ï¼Œè¡¨ç¤ºä¸¥é‡é”™è¯¯æˆ–å¼‚å¸¸æƒ…å†µï¼Œåº”ç”¨å¯èƒ½æ— æ³•ç»§ç»­è¿è¡Œ</li></ol></li><li><code>WARNING</code><ol><li>è­¦å‘Šä¿¡æ¯ï¼Œæç¤ºæ½œåœ¨çš„é—®é¢˜ï¼Œä½†åº”ç”¨ä»ç„¶å¯ä»¥ç»§ç»­è¿è¡Œ</li></ol></li><li><code>INFO</code><ol><li>è¾“å‡ºå¸¸è§„è¿è¡Œä¿¡æ¯ï¼Œæä¾›ç³»ç»Ÿè¿è¡ŒçŠ¶æ€</li></ol></li><li><code>CONFIG</code><ol><li>è¾“å‡ºé…ç½®é¡¹ä¿¡æ¯</li></ol></li><li><code>FINE</code><ol><li>è°ƒè¯•ä¿¡æ¯ï¼ˆå°‘ï¼‰ï¼Œè¯¦ç»†è°ƒè¯•æ—¶ä½¿ç”¨</li></ol></li><li><code>FINER</code><ol><li>è°ƒè¯•ä¿¡æ¯ï¼ˆä¸­ï¼‰ï¼Œè¯¦ç»†è°ƒè¯•æ—¶ä½¿ç”¨</li></ol></li><li><code>FINEST</code><ol><li>è°ƒè¯•ä¿¡æ¯ï¼ˆå¤šï¼‰ï¼Œè¯¦ç»†è°ƒè¯•æ—¶ä½¿ç”¨</li></ol></li><li><code>ALL</code><ol><li>æ•è·æ‰€æœ‰çº§åˆ«çš„æ—¥å¿—ä¿¡æ¯</li></ol></li></ol></li></ol></li></ol><hr><h2 id="3-JUL-æ ¸å¿ƒç‰¹æ€§"><a href="#3-JUL-æ ¸å¿ƒç‰¹æ€§" class="headerlink" title="3. JUL æ ¸å¿ƒç‰¹æ€§"></a>3. JUL æ ¸å¿ƒç‰¹æ€§</h2><p><code>JUL</code> æ˜¯ä¸€ä¸ªå…·å¤‡å±‚æ¬¡ç»“æ„çš„æ—¥å¿—è®°å½•å™¨ï¼Œé‡‡ç”¨çˆ¶å­å…³ç³»è¿›è¡Œç»„ç»‡ã€‚ä¾‹å¦‚ <code>com</code> æ˜¯ <code>com.example</code> çš„çˆ¶çº§ï¼Œè€Œ <code>com.example</code> åˆæ˜¯ <code>com.example.test</code> çš„çˆ¶çº§ï¼Œè€Œæœ€é¡¶å±‚çš„ <code>com</code> åˆ™ä»¥æ ¹æ—¥å¿—ï¼ˆ <code>RootLogger</code>ï¼‰ ä½œä¸ºå…¶çˆ¶çº§ã€‚</p><p>è€Œ <code>JUL</code> åŒ…å«ä»¥ä¸‹æ ¸å¿ƒç‰¹æ€§ï¼š</p><ol><li>ç»§æ‰¿çš„ç‰¹æ€§<ol><li>å¦‚æœæˆ‘ä»¬æ²¡æœ‰ä¸ºå­çº§ <code>Logger</code> æ‰‹åŠ¨è®¾ç½®æ—¥å¿—çº§åˆ«ï¼Œå®ƒä¼šé»˜è®¤ç»§æ‰¿çˆ¶çº§ <code>Logger</code> çš„æ—¥å¿—çº§åˆ«</li></ol></li><li>æ—¥å¿—å‘ä¸Šä¼ é€’çš„ç‰¹æ€§<ol><li>æ¯å½“å­çº§ <code>Logger</code>ï¼ˆä¾‹å¦‚ <code>com.example</code>ï¼‰è®°å½•ä¸€æ¡æ—¥å¿—æ—¶ï¼Œé¦–å…ˆä¼šé€šè¿‡è‡ªèº«é…ç½®çš„ <code>Handler</code> è¾“å‡º</li><li>éšåï¼Œè¿™æ¡æ—¥å¿—ä¼šå‘ä¸Šä¼ é€’è‡³çˆ¶çº§ <code>Logger</code>ï¼Œå¹¶é€šè¿‡çˆ¶çº§çš„ <code>Handler</code> è¾“å‡ºï¼ˆåœ¨çˆ¶çº§åŒæ ·ä¼šè¿›è¡Œè¿‡æ»¤ï¼‰</li><li>è¿™ä¸ªå‘ä¸Šä¼ é€’è¿‡ç¨‹ä¼šé€çº§è¿›è¡Œï¼Œæœ€ç»ˆåˆ°è¾¾æœ€é¡¶å±‚çš„ <code>RootLogger</code>ï¼Œå¹¶é€šè¿‡å…¶ <code>Handler</code> è¾“å‡º</li><li>æˆ‘ä»¬å¯ä»¥ç¦ç”¨è¿™ç§å‘ä¸Šä¼ é€’è¡Œä¸ºï¼ˆé€šè¿‡ <code>setUseParentHandlers(false)</code>ï¼‰</li></ol></li></ol><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>ç”±äºæ—¥å¿—æ˜¯é€æ¡å‘ä¸Šä¼ é€’çš„ï¼Œè€Œä¸æ˜¯ç­‰åˆ°åº•å±‚ <code>Handler</code> æ•´ä½“è¾“å‡ºåå†æ•´ä½“å‘ä¸Šä¼ é€’ï¼Œå› æ­¤å¯èƒ½ä¼šçœ‹åˆ°ç±»ä¼¼ä»¥ä¸‹çš„æ—¥å¿—è¾“å‡ºï¼š</li></ol></blockquote><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-number">3</span>æœˆ <span class="hljs-number">12</span>, <span class="hljs-number">2025</span> <span class="hljs-number">10</span>:<span class="hljs-number">47</span>:<span class="hljs-number">37</span> ä¸Šåˆ com<span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.test</span><span class="hljs-selector-class">.Main</span> <span class="hljs-selector-tag">main</span><br>ä¸¥é‡: severe ä¿¡æ¯<br><span class="hljs-number">3</span>æœˆ <span class="hljs-number">12</span>, <span class="hljs-number">2025</span> <span class="hljs-number">10</span>:<span class="hljs-number">47</span>:<span class="hljs-number">37</span> ä¸Šåˆ com<span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.test</span><span class="hljs-selector-class">.Main</span> <span class="hljs-selector-tag">main</span><br>ä¸¥é‡: severe ä¿¡æ¯<br><span class="hljs-number">3</span>æœˆ <span class="hljs-number">12</span>, <span class="hljs-number">2025</span> <span class="hljs-number">10</span>:<span class="hljs-number">47</span>:<span class="hljs-number">37</span> ä¸Šåˆ com<span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.test</span><span class="hljs-selector-class">.Main</span> <span class="hljs-selector-tag">main</span><br>ä¸¥é‡: severe ä¿¡æ¯<br><span class="hljs-number">3</span>æœˆ <span class="hljs-number">12</span>, <span class="hljs-number">2025</span> <span class="hljs-number">10</span>:<span class="hljs-number">47</span>:<span class="hljs-number">37</span> ä¸Šåˆ com<span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.test</span><span class="hljs-selector-class">.Main</span> <span class="hljs-selector-tag">main</span><br>è­¦å‘Š: warning ä¿¡æ¯<br><span class="hljs-number">3</span>æœˆ <span class="hljs-number">12</span>, <span class="hljs-number">2025</span> <span class="hljs-number">10</span>:<span class="hljs-number">47</span>:<span class="hljs-number">37</span> ä¸Šåˆ com<span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.test</span><span class="hljs-selector-class">.Main</span> <span class="hljs-selector-tag">main</span><br>è­¦å‘Š: warning ä¿¡æ¯<br><span class="hljs-number">3</span>æœˆ <span class="hljs-number">12</span>, <span class="hljs-number">2025</span> <span class="hljs-number">10</span>:<span class="hljs-number">47</span>:<span class="hljs-number">37</span> ä¸Šåˆ com<span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.test</span><span class="hljs-selector-class">.Main</span> <span class="hljs-selector-tag">main</span><br>è­¦å‘Š: warning ä¿¡æ¯<br><span class="hljs-number">3</span>æœˆ <span class="hljs-number">12</span>, <span class="hljs-number">2025</span> <span class="hljs-number">10</span>:<span class="hljs-number">47</span>:<span class="hljs-number">37</span> ä¸Šåˆ com<span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.test</span><span class="hljs-selector-class">.Main</span> <span class="hljs-selector-tag">main</span><br>ä¿¡æ¯: info ä¿¡æ¯<br><span class="hljs-number">3</span>æœˆ <span class="hljs-number">12</span>, <span class="hljs-number">2025</span> <span class="hljs-number">10</span>:<span class="hljs-number">47</span>:<span class="hljs-number">37</span> ä¸Šåˆ com<span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.test</span><span class="hljs-selector-class">.Main</span> <span class="hljs-selector-tag">main</span><br>ä¿¡æ¯: info ä¿¡æ¯<br><span class="hljs-number">3</span>æœˆ <span class="hljs-number">12</span>, <span class="hljs-number">2025</span> <span class="hljs-number">10</span>:<span class="hljs-number">47</span>:<span class="hljs-number">37</span> ä¸Šåˆ com<span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.test</span><span class="hljs-selector-class">.Main</span> <span class="hljs-selector-tag">main</span><br>ä¿¡æ¯: info ä¿¡æ¯<br></code></pre></td></tr></table></figure><hr><h2 id="4-JUL-ä½¿ç”¨æ–¹å¼"><a href="#4-JUL-ä½¿ç”¨æ–¹å¼" class="headerlink" title="4. JUL ä½¿ç”¨æ–¹å¼"></a>4. JUL ä½¿ç”¨æ–¹å¼</h2><h3 id="4-1-è¿›è¡Œ-JUL-ç›¸å…³é…ç½®"><a href="#4-1-è¿›è¡Œ-JUL-ç›¸å…³é…ç½®" class="headerlink" title="4.1. è¿›è¡Œ JUL ç›¸å…³é…ç½®"></a>4.1. è¿›è¡Œ JUL ç›¸å…³é…ç½®</h3><h4 id="4-1-1-æ–‡ä»¶é…ç½®"><a href="#4-1-1-æ–‡ä»¶é…ç½®" class="headerlink" title="4.1.1. æ–‡ä»¶é…ç½®"></a>4.1.1. æ–‡ä»¶é…ç½®</h4><h5 id="4-1-1-1-JAVA-HOME-conf-logging-properties"><a href="#4-1-1-1-JAVA-HOME-conf-logging-properties" class="headerlink" title="4.1.1.1. ${JAVA_HOME}&#x2F;conf&#x2F;logging.properties"></a>4.1.1.1. ${JAVA_HOME}&#x2F;conf&#x2F;logging.properties</h5><h6 id="4-1-1-1-1-é…ç½®æ¦‚è¿°"><a href="#4-1-1-1-1-é…ç½®æ¦‚è¿°" class="headerlink" title="4.1.1.1.1. é…ç½®æ¦‚è¿°"></a>4.1.1.1.1. é…ç½®æ¦‚è¿°</h6><p>è¯¥é…ç½®ç”¨äºé…ç½®æ ¹æ—¥å¿—ç®¡é“</p><hr><h6 id="4-1-1-1-2-Logger-é…ç½®"><a href="#4-1-1-1-2-Logger-é…ç½®" class="headerlink" title="4.1.1.1.2. Logger é…ç½®"></a>4.1.1.1.2. Logger é…ç½®</h6><p><font color="#92d050">1. é…ç½® Logger çš„æ—¥å¿—çº§åˆ«</font></p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">.level</span> = <span class="hljs-string">INFO  </span><br></code></pre></td></tr></table></figure><hr><h6 id="4-1-1-1-3-Handler-é…ç½®"><a href="#4-1-1-1-3-Handler-é…ç½®" class="headerlink" title="4.1.1.1.3. Handler é…ç½®"></a>4.1.1.1.3. Handler é…ç½®</h6><p><font color="#92d050">1. é…ç½® RootLogger ä½¿ç”¨å“ªäº› Handler</font></p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">handlers</span> = <span class="hljs-string">java.util.logging.ConsoleHandler, java.util.logging.FileHandler</span><br></code></pre></td></tr></table></figure><p><font color="#92d050">2. ConsoleHandler çš„è¯¦ç»†é…ç½®</font></p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-comment"># 1. ConsoleHandler çš„æ—¥å¿—çº§åˆ«</span><br><span class="hljs-attr">java.util.logging.ConsoleHandler.level</span> = <span class="hljs-string">INFO</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"># 2. ConsoleHandler çš„æ—¥å¿—è¾“å‡ºæ ¼å¼</span><br><span class="hljs-attr">java.util.logging.ConsoleHandler.formatter</span> = <span class="hljs-string">java.util.logging.SimpleFormatter</span><br></code></pre></td></tr></table></figure><p><font color="#92d050">3. FileHandler çš„è¯¦ç»†é…ç½®</font></p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-comment"># 1. FileHandler çš„æ—¥å¿—çº§åˆ«</span><br><span class="hljs-attr">java.util.logging.FileHandler.level</span> = <span class="hljs-string">ALL</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"># 2. FileHandler è¾“å‡ºåˆ°çš„æ—¥å¿—æ–‡ä»¶çš„å­˜æ”¾ä½ç½®</span><br><span class="hljs-attr">java.util.logging.FileHandler.pattern</span> = <span class="hljs-string">D:\\EnglishDeployment\\logs\\JUL.%g.log</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"># 3. å•ä¸ªæ—¥å¿—æ–‡ä»¶æœ€å¤§å­—èŠ‚æ•°é‡ï¼ˆ10485760 å­—èŠ‚ ä¸º 10MBï¼‰</span><br><span class="hljs-attr">java.util.logging.FileHandler.limit</span> = <span class="hljs-string">10485760</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"># 4. æ—¥å¿—æ–‡ä»¶æœ€å¤§æ€»æ•°é‡</span><br><span class="hljs-attr">java.util.logging.FileHandler.count</span> = <span class="hljs-string">5 </span><br><span class="hljs-comment"></span><br><span class="hljs-comment"># 5. FileHandler è¾“å‡ºæ—¥å¿—æ˜¯å¦ä»¥è¿½åŠ æ¨¡å¼ï¼ˆtrue ä¸ºè¿½åŠ æ¨¡å¼ï¼Œfalse ä¸ºè¦†ç›–æ¨¡å¼ï¼‰</span><br>    <span class="hljs-attr">1.</span> <span class="hljs-string">true</span><br>        <span class="hljs-attr">1.</span> <span class="hljs-string">è¿½åŠ æ¨¡å¼</span><br>        <span class="hljs-attr">2.</span> <span class="hljs-string">å¦‚æœæ—¥å¿—æ–‡ä»¶å·²ç»å­˜åœ¨ï¼Œæ–°æ—¥å¿—ä¼šæ¥åœ¨æ—§æ—¥å¿—åé¢ç»§ç»­å†™</span><br>    <span class="hljs-attr">2.</span> <span class="hljs-string">false</span><br>        <span class="hljs-attr">1.</span> <span class="hljs-string">è¦†ç›–æ¨¡å¼</span><br>        <span class="hljs-attr">2.</span> <span class="hljs-string">æ¯æ¬¡åº”ç”¨å¯åŠ¨æ—¶ï¼Œå¦‚æœæ—¥å¿—æ–‡ä»¶å·²å­˜åœ¨ï¼Œä¼šå…ˆæ¸…ç©ºï¼Œä»å¤´å†™æ–°çš„å†…å®¹</span><br><span class="hljs-attr">java.util.logging.FileHandler.append</span> = <span class="hljs-string">true</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"># 6. FileHandler çš„æ—¥å¿—è¾“å‡ºæ ¼å¼ï¼ˆé»˜è®¤æ˜¯ XML æ–¹å¼ï¼‰</span><br><span class="hljs-attr">java.util.logging.FileHandler.formatter</span> = <span class="hljs-string">java.util.logging.SimpleFormatter</span><br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>å¦‚æœéœ€è¦å°†æ—¥å¿—å†™å…¥æ–‡ä»¶ï¼ˆå³ä½¿ç”¨ <code>FileHandler</code>ï¼‰ï¼Œéœ€è¦æ³¨æ„ä»¥ä¸‹ä¸‰ç‚¹ï¼š<ol><li><code>JUL</code> åªåˆ›å»ºæ–‡ä»¶è€Œä¸ä¼šè‡ªåŠ¨ç”Ÿæˆæ–‡ä»¶æ‰€åœ¨çš„ç›®å½•ï¼Œå› æ­¤å¿…é¡»æ‰‹åŠ¨åˆ›å»º <code>logs</code> ç›®å½•ï¼Œå¹¶ç¡®ä¿ç¨‹åºå…·æœ‰ç›¸åº”çš„è¯»å†™æƒé™ã€‚</li><li>æ–‡ä»¶è·¯å¾„çš„æ ¼å¼åº”ä½¿ç”¨ <code>\\</code> è€Œé <code>\</code></li><li><code>JUL</code> ä¸­çš„æ—¥å¿—è½®æ¢æœºåˆ¶æµç¨‹å¦‚ä¸‹ï¼š<ol><li><code>JUL</code> å…ˆå°†æ—¥å¿—è®°å½•åœ¨ <code>JUL.0.log</code> æ–‡ä»¶ä¸­ã€‚</li><li>å½“ <code>JUL.0.log</code> æ–‡ä»¶å†™æ»¡æ—¶ï¼Œå®ƒä¼šè¢«é‡å‘½åä¸º <code>JUL.1.log</code>ï¼ŒåŒæ—¶åˆ›å»ºä¸€ä¸ªæ–°çš„ <code>JUL.0.log</code> ç»§ç»­è®°å½•ã€‚</li><li>éšç€ <code>JUL.0.log</code> æ—¥å¿—å†æ¬¡å†™æ»¡ï¼Œ<code>JUL.1.log</code> ä¼šè¢«é‡å‘½åä¸º <code>JUL.2.log</code>ï¼Œè€Œ <code>JUL.0.log</code> åˆ™å†æ¬¡é‡å‘½åä¸º <code>JUL.1.log</code>ï¼Œè¿™æ ·ä¾æ¬¡è¿›è¡Œã€‚</li><li>å½“æ–‡ä»¶æ•°é‡è¾¾åˆ°æœ€å¤§é™åˆ¶æ—¶ï¼Œæœ€æ—©çš„æ—¥å¿—æ–‡ä»¶ï¼ˆå¦‚ <code>JUL.4.log</code>ï¼‰å°†è¢«åˆ é™¤ï¼Œä»¥è…¾å‡ºç©ºé—´</li></ol></li></ol></li></ol></blockquote><hr><h4 id="4-1-2-é…ç½®åŒ…æ—¥å¿—ç®¡é“"><a href="#4-1-2-é…ç½®åŒ…æ—¥å¿—ç®¡é“" class="headerlink" title="4.1.2. é…ç½®åŒ…æ—¥å¿—ç®¡é“"></a>4.1.2. é…ç½®åŒ…æ—¥å¿—ç®¡é“</h4><p>å¯¹äºæŸäº›åŒ…ä¸‹çš„ä»£ç ï¼Œå¦‚æœæˆ‘ä»¬ä¸å¸Œæœ›å®Œå…¨æ²¿ç”¨<code> RootLogger</code> çš„é…ç½®ï¼Œå¯ä»¥åœ¨ä»£ç ä¸­æ‰‹åŠ¨ä¸ºè¿™äº›åŒ…å•ç‹¬é…ç½®</p><p>åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä¸º <code>com.example.Main</code> åŒ…å•ç‹¬é…ç½®äº†æ—¥å¿—ç®¡é“ï¼ˆæœ‰å…¥å£ï¼Œæœ‰å‡ºå£ï¼Œä¸å¦‚ç›´æ¥å«åšæ—¥å¿—ç®¡é“ï¼‰ï¼Œå¹¶ä¸”ç¦ç”¨äº†æ—¥å¿—å‘ä¸Šä¼ é€’</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Main</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br><br>        <span class="hljs-comment">// 1. åˆ›å»º ConsoleHandlerï¼ˆæ—¥å¿—å¤„ç†å™¨ï¼‰</span><br>        <span class="hljs-type">ConsoleHandler</span> <span class="hljs-variable">consoleHandler</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConsoleHandler</span>();<br><br>        <span class="hljs-comment">// 2. åˆ›å»º SimpleFormatterï¼ˆæ ¼å¼åŒ–ç»„ä»¶ï¼‰</span><br>        <span class="hljs-type">SimpleFormatter</span> <span class="hljs-variable">simpleFormatter</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleFormatter</span>();<br><br>        <span class="hljs-comment">// 3. å°†æ ¼å¼åŒ–ç»„ä»¶è®¾ç½®åˆ°æ—¥å¿—å¤„ç†å™¨ä¸­</span><br>        consoleHandler.setFormatter(simpleFormatter);<br><br>        <span class="hljs-comment">// 4. è·å– com.example.Main å±‚çš„ Logger</span><br>        <span class="hljs-type">Logger</span> <span class="hljs-variable">logger</span> <span class="hljs-operator">=</span> Logger.getLogger(<span class="hljs-string">&quot;com.example.Main&quot;</span>);<br><br>        <span class="hljs-comment">// 5. é…ç½® com.example.Main å±‚çš„ Logger</span><br>        <span class="hljs-comment">// Logger çš„æ—¥å¿—çº§åˆ«</span><br>        logger.setLevel(Level.INFO); <br>        <br>        <span class="hljs-comment">// ç¦ç”¨æ—¥å¿—å‘ä¸Šä¼ é€’</span><br>        logger.setUseParentHandlers(<span class="hljs-literal">false</span>); <br>        <br>        <span class="hljs-comment">// Logger è¾“å‡ºåˆ°çš„ Handler</span><br>        logger.addHandler(consoleHandler); <br><br>        <span class="hljs-comment">// 6. è°ƒç”¨æˆ‘ä»¬é…ç½®å¥½çš„åŒ…æ—¥å¿—ç®¡é“è®°å½•æ—¥å¿—ï¼ˆè®°å½•æ—¶æ˜¯ä½¿ç”¨ logger è¿›è¡Œè®°å½•ï¼Œå› ä¸º logger æ˜¯æ—¥å¿—çš„å…¥å£ï¼‰</span><br>        logger.severe(<span class="hljs-string">&quot;severe ä¿¡æ¯&quot;</span>);<br>        logger.warning(<span class="hljs-string">&quot;warning ä¿¡æ¯&quot;</span>);<br>        logger.info(<span class="hljs-string">&quot;info ä¿¡æ¯&quot;</span>);<br>        logger.config(<span class="hljs-string">&quot;config ä¿¡æ¯&quot;</span>);<br>        logger.fine(<span class="hljs-string">&quot;fine ä¿¡æ¯&quot;</span>);<br>        logger.finer(<span class="hljs-string">&quot;finer ä¿¡æ¯&quot;</span>);<br>        logger.finest(<span class="hljs-string">&quot;finest ä¿¡æ¯&quot;</span>);<br>        <br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>å¦‚æœæˆ‘ä»¬ä¸ºæ¯ä¸ªç±»éƒ½å•ç‹¬å†™ä¸€å †æ—¥å¿—é…ç½®ï¼Œä½¿ç”¨èµ·æ¥å°±ä¼šæ˜¾å¾—éå¸¸ç¹çã€‚æ›´å¥½çš„åšæ³•æ˜¯å†™ä¸€ä¸ª <code>LogUtil</code> å·¥å…·ç±»ï¼Œåœ¨é‡Œé¢ä¸€æ¬¡æ€§ä¸º <code>com.example</code> åŒ…é…ç½®å¥½æ—¥å¿—ç®¡é“ï¼Œè¿™æ ·åç»­å„ä¸ªç±»åªéœ€è¦ç›´æ¥è·å– Logger å°±èƒ½è®°å½•æ—¥å¿—äº†ã€‚</li></ol></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LogUtil</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Logger</span> <span class="hljs-variable">logger</span> <span class="hljs-operator">=</span> Logger.getLogger(<span class="hljs-string">&quot;com.example&quot;</span>);<br><br>    <span class="hljs-keyword">static</span> &#123;<br>        <span class="hljs-type">ConsoleHandler</span> <span class="hljs-variable">handler</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConsoleHandler</span>();<br>        handler.setFormatter(<span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleFormatter</span>());<br>        handler.setLevel(Level.ALL);<br>        logger.addHandler(handler);<br>        logger.setUseParentHandlers(<span class="hljs-literal">false</span>);<br>        logger.setLevel(Level.ALL);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Logger <span class="hljs-title function_">getLogger</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> logger;<br>    &#125;<br>    <br>&#125;<br></code></pre></td></tr></table></figure><hr><h3 id="4-2-ä½¿ç”¨-JUL-è®°å½•æ—¥å¿—"><a href="#4-2-ä½¿ç”¨-JUL-è®°å½•æ—¥å¿—" class="headerlink" title="4.2. ä½¿ç”¨ JUL è®°å½•æ—¥å¿—"></a>4.2. ä½¿ç”¨ JUL è®°å½•æ—¥å¿—</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br><br><span class="hljs-comment">// è·å– com.example.Main å±‚çš„ Logger</span><br>        <span class="hljs-type">Logger</span> <span class="hljs-variable">logger</span> <span class="hljs-operator">=</span> Logger.getLogger(<span class="hljs-string">&quot;com.example.Main&quot;</span>);<br><br>        logger.severe(<span class="hljs-string">&quot;severe ä¿¡æ¯&quot;</span>);<br><br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li><code>JUL</code> çš„ <code>Logger</code> æ˜¯æŒ‰åå­—å•ä¾‹çš„ï¼Œéƒ½ä¼šä¿å­˜åœ¨å…¨å±€çš„ <code>LogManager</code> ä¸­ã€‚<ol><li>å¦‚æœä½ ä¹‹å‰å·²ç»è¿è¡Œè¿‡é…ç½®å¥½çš„ <code>com.example.Main</code> å±‚çš„ <code>Logger</code>ï¼Œé‚£ä¹ˆåœ¨å…¶å®ƒåœ°æ–¹è·å–åŒåçš„ <code>Logger</code>ï¼Œæ‹¿åˆ°çš„å°±æ˜¯è¿™ä¸ªå·²ç»é…ç½®è¿‡çš„å®ä¾‹ã€‚</li><li>ä½†æ˜¯å¦‚æœä½ ä¹‹å‰æ²¡æœ‰è¿è¡Œè¿‡ï¼Œé‚£ä¹ˆåœ¨è·å–æ—¶ï¼Œ <code>LogManager</code> ä¼šä¸º <code>com.example.Main</code> æ–°å»ºä¸€ä¸ª <code>Logger</code>ï¼Œå¹¶ä½¿ç”¨é»˜è®¤é…ç½®ï¼ˆç»§æ‰¿çˆ¶çº§ <code>Logger</code>ï¼‰ï¼Œå†åœ¨å…¶å®ƒåœ°æ–¹è·å–åŒåçš„ <code>Logger</code>ï¼Œæ‹¿åˆ°çš„å°±æ˜¯è¿™ä¸ªå·²ç»é…ç½®è¿‡çš„å®ä¾‹ï¼ˆå³ä¾¿å†è¿è¡Œé…ç½®å¥½çš„ <code>com.example.Main</code> å±‚çš„ <code>Logger</code>ï¼‰</li></ol></li><li><code>JUL</code> è¿˜æä¾›ä¸€ç§æ–¹ä¾¿çš„æ—¥å¿—è®°å½•æ–¹å¼ï¼Œå…è®¸æˆ‘ä»¬åŠ¨æ€ä¼ é€’å‚æ•°ï¼Œä»è€Œä»£æ›¿æ‹¼æ¥å­—ç¬¦ä¸²ï¼š</li></ol></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;Ba Tian&quot;</span>;<br><span class="hljs-type">int</span> <span class="hljs-variable">age</span> <span class="hljs-operator">=</span> <span class="hljs-number">18</span>;<br>logger.log(Level.INFO,<span class="hljs-string">&quot;å­¦ç”Ÿçš„å§“åä¸ºï¼š&#123;0&#125;ï¼Œå¹´é¾„ä¸ºï¼š&#123;1&#125;&quot;</span>,<span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]&#123;name,age&#125;);<br></code></pre></td></tr></table></figure><hr><h1 id="äº”ã€SLF4J"><a href="#äº”ã€SLF4J" class="headerlink" title="äº”ã€SLF4J"></a>äº”ã€SLF4J</h1><h2 id="1-SLF4J-æ¦‚è¿°"><a href="#1-SLF4J-æ¦‚è¿°" class="headerlink" title="1. SLF4J æ¦‚è¿°"></a>1. SLF4J æ¦‚è¿°</h2><p><code>SLF4J</code>ï¼ˆ<code>Simple Logging Facade for Java</code>ï¼‰æ˜¯ä¸€ç§æ—¥å¿—é—¨é¢æ¡†æ¶ï¼Œä¸ºå„ç§æ—¥å¿—æ¡†æ¶æä¾›ç»Ÿä¸€çš„æŠ½è±¡æ¥å£ï¼ˆ<code>API</code>ï¼‰ï¼Œè®©å¼€å‘è€…åœ¨åº”ç”¨ä¸­åªéœ€ä¾èµ–äºè¿™ä¸€å¥— <code>API</code>ï¼Œè€Œæ— éœ€é’ˆå¯¹ä¸åŒçš„æ—¥å¿—å®ç°å­¦ä¹ å„è‡ªçš„ä¸“æœ‰ <code>API</code></p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li><code>SLF4J</code> åªæ˜¯ä¸ªæ—¥å¿—é—¨é¢ï¼Œè‡ªèº«ä¸æä¾›ä»»ä½•é…ç½®åŠŸèƒ½</li><li>å¦‚æœéœ€è¦é…ç½®æ—¥å¿—ï¼Œä¾‹å¦‚è®¾ç½®æ—¥å¿—çº§åˆ«ç­‰ï¼Œä»éœ€æŒ‰ç…§å…·ä½“æ—¥å¿—å®ç°ï¼ˆå¦‚ <code>Log4J2</code>ã€<code>JUL</code> ç­‰ï¼‰çš„é…ç½®æ–¹å¼ï¼Œè¿›è¡Œç›¸å…³é…ç½®</li></ol></blockquote><hr><h2 id="2-SLF4J-æ”¯æŒçš„æ—¥å¿—çº§åˆ«"><a href="#2-SLF4J-æ”¯æŒçš„æ—¥å¿—çº§åˆ«" class="headerlink" title="2. SLF4J æ”¯æŒçš„æ—¥å¿—çº§åˆ«"></a>2. SLF4J æ”¯æŒçš„æ—¥å¿—çº§åˆ«</h2><p><code>SLF4J</code> æ”¯æŒçš„æ—¥å¿—çº§åˆ«é¡ºåºä¸ºï¼š</p><ol><li><code>ERROR</code><ol><li>è¾“å‡ºé”™è¯¯ä¿¡æ¯ï¼Œè¡¨ç¤ºä¸¥é‡é”™è¯¯æˆ–å¼‚å¸¸æƒ…å†µï¼Œåº”ç”¨å¯èƒ½æ— æ³•ç»§ç»­è¿›è¡Œ</li></ol></li><li><code>WARN</code>ï¼ˆæœ€æ¨èï¼‰<ol><li>è¾“å‡ºè­¦å‘Šä¿¡æ¯ï¼Œæç¤ºæ½œåœ¨çš„é—®é¢˜</li></ol></li><li><code>INFO</code><ol><li>è¾“å‡ºå¸¸è§„è¿è¡Œä¿¡æ¯ï¼Œæä¾›ç³»ç»Ÿè¿è¡ŒçŠ¶æ€</li></ol></li><li><code>DEBUF</code><ol><li>è¾“å‡ºè°ƒè¯•ä¿¡æ¯ï¼Œæ¯”å¦‚è¯¦ç»†çš„é…ç½®è§£æè¿‡ç¨‹</li></ol></li><li><code>TRACE</code><ol><li>è¾“å‡ºæœ€è¯¦ç»†çš„ä¿¡æ¯ï¼Œå‡ ä¹æ˜¯é€è¡Œè§£é‡Šå‘ç”Ÿäº†ä»€ä¹ˆ</li></ol></li></ol><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li><code>SLF4J</code> æœ¬èº«åªæ˜¯ä¸ªæ—¥å¿—é—¨é¢ï¼Œå› æ­¤ä»–æ²¡æœ‰é»˜è®¤çš„æ—¥å¿—çº§åˆ«ï¼Œå…¶å–å†³äºæˆ‘ä»¬ä½¿ç”¨çš„åº•å±‚æ—¥å¿—å®ç°ï¼š<ol><li><code>JUL</code><ol><li>é»˜è®¤æ—¥å¿—çº§åˆ«æ˜¯ <code>INFO</code></li></ol></li><li><code>Log4J</code><ol><li>é»˜è®¤æ—¥å¿—çº§åˆ«æ˜¯ <code>ERROR</code></li></ol></li><li><code>Log4J2</code><ol><li>é»˜è®¤æ—¥å¿—çº§åˆ«æ˜¯ <code>ERROR</code></li></ol></li></ol></li></ol></blockquote><hr><h2 id="3-SLF4J-ä½¿ç”¨æ–¹å¼"><a href="#3-SLF4J-ä½¿ç”¨æ–¹å¼" class="headerlink" title="3. SLF4J ä½¿ç”¨æ–¹å¼"></a>3. SLF4J ä½¿ç”¨æ–¹å¼</h2><h3 id="3-1-æ·»åŠ ç›¸å…³ä¾èµ–"><a href="#3-1-æ·»åŠ ç›¸å…³ä¾èµ–" class="headerlink" title="3.1. æ·»åŠ ç›¸å…³ä¾èµ–"></a>3.1. æ·»åŠ ç›¸å…³ä¾èµ–</h3><ol><li>åˆ›å»ºå<ol><li><code>slf4j-api</code><ol><li><code>Maven</code><ol><li><a href="https://mvnrepository.com/artifact/org.slf4j/slf4j-api">https://mvnrepository.com/artifact/org.slf4j/slf4j-api</a></li></ol></li><li><code>Gradle</code><ol><li></li></ol></li></ol></li><li><code>log4j-slf4j2-impl</code><ol><li><code>Maven</code><ol><li><a href="https://mvnrepository.com/artifact/org.apache.logging.log4j/log4j-slf4j2-impl">https://mvnrepository.com/artifact/org.apache.logging.log4j/log4j-slf4j2-impl</a></li></ol></li><li><code>Gradle</code><ol><li></li></ol></li></ol></li></ol></li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.slf4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>slf4j-api<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.1.0-alpha1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.logging.log4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>log4j-slf4j2-impl<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.0.0-beta2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>compile<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>è¿™é‡Œå¼•å…¥çš„ <code>log4j-slf4j2-impl</code> ä¾èµ–æ˜¯ä¸€ä¸ªé€‚é…å™¨ã€‚</li><li>å› ä¸º <code>SLF4J</code> è¯ç”Ÿä¹‹å‰çš„æ—¥å¿—æ¡†æ¶ï¼Œå¹¶æœªéµå¾ª <code>SLF4J</code> æ ‡å‡†ï¼Œå› æ­¤æ— æ³•åœ¨å¼•å…¥ <code>SLF4J</code> ä¾èµ–åï¼Œç«‹å³æŠ•å…¥ä½¿ç”¨ï¼Œéœ€è¦é¢å¤–å¼•å…¥é€‚é…å™¨</li><li>è€Œ <code>SLF4J</code> ä¹‹åçš„æ—¥å¿—æ¡†æ¶ï¼Œå¦‚æœå·²éµå¾ª <code>SLF4J</code> è§„èŒƒï¼Œåˆ™åªéœ€ç›´æ¥å¼•å…¥ç›¸å…³ä¾èµ–å³å¯æ­£å¸¸ä½¿ç”¨ã€‚ä½†å¦‚æœæ—¥å¿—æ¡†æ¶æœªéµå¾ª <code>SLF4J</code> æ ‡å‡†ï¼ˆä¾‹å¦‚ <code>Log4J2</code>ï¼‰ï¼Œä»ç„¶éœ€è¦å¼•å…¥é€‚é…å™¨æ‰èƒ½ä½¿ç”¨</li></ol></blockquote><hr><h3 id="3-2-ä½¿ç”¨-SLF4J-è®°å½•æ—¥å¿—"><a href="#3-2-ä½¿ç”¨-SLF4J-è®°å½•æ—¥å¿—" class="headerlink" title="3.2. ä½¿ç”¨ SLF4J è®°å½•æ—¥å¿—"></a>3.2. ä½¿ç”¨ SLF4J è®°å½•æ—¥å¿—</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> &#123;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;  <br>        <span class="hljs-type">Logger</span> <span class="hljs-variable">logger</span> <span class="hljs-operator">=</span> LoggerFactory.getLogger(<span class="hljs-string">&quot;com.example.Main&quot;</span>);<br>        logger.trace(<span class="hljs-string">&quot;trace ä¿¡æ¯&quot;</span>);  <br>        logger.debug(<span class="hljs-string">&quot;debug ä¿¡æ¯&quot;</span>);  <br>        logger.info(<span class="hljs-string">&quot;info ä¿¡æ¯&quot;</span>);  <br>        logger.warn(<span class="hljs-string">&quot;warn ä¿¡æ¯&quot;</span>);  <br>        logger.error(<span class="hljs-string">&quot;error ä¿¡æ¯&quot;</span>);  <br>    &#125;  <br>    <br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li><code>SLF4J</code> åŒæ ·æä¾›å¦å¤–ä¸€ç§è®°å½•æ–¹å¼ï¼Œå…è®¸æˆ‘ä»¬åŠ¨æ€ä¼ é€’å‚æ•°ï¼Œä»è€Œä»£æ›¿æ‹¼æ¥å­—ç¬¦ä¸²ï¼š</li></ol></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;Ba Tian&quot;</span>;<br><span class="hljs-type">int</span> <span class="hljs-variable">age</span> <span class="hljs-operator">=</span> <span class="hljs-number">18</span>;<br>logger.log(Level.INFO,<span class="hljs-string">&quot;å­¦ç”Ÿçš„å§“åä¸ºï¼š&#123;&#125;ï¼Œå¹´é¾„ä¸ºï¼š&#123;&#125;&quot;</span>,name,age);<br></code></pre></td></tr></table></figure><hr><h1 id="å…­ã€SLF4J-Log4J2"><a href="#å…­ã€SLF4J-Log4J2" class="headerlink" title="å…­ã€SLF4J + Log4J2"></a>å…­ã€SLF4J + Log4J2</h1><h2 id="1-SLF4J-Log4J2-æ¦‚è¿°"><a href="#1-SLF4J-Log4J2-æ¦‚è¿°" class="headerlink" title="1. SLF4J + Log4J2 æ¦‚è¿°"></a>1. SLF4J + Log4J2 æ¦‚è¿°</h2><p>ä½¿ç”¨ <code>SLF4J</code> ä½œä¸ºæ—¥å¿—é—¨é¢æ¡†æ¶ï¼Œæ­é… <code>Log4j2</code> çš„æ—¥å¿—å®ç°æ¡†æ¶ï¼Œç»å¯¹æ˜¯å½“å‰å¸‚åœºä¸Šæœ€å¼ºå¤§ã€æœ€çµæ´»çš„æ—¥å¿—åŠŸèƒ½å®ç°æ–¹å¼</p><hr><h2 id="2-Log4J2-ç›¸å…³ç»„ä»¶"><a href="#2-Log4J2-ç›¸å…³ç»„ä»¶" class="headerlink" title="2. Log4J2 ç›¸å…³ç»„ä»¶"></a>2. Log4J2 ç›¸å…³ç»„ä»¶</h2><p><code>Log4j2</code> ä¸»è¦ç”±æ—¥å¿—è®°å½•å™¨ï¼ˆ<code>Loggers</code>ï¼‰ã€è¾“å‡ºæ§åˆ¶å™¨ï¼ˆ<code>Appenders</code>ï¼‰å’Œæ—¥å¿—æ ¼å¼åŒ–å™¨ï¼ˆ<code>Layout</code>ï¼‰ç»„æˆ</p><ol><li><code>Loggers</code><ol><li><code>Loggers</code>ï¼ˆæ—¥å¿—è®°å½•å™¨ï¼‰ï¼Œè´Ÿè´£è®°å½•æ—¥å¿—ï¼Œå¹¶æ§åˆ¶æ—¥å¿—çš„è¾“å‡ºçº§åˆ«</li><li>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸ <code>JUL</code> ä¸åŒï¼Œ<code>Log4j2</code> ä¸­çš„æ—¥å¿—ä¿¡æ¯åœ¨ <code>Logger</code> ä¸­ç¡®å®šè¾“å‡ºçº§åˆ«åï¼Œä¸ä¼šå†ç»è¿‡ <code>Handler</code> çš„å†æ¬¡è¿‡æ»¤ï¼Œè¿™æ„å‘³ç€ <code>Logger</code> é…ç½®çš„è¾“å‡ºçº§åˆ«ç›´æ¥å†³å®šæœ€ç»ˆçš„æ—¥å¿—è¾“å‡ºçº§åˆ«</li></ol></li><li><code>Appenders</code><ol><li><code>Appenders</code>ï¼ˆè¾“å‡ºæ§åˆ¶å™¨ï¼‰ï¼Œè´Ÿè´£æŠŠæ—¥å¿—è¾“å‡ºåˆ°æŒ‡å®šä½ç½®</li><li><code>Appenders</code> åˆ†åˆ«æœ‰ï¼š<ol><li><code>ConsoleAppender</code><ol><li>å°†æ—¥å¿—è¾“å‡ºåˆ°æ§åˆ¶å°</li></ol></li><li><code>FileAppender</code><ol><li>å°†æ—¥å¿—å†™å…¥åˆ°å•ä¸€æ–‡ä»¶ä¸­</li></ol></li><li><code>RollingFileAppender</code><ol><li>å°†æ—¥å¿—å†™å…¥åˆ°æ–‡ä»¶ä¸­ï¼Œæ”¯æŒæŒ‰å¤§å°å’Œæ—¶é—´æ»šåŠ¨</li></ol></li><li><code>JDBCAppender</code><ol><li>å°†æ—¥å¿—å­˜å‚¨åˆ°å…³ç³»å‹æ•°æ®åº“ä¸­</li></ol></li></ol></li></ol></li><li><code>Layout</code><ol><li><code>Layout</code>ï¼ˆæ—¥å¿—æ ¼å¼åŒ–å™¨ï¼‰ï¼Œå†³å®šäº†æ—¥å¿—çš„æ ¼å¼åŒ–æ–¹å¼ï¼Œå³æ—¥å¿—è¾“å‡ºçš„å…·ä½“æ ¼å¼</li><li>å¸¸ç”¨çš„ <code>Layout</code> åŒ…æ‹¬ï¼š<ol><li><code>HTMLLayout</code><ol><li>è¾“å‡ºä¸º <code>HTML</code> è¡¨æ ¼çš„æ ¼å¼</li></ol></li><li><code>JSONLayout</code><ol><li>è¾“å‡ºä¸º <code>JSON</code> æ ¼å¼</li></ol></li><li><code>XMLLayout</code><ol><li>è¾“å‡ºä¸º <code>XML</code> æ ¼å¼</li></ol></li><li><code>SimpleLayout</code><ol><li>ç®€å•çš„æ—¥å¿—è¾“å‡ºæ ¼å¼</li></ol></li><li><code>PatternLayout</code>ï¼ˆé»˜è®¤ï¼‰<ol><li>æœ€å¼ºå¤§çš„æ ¼å¼åŒ–ç»„ä»¶ï¼Œå¯ä»¥æ ¹æ®è‡ªå®šä¹‰æ—¥å¿—è¾“å‡ºæ ¼å¼</li></ol></li></ol></li></ol></li></ol><hr><h2 id="3-Log4J2-æ”¯æŒçš„æ—¥å¿—çº§åˆ«"><a href="#3-Log4J2-æ”¯æŒçš„æ—¥å¿—çº§åˆ«" class="headerlink" title="3. Log4J2 æ”¯æŒçš„æ—¥å¿—çº§åˆ«"></a>3. Log4J2 æ”¯æŒçš„æ—¥å¿—çº§åˆ«</h2><p><code>Log4J2</code> æ”¯æŒçš„çº§åˆ«é¡ºåºä¸ºï¼š</p><ol><li><code>OFF</code><ol><li>ç¦æ­¢æ•è·æ‰€æœ‰çº§åˆ«çš„æ—¥å¿—ä¿¡æ¯</li></ol></li><li><code>FATAL</code><ol><li>è¾“å‡ºä¸¥é‡é”™è¯¯ä¿¡æ¯ï¼Œåº”ç”¨å¯èƒ½æ— æ³•ç»§ç»­è¿è¡Œ</li></ol></li><li><code>ERROR</code><ol><li>è¾“å‡ºé”™è¯¯ä¿¡æ¯ï¼Œè¡¨ç¤ºä¸¥é‡é”™è¯¯æˆ–å¼‚å¸¸æƒ…å†µï¼Œä½†åº”ç”¨ä»ç„¶å¯ä»¥ç»§ç»­è¿è¡Œ</li></ol></li><li><code>WARN</code><ol><li>è¾“å‡ºè­¦å‘Šä¿¡æ¯ï¼Œæç¤ºæ½œåœ¨çš„é—®é¢˜</li></ol></li><li><code>INFO</code><ol><li>è¾“å‡ºå¸¸è§„è¿è¡Œä¿¡æ¯ï¼Œæä¾›ç³»ç»Ÿè¿è¡ŒçŠ¶æ€</li></ol></li><li><code>DEBUG</code><ol><li>è¾“å‡ºè°ƒè¯•ä¿¡æ¯ï¼Œæ¯”å¦‚è¯¦ç»†çš„é…ç½®è§£æè¿‡ç¨‹</li></ol></li><li><code>TRACE</code><ol><li>è¾“å‡ºæœ€è¯¦ç»†çš„ä¿¡æ¯ï¼Œå‡ ä¹æ˜¯é€è¡Œè§£é‡Šå‘ç”Ÿäº†ä»€ä¹ˆ</li></ol></li><li><code>ALL</code><ol><li>æ•è·æ‰€æœ‰çº§åˆ«çš„æ—¥å¿—ä¿¡æ¯</li></ol></li></ol><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ— éœ€æ‹…å¿ƒ <code>SLF4J</code> æ—¥å¿—é—¨é¢æ¡†æ¶åªæœ‰äº”ä¸ªæ ‡å‡†çº§åˆ«çš„é™åˆ¶ï¼Œè¿™æ˜¯å› ä¸ºé€‚é…å™¨åœ¨ <code>SLF4J</code> å’Œ <code>Log4j2</code> ä¹‹é—´å»ºç«‹äº†ä¸€å¥—å®Œæ•´çš„æ˜ å°„å…³ç³»ï¼š<br><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%97%A5%E5%BF%97%E6%A1%86%E6%9E%B6/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%97%A5%E5%BF%97%E6%A1%86%E6%9E%B6-2.png"></p><hr><h2 id="4-SLF4J-Log4J2-ä½¿ç”¨æ–¹å¼"><a href="#4-SLF4J-Log4J2-ä½¿ç”¨æ–¹å¼" class="headerlink" title="4. SLF4J + Log4J2 ä½¿ç”¨æ–¹å¼"></a>4. SLF4J + Log4J2 ä½¿ç”¨æ–¹å¼</h2><h3 id="4-1-æ·»åŠ ç›¸å…³ä¾èµ–"><a href="#4-1-æ·»åŠ ç›¸å…³ä¾èµ–" class="headerlink" title="4.1. æ·»åŠ ç›¸å…³ä¾èµ–"></a>4.1. æ·»åŠ ç›¸å…³ä¾èµ–</h3><ol><li>åˆ›å»ºæ—¶<ol><li><code>Web</code><ol><li><code>Spring Web</code></li></ol></li></ol></li><li>åˆ›å»ºå<ol><li><code>slf4j-api </code><ol><li><code>Maven</code><ol><li><a href="https://mvnrepository.com/artifact/org.slf4j/slf4j-api">https://mvnrepository.com/artifact/org.slf4j/slf4j-api</a></li></ol></li><li><code>Gradle</code><ol><li></li></ol></li></ol></li><li><code>log4j-api</code><ol><li><code>Maven</code><ol><li><a href="https://mvnrepository.com/artifact/org.apache.logging.log4j/log4j-api">https://mvnrepository.com/artifact/org.apache.logging.log4j/log4j-api</a></li></ol></li><li><code>Gradle</code><ol><li></li></ol></li></ol></li><li><code>log4j-core</code><ol><li><code>Maven</code><ol><li><a href="https://mvnrepository.com/artifact/org.apache.logging.log4j/log4j-core">https://mvnrepository.com/artifact/org.apache.logging.log4j/log4j-core</a></li></ol></li><li><code>Gradle</code></li></ol></li><li><code>disruptor</code><ol><li><code>Maven</code><ol><li><a href="https://mvnrepository.com/artifact/com.lmax/disruptor">https://mvnrepository.com/artifact/com.lmax/disruptor</a></li></ol></li><li><code>Gradle</code><ol><li></li></ol></li></ol></li><li><code>log4j-slf4j2-impl</code><ol><li><code>Maven</code><ol><li><a href="https://mvnrepository.com/artifact/org.apache.logging.log4j/log4j-slf4j2-impl">https://mvnrepository.com/artifact/org.apache.logging.log4j/log4j-slf4j2-impl</a></li></ol></li><li><code>Gradle</code><ol><li></li></ol></li></ol></li></ol></li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.slf4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>slf4j-api<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.1.0-alpha1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.logging.log4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>log4j-api<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.24.3<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.logging.log4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>log4j-core<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.24.3<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.lmax<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>disruptor<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.4.4<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.logging.log4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>log4j-slf4j2-impl<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.24.3<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li><code>log4j-api</code> æ˜¯ <code>Log4j</code> çš„æ—¥å¿—é—¨é¢ï¼Œä¸ºä»€ä¹ˆåœ¨å·²æœ‰ <code>SLF4J</code> é—¨é¢çš„æƒ…å†µä¸‹ä»éœ€è¦å¼•å…¥ï¼Ÿ<ol><li>è™½ç„¶ <code>SLF4J</code> æ˜¯ä¸€ä¸ªé€šç”¨æ—¥å¿—é—¨é¢ï¼Œä½†åœ¨ä½¿ç”¨ <code>Log4j2</code> ä½œä¸ºæ—¥å¿—å®ç°æ—¶ï¼Œ<code>SLF4J</code> å®é™…ä¸Šä¼šè®¿é—®è°ƒç”¨ <code>log4j-api</code>ï¼Œå†ç”±å®ƒå¯¹æ¥ <code>Log4j2</code> çš„å…·ä½“å®ç°</li></ol></li><li>ä¸ºä»€ä¹ˆå¼•å…¥çš„æ˜¯ <code>Log4j2</code> ä¾èµ–ï¼Œçœ‹èµ·æ¥å´åƒæ˜¯åœ¨å¼•å…¥ <code>Log4j</code> ä¾èµ–ï¼Ÿ<ol><li>å¦‚æœä¾èµ–çš„ç‰ˆæœ¬å·æ˜¯ <code>2.x.x</code>ï¼Œè¯´æ˜å¼•å…¥çš„ç¡®å®æ˜¯ <code>Log4j2</code></li></ol></li></ol></blockquote><hr><h3 id="4-2-è¿›è¡Œ-Log4J2-ç›¸å…³é…ç½®"><a href="#4-2-è¿›è¡Œ-Log4J2-ç›¸å…³é…ç½®" class="headerlink" title="4.2. è¿›è¡Œ Log4J2 ç›¸å…³é…ç½®"></a>4.2. è¿›è¡Œ Log4J2 ç›¸å…³é…ç½®</h3><h4 id="4-2-1-Xml-é…ç½®"><a href="#4-2-1-Xml-é…ç½®" class="headerlink" title="4.2.1. Xml é…ç½®"></a>4.2.1. Xml é…ç½®</h4><h5 id="4-2-1-1-resources-log4j2-xml"><a href="#4-2-1-1-resources-log4j2-xml" class="headerlink" title="4.2.1.1. resources&#x2F;log4j2.xml"></a>4.2.1.1. resources&#x2F;log4j2.xml</h5><h6 id="4-2-1-1-1-é…ç½®æ¦‚è¿°"><a href="#4-2-1-1-1-é…ç½®æ¦‚è¿°" class="headerlink" title="4.2.1.1.1. é…ç½®æ¦‚è¿°"></a>4.2.1.1.1. é…ç½®æ¦‚è¿°</h6><p>è¯¥é…ç½®ç”¨äºé…ç½® <code>Loggers</code>ã€<code>Appenders</code>ã€<code>Layout</code></p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>æ–‡ä»¶åå¿…é¡»å›ºå®šï¼Œå¹¶ä¸” <code>Log4J2</code> é»˜è®¤ä¼šæŒ‰ç…§ä¸€å®šé¡ºåºåœ¨ç±»è·¯å¾„ä¸‹æŸ¥æ‰¾é…ç½®æ–‡ä»¶ï¼š<ol><li><code>log4j2.xml</code></li><li><code>log4j2.json</code>ï¼ˆ<code>log4j2.jsn</code>ï¼‰</li><li><code>log4j2.yaml</code>ï¼ˆ<code>log4j2.yml</code>ï¼‰</li><li><code>log4j2.properties</code></li></ol></li></ol></blockquote><hr><h6 id="4-2-1-1-2-Tiny-é…ç½®"><a href="#4-2-1-1-2-Tiny-é…ç½®" class="headerlink" title="4.2.1.1.2. Tiny é…ç½®"></a>4.2.1.1.2. Tiny é…ç½®</h6><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span>?&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">Configuration</span> <span class="hljs-attr">status</span>=<span class="hljs-string">&quot;WARN&quot;</span> <span class="hljs-attr">monitorInterval</span>=<span class="hljs-string">&quot;30&quot;</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- å®šä¹‰å…¨å±€å±æ€§ --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">Properties</span>&gt;</span><br>    <br>        <span class="hljs-comment">&lt;!-- è‡ªå®šä¹‰æ—¥å¿—è¾“å‡ºæ ¼å¼ï¼ˆLayoutï¼‰ --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">Property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;LOG_PATTERN&quot;</span>&gt;</span>%d&#123;yyyy-MM-dd HH:mm:ss&#125; [%t] %-5level %logger&#123;36&#125; - %msg%n<span class="hljs-tag">&lt;/<span class="hljs-name">Property</span>&gt;</span><br><br>        <span class="hljs-comment">&lt;!-- è‡ªå®šä¹‰æ—¥å¿—æ–‡ä»¶çš„ä¿å­˜è·¯å¾„ --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">Property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;LOG_PATH&quot;</span>&gt;</span>D:\\EnglishDeployment\\logs<span class="hljs-tag">&lt;/<span class="hljs-name">Property</span>&gt;</span>   <span class="hljs-comment">&lt;!-- è‡ªå®šä¹‰æ–‡ä»¶çš„ä¿å­˜è·¯å¾„ --&gt;</span><br>        <br>    <span class="hljs-tag">&lt;/<span class="hljs-name">Properties</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- é…ç½® Appendersï¼ˆæ—¥å¿—è¾“å‡ºå™¨ï¼‰ --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">Appenders</span>&gt;</span><br>        <br>    <span class="hljs-tag">&lt;/<span class="hljs-name">Appenders</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- é…ç½® Loggersï¼ˆæ—¥å¿—è®°å½•å™¨ï¼‰ --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">Loggers</span>&gt;</span><br>        <br>    <span class="hljs-tag">&lt;/<span class="hljs-name">Loggers</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">Configuration</span>&gt;</span><br></code></pre></td></tr></table></figure><hr><h6 id="4-2-1-1-3-é…ç½®-Appenders"><a href="#4-2-1-1-3-é…ç½®-Appenders" class="headerlink" title="4.2.1.1.3. é…ç½® Appenders"></a>4.2.1.1.3. é…ç½® Appenders</h6><p><font color="#92d050">1. é…ç½® ConsoleAppender</font></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">Console</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;ConsoleAppender&quot;</span> <span class="hljs-attr">target</span>=<span class="hljs-string">&quot;SYSTEM_OUT&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">PatternLayout</span> <span class="hljs-attr">pattern</span>=<span class="hljs-string">&quot;$&#123;LOG_PATTERN&#125;&quot;</span>/&gt;</span>  <br><span class="hljs-tag">&lt;/<span class="hljs-name">Console</span>&gt;</span><br></code></pre></td></tr></table></figure><ol><li><code>target</code><ol><li>è¾“å‡ºçš„ä½ç½®</li><li>å¯é€‰å‚æ•°åŒ…æ‹¬ï¼š<ol><li><code>SYSTEM_OUT</code><ol><li>è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºæµï¼ˆ<code>System.out</code>ï¼‰</li></ol></li><li><code>SYSTEM_ERR</code><ol><li>è¾“å‡ºåˆ°æ ‡å‡†é”™è¯¯æµï¼ˆ<code>System.err</code>ï¼‰</li></ol></li></ol></li></ol></li></ol><p><font color="#92d050">2. é…ç½® FileAppender</font></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">File</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;FileAppender&quot;</span> <span class="hljs-attr">fileName</span>=<span class="hljs-string">&quot;$&#123;LOG_PATH&#125;/app.log&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">PatternLayout</span> <span class="hljs-attr">pattern</span>=<span class="hljs-string">&quot;$&#123;LOG_PATTERN&#125;&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">File</span>&gt;</span><br></code></pre></td></tr></table></figure><p><font color="#92d050">3. é…ç½® RollingFileAppender</font></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">RollingFile</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;RollingFileAppender&quot;</span> <span class="hljs-attr">fileName</span>=<span class="hljs-string">&quot;$&#123;LOG_PATH&#125;/rolling.log&quot;</span> <span class="hljs-attr">filePattern</span>=<span class="hljs-string">&quot;$&#123;LOG_PATH&#125;/rolling-%d&#123;yyyy-MM-dd&#125;-%i.log&quot;</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">PatternLayout</span> <span class="hljs-attr">pattern</span>=<span class="hljs-string">&quot;$&#123;LOG_PATTERN&#125;&quot;</span>/&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">Policies</span>&gt;</span><br><br><span class="hljs-comment">&lt;!-- æ–‡ä»¶è¾¾åˆ° 10MB æ—¶æ»šåŠ¨ä¸€æ¬¡ --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">SizeBasedTriggeringPolicy</span> <span class="hljs-attr">size</span>=<span class="hljs-string">&quot;10MB&quot;</span>/&gt;</span><br><br><span class="hljs-comment">&lt;!-- æ¯å¤©æ»šåŠ¨ä¸€æ¬¡ --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">TimeBasedTriggeringPolicy</span>/&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">Policies</span>&gt;</span><br><br><span class="hljs-comment">&lt;!-- æœ€å¤šä¿ç•™ 7 ä¸ªå†å²æ–‡ä»¶ --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">DefaultRolloverStrategy</span> <span class="hljs-attr">max</span>=<span class="hljs-string">&quot;7&quot;</span>/&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">RollingFile</span>&gt;</span><br></code></pre></td></tr></table></figure><p><font color="#92d050">4. JDBCAppender</font></p><hr><h6 id="4-2-1-1-4-é…ç½®-Loggers"><a href="#4-2-1-1-4-é…ç½®-Loggers" class="headerlink" title="4.2.1.1.4. é…ç½® Loggers"></a>4.2.1.1.4. é…ç½® Loggers</h6><p><font color="#92d050">1. æ ¹ Logger é…ç½®</font></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">Root</span> <span class="hljs-attr">level</span>=<span class="hljs-string">&quot;INFO&quot;</span>&gt;</span><br><br><span class="hljs-comment">&lt;!-- ä½¿ç”¨ ConsoleAppenderï¼ˆè¿™é‡Œ ref å¼•ç”¨çš„ï¼Œæ˜¯æˆ‘ä»¬ä¸Šé¢é…ç½® Appenders æ—¶çš„ nameï¼‰ --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">AppenderRef</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;ConsoleAppender&quot;</span>/&gt;</span>  <br><br><span class="hljs-comment">&lt;!-- ä½¿ç”¨ RollingFileAppender --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">AppenderRef</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;RollingFileAppender&quot;</span>/&gt;</span>  <br><br><span class="hljs-tag">&lt;/<span class="hljs-name">Root</span>&gt;</span><br></code></pre></td></tr></table></figure><p><font color="#92d050">2. åŒ… Logger é…ç½®</font></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">Logger</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;com.example.service&quot;</span> <span class="hljs-attr">level</span>=<span class="hljs-string">&quot;DEBUG&quot;</span> <span class="hljs-attr">additivity</span>=<span class="hljs-string">&quot;false&quot;</span>&gt;</span><br><span class="hljs-comment">&lt;!-- ä½¿ç”¨ FileAppender --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">AppenderRef</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;FileAppender&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">Logger</span>&gt;</span><br></code></pre></td></tr></table></figure><ol><li><code>additivity</code><ol><li>æ—¥å¿—æ˜¯å¦å‘ä¸Šä¼ é€’</li></ol></li></ol><p><font color="#92d050">3. æ··åˆå¼‚æ­¥æ—¥å¿—é…ç½®</font><br>æ··åˆå¼‚æ­¥æ—¥å¿—æ˜¯æŒ‡ï¼šåœ¨ä¿æŒæ ¹æ—¥å¿—ç®¡é“ä¸ºåŒæ­¥æ¨¡å¼çš„å‰æä¸‹ï¼Œä¸ºç‰¹å®šåŒ…çš„æ—¥å¿—ç®¡é“å•ç‹¬é…ç½®ä¸ºå¼‚æ­¥æ¨¡å¼ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">AsyncLogger</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;com.example.async&quot;</span> <span class="hljs-attr">level</span>=<span class="hljs-string">&quot;INFO&quot;</span> <span class="hljs-attr">additivity</span>=<span class="hljs-string">&quot;false&quot;</span> <span class="hljs-attr">includeLocation</span>=<span class="hljs-string">&quot;false&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">AppenderRef</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;ConsoleAppender&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">AsyncLogger</span>&gt;</span><br></code></pre></td></tr></table></figure><ol><li><code>includeLocation</code><ol><li>æ—¥å¿—ä¸­æ˜¯å¦åŒ…å«è¡Œå·ä¿¡æ¯</li><li>ç”±äºè·å–è¡Œå·ä¿¡æ¯ä¼šå½±å“æ—¥å¿—è®°å½•æ€§èƒ½ï¼Œå»ºè®®å°†å…¶è®¾ç½®ä¸º <code>false</code> ä»¥æå‡æ•ˆç‡</li></ol></li></ol><hr><h5 id="4-2-1-2-resources-log4j2-component-properties"><a href="#4-2-1-2-resources-log4j2-component-properties" class="headerlink" title="4.2.1.2. resources&#x2F;log4j2.component.properties"></a>4.2.1.2. resources&#x2F;log4j2.component.properties</h5><h6 id="4-2-1-2-1-é…ç½®æ¦‚è¿°"><a href="#4-2-1-2-1-é…ç½®æ¦‚è¿°" class="headerlink" title="4.2.1.2.1. é…ç½®æ¦‚è¿°"></a>4.2.1.2.1. é…ç½®æ¦‚è¿°</h6><p>å…¨å±€å¼‚æ­¥æ—¥å¿—æ˜¯æŒ‡ï¼šæ‰€æœ‰æ—¥å¿—è®°å½•çš„æ“ä½œç»Ÿä¸€è®¾ç½®ä¸ºå¼‚æ­¥æ¨¡å¼</p><p>è€Œè¯¥é…ç½®ç”¨äºé…ç½®å¼‚æ­¥æ¨¡å¼</p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>æ–‡ä»¶åå¿…é¡»å›ºå®š</li></ol></blockquote><hr><h6 id="4-2-1-2-2-å…·ä½“é…ç½®"><a href="#4-2-1-2-2-å…·ä½“é…ç½®" class="headerlink" title="4.2.1.2.2. å…·ä½“é…ç½®"></a>4.2.1.2.2. å…·ä½“é…ç½®</h6><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">Log4jContextSelector</span>=<span class="hljs-string">org.apache.logging.log4j.core.async.AsyncLoggerContextSelector</span><br></code></pre></td></tr></table></figure><hr><h3 id="4-3-ä½¿ç”¨-Log4J2-è®°å½•æ—¥å¿—"><a href="#4-3-ä½¿ç”¨-Log4J2-è®°å½•æ—¥å¿—" class="headerlink" title="4.3. ä½¿ç”¨ Log4J2 è®°å½•æ—¥å¿—"></a>4.3. ä½¿ç”¨ Log4J2 è®°å½•æ—¥å¿—</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> &#123;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;  <br>        <span class="hljs-type">Logger</span> <span class="hljs-variable">logger</span> <span class="hljs-operator">=</span> LoggerFactory.getLogger(<span class="hljs-string">&quot;com.example.Main&quot;</span>);<br>        logger.trace(<span class="hljs-string">&quot;trace ä¿¡æ¯&quot;</span>);  <br>        logger.debug(<span class="hljs-string">&quot;debug ä¿¡æ¯&quot;</span>);  <br>        logger.info(<span class="hljs-string">&quot;info ä¿¡æ¯&quot;</span>);  <br>        logger.warn(<span class="hljs-string">&quot;warn ä¿¡æ¯&quot;</span>);  <br>        logger.error(<span class="hljs-string">&quot;error ä¿¡æ¯&quot;</span>);  <br>    &#125;  <br>    <br>&#125;<br></code></pre></td></tr></table></figure><hr><h1 id="ä¸ƒã€Spring-Boot-Starter-Log4J2"><a href="#ä¸ƒã€Spring-Boot-Starter-Log4J2" class="headerlink" title="ä¸ƒã€Spring Boot Starter Log4J2"></a>ä¸ƒã€Spring Boot Starter Log4J2</h1><h2 id="1-å¿«é€Ÿä¸Šæ‰‹"><a href="#1-å¿«é€Ÿä¸Šæ‰‹" class="headerlink" title="1. å¿«é€Ÿä¸Šæ‰‹"></a>1. å¿«é€Ÿä¸Šæ‰‹</h2><h3 id="1-1-æ·»åŠ ç›¸å…³ä¾èµ–"><a href="#1-1-æ·»åŠ ç›¸å…³ä¾èµ–" class="headerlink" title="1.1. æ·»åŠ ç›¸å…³ä¾èµ–"></a>1.1. æ·»åŠ ç›¸å…³ä¾èµ–</h3><ol><li>åˆ›å»ºæ—¶<ol><li><code>Web</code><ol><li><code>Spring Web</code></li></ol></li></ol></li><li>åˆ›å»ºå<ol><li><code>spring-boot-starter-log4j2</code><ol><li><code>Maven</code><ol><li><a href="https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-log4j2">https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-log4j2</a></li></ol></li><li><code>Gradle</code><ol><li></li></ol></li></ol></li><li><code>lombok</code><ol><li><code>Maven</code><ol><li><a href="https://mvnrepository.com/artifact/org.projectlombok/lombok">https://mvnrepository.com/artifact/org.projectlombok/lombok</a></li></ol></li><li><code>Gradle</code><ol><li></li></ol></li></ol></li></ol></li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">exclusions</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">exclusion</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-logging<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">exclusion</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">exclusions</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-log4j2<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.projectlombok<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>lombok<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">optional</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">optional</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>åœ¨æ·»åŠ  <code>spring-boot-starter-web</code> ä¾èµ–æ—¶ï¼Œéœ€è¦æ’é™¤ <code>spring-boot-starter-logging</code>ã€‚å› ä¸º <code>Spring Web</code> é»˜è®¤ä½¿ç”¨ <code>SLF4J + Logback</code></li><li><code>lombok</code> æä¾›äº† <code>@Slf4j</code>ï¼Œæˆ‘ä»¬ä¸€èˆ¬è¦æ·»åŠ è¯¥ä¾èµ–</li></ol></blockquote><hr><h3 id="1-2-è¿›è¡Œ-Log4J2-ç›¸å…³é…ç½®"><a href="#1-2-è¿›è¡Œ-Log4J2-ç›¸å…³é…ç½®" class="headerlink" title="1.2. è¿›è¡Œ Log4J2 ç›¸å…³é…ç½®"></a>1.2. è¿›è¡Œ Log4J2 ç›¸å…³é…ç½®</h3><hr><h3 id="1-3-ä½¿ç”¨-SLF4J-è®°å½•æ—¥å¿—"><a href="#1-3-ä½¿ç”¨-SLF4J-è®°å½•æ—¥å¿—" class="headerlink" title="1.3. ä½¿ç”¨ SLF4J è®°å½•æ—¥å¿—"></a>1.3. ä½¿ç”¨ SLF4J è®°å½•æ—¥å¿—</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Slf4j</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> &#123;  <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-type">Logger</span> <span class="hljs-variable">logger</span> <span class="hljs-operator">=</span> LoggerFactory.getLogger(<span class="hljs-string">&quot;com.example.Main&quot;</span>);<br>        logger.trace(<span class="hljs-string">&quot;trace ä¿¡æ¯&quot;</span>);  <br>        logger.debug(<span class="hljs-string">&quot;debug ä¿¡æ¯&quot;</span>);  <br>        logger.info(<span class="hljs-string">&quot;info ä¿¡æ¯&quot;</span>);  <br>        logger.warn(<span class="hljs-string">&quot;warn ä¿¡æ¯&quot;</span>);  <br>        logger.error(<span class="hljs-string">&quot;error ä¿¡æ¯&quot;</span>);  <br>    &#125;  <br>    <br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>ä»¥ä¸Šè¿°ä»£ç ä¸ºä¾‹ï¼Œ<code>@Slf4j</code> ä¼šåœ¨ç¼–è¯‘é˜¶æ®µè‡ªåŠ¨æ·»åŠ  <code>private static final Logger log = LoggerFactory.getLogger(MyService.class)</code></li></ol></blockquote><hr>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
      <category>Java æ—¥å¿—æ¡†æ¶</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>ç¬”è®°ï¼šHexo + Obsidian + GitHub Pages</title>
    <link href="/2025/11/23/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages/"/>
    <url>/2025/11/23/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><hr><h2 id="3-ç¯å¢ƒå‡†å¤‡"><a href="#3-ç¯å¢ƒå‡†å¤‡" class="headerlink" title="3. ç¯å¢ƒå‡†å¤‡"></a>3. ç¯å¢ƒå‡†å¤‡</h2><ol><li><code>Git</code></li><li><code>Node.js</code></li><li><code>PowerShell</code></li></ol><hr><h2 id="4-åˆ›å»º-Hexo-é¡¹ç›®"><a href="#4-åˆ›å»º-Hexo-é¡¹ç›®" class="headerlink" title="4. åˆ›å»º Hexo é¡¹ç›®"></a>4. åˆ›å»º Hexo é¡¹ç›®</h2><h3 id="4-1-åˆå§‹åŒ–-Hexo-é¡¹ç›®"><a href="#4-1-åˆå§‹åŒ–-Hexo-é¡¹ç›®" class="headerlink" title="4.1. åˆå§‹åŒ– Hexo é¡¹ç›®"></a>4.1. åˆå§‹åŒ– Hexo é¡¹ç›®</h3><p><font color="#92d050">1. åˆ›å»ºæ–‡ä»¶å¤¹</font><br>è¿™é‡Œæˆ‘å‘½åä¸º <code>myNote</code>ï¼ˆåç§°å¯è‡ªå®šä¹‰ï¼‰<br><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages.png"></p><p><font color="#92d050">2. ä½¿ç”¨ PowerShell æ‰“å¼€æ–‡ä»¶å¤¹</font><br><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages-1.png"></p><p><font color="#92d050">3. å…¨å±€å®‰è£… hexo</font></p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs avrasm">npm install -g hexo-<span class="hljs-keyword">cli</span><br></code></pre></td></tr></table></figure><p><font color="#92d050">4. åˆå§‹åŒ– Hexo é¡¹ç›®</font></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs csharp">hexo <span class="hljs-keyword">init</span><br></code></pre></td></tr></table></figure><p><font color="#92d050">5. å®‰è£…ç›¸å…³ä¾èµ–</font></p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmake">npm <span class="hljs-keyword">install</span><br></code></pre></td></tr></table></figure><hr><h3 id="4-2-é…ç½®-Hexo-å…ƒæ•°æ®"><a href="#4-2-é…ç½®-Hexo-å…ƒæ•°æ®" class="headerlink" title="4.2. é…ç½® Hexo å…ƒæ•°æ®"></a>4.2. é…ç½® Hexo å…ƒæ•°æ®</h3><p><font color="#92d050">1. ä½¿ç”¨ VS Code æ‰“å¼€ myNote æ–‡ä»¶å¤¹</font><br><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages-2.png"></p><p><font color="#92d050">2. é…ç½® Hexo å…ƒæ•°æ®</font><br>åœ¨ç³»ç»Ÿ <code>myNote/_config.yml</code> æ–‡ä»¶ä¸­é…ç½®å…ƒæ•°æ®ï¼š<br><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages-3.png"></p><hr><h3 id="4-3-å¯åŠ¨-Hexoï¼ŒæŸ¥çœ‹æ•ˆæœ"><a href="#4-3-å¯åŠ¨-Hexoï¼ŒæŸ¥çœ‹æ•ˆæœ" class="headerlink" title="4.3. å¯åŠ¨ Hexoï¼ŒæŸ¥çœ‹æ•ˆæœ"></a>4.3. å¯åŠ¨ Hexoï¼ŒæŸ¥çœ‹æ•ˆæœ</h3><p><font color="#92d050">1. ä½¿ç”¨ PowerShell æ‰“å¼€æ–‡ä»¶å¤¹</font><br><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages-4.png"></p><p><font color="#92d050">2. ä¾æ¬¡æ‰§è¡Œå‘½ä»¤</font></p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-comment"># 1. æ¸…é™¤ç°å­˜çš„ Hexo çš„é™æ€æ–‡ä»¶</span><br><span class="hljs-attribute">hexo</span> clean<br><br><br><span class="hljs-comment"># 2. ç”Ÿæˆæ–°çš„ Hexo é™æ€æ–‡ä»¶</span><br>hexo g<br><br><br><span class="hljs-comment"># 3. å¯åŠ¨æœ¬åœ°æœåŠ¡å™¨ï¼Œé¢„è§ˆç”Ÿæˆçš„ç½‘é¡µæ•ˆæœï¼Œä¾¿äºæœ¬åœ°è°ƒè¯•</span><br>hexo s<br></code></pre></td></tr></table></figure><p><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages-5.png"></p><p><font color="#92d050">3. æŸ¥çœ‹ Hexo æ•ˆæœ</font><br>æŸ¥çœ‹ï¼š <a href="http://localhost:4000/">http://localhost:4000/</a></p><hr><h3 id="4-4-é…ç½®-Hexo-ä¸»é¢˜"><a href="#4-4-é…ç½®-Hexo-ä¸»é¢˜" class="headerlink" title="4.4. é…ç½® Hexo ä¸»é¢˜"></a>4.4. é…ç½® Hexo ä¸»é¢˜</h3><p>ä¸Šé¢å±•ç¤ºçš„ Hexo é»˜è®¤æ ·å¼è¾ƒä¸ºç®€é™‹ï¼Œè§†è§‰æ•ˆæœä¸ä½³ã€‚ä½ å¯ä»¥åœ¨ <a href="https://hexo.io/themes/">Hexoä¸»é¢˜åº“</a> ä¸­æŒ‘é€‰ä¸€ä¸ªè‡ªå·±å–œæ¬¢çš„ä¸»é¢˜ï¼Œè¿™é‡Œæˆ‘é€‰æ‹© <a href="https://github.com/fluid-dev/hexo-theme-fluid">Fluid</a> ä½œä¸ºæˆ‘çš„ä¸»é¢˜ã€‚</p><p><font color="#92d050">1. ä¸‹è½½ fluid å®‰è£…åŒ…</font><br><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages-6.png"></p><p><font color="#92d050">2. è§£å‹ç¼©åˆ° myNote&#x2F;theme ç›®å½•ä¸‹ï¼Œå¹¶å°†å…¶é‡å‘½åä¸º fluid</font><br><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages-7.png"></p><p><font color="#92d050">3. é…ç½®ä½¿ç”¨ fluid ä¸»é¢˜</font><br><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages-8.png"></p><p><font color="#92d050">4. ä½¿ç”¨ PowerShell æ‰“å¼€æ–‡ä»¶å¤¹</font><br><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages-9.png"></p><p><font color="#92d050">5. æ·»åŠ  about é¡µé¢</font></p><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs actionscript">hexo <span class="hljs-keyword">new</span> page about<br></code></pre></td></tr></table></figure><p><font color="#92d050">6. è®¾ç½® about&#x2F;index.md çš„å¤´éƒ¨å±æ€§</font><br><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages-10.png"></p><p><font color="#92d050">7. è¿›è¡Œ Hexo ä¸»é¢˜é…ç½®</font><br>æ ¹æ®éœ€è¦åœ¨ä¸»é¢˜çš„ <code>myNote/themes/fluid/config.yml</code> æ–‡ä»¶ä¸­è¿›è¡Œç›¸åº”çš„é…ç½®ï¼Œå…·ä½“æ€ä¹ˆé…ï¼Œçœ‹ä½ è‡ªå·±å–œæ¬¢å°±è¡Œã€‚</p><p><font color="#92d050">8. å¯åŠ¨ Hexoï¼ŒæŸ¥çœ‹æ•ˆæœ</font></p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-comment"># 1. æ¸…é™¤ç°å­˜çš„ Hexo çš„é™æ€æ–‡ä»¶</span><br><span class="hljs-attribute">hexo</span> clean<br><br><br><span class="hljs-comment"># 2. ç”Ÿæˆæ–°çš„ Hexo é™æ€æ–‡ä»¶</span><br>hexo g<br><br><br><span class="hljs-comment"># 3. å¯åŠ¨æœ¬åœ°æœåŠ¡å™¨ï¼Œé¢„è§ˆç”Ÿæˆçš„ç½‘é¡µæ•ˆæœï¼Œä¾¿äºæœ¬åœ°è°ƒè¯•</span><br>hexo s<br></code></pre></td></tr></table></figure><hr><h2 id="5-é›†æˆ-GitHub-Pages"><a href="#5-é›†æˆ-GitHub-Pages" class="headerlink" title="5. é›†æˆ GitHub Pages"></a>5. é›†æˆ GitHub Pages</h2><h3 id="5-1-è¿›è¡Œ-Git-ä»£ç†é…ç½®"><a href="#5-1-è¿›è¡Œ-Git-ä»£ç†é…ç½®" class="headerlink" title="5.1. è¿›è¡Œ Git ä»£ç†é…ç½®"></a>5.1. è¿›è¡Œ Git ä»£ç†é…ç½®</h3><p>ç”±äºéœ€è¦å°†é™æ€é¡µé¢éƒ¨ç½²åˆ° <code>GitHub Pages</code>ï¼Œå¹¶å°†æ•´ä¸ª <code>Obsidian</code> ä»“åº“æ¨é€åˆ° <code>MyNote</code> ä»“åº“ï¼Œæˆ‘ä»¬å…ˆè®¾ç½® <code>Git</code> ä»£ç†ï¼Œä»¥æå‡ç½‘ç»œä¼ è¾“é€Ÿåº¦</p><p><font color="#92d050">1. æ£€æŸ¥æ˜¯å¦é…ç½®è¿‡ Git ä»£ç†</font></p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs lua">git <span class="hljs-built_in">config</span> <span class="hljs-comment">--global http.proxy</span><br><br><br>git <span class="hljs-built_in">config</span> <span class="hljs-comment">--global https.proxy</span><br></code></pre></td></tr></table></figure><p><font color="#92d050">2. å¦‚æœå­˜åœ¨ä»£ç†ï¼Œè¿›è¡Œä»£ç†å–æ¶ˆ</font></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs stylus">git config <span class="hljs-attr">--global</span> <span class="hljs-attr">--unset</span> http<span class="hljs-selector-class">.proxy</span><br><br><br>git config <span class="hljs-attr">--global</span> <span class="hljs-attr">--unset</span> https.proxy<br></code></pre></td></tr></table></figure><p><font color="#92d050">3. é‡æ–°é…ç½® Git ä»£ç†</font></p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs lua">git <span class="hljs-built_in">config</span> <span class="hljs-comment">--global https.proxy 127.0.0.1:7890</span><br><br><br>git <span class="hljs-built_in">config</span> <span class="hljs-comment">--global http.proxy 127.0.0.1:7890</span><br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>æ­¤å¤„çš„ç«¯å£å·éœ€æ ¹æ®ä½ æœ¬åœ° <code>Clash</code> çš„é…ç½®è¿›è¡Œè°ƒæ•´ï¼Œå¡«å†™ä½ å®é™…ä½¿ç”¨çš„ä»£ç†ç«¯å£ã€‚</li></ol></blockquote><p><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages-11.png"></p><hr><h3 id="5-2-åˆ›å»º-GitHub-Pages"><a href="#5-2-åˆ›å»º-GitHub-Pages" class="headerlink" title="5.2. åˆ›å»º GitHub Pages"></a>5.2. åˆ›å»º GitHub Pages</h3><p>é¦–å…ˆï¼Œç™»å½• <code>GitHub</code> å¹¶åˆ›å»ºä¸€ä¸ªåä¸º <code>&lt;your_id&gt;.github.io</code> çš„ä»“åº“ï¼Œå¹¶ç¡®ä¿å°†å…¶è®¾ç½®ä¸º <code>Public</code>ï¼ˆå…¬å¼€ï¼‰<br><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages-12.png"></p><hr><h3 id="5-3-Hexo-é¡¹ç›®å…³è”åˆ°-GitHub-Pages"><a href="#5-3-Hexo-é¡¹ç›®å…³è”åˆ°-GitHub-Pages" class="headerlink" title="5.3. Hexo é¡¹ç›®å…³è”åˆ° GitHub Pages"></a>5.3. Hexo é¡¹ç›®å…³è”åˆ° GitHub Pages</h3><p><font color="#92d050">1. å®‰è£… deploy æ’ä»¶</font></p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada">npm install hexo-deployer-git <span class="hljs-comment">--save</span><br></code></pre></td></tr></table></figure><p><font color="#92d050">2. è¿›è¡Œ myNote&#x2F;config.yml é…ç½®</font></p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">deploy:</span><br><span class="hljs-symbol">Â  type:</span> git<br><span class="hljs-symbol">Â  repo:</span> https:<span class="hljs-comment">//github.com/wangjia5289/wangjia5289.github.io.git</span><br><span class="hljs-symbol">Â  branch:</span> main<br></code></pre></td></tr></table></figure><hr><h3 id="5-4-Hexo-é¡¹ç›®æ¨é€åˆ°-GitHub-Pages"><a href="#5-4-Hexo-é¡¹ç›®æ¨é€åˆ°-GitHub-Pages" class="headerlink" title="5.4. Hexo é¡¹ç›®æ¨é€åˆ° GitHub Pages"></a>5.4. Hexo é¡¹ç›®æ¨é€åˆ° GitHub Pages</h3><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-comment"># 1. æ¸…é™¤ç°å­˜çš„Hexoçš„é™æ€æ–‡ä»¶</span><br><span class="hljs-attribute">hexo</span> clean<br><br><br><span class="hljs-comment"># 2. ç”Ÿæˆæ–°çš„ Hexo é™æ€æ–‡ä»¶</span><br>hexo g<br><br><br><span class="hljs-comment"># 3. å¯åŠ¨æœ¬åœ°æœåŠ¡å™¨ï¼Œé¢„è§ˆç”Ÿæˆçš„ç½‘é¡µæ•ˆæœï¼Œä¾¿äºæœ¬åœ°è°ƒè¯•</span><br>hexo s<br><br><br><span class="hljs-comment"># 4. å°† Hexo é¡¹ç›®æ¨é€åˆ° GitHub Pages</span><br>hexo d<br></code></pre></td></tr></table></figure><hr><h3 id="5-5-æŸ¥çœ‹-GitHub-Pages-æ•ˆæœ"><a href="#5-5-æŸ¥çœ‹-GitHub-Pages-æ•ˆæœ" class="headerlink" title="5.5. æŸ¥çœ‹ GitHub Pages æ•ˆæœ"></a>5.5. æŸ¥çœ‹ GitHub Pages æ•ˆæœ</h3><p>æŸ¥çœ‹ï¼š <a href="https://github.com/wangjia5289/wangjia5289.github.io.git">https://github.com/wangjia5289/wangjia5289.github.io.git</a></p><hr><h2 id="6-é›†æˆ-GitHub-Repository"><a href="#6-é›†æˆ-GitHub-Repository" class="headerlink" title="6. é›†æˆ GitHub Repository"></a>6. é›†æˆ GitHub Repository</h2><p><font color="#92d050">1. åˆ›å»º GitHub Repository</font><br>æˆ‘ä»¬é¢å¤–åˆ›å»ºä¸€ä¸ªåä¸º <code>myNote</code>ï¼ˆåç§°å¯è‡ªå®šä¹‰ï¼‰çš„ä»“åº“ï¼Œå¹¶ç¡®ä¿å°†å…¶è®¾ç½®ä¸º <code>Private</code>ï¼ˆç§æœ‰ï¼‰ç”¨äºå¤‡ä»½æ‰€æœ‰æ–‡ä»¶ï¼Œä»¥é˜²æ•°æ®ä¸¢å¤±<br><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages-13.png"></p><p><font color="#92d050">2. ä¾æ¬¡è¿è¡Œå‘½ä»¤</font></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-meta"># 1. åˆå§‹åŒ–æœ¬åœ° Git ä»“åº“</span><br>git <span class="hljs-keyword">init</span><br><br><br><span class="hljs-meta"># 2. åˆ›å»º README æ–‡æ¡£</span><br>echo <span class="hljs-string">&quot;éšä¾¿å†™ç‚¹ä¸œè¥¿å¥½äº†&quot;</span> &gt; README.md<br><br><br><span class="hljs-meta"># 3. å°† README ç¨³å®šæ·»åŠ åˆ°ç¼“å†²å–</span><br>git <span class="hljs-keyword">add</span> README.md<br><br><br><span class="hljs-meta"># 4. è¿›è¡Œç¬¬ä¸€æ¬¡æ¨é€ï¼ˆåŠ¡å¿…è¿›è¡Œï¼Œç›¸å½“äºç‚¹ç«å™¨ï¼‰</span><br>git commit -m <span class="hljs-string">&quot;first commit&quot;</span><br><br><br><span class="hljs-meta"># 5. å°†å½“å‰åˆ†æ”¯å¼ºåˆ¶é‡å‘½åä¸º main</span><br>git branch -M main<br><br><br><span class="hljs-meta"># 6. æœ¬åœ°ä»“åº“ä¸è¿œç¨‹ä»“åº“è¿›è¡Œå…³è”ã€‚</span><br>git remote <span class="hljs-keyword">add</span> origin https:<span class="hljs-comment">//github.com/wangjia5289/xxxxxx.git</span><br><br><br><span class="hljs-meta"># 7. è¿›è¡Œåˆ†æ”¯å…³è”ï¼ˆä½¿ç”¨ -u é€‰é¡¹ï¼Œå°†æœ¬åœ° main åˆ†æ”¯ä¸è¿œç¨‹ main åˆ†æ”¯å…³è”ï¼Œä¹‹åå¯ä»¥ç›´æ¥ä½¿ç”¨ git push å’Œ git pullï¼Œè€Œæ— éœ€æ¯æ¬¡æŒ‡å®šè¿œç¨‹ä»“åº“å’Œåˆ†æ”¯ã€‚ï¼‰</span><br>git push -u origin main<br><br><br><span class="hljs-meta"># 8. åç»­æ¨é€</span><br>æˆ‘ä»¬å¯ä»¥é€šè¿‡å‘½ä»¤è¡Œæˆ–ä½¿ç”¨ GitHub Desktop ç­‰å·¥å…·æ¥æ¨é€ä»£ç ã€‚<br></code></pre></td></tr></table></figure><hr><h2 id="7-é›†æˆ-Obsidian"><a href="#7-é›†æˆ-Obsidian" class="headerlink" title="7. é›†æˆ Obsidian"></a>7. é›†æˆ Obsidian</h2><h3 id="7-1-åˆ›å»ºæ¨¡ç‰ˆ"><a href="#7-1-åˆ›å»ºæ¨¡ç‰ˆ" class="headerlink" title="7.1. åˆ›å»ºæ¨¡ç‰ˆ"></a>7.1. åˆ›å»ºæ¨¡ç‰ˆ</h3><p>åœ¨ <code>Hexo</code> ä¸­ï¼Œä¸ºç¡®ä¿æ¯ç¯‡æ–‡ç« éƒ½èƒ½ä»¥é¢„è®¾æ ¼å¼å’Œæ ·å¼å±•ç¤ºï¼Œé€šå¸¸éœ€è¦åœ¨æ–‡ç« å¤´éƒ¨è®¾ç½®ç‰¹å®šçš„å±æ€§ã€‚ç„¶è€Œï¼Œæ‰‹åŠ¨è®¾ç½®è¿™äº›å±æ€§å¯¹äºæ¯ä¸€æ¬¡æ’°å†™æ–°æ–‡ç« æ¥è¯´å¯èƒ½æ˜¾å¾—ç¹çã€‚ä¸ºç®€åŒ–è¿™ä¸€è¿‡ç¨‹ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªæ¨¡æ¿ã€‚è¿™æ ·ï¼Œæ¯æ¬¡æ’°å†™æ–°æ–‡ç« æ—¶ï¼Œåªéœ€å¯¼å…¥è¯¥æ¨¡æ¿ï¼Œå³å¯è‡ªåŠ¨åŒ…å«æ‰€éœ€çš„é»˜è®¤å±æ€§è®¾ç½®ã€‚</p><p><font color="#92d050">1. åˆ›å»ºæ¨¡ç‰ˆ</font><br><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages-14.png"></p><p><font color="#92d050">2. è®¾ç½®æ¨¡ç‰ˆ</font><br><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages-15.png"></p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹ï¼šHexo é¡µé¢åŠ é”</p></blockquote><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm"><span class="hljs-comment"># 1. å®‰è£… hexo-blog-encrypt</span><br>npm <span class="hljs-keyword">install </span>--save hexo-<span class="hljs-keyword">blog-encrypt</span><br><span class="hljs-keyword"></span><br><br><span class="hljs-comment">## 2. åœ¨æ–‡ç« å¤´éƒ¨æ·»åŠ  password</span><br><span class="hljs-symbol">password:</span> xxxxxx<br></code></pre></td></tr></table></figure><hr><h3 id="7-2-å¿½ç•¥æ²¡ç”¨æ–‡ä»¶"><a href="#7-2-å¿½ç•¥æ²¡ç”¨æ–‡ä»¶" class="headerlink" title="7.2. å¿½ç•¥æ²¡ç”¨æ–‡ä»¶"></a>7.2. å¿½ç•¥æ²¡ç”¨æ–‡ä»¶</h3><p><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages-27.png"></p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>å¦‚æœå®‰è£…äº† <code>Omnisearch</code> æ’ä»¶ï¼Œéœ€è¦å¼€å¯è¿™ä¸ªé€‰é¡¹ï¼š</li></ol></blockquote><p><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages-28.png"></p><hr><h3 id="7-3-Custom-Attachment-Location-æ’ä»¶"><a href="#7-3-Custom-Attachment-Location-æ’ä»¶" class="headerlink" title="7.3. Custom Attachment Location æ’ä»¶"></a>7.3. Custom Attachment Location æ’ä»¶</h3><p><font color="#92d050">1. ä¿®æ”¹ Obsidian é…ç½®</font><br><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages-16.png"></p><p><font color="#92d050">2. å®‰è£… Custom Attachment Location æ’ä»¶</font><br><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages-17.png"></p><p><font color="#92d050">3. è¿›è¡Œæ’ä»¶é…ç½®</font><br><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages-18.png"></p><p><font color="#92d050">4. è¿›è¡Œ myNote&#x2F;config.yml é…ç½®</font></p><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs nix"><span class="hljs-comment"># 1. å°† post_asset_foler è®¾ç½®ä¸º true</span><br><span class="hljs-params">post_asset_folder:</span> <span class="hljs-literal">true</span><br><br><br><span class="hljs-comment"># 2. æ·»åŠ ä¸‹è¿°å†…å®¹</span><br><span class="hljs-params">marked:</span> <br>Â  <span class="hljs-params">prependRoot:</span> <span class="hljs-literal">true</span><br>Â  <span class="hljs-params">postAsset:</span> <span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><hr><h3 id="7-4-File-Explorer-æ’ä»¶"><a href="#7-4-File-Explorer-æ’ä»¶" class="headerlink" title="7.4. File Explorer++ æ’ä»¶"></a>7.4. File Explorer++ æ’ä»¶</h3><p><font color="#92d050">1. å®‰è£… File Explorer++ æ’ä»¶</font><br><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages-19.png"></p><p><font color="#92d050">2. è¿›è¡Œæ’ä»¶é…ç½®</font><br><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages-20.png"></p><hr><h3 id="7-5-Git-æ’ä»¶"><a href="#7-5-Git-æ’ä»¶" class="headerlink" title="7.5. Git æ’ä»¶"></a>7.5. Git æ’ä»¶</h3><p><font color="#92d050">1. å®‰è£… Git æ’ä»¶</font><br><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages-21.png"></p><p><font color="#92d050">2. é…ç½®æ’ä»¶</font><br><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages-22.png"></p><p><font color="#92d050">3. æ‰‹åŠ¨å®ç°æ¨é€åˆ° Repository</font><br><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages-23.png"></p><hr><h2 id="8-Page-ä¸åŸŸåç»‘å®šï¼ˆå¯é€‰ï¼‰"><a href="#8-Page-ä¸åŸŸåç»‘å®šï¼ˆå¯é€‰ï¼‰" class="headerlink" title="8. Page ä¸åŸŸåç»‘å®šï¼ˆå¯é€‰ï¼‰"></a>8. Page ä¸åŸŸåç»‘å®šï¼ˆå¯é€‰ï¼‰</h2><p><font color="#92d050">1. ç™»å½• GitHubï¼Œåœ¨æ‚¨çš„ id.github.io é¡¹ç›®ä¸­ï¼Œé€šè¿‡ Settingsé€‰é¡¹è¿›è¡ŒåŸŸåé…ç½®</font><br><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages-24.png"></p><p><font color="#92d050">2. åœ¨ public æ–‡ä»¶å¤¹ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º CNAME çš„æ–‡ä»¶ï¼Œå¹¶åœ¨å…¶ä¸­ä¿å­˜æ‚¨å¸Œæœ›ç»‘å®šçš„åŸŸå</font><br><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages-25.png"></p><p><font color="#92d050">3. ä¸ºåŸŸåæ·»åŠ  CNAME è®°å½•å¹¶æŒ‡å‘ id.github.io</font><br><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages/%E7%AC%94%E8%AE%B0%EF%BC%9AHexo+Obsidian+GitHubPages-26.png"></p><hr>]]></content>
    
    
    <categories>
      
      <category>Blog</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>ç¬”è®°ï¼šJUC</title>
    <link href="/2025/11/23/%E7%AC%94%E8%AE%B0%EF%BC%9AJUC/"/>
    <url>/2025/11/23/%E7%AC%94%E8%AE%B0%EF%BC%9AJUC/</url>
    
    <content type="html"><![CDATA[<h1 id="ä¸€ã€TODO"><a href="#ä¸€ã€TODO" class="headerlink" title="ä¸€ã€TODO"></a>ä¸€ã€TODO</h1><hr><h1 id="äºŒã€è„‘å›¾"><a href="#äºŒã€è„‘å›¾" class="headerlink" title="äºŒã€è„‘å›¾"></a>äºŒã€è„‘å›¾</h1><ol><li><p>Xmind</p></li><li><p>Edraw<br><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJUC/%E7%AC%94%E8%AE%B0%EF%BC%9AJUC.eddx"></p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/11/23/%E7%AC%94%E8%AE%B0%EF%BC%9AJUC/">http://blog.wangjia.ink/2025/11/23/ç¬”è®°ï¼šJUC/</a></p></li><li><p>ä»£ç æ´ªè’ï¼ˆé¢è¯•å®å…¸ï¼‰<br>ğŸ‘‰ <a href="https://www.notion.so/JUC-2b2974fbda5e8012975ef0197d6e8237">https://www.notion.so/JUC-2b2974fbda5e8012975ef0197d6e8237</a></p></li></ol><hr><h1 id="ä¸‰ã€JUC-å‰ç½®åŸºç¡€"><a href="#ä¸‰ã€JUC-å‰ç½®åŸºç¡€" class="headerlink" title="ä¸‰ã€JUC å‰ç½®åŸºç¡€"></a>ä¸‰ã€JUC å‰ç½®åŸºç¡€</h1><h2 id="1-çº¿ç¨‹çš„çŠ¶æ€"><a href="#1-çº¿ç¨‹çš„çŠ¶æ€" class="headerlink" title="1. çº¿ç¨‹çš„çŠ¶æ€"></a>1. çº¿ç¨‹çš„çŠ¶æ€</h2><h3 id="1-1-æ“ä½œç³»ç»Ÿå±‚"><a href="#1-1-æ“ä½œç³»ç»Ÿå±‚" class="headerlink" title="1.1. æ“ä½œç³»ç»Ÿå±‚"></a>1.1. æ“ä½œç³»ç»Ÿå±‚</h3><p>æ“ä½œç³»ç»Ÿå±‚çš„çº¿ç¨‹çŠ¶æ€ï¼Œæ˜¯æ“ä½œç³»ç»Ÿå†…æ ¸å¯¹çº¿ç¨‹çš„å®é™…è°ƒåº¦åæ˜ <br><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJUC/%E7%AC%94%E8%AE%B0%EF%BC%9AJUC.png"></p><hr><h3 id="1-2-Java-åº”ç”¨å±‚"><a href="#1-2-Java-åº”ç”¨å±‚" class="headerlink" title="1.2. Java åº”ç”¨å±‚"></a>1.2. Java åº”ç”¨å±‚</h3><p><code>Java</code> åº”ç”¨å±‚çš„çº¿ç¨‹çŠ¶æ€ï¼Œæ˜¯ <code>JVM</code> å¯¹çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸçš„æŠ½è±¡å’Œç®¡ç†ï¼Œä¸»è¦åæ˜ çº¿ç¨‹åœ¨ <code>Java</code> å†…å­˜æ¨¡å‹ä¸­çš„è¡Œä¸º<br><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJUC/%E7%AC%94%E8%AE%B0%EF%BC%9AJUC-1.png"></p><ol><li><code>NEW</code><ol><li>åœ¨ <code>Java</code> åº”ç”¨å±‚ï¼Œ<code>Thread</code> å®ä¾‹å·²åˆ›å»ºï¼Œä½†å°šæœªè°ƒç”¨ <code>Thread#start</code>ï¼Œå¤„äºæœªå¯åŠ¨çŠ¶æ€</li><li>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬åªæ˜¯åˆ›å»ºäº†çº¿ç¨‹å®ä¾‹ï¼Œä½†æ˜¯è¯¥å®ä¾‹å°šæœªä¸æ“ä½œç³»ç»Ÿå±‚é¢çš„çº¿ç¨‹å»ºç«‹å…³è”</li></ol></li><li><code>RUNNABLE</code><ol><li>å¯è¿è¡ŒçŠ¶æ€<ol><li>å½“æˆ‘ä»¬è°ƒç”¨ <code>Thread#start</code> åï¼Œ<code>JVM</code> ä¼šåœ¨æ“ä½œç³»ç»Ÿå±‚é¢è¯·æ±‚åˆ›å»ºä¸€ä¸ªæœ¬åœ°çº¿ç¨‹</li><li>ä¸€æ—¦æ“ä½œç³»ç»Ÿåˆ›å»ºäº†è¿™ä¸ªæœ¬åœ°çº¿ç¨‹ï¼Œå¹¶å°†å…¶ä¸ <code>Thread</code> å®ä¾‹ â€œç»‘å®šâ€ï¼Œ<code>Thread</code> å®ä¾‹å°±ä¼šè¿›å…¥å¯è¿è¡ŒçŠ¶æ€</li><li>å¯è¿è¡ŒçŠ¶æ€è¡¨ç¤º <code>Thread</code> å®ä¾‹å·²ç»å‡†å¤‡å¥½è¿è¡Œäº†ï¼Œç„¶è€Œï¼Œèƒ½å¦çœŸæ­£è¿è¡Œè¿˜è¦å–å†³äºæ“ä½œç³»ç»Ÿçš„è°ƒåº¦</li></ol></li><li>è¿è¡ŒçŠ¶æ€<ol><li>æœ¬åœ°çº¿ç¨‹è¢«åˆ†é…åˆ° <code>CPU</code> æ—¶é—´ç‰‡åï¼Œå¼€å§‹æ‰§è¡Œ <code>Java</code> ä»£ç </li></ol></li><li>é˜»å¡çŠ¶æ€<ol><li>é˜»å¡çŠ¶æ€å…¶å®å°±æ˜¯æœ¬åœ°çº¿ç¨‹è¿›å…¥ <code>IO</code> é˜»å¡</li><li>éœ€è¦æ³¨æ„çš„æ˜¯ï¼š<ol><li>åœ¨ <code>Java</code> åº”ç”¨å±‚çš„ <code>IO</code> é˜»å¡ã€<code>BLOCKED</code>ã€<code>WAITING</code>ã€<code>TIMED_WAITING</code>ï¼Œåœ¨æ“ä½œç³»ç»Ÿå±‚éƒ½å±äºé˜»å¡çŠ¶æ€ï¼Œ<code>CPU</code> ä¸å†è°ƒç”¨è¿™ä¸ªçº¿ç¨‹</li><li><code>IO</code> é˜»å¡ä¸¥æ ¼æ¥è¯´æ˜¯æ“ä½œç³»ç»Ÿå±‚çš„é˜»å¡ï¼Œä½†æ˜¯æˆ‘ä»¬æ²¡å¿…è¦åˆ’åˆ†çš„é‚£ä¹ˆæ¸…æ™°ï¼ŒçŸ¥é“å®ƒæ˜¯ä»€ä¹ˆä¸œè¥¿å³å¯</li></ol></li></ol></li></ol></li><li><code>TERMINATED</code><ol><li>å½“çº¿ç¨‹æ‰§è¡Œå®Œä»»åŠ¡åï¼Œçº¿ç¨‹å®ä¾‹å°±ä¼šè¿›å…¥<code>TERMINATED</code> çŠ¶æ€</li><li>åœ¨ <code>Java</code> å±‚é¢ä¸Šï¼Œçº¿ç¨‹æ˜¯ä¸€ä¸ªçº¿ç¨‹å¯¹è±¡ï¼Œå½“è¿™ä¸ªçº¿ç¨‹å¯¹è±¡ä¸å†è¢«å¼•ç”¨æ—¶ï¼Œä¼šåœ¨ä¸‹ä¸€æ¬¡ GC æ—¶è¢«åƒåœ¾å›æ”¶ã€‚</li></ol></li></ol><hr><h2 id="2-çº¿ç¨‹ç›¸å…³åˆ†ç±»"><a href="#2-çº¿ç¨‹ç›¸å…³åˆ†ç±»" class="headerlink" title="2. çº¿ç¨‹ç›¸å…³åˆ†ç±»"></a>2. çº¿ç¨‹ç›¸å…³åˆ†ç±»</h2><p>åœ¨ <code>Java</code> åº”ç”¨å±‚ï¼Œçº¿ç¨‹åˆ†ä¸ºï¼š</p><ol><li>ç”¨æˆ·çº¿ç¨‹</li><li>å®ˆæŠ¤çº¿ç¨‹</li></ol><p>æˆ‘ä»¬å¹³æ—¶åˆ›å»ºçš„ <code>Thread</code> å®ä¾‹é»˜è®¤éƒ½æ˜¯ç”¨æˆ·çº¿ç¨‹ï¼Œ<code>main</code> æ–¹æ³•çš„ä¸»çº¿ç¨‹ä¹Ÿæ˜¯ä¸€ä¸ªç”¨æˆ·çº¿ç¨‹ã€‚å¾ˆå¤šäººè¯¯ä»¥ä¸ºï¼šåªè¦ä¸»çº¿ç¨‹ç»“æŸåï¼Œ<code>JVM</code> è¿›ç¨‹å°±ä¼šç»“æŸã€‚äº‹å®ä¸Šï¼Œè¿™ç§ç†è§£æ˜¯é”™è¯¯çš„ï¼Œåªè¦ä»æœ‰ç”¨æˆ·çº¿ç¨‹åœ¨è¿è¡Œï¼Œ<code>JVM</code> è¿›ç¨‹å°±ä¼šç»§ç»­å­˜æ´»ã€‚</p><p>ä½†æ˜¯å®ˆæŠ¤çº¿ç¨‹çš„è¡Œä¸ºåˆ™éå¦‚æ­¤ï¼Œå½“æ‰€æœ‰ç”¨æˆ·çº¿ç¨‹éƒ½æ‰§è¡Œå®Œæ¯•åï¼Œ<code>JVM</code> è¿›ç¨‹å°†è‡ªåŠ¨é€€å‡ºï¼Œè€Œä¸ç®¡æ˜¯å¦è¿˜æœ‰å®ˆæŠ¤çº¿ç¨‹åœ¨è¿è¡Œã€‚æ­¤æ—¶å®ˆæŠ¤çº¿ç¨‹ä¼šè¢«å¼ºåˆ¶ç»ˆæ­¢ï¼Œå…¶ <code>finally</code> å—ä¸­çš„ä»£ç ä¹Ÿä¸ä¿è¯ä¸€å®šæ‰§è¡Œã€‚å› æ­¤å®ˆæŠ¤çº¿ç¨‹å¸¸ç”¨äºåå°æœåŠ¡ï¼Œä¾‹å¦‚åƒåœ¾å›æ”¶ã€å¿ƒè·³ç›‘æ§ã€æ—¥å¿—æ¸…ç†ç­‰ä»»åŠ¡</p><hr><h2 id="3-çº¿ç¨‹é˜»å¡ç›¸å…³åˆ†ç±»"><a href="#3-çº¿ç¨‹é˜»å¡ç›¸å…³åˆ†ç±»" class="headerlink" title="3. çº¿ç¨‹é˜»å¡ç›¸å…³åˆ†ç±»"></a>3. çº¿ç¨‹é˜»å¡ç›¸å…³åˆ†ç±»</h2><ol><li><code>IO</code> é˜»å¡<ol><li><code>Java</code> ç¨‹åºåœ¨ä¸æ“ä½œç³»ç»Ÿäº¤äº’æ—¶ï¼Œç”±æ“ä½œç³»ç»Ÿå±‚ä»£æˆ‘ä»¬æ‰§è¡Œçš„é˜»å¡ï¼Œè®©æˆ‘ä»¬çš„æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€</li><li>è™½ç„¶ <code>IO</code> é˜»å¡åœ¨æ“ä½œç³»ç»Ÿå±‚é¢ä¹Ÿå±äºé˜»å¡çŠ¶æ€ï¼Œä½†å¯¹ <code>Java</code> åº”ç”¨å±‚æ¥è¯´ï¼Œå®ƒå¹¶ä¸èƒ½ç›´æ¥æ„ŸçŸ¥æœ¬åœ°çº¿ç¨‹æ˜¯å¦æ­£å¤„äº <code>IO</code> é˜»å¡ï¼Œå› æ­¤ <code>Thread</code> å®ä¾‹çš„çŠ¶æ€ä»ä¸º <code>RUNNABLE</code>ã€‚ç®€å•æ¥è¯´å°±æ˜¯ï¼šå› ä¸ºæ„ŸçŸ¥ä¸åˆ°ï¼Œæ‰€ä»¥è®¤ä¸ºè¿˜åœ¨è¿è¡Œ</li></ol></li><li><code>BLOCKED</code> é˜»å¡ã€<code>WAITING</code> é˜»å¡ã€<code>TIMED_WAITING</code> é˜»å¡<ol><li><code>Java</code> åº”ç”¨å±‚è¿˜æä¾›äº†å¤šç§ <code>API</code> è®©æœ¬åœ°çº¿ç¨‹ä¸»åŠ¨è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œ<code>Thread</code> å®ä¾‹è¿›å…¥ <code>BWTW</code> çŠ¶æ€</li><li>å› ä¸ºè°ƒç”¨äº† <code>Java</code> åº”ç”¨å±‚æä¾›çš„ <code>API</code>ï¼Œæ‰€ä»¥ <code>Java</code> åº”ç”¨å±‚èƒ½çŸ¥é“çº¿ç¨‹è¿›å…¥äº†é˜»å¡çŠ¶æ€ï¼Œå¹¶ä¸”è¿˜çŸ¥é“çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€çš„ â€œåŸå› â€ï¼Œæ‰€ä»¥ <code>Thread</code> å®ä¾‹èƒ½è¿›å…¥å¯¹åº”çš„ <code>BLOCKED</code>ã€<code>WAITING</code> æˆ– <code>TIMED_WAITING</code> çŠ¶æ€</li><li><code>Java</code> åº”ç”¨å±‚æä¾›çš„ç›¸å…³ <code>API</code> ä¸»è¦åŒ…æ‹¬ï¼š<ol><li><code>Thread.sleep</code><ol><li>æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œ<code>Thread</code> å®ä¾‹è¿›å…¥ <code>TIMED_WAITING</code> çŠ¶æ€ï¼Œç­‰å¾…è¢«ä¸­æ–­ï¼ˆ<code>Thread#interrupt</code>ï¼‰ã€é˜»å¡è¶…æ—¶</li></ol></li><li>åŸºäº <code>Monitor</code> çš„é˜»å¡<ol><li>ç«äº‰ <code>Monitor</code> é”å¤±è´¥<ol><li><code>synchronized</code><ol><li>æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œ<code>Thread</code> å®ä¾‹è¿›å…¥ <code>BLOCKED</code> çŠ¶æ€ï¼Œå¹¶è¢«æŠ•é€’åˆ° <code>Monitor</code> çš„ <code>EntryList</code> é˜Ÿåˆ—ï¼ˆç«äº‰é˜Ÿåˆ—ï¼‰ï¼Œç­‰å¾…è¢«å”¤é†’ï¼ˆ<code>Monitor</code> é”è¢«é‡Šæ”¾æ—¶ï¼Œç”± <code>JVM</code> å”¤é†’ï¼‰</li></ol></li></ol></li><li><code>Object#wait</code><ol><li><code>Object#wait()</code><ol><li>æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œ<code>Thread</code> å®ä¾‹è¿›å…¥ <code>WAITING</code> çŠ¶æ€ï¼Œå¹¶è¢«æŠ•é€’åˆ° <code>Monitor</code> çš„ <code>WaitSet</code> é˜Ÿåˆ—ï¼ˆç­‰å¾…é˜Ÿåˆ—ï¼‰ï¼Œç­‰å¾…è¢«å”¤é†’ï¼ˆ<code>Object#notify</code>ï¼‰ã€è¢«ä¸­æ–­</li></ol></li><li><code>Object#wait(long timeoutMillis)</code><ol><li>æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œ<code>Thread</code> å®ä¾‹è¿›å…¥ <code>TIMED_WAITING</code> çŠ¶æ€ï¼Œå¹¶è¢«æŠ•é€’åˆ° <code>Monitor</code> çš„ <code>WaitSet</code> é˜Ÿåˆ—ï¼ˆç­‰å¾…é˜Ÿåˆ—ï¼‰ï¼Œç­‰å¾…è¢«å”¤é†’ï¼ˆ<code>Object#notify</code>ï¼‰ã€è¢«ä¸­æ–­ã€é˜»å¡è¶…æ—¶</li></ol></li></ol></li><li><code>Thread#join</code><ol><li><code>Thread#join()</code><ol><li>æ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œå› ä¸ºå…¶æœ¬è´¨æ˜¯åŸºäº <code>Object#wait</code> å®ç°çš„é˜»å¡</li></ol></li><li><code>Thread#join(final long millis)</code></li><li><code>Thread#join(long millis, int nanos)</code></li></ol></li><li>éœ€è¦æ³¨æ„çš„æ˜¯ï¼š<ol><li><code>Object#wait</code> å’Œ <code>Thread#join</code> éƒ½ä¼šä½¿ <code>Thread</code> å®ä¾‹è¿›å…¥ <code>Monitor</code> çš„ç­‰å¾…é˜Ÿåˆ—ã€‚é‚£ä¹ˆä¸ºä»€ä¹ˆè¦è¿›å…¥ç­‰å¾…é˜Ÿåˆ—ï¼Œè€Œä¸æ˜¯è¿›å…¥ç«äº‰é˜Ÿåˆ—å‘¢ï¼Ÿ</li><li>è¿›å…¥ç­‰å¾…é˜Ÿåˆ—æ˜¯å› ä¸º <code>Thread</code> å®ä¾‹åœ¨ç«äº‰åˆ° <code>Monitor</code> é”åï¼Œå‘ç°æŸä¸ªæ¡ä»¶å°šæœªæ»¡è¶³ï¼Œä¸ºäº†ä¸å½±å“å…¶ä»–çº¿ç¨‹ç»§ç»­è·å– <code>Monitor</code> é”ï¼Œæ‰€ä»¥ä¼šä¸»åŠ¨é‡Šæ”¾é”ï¼Œå¹¶è¿›å…¥ç­‰å¾…é˜Ÿåˆ—ä¸­ç­‰å¾…æ¡ä»¶è¢«æ»¡è¶³</li><li>æ‰€ä»¥ <code>Object#wait</code> å’Œ <code>Thread#join</code> çš„å‰ç½®æ¡ä»¶æ˜¯ï¼šç«äº‰åˆ° <code>Monitor</code> é”ã€‚åªæœ‰å…ˆç«äº‰åˆ° <code>Monitor</code> é”ï¼Œæ‰çŸ¥é“æŸä¸ªæ¡ä»¶å°šæœªæ»¡è¶³</li><li>æˆ‘çš„æ„æ€æ˜¯ï¼š<code>Object#wait</code>ã€<code>Thread#join</code> å’Œ <code>synchronized</code> æ˜¯ç»‘å®šçš„ï¼Œå®ƒä»¬å¿…é¡»å‡ºç°åœ¨ <code>synchronized</code> ä»£ç å—ä¸­ï¼Œå¦åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚è€Œ <code>Thread.sleep</code>ã€åŸºäº <code>Park</code> çš„é˜»å¡æ²¡æœ‰è¿™ç§é™åˆ¶ï¼Œå¯ä»¥åœ¨ä»»ä½•åœ°æ–¹ä½¿ç”¨</li><li>éœ€è¦æ³¨æ„çš„æ˜¯ï¼šå¦‚æœç«äº‰åˆ° <code>Monitor</code> é”ï¼Œä½†æ˜¯ä½¿ç”¨äº† <code>Thread.sleep</code>ã€åŸºäº <code>Park</code> çš„é˜»å¡çš„æƒ…å†µä¸‹ï¼Œ<code>Monitor</code> é”æ˜¯ä¸ä¼šè¢«é‡Šæ”¾çš„</li></ol></li></ol></li><li>åŸºäº <code>Park</code> çš„é˜»å¡<ol><li><code>LockSupport.park</code><ol><li><code>LockSupport.park()</code><ol><li>æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œ<code>Thread</code> å®ä¾‹è¿›å…¥ <code>WAITING</code> çŠ¶æ€ï¼Œç­‰å¾…è¢«å”¤é†’ï¼ˆ<code>LockSupport.unpark</code>ï¼‰ã€è¢«ä¸­æ–­ï¼ˆ<code>Thread#interrupt</code>ï¼‰</li></ol></li><li><code>LockSupport.parkNanos(long nanos)</code><ol><li>æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œ<code>Thread</code> å®ä¾‹è¿›å…¥ <code>TIMED_WAITING</code> çŠ¶æ€ï¼Œç­‰å¾…è¢«å”¤é†’ï¼ˆ<code>LockSupport.unpark</code>ï¼‰ã€è¢«ä¸­æ–­ï¼ˆ<code>Thread#interrupt</code>ï¼‰ã€é˜»å¡è¶…æ—¶</li></ol></li><li><code>LockSupport.parkUntil(long deadline)</code><ol><li>æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œ<code>Thread</code> å®ä¾‹è¿›å…¥ <code>TIMED_WAITING</code> çŠ¶æ€ï¼Œç­‰å¾…è¢«å”¤é†’ï¼ˆ<code>LockSupport.unpark</code>ï¼‰ã€è¢«ä¸­æ–­ï¼ˆ<code>Thread#interrupt</code>ï¼‰ã€é˜»å¡è¶…æ—¶</li></ol></li><li>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå…·ä½“çš„è¿‡ç¨‹æ¯”ä¸Šè¿°æè¿°ç¨å¾®å¤æ‚ä¸€ç‚¹ï¼Œè¯¦è§æºç ï¼š<code>LockSupport</code>ï¼ˆ<code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.LockSupport%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.locks.LockSupportæºç è§£æ</a>ï¼Œ<code>Hexo</code> é“¾æ¥ï¼š <a href="http://blog.wangjia.ink/2025/11/13/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.LockSupport%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/13/æºç ï¼šjava.util.concurrent.locks.LockSupportæºç è§£æ/</a> ï¼‰</li></ol></li></ol></li></ol></li></ol></li></ol><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li><code>IO</code> é˜»å¡ã€<code>Threa.sleep</code> éƒ½ä¾èµ–äºæ“ä½œç³»ç»Ÿå±‚çš„é˜Ÿåˆ—</li><li>åŸºäº <code>Monitor</code> çš„é˜»å¡ä¾èµ–äº <code>Java</code> åº”ç”¨å±‚çš„ <code>Monitor</code> ä¸­çš„ <code>EntryList</code>ã€<code>WaitSet</code> é˜Ÿåˆ—</li><li>è€ŒåŸºäº <code>Park</code> çš„é˜»å¡ï¼ŒåŸåˆ™ä¸Šæ˜¯ä¸ä¾èµ–äºä»»ä½•æ•°æ®ç»“æ„ï¼Œä¸è¿‡åœ¨å®é™…ä¸­ï¼Œå‡ ä¹æ‰€æœ‰åŸºäº <code>Park</code> é˜»å¡çš„äº§å“ï¼Œéƒ½ä¼šç»´æŠ¤ä¸€ä¸ªæ•°æ®ç»“æ„ï¼ˆå¯èƒ½æ˜¯é˜Ÿåˆ—ï¼Œä¹Ÿå¯èƒ½æ˜¯å…¶ä»–æ•°æ®ç»“æ„ï¼‰ã€‚å› ä¸ºå¦‚æœæ²¡æœ‰è¿™ä¸ªæ•°æ®ç»“æ„ï¼Œå°±æ— æ³•è®°å½•å“ªäº›çº¿ç¨‹è¢«é˜»å¡ã€ä»¥åŠåº”å½“å”¤é†’å“ªäº›çº¿ç¨‹</li></ol></blockquote><hr><h2 id="4-çº¿ç¨‹ä¹‹é—´çš„æ‰§è¡Œå…³ç³»"><a href="#4-çº¿ç¨‹ä¹‹é—´çš„æ‰§è¡Œå…³ç³»" class="headerlink" title="4. çº¿ç¨‹ä¹‹é—´çš„æ‰§è¡Œå…³ç³»"></a>4. çº¿ç¨‹ä¹‹é—´çš„æ‰§è¡Œå…³ç³»</h2><p><font color="#92d050">1. ä¸²è¡Œ</font><br>ä¸²è¡Œæ˜¯æŒ‡ä»»åŠ¡æŒ‰é¡ºåºä¸€ä¸ªæ¥ä¸€ä¸ªåœ°æ‰§è¡Œï¼Œåªæœ‰å½“å‰ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œå®Œæˆï¼Œåä¸€ä¸ªä»»åŠ¡æ‰ä¼šå¼€å§‹æ‰§è¡Œï¼Œä¸¥æ ¼éµå¾ªä»»åŠ¡æäº¤çš„å…ˆåé¡ºåºã€‚å³ä¾¿ç³»ç»Ÿæ‹¥æœ‰å¤šä¸ª <code>CPU</code> æ ¸å¿ƒï¼Œåœ¨ä¸²è¡Œæ¨¡å¼ä¸‹ï¼Œä»»æ„æ—¶åˆ»ä¹Ÿåªä¼šæœ‰ä¸€ä¸ªçº¿ç¨‹åœ¨è¿è¡Œã€‚</p><p><font color="#92d050">2. å¹¶å‘</font><br>å¹¶å‘æ˜¯æŒ‡å¤šä¸ªçº¿ç¨‹çœ‹èµ·æ¥åƒæ˜¯åœ¨åŒæ—¶è¿è¡Œï¼Œå…¶æ˜¯é€šè¿‡æ—¶é—´ç‰‡è½®è½¬æœºåˆ¶å®ç°ï¼Œé€šè¿‡å¿«é€Ÿåˆ‡æ¢çº¿ç¨‹ï¼Œè®©æ¯ä¸ªçº¿ç¨‹éƒ½è·å¾—è¿è¡Œæœºä¼šï¼Œå› æ­¤å¹¶å‘ç‰¹æ€§åœ¨å•æ ¸ç¯å¢ƒä¸­ä½“ç°å¾—å°¤ä¸ºæ˜æ˜¾ã€‚</p><p>è€Œåœ¨å¤šæ ¸ <code>CPU</code> ä¸Šï¼Œçº¿ç¨‹æœ‰å¯èƒ½è¢«åˆ†é…åˆ°ä¸åŒçš„æ ¸å¿ƒä¸Šå¹¶è¡Œæ‰§è¡Œï¼Œä½†å½“çº¿ç¨‹æ•°é‡å¤šäºæ ¸å¿ƒæ•°é‡æ—¶ï¼Œ<code>CPU</code> ä»éœ€é€šè¿‡æ—¶é—´ç‰‡è½®è½¬è¿›è¡Œè°ƒåº¦ï¼Œä»¥ç¡®ä¿æ‰€æœ‰çº¿ç¨‹éƒ½èƒ½è·å¾—æ‰§è¡Œæœºä¼šã€‚</p><p><font color="#92d050">3. å¹¶è¡Œ</font><br>å¹¶è¡Œæ˜¯æŒ‡å¤šä¸ªçº¿ç¨‹åœ¨çœŸæ­£æ„ä¹‰ä¸ŠåŒæ—¶è¿è¡Œï¼Œåˆ†åˆ«å ç”¨ä¸åŒçš„ <code>CPU</code> æ ¸å¿ƒï¼Œåœ¨åŒä¸€æ—¶åˆ»æ‰§è¡Œå„è‡ªçš„ä»»åŠ¡ï¼Œä½“ç°å‡ºçœŸæ­£çš„åŒæ—¶å¤„ç†èƒ½åŠ›ã€‚</p><hr><h2 id="5-çº¿ç¨‹çš„æ´»è·ƒæ€§"><a href="#5-çº¿ç¨‹çš„æ´»è·ƒæ€§" class="headerlink" title="5. çº¿ç¨‹çš„æ´»è·ƒæ€§"></a>5. çº¿ç¨‹çš„æ´»è·ƒæ€§</h2><h3 id="5-1-æ­»é”"><a href="#5-1-æ­»é”" class="headerlink" title="5.1. æ­»é”"></a>5.1. æ­»é”</h3><h4 id="5-1-1-æ­»é”æ¦‚è¿°"><a href="#5-1-1-æ­»é”æ¦‚è¿°" class="headerlink" title="5.1.1. æ­»é”æ¦‚è¿°"></a>5.1.1. æ­»é”æ¦‚è¿°</h4><p>æ­»é”æ˜¯æŒ‡ï¼šä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„çº¿ç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå› äº’ç›¸æŒæœ‰å¯¹æ–¹æ‰€éœ€çš„èµ„æºè€Œé€ æˆçš„ä¸€ç§äº’ç›¸ç­‰å¾…çš„ç°è±¡ã€‚å¦‚æœæ²¡æœ‰å¤–åŠ›å¹²æ¶‰ï¼Œè¿™äº›çº¿ç¨‹éƒ½å°†æ— æ³•æ¨è¿›ä¸‹å»ï¼Œæ°¸è¿œå¤„äºé˜»å¡çŠ¶æ€</p><p>ä¾‹å¦‚çº¿ç¨‹ $T_1$ å·²ç»æŒæœ‰äº†é” <code>A</code>ï¼Œç°åœ¨æƒ³å»ç«äº‰é” <code>B</code>ã€‚çº¿ç¨‹ $T_2$ å·²ç»æŒæœ‰äº†é” <code>B</code>ï¼Œç°åœ¨æƒ³å»ç«äº‰é” <code>A</code>ï¼Œè¿™ä¾¿å½¢æˆäº†æ­»é”</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼šåœ¨ <code>JUC</code> ä¸­ï¼Œæ‰€è°“çš„ â€œèµ„æºâ€ æ˜¯æŒ‡ï¼šé”</p><hr><h4 id="5-1-2-æ­»é”çš„å¿…è¦æ¡ä»¶"><a href="#5-1-2-æ­»é”çš„å¿…è¦æ¡ä»¶" class="headerlink" title="5.1.2. æ­»é”çš„å¿…è¦æ¡ä»¶"></a>5.1.2. æ­»é”çš„å¿…è¦æ¡ä»¶</h4><ol><li>äº’æ–¥æ¡ä»¶<ol><li>èµ„æºæ˜¯ç‹¬å çš„ï¼ŒåŒä¸€æ—¶åˆ»åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹æŒæœ‰</li></ol></li><li>ä¸å‰¥å¤ºæ¡ä»¶<ol><li>çº¿ç¨‹å·²æŒæœ‰çš„èµ„æºï¼Œåœ¨æœ«ä½¿ç”¨å®Œä¹‹å‰ï¼Œä¸èƒ½è¢«å…¶ä»–çº¿ç¨‹å¼ºè¡Œå‰¥å¤ºï¼Œåªèƒ½ç”±çº¿ç¨‹è‡ªå·±ä¸»åŠ¨é‡Šæ”¾</li></ol></li><li>å¾ªç¯ç­‰å¾…æ¡ä»¶<ol><li>è‹¥å¹²çº¿ç¨‹ä¹‹é—´å½¢æˆä¸€ç§å¤´å°¾ç›¸æ¥çš„å¾ªç¯ç­‰å¾…èµ„æºçš„å…³ç³»ï¼ˆä¾‹å¦‚ <code>A</code> ç­‰ <code>B</code>ï¼Œ<code>B</code> ç­‰ <code>A</code>ï¼‰</li></ol></li><li>è¯·æ±‚ä¸ä¿æŒæ¡ä»¶<ol><li>çº¿ç¨‹åœ¨ç­‰å¾…æ–°èµ„æºæ—¶ï¼Œå¯¹å·²ç»æŒæœ‰çš„èµ„æºä¿æŒä¸æ”¾ï¼ˆåƒç€ç¢—é‡Œçš„ï¼Œçœ‹ç€é”…é‡Œçš„ï¼‰</li></ol></li></ol><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>è§£å†³æ­»é”çš„æ ¸å¿ƒæ€è·¯ï¼Œå°±æ˜¯ç ´åä¸Šè¿°å››ä¸ªæ¡ä»¶çš„ä»»æ„ä¸€ä¸ªã€‚ç”±äº â€œäº’æ–¥æ¡ä»¶â€ æ˜¯é”çš„åŸºæœ¬ç‰¹æ€§ï¼Œé€šå¸¸æˆ‘ä»¬æ— æ³•ç ´åï¼Œå› æ­¤ä¸»è¦é’ˆå¯¹åä¸‰ä¸ªæ¡ä»¶è¿›è¡Œç ´å</li></ol></blockquote><hr><h4 id="5-1-3-æ­»é”çš„è§£å†³æ–¹æ¡ˆ"><a href="#5-1-3-æ­»é”çš„è§£å†³æ–¹æ¡ˆ" class="headerlink" title="5.1.3. æ­»é”çš„è§£å†³æ–¹æ¡ˆ"></a>5.1.3. æ­»é”çš„è§£å†³æ–¹æ¡ˆ</h4><h5 id="5-1-3-1-ç ´åä¸å‰¥å¤ºæ¡ä»¶"><a href="#5-1-3-1-ç ´åä¸å‰¥å¤ºæ¡ä»¶" class="headerlink" title="5.1.3.1. ç ´åä¸å‰¥å¤ºæ¡ä»¶"></a>5.1.3.1. ç ´åä¸å‰¥å¤ºæ¡ä»¶</h5><p>ç ´åä¸å‰¥å¤ºæ¡ä»¶æ˜¯æŒ‡ï¼šçº¿ç¨‹ç­‰å¾…èµ„æºè¶…è¿‡ä¸€æ®µæ—¶é—´ï¼Œå°±æ”¾å¼ƒç­‰å¾…ï¼Œå¹¶é‡Šæ”¾å·²æŒæœ‰çš„èµ„æº</p><hr><h5 id="5-1-3-2-ç ´åå¾ªç¯ç­‰å¾…æ¡ä»¶ï¼ˆæœ€å¸¸ç”¨ï¼‰"><a href="#5-1-3-2-ç ´åå¾ªç¯ç­‰å¾…æ¡ä»¶ï¼ˆæœ€å¸¸ç”¨ï¼‰" class="headerlink" title="5.1.3.2. ç ´åå¾ªç¯ç­‰å¾…æ¡ä»¶ï¼ˆæœ€å¸¸ç”¨ï¼‰"></a>5.1.3.2. ç ´åå¾ªç¯ç­‰å¾…æ¡ä»¶ï¼ˆæœ€å¸¸ç”¨ï¼‰</h5><p>ç ´åå¾ªç¯ç­‰å¾…æ¡ä»¶æ˜¯æŒ‡ï¼šè§„å®šæ‰€æœ‰çº¿ç¨‹å¿…é¡»æŒ‰ç…§ç›¸åŒçš„é¡ºåºè·å–èµ„æºã€‚ä¾‹å¦‚è§„å®šæ‰€æœ‰çº¿ç¨‹å¿…é¡»å…ˆè·å–é” <code>A</code>ï¼Œå†è·å–é” <code>B</code>ï¼Œå†è·å–é” <code>C</code></p><hr><h5 id="5-1-3-3-ç ´åè¯·æ±‚ä¸ä¿æŒæ¡ä»¶"><a href="#5-1-3-3-ç ´åè¯·æ±‚ä¸ä¿æŒæ¡ä»¶" class="headerlink" title="5.1.3.3. ç ´åè¯·æ±‚ä¸ä¿æŒæ¡ä»¶"></a>5.1.3.3. ç ´åè¯·æ±‚ä¸ä¿æŒæ¡ä»¶</h5><p>ç ´åè¯·æ±‚ä¸ä¿æŒæ¡ä»¶æ˜¯æŒ‡ï¼šé‡‡ç”¨ â€œé¢„å…ˆç”³è¯·â€ çš„æ–¹å¼ï¼Œè®©æ‰€æœ‰çº¿ç¨‹å¿…é¡»ä¸€æ¬¡æ€§ç”³è¯·å®ƒæ‰€éœ€è¦çš„æ‰€æœ‰èµ„æºã€‚å¦‚æœèƒ½ç”³è¯·åˆ°æ‰€æœ‰èµ„æºï¼Œçº¿ç¨‹ç»§ç»­å‘ä¸‹æ‰§è¡Œã€‚å¦‚æœä¸èƒ½ç”³è¯·åˆ°æ‰€æœ‰èµ„æºï¼Œåˆ™é‡Šæ”¾å·²æŒæœ‰çš„èµ„æº</p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>ç ´åè¯·æ±‚ä¸ä¿æŒæ¡ä»¶ï¼Œé€šå¸¸å’Œç ´åä¸å‰¥å¤ºæ¡ä»¶ç»“åˆä½¿ç”¨</li></ol></blockquote><hr><h3 id="5-2-æ´»é”"><a href="#5-2-æ´»é”" class="headerlink" title="5.2. æ´»é”"></a>5.2. æ´»é”</h3><h4 id="5-2-1-æ´»é”æ¦‚è¿°"><a href="#5-2-1-æ´»é”æ¦‚è¿°" class="headerlink" title="5.2.1. æ´»é”æ¦‚è¿°"></a>5.2.1. æ´»é”æ¦‚è¿°</h4><p>æ´»é”æ˜¯æŒ‡ï¼šä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„çº¿ç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ç§ï¼Œå› ä¸ºä¸æ–­äº’ç›¸æ”¹å˜å¯¹æ–¹çš„ç»ˆæ­¢æ¡ä»¶ï¼Œå¯¼è‡´æ‰€æœ‰çº¿ç¨‹éƒ½æ— æ³•ç»§ç»­å‘ä¸‹æ‰§è¡Œã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestLiveLock</span> &#123;<br><br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">int</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-number">10</span>;<br>    <br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sleep</span><span class="hljs-params">(<span class="hljs-type">double</span> seconds)</span> &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            Thread.sleep((<span class="hljs-type">long</span>) (seconds * <span class="hljs-number">1000</span>));<br>        &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>            Thread.currentThread().interrupt();<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; &#123;<br>            <span class="hljs-comment">// æœŸæœ›å‡åˆ° 0 é€€å‡ºå¾ªç¯</span><br>            <span class="hljs-keyword">while</span> (count &gt; <span class="hljs-number">0</span>) &#123;<br>                sleep(<span class="hljs-number">0.2</span>);<br>                count--;<br>                log.debug(<span class="hljs-string">&quot;count: &#123;&#125;&quot;</span>, count);<br>            &#125;<br>        &#125;, <span class="hljs-string">&quot;t1&quot;</span>).start();<br>        <br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; &#123;<br>            <span class="hljs-comment">// æœŸæœ›åŠ åˆ° 20 é€€å‡ºå¾ªç¯</span><br>            <span class="hljs-keyword">while</span> (count &lt; <span class="hljs-number">20</span>) &#123;<br>                sleep(<span class="hljs-number">0.2</span>);<br>                count++;<br>                log.debug(<span class="hljs-string">&quot;count: &#123;&#125;&quot;</span>, count);<br>            &#125;<br>        &#125;, <span class="hljs-string">&quot;t2&quot;</span>).start();<br>    &#125;<br>    <br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>æ´»é”æœ¬è´¨ä¸Šæ˜¯ â€é‡è¯•â€œ å¯¼è‡´çš„å†²çª</li></ol></blockquote><hr><h4 id="5-2-2-æ´»é”çš„è§£å†³æ–¹æ¡ˆ"><a href="#5-2-2-æ´»é”çš„è§£å†³æ–¹æ¡ˆ" class="headerlink" title="5.2.2. æ´»é”çš„è§£å†³æ–¹æ¡ˆ"></a>5.2.2. æ´»é”çš„è§£å†³æ–¹æ¡ˆ</h4><h5 id="5-2-2-1-åŠ é”"><a href="#5-2-2-1-åŠ é”" class="headerlink" title="5.2.2.1. åŠ é”"></a>5.2.2.1. åŠ é”</h5><p>æ´»é”æœ¬è´¨ä¸Šå¹¶ä¸æ˜¯ â€œé”â€ æœ¬èº«ï¼Œä½†è§£å†³æ´»é”æ—¶ï¼Œå´æ˜¯å¯ä»¥ä½¿ç”¨ â€åŠ é”â€œ æ¥è§£å†³</p><hr><h5 id="5-2-2-2-éšæœºé¿è®©ï¼ˆæœ€å¸¸ç”¨ï¼‰"><a href="#5-2-2-2-éšæœºé¿è®©ï¼ˆæœ€å¸¸ç”¨ï¼‰" class="headerlink" title="5.2.2.2. éšæœºé¿è®©ï¼ˆæœ€å¸¸ç”¨ï¼‰"></a>5.2.2.2. éšæœºé¿è®©ï¼ˆæœ€å¸¸ç”¨ï¼‰</h5><p>éšå³é¿è®©æ˜¯æŒ‡ï¼šå½“å¤šä¸ª â€è¯·æ±‚â€œ åŒæ—¶äº‰æŠ¢èµ„æºå¤±è´¥æ—¶ï¼Œä¸è¦ç«‹å³é‡è¯•ï¼Œä¹Ÿä¸è¦ä½¿ç”¨å›ºå®šçš„ä¼‘çœ æ—¶é—´ã€‚æ›´åˆç†çš„åšæ³•æ˜¯é‡‡ç”¨ â€æŒ‡æ•°é€€é¿ + éšæœºæŠ–åŠ¨â€œ çš„ç­–ç•¥ï¼Œé™ä½ç«äº‰å†²çª</p><p>è¿™é‡ŒåŒæ ·èƒ½ä½¿ç”¨éšå³é¿è®©èƒ½é¿å…è¿™ä¸ªé—®é¢˜ï¼Œä¸è¿‡åœºæ™¯ä¸å†æ˜¯ â€œäº‰æŠ¢èµ„æºâ€ï¼Œè€Œæ˜¯ â€œé‡è¯•â€ å¯¼è‡´çš„å†²çªã€‚æˆ‘ä»¬å¯ä»¥åœ¨é‡è¯•æ—¶åŠ å…¥éšæœºé¿è®©ï¼Œå‡å°‘é‡è¯•ä¹‹é—´çš„åŒæ­¥ç¢°æ’</p><hr><h5 id="5-2-2-3-é™åˆ¶é‡è¯•æ¬¡æ•°"><a href="#5-2-2-3-é™åˆ¶é‡è¯•æ¬¡æ•°" class="headerlink" title="5.2.2.3. é™åˆ¶é‡è¯•æ¬¡æ•°"></a>5.2.2.3. é™åˆ¶é‡è¯•æ¬¡æ•°</h5><hr><h3 id="5-3-é¥¥é¥¿"><a href="#5-3-é¥¥é¥¿" class="headerlink" title="5.3. é¥¥é¥¿"></a>5.3. é¥¥é¥¿</h3><h4 id="5-3-1-é¥¥é¥¿æ¦‚è¿°"><a href="#5-3-1-é¥¥é¥¿æ¦‚è¿°" class="headerlink" title="5.3.1. é¥¥é¥¿æ¦‚è¿°"></a>5.3.1. é¥¥é¥¿æ¦‚è¿°</h4><p>é¥¥é¥¿æ˜¯æŒ‡ï¼šæŸä¸ªçº¿ç¨‹è™½ç„¶é•¿æœŸå¤„äºå¯è¿è¡ŒçŠ¶æ€ï¼Œä½†æ˜¯å´ä¸€ç›´æ— æ³•è·å–æ‰€éœ€è¦çš„èµ„æºï¼ˆä¾‹å¦‚ <code>CPU</code> æ—¶é—´ç‰‡ã€é”ã€èµ„æºæ± èµ„æºç­‰ï¼‰ï¼Œå¯¼è‡´çº¿ç¨‹æ— æ³•ç»§ç»­æ‰§è¡Œ</p><hr><h4 id="5-3-2-é¥¥é¥¿çš„è§£å†³æ–¹æ¡ˆ"><a href="#5-3-2-é¥¥é¥¿çš„è§£å†³æ–¹æ¡ˆ" class="headerlink" title="5.3.2. é¥¥é¥¿çš„è§£å†³æ–¹æ¡ˆ"></a>5.3.2. é¥¥é¥¿çš„è§£å†³æ–¹æ¡ˆ</h4><p>æ— è®ºæ˜¯çº¿ç¨‹é¥¥é¥¿ã€æµé‡æ§åˆ¶ï¼Œè¿˜æ˜¯ <code>IO</code> é˜»å¡ï¼Œè¿™äº›é—®é¢˜çš„æœ¬è´¨éƒ½æ˜¯ç›¸åŒçš„ï¼šå› æ— æ³•è·å–æ‰€éœ€è¦çš„èµ„æºï¼Œå¯¼è‡´æ— æ³•ç»§ç»­æ‰§è¡Œã€‚</p><p>é’ˆå¯¹è¿™ç§ â€èµ„æºåŒ®ä¹â€œ çš„é—®é¢˜ï¼Œé€šå¸¸æœ‰äº”ç§è§£å†³æ–¹æ¡ˆï¼š</p><ol><li>å¼ºåˆ¶æ’é˜Ÿ</li><li>èµ„æºé¢„ç•™</li><li>åŠæ—¶æ­¢æŸ<ol><li>å¼‚æ­¥å¤„ç†</li><li>é™çº§å¤„ç†</li><li>å¯åŠ¨å‘Šè­¦</li></ol></li><li>éšæœºé¿è®©</li><li>è°ƒæ•´ä¼˜å…ˆçº§</li></ol><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>æµé‡æ§åˆ¶ä¸»è¦åŒ…æ‹¬å¹¶å‘æ§åˆ¶å’Œé€Ÿç‡é™åˆ¶</li></ol></blockquote><h5 id="5-3-2-1-å¼ºåˆ¶æ’é˜Ÿ"><a href="#5-3-2-1-å¼ºåˆ¶æ’é˜Ÿ" class="headerlink" title="5.3.2.1. å¼ºåˆ¶æ’é˜Ÿ"></a>5.3.2.1. å¼ºåˆ¶æ’é˜Ÿ</h5><p>å¼ºåˆ¶æ’é˜Ÿæ˜¯æŒ‡ï¼šæ”¾å¼ƒ â€œè‡ªç”±ç«äº‰â€ï¼Œä¸¥æ ¼éµå¾ª â€œå…ˆæ¥ååˆ°â€ åŸåˆ™ï¼Œä¿è¯æ¯ä¸ª â€è¯·æ±‚â€œ æœ€ç»ˆéƒ½èƒ½å¾—åˆ°å¤„ç†</p><p>ä»¥é”èµ„æºä¸ºä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å…¬å¹³é”ï¼Œè€Œä¸æ˜¯éå…¬å¹³é”</p><hr><h5 id="5-3-2-2-èµ„æºé¢„ç•™"><a href="#5-3-2-2-èµ„æºé¢„ç•™" class="headerlink" title="5.3.2.2. èµ„æºé¢„ç•™"></a>5.3.2.2. èµ„æºé¢„ç•™</h5><p>èµ„æºé¢„ç•™æ˜¯æŒ‡ï¼šæå‰åˆ’åˆ†å¥½èµ„æºé…é¢ï¼Œå®è¡Œèµ„æºéš”ç¦»ï¼Œåšåˆ° â€ä¸“æ¬¾ä¸“ç”¨â€œï¼Œé˜²æ­¢æŸå•ä¸€ â€è¯·æ±‚â€œ è€—å°½æ‰€æœ‰èµ„æº</p><p>ä»¥çº¿ç¨‹èµ„æºä¸ºä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºæ¯ä¸ªä¸šåŠ¡åˆ†é…ä¸€ä¸ªç‹¬ç«‹çš„çº¿ç¨‹æ± ï¼Œè€Œä¸æ˜¯å…±ç”¨ä¸€ä¸ªå¤§çš„çº¿ç¨‹æ± </p><hr><h5 id="5-3-2-3-åŠæ—¶æ­¢æŸ"><a href="#5-3-2-3-åŠæ—¶æ­¢æŸ" class="headerlink" title="5.3.2.3. åŠæ—¶æ­¢æŸ"></a>5.3.2.3. åŠæ—¶æ­¢æŸ</h5><p>åŠæ—¶æ­¢æŸæ˜¯æŒ‡ï¼šå½“é€šè¿‡é™æ—¶é˜»å¡ï¼ˆè¶…æ—¶æœªè·å–ï¼‰æˆ–éé˜»å¡ï¼ˆå°è¯•ä¸€æ¬¡æœªè·å–ï¼‰ç¡®å®šæ‹¿ä¸åˆ°èµ„æºçš„æ—¶å€™ï¼Œä¸å†ç»§ç»­ç­‰å¾…ï¼Œè€Œæ˜¯é‡‡å–ä»¥ä¸‹ç­–ç•¥ï¼š</p><ol><li>å¼‚æ­¥å¤„ç†<ol><li>å¼‚æ­¥ç¼–ç¨‹æˆ–å€ŸåŠ© <code>MQ</code> å®ç° â€œå‰Šå³°å¡«è°·â€</li></ol></li><li>é™çº§å¤„ç†</li><li>å¯åŠ¨å‘Šè­¦</li><li>å¼‚æ­¥ç¼–ç¨‹å›è°ƒ</li></ol><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>å¯èƒ½æ˜¯é™æ—¶é˜»å¡ï¼Œä¹Ÿå¯èƒ½æ˜¯éé˜»å¡ï¼Œè¿˜å¯èƒ½æ˜¯ç›´æ¥ä½¿ç”¨å¼‚æ­¥ç¼–ç¨‹å›è°ƒï¼ˆè¿éé˜»å¡ä¹Ÿä¸ç”¨ï¼Œç›´æ¥ä½¿ç”¨å¼‚æ­¥ç¼–ç¨‹å›è°ƒï¼‰</li></ol></blockquote><hr><h5 id="5-3-2-4-éšæœºé¿è®©"><a href="#5-3-2-4-éšæœºé¿è®©" class="headerlink" title="5.3.2.4. éšæœºé¿è®©"></a>5.3.2.4. éšæœºé¿è®©</h5><p>éšå³é¿è®©æ˜¯æŒ‡ï¼šå½“å¤šä¸ª â€è¯·æ±‚â€œ åŒæ—¶äº‰æŠ¢èµ„æºå¤±è´¥æ—¶ï¼Œä¸è¦ç«‹å³é‡è¯•ï¼Œä¹Ÿä¸è¦ä½¿ç”¨å›ºå®šçš„ä¼‘çœ æ—¶é—´ã€‚æ›´åˆç†çš„åšæ³•æ˜¯é‡‡ç”¨ â€æŒ‡æ•°é€€é¿ + éšæœºæŠ–åŠ¨â€œ çš„ç­–ç•¥ï¼Œé™ä½ç«äº‰å†²çª</p><hr><h5 id="5-3-2-5-è°ƒæ•´ä¼˜å…ˆçº§"><a href="#5-3-2-5-è°ƒæ•´ä¼˜å…ˆçº§" class="headerlink" title="5.3.2.5. è°ƒæ•´ä¼˜å…ˆçº§"></a>5.3.2.5. è°ƒæ•´ä¼˜å…ˆçº§</h5><p>è°ƒæ•´ä¼˜å…ˆçº§æ˜¯æŒ‡ï¼šè°ƒæ•´ç«äº‰æƒé‡ï¼Œè®©æ ¸å¿ƒçš„ â€è¯·æ±‚â€œ æ‹¥æœ‰æ›´é«˜çš„ä¼˜å…ˆçº§</p><p>ä»¥ <code>CPU</code> æ—¶é—´ç‰‡èµ„æºä¸ºä¾‹ï¼Œæˆ‘ä»¬åŠ¨æ€è°ƒæ•´çº¿ç¨‹çš„ä¼˜å…ˆçº§</p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>è™½ç„¶ <code>Java</code> æä¾›äº† <code>Thread#setPriority</code>ï¼Œä½†è¿™é€šå¸¸ä¸æ˜¯ä¸€ä¸ªé è°±çš„è§£å†³æ–¹æ¡ˆï¼Œæ›´å¤šæ—¶å€™æˆ‘ä»¬è¦åå…¶é“è€Œè¡Œä¹‹ï¼šå°½é‡ä¸è¦ä¿®æ”¹çº¿ç¨‹çš„ä¼˜å…ˆçº§ï¼Œè®©æ‰€æœ‰çº¿ç¨‹çš„ä¼˜å…ˆçº§ä¿æŒåŒç­‰æ°´å¹³</li></ol></blockquote><hr><h2 id="8-çº¿ç¨‹ç›¸å…³å¸¸ç”¨æ–¹æ³•"><a href="#8-çº¿ç¨‹ç›¸å…³å¸¸ç”¨æ–¹æ³•" class="headerlink" title="8. çº¿ç¨‹ç›¸å…³å¸¸ç”¨æ–¹æ³•"></a>8. çº¿ç¨‹ç›¸å…³å¸¸ç”¨æ–¹æ³•</h2><p>çº¿ç¨‹ç›¸å…³çš„å¸¸ç”¨æ–¹æ³•ä¸»è¦åŒ…æ‹¬ï¼š</p><ol><li><code>Thread</code> ä¸­çš„ä¸€äº›çš„æ–¹æ³•</li><li><code>TimeUnit</code> ä¸­çš„ä¸€äº›æ–¹æ³•<ol><li><code>TimeUnit#sleep</code></li><li><code>TimeUnit#timedJoin</code></li><li><code>TimeUnit#timedWait</code></li></ol></li><li><code>Object</code> ä¸­çš„ä¸€äº›æ–¹æ³•<ol><li><code>Object#wait</code></li><li><code>Object#notify</code></li></ol></li><li><code>LockSupport</code> ä¸­çš„ä¸€äº›æ–¹æ³•</li></ol><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>è¯¦è§æºç ï¼š<code>Thread</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.Thread%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.lang.Threadæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/11/12/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.Thread%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/12/æºç ï¼šjava.lang.Threadæºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>Object</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.Object%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.lang.Objectæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/09/24/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.Object%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/09/24/æºç ï¼šjava.lang.Objectæºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>LockSupport</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.LockSupport%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.locks.LockSupportæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/11/13/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.LockSupport%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/13/æºç ï¼šjava.util.concurrent.locks.LockSupportæºç è§£æ/</a></li></ol></li></ol></li></ol></blockquote><hr><h1 id="å››ã€ThreadLocal"><a href="#å››ã€ThreadLocal" class="headerlink" title="å››ã€ThreadLocal"></a>å››ã€ThreadLocal</h1><p><code>ThreadLocal</code> æ˜¯æŒ‡ï¼š<code>Thread-&gt;threadLocals</code>ï¼Œç”¨äºè®°å½•è¯¥ <code>Thread</code> å®ä¾‹ç‹¬å±çš„ä¸€äº›ä¿¡æ¯ã€‚è€Œ <code>Thread-&gt;threadLocals</code> åˆæ˜¯ <code>ThreadLocal.ThreadLocalMap</code> ç±»å‹ï¼Œè¯¦è§æºç ï¼š<code>ThreadLocal&lt;T&gt;.ThreadLocalMap</code>ï¼ˆ<code>obsidian</code> å†…éƒ¨è¿æ¥ï¼š<a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.ThreadLocal%EF%BC%9CT%EF%BC%9E.ThreadLocalMap%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.lang.ThreadLocalï¼œTï¼.ThreadLocalMapæºç è§£æ</a>ï¼Œ<code>Hexo</code> é“¾æ¥ï¼š <a href="http://blog.wangjia.ink/2025/11/16/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.ThreadLocal%EF%BC%9CT%EF%BC%9E.ThreadLocalMap%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/16/æºç ï¼šjava.lang.ThreadLocalï¼œTï¼.ThreadLocalMapæºç è§£æ/</a> ï¼‰</p><hr><h1 id="äº”ã€é”"><a href="#äº”ã€é”" class="headerlink" title="äº”ã€é”"></a>äº”ã€é”</h1><h2 id="1-é”åŸºç¡€ä½“ç³»"><a href="#1-é”åŸºç¡€ä½“ç³»" class="headerlink" title="1. é”åŸºç¡€ä½“ç³»"></a>1. é”åŸºç¡€ä½“ç³»</h2><p><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJUC/%E7%AC%94%E8%AE%B0%EF%BC%9AJUC-2.png"></p><ol><li>è¯¦è§æºç ï¼š<code>Serializable</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.io.Serializable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.io.Serializableæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/10/28/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.io.Serializable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/10/28/æºç ï¼šjava.io.Serializableæºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>Lock</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.Lock%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.locks.Lockæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/11/07/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.Lock%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/07/æºç ï¼šjava.util.concurrent.locks.Lockæºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>ReadWriteLock</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.ReadWriteLock%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.locks.ReadWriteLockæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/11/07/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.ReadWriteLock%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/07/æºç ï¼šjava.util.concurrent.locks.ReadWriteLockæºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>Condition</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.Condition%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.locks.Conditionæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/08/31/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.Condition%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/08/31/æºç ï¼šjava.util.concurrent.locks.Conditionæºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>AbstractOwnableSynchronizer</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractOwnableSynchronizer%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.locks.AbstractOwnableSynchronizeræºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/09/02/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractOwnableSynchronizer%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/09/02/æºç ï¼šjava.util.concurrent.locks.AbstractOwnableSynchronizeræºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>AbstractQueuedSynchronizer</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedSynchronizer%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.locks.AbstractQueuedSynchronizeræºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/09/01/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedSynchronizer%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/09/01/æºç ï¼šjava.util.concurrent.locks.AbstractQueuedSynchronizeræºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>AbstractQueuedLongSynchronizer</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedLongSynchronizer%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.locks.AbstractQueuedLongSynchronizeræºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/11/19/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedLongSynchronizer%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/19/æºç ï¼šjava.util.concurrent.locks.AbstractQueuedLongSynchronizeræºç è§£æ/</a></li></ol></li></ol></li></ol><hr><h2 id="2-synchronized"><a href="#2-synchronized" class="headerlink" title="2. synchronized"></a>2. synchronized</h2><h3 id="2-1-synchronized-å‰ç½®åŸºç¡€"><a href="#2-1-synchronized-å‰ç½®åŸºç¡€" class="headerlink" title="2.1. synchronized å‰ç½®åŸºç¡€"></a>2.1. synchronized å‰ç½®åŸºç¡€</h3><h4 id="2-1-1-Java-å¯¹è±¡å¤´"><a href="#2-1-1-Java-å¯¹è±¡å¤´" class="headerlink" title="2.1.1. Java å¯¹è±¡å¤´"></a>2.1.1. Java å¯¹è±¡å¤´</h4><p>é€šå¸¸æˆ‘ä»¬çš„ä¸€ä¸ª <code>Java</code> å®ä¾‹ï¼Œä»–åœ¨å †å†…å­˜ä¸­ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼š</p><ol><li><code>Java</code> å¯¹è±¡å¤´ï¼ˆ<code>Object Header</code>ï¼‰</li><li>å®ä¾‹æ•°æ®ï¼ˆ<code>Instance Data</code>ï¼‰</li><li>å¯¹é½å¡«å……ï¼ˆ<code>Padding</code>ï¼‰</li></ol><p>ä»¥ <code>32</code> ä½è™šæ‹Ÿæœºä¸ºä¾‹ï¼š<br><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJUC/%E7%AC%94%E8%AE%B0%EF%BC%9AJUC-3.png"></p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>è¿™é‡Œçš„ <code>Klass Word</code> åº”è¯¥å«åš <code>Klass Pointer</code></li></ol></blockquote><hr><h3 id="2-2-synchronized-æ¦‚è¿°"><a href="#2-2-synchronized-æ¦‚è¿°" class="headerlink" title="2.2. synchronized æ¦‚è¿°"></a>2.2. synchronized æ¦‚è¿°</h3><p><code>synchronized</code> æ˜¯ä¸€ç§å¯é‡å…¥ã€æ‚²è§‚ã€éå…¬å¹³ã€äº’æ–¥çš„é”</p><hr><h3 id="2-3-synchronized-ä½¿ç”¨æ–¹å¼"><a href="#2-3-synchronized-ä½¿ç”¨æ–¹å¼" class="headerlink" title="2.3. synchronized ä½¿ç”¨æ–¹å¼"></a>2.3. synchronized ä½¿ç”¨æ–¹å¼</h3><p>ä»¥å¦‚ä¸‹ä»£ç ä¸ºä¾‹ï¼Œå¦‚æœ <code>Room#increment</code> ç«äº‰åˆ°äº†é”ï¼Œé‚£ä¹ˆ <code>Room#decrement</code>ã€<code>Room#getCounter</code> éƒ½æ— æ³•å†ç«äº‰åˆ°é”</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Room</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">counter</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment</span><span class="hljs-params">()</span> &#123;<br>        counter++;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">decrement</span><span class="hljs-params">()</span> &#123;<br>        counter--;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getCounter</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> counter;<br>    &#125;<br>    <br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>å½“æˆ‘ä»¬ä¸ºé™æ€å…·ä½“æ–¹æ³•åŠ ä¸Š <code>synchronized</code> ä¿®é¥°ç¬¦ï¼Œé”çš„æ˜¯ç±»å¯¹è±¡ï¼ˆå³ <code>Class</code> å¯¹è±¡ï¼‰</li></ol></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// åŸå†™æ³•</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment</span><span class="hljs-params">()</span> &#123;<br>counter++;<br>&#125;<br><br><br><span class="hljs-comment">// ç­‰ä»·å†™æ³•</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-keyword">synchronized</span> (Room.Class) &#123;<br>counter++;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹<br>2. å½“æˆ‘ä»¬ä¸ºå®ä¾‹æ™®é€šæ–¹æ³•åŠ ä¸Š <code>synchronized</code> ä¿®é¥°ç¬¦ï¼Œé”çš„æ˜¯ä»…æ˜¯å½“å‰å¯¹è±¡ï¼ˆå³ <code>this</code>ï¼‰</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// åŸå†™æ³•</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment</span><span class="hljs-params">()</span> &#123;<br>counter++;<br>&#125;<br><br><br><span class="hljs-comment">// ç­‰ä»·å†™æ³•</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-keyword">synchronized</span> (<span class="hljs-built_in">this</span>) &#123;<br>counter++;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹<br>3. æ™®é€šå®ä¾‹æ–¹æ³•å¹¶ä¸å¿…ç„¶åªèƒ½é”å½“å‰å¯¹è±¡ (<code>this</code>)ï¼Œé™æ€æ–¹æ³•ä¹Ÿå¹¶éåªèƒ½é”ç±»å¯¹è±¡ï¼ˆ<code>Class</code> å¯¹è±¡ï¼‰</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-keyword">synchronized</span> (<span class="hljs-built_in">this</span>) &#123;<br>counter++;<br>&#125;<br>&#125;<br><br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-keyword">synchronized</span> (Room.class) &#123;<br>counter++;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹<br>4. ä»¥å¦‚ä¸‹ä»£ç ä¸ºä¾‹ï¼Œè™½ç„¶ <code>Room#sleep</code> å’Œ <code>Room#study</code> æœ¬èº«æ²¡æœ‰é€»è¾‘ä¸Šçš„äº¤é›†ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¼•å…¥å¤šæŠŠé”æ¥è¿›è¡Œä¼˜åŒ–ï¼š</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// åŸä»£ç </span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Room</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sleep</span><span class="hljs-params">()</span> &#123;<br>System.out.println(<span class="hljs-string">&quot;sleeping 2 å°æ—¶&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">study</span><span class="hljs-params">()</span> &#123;<br>System.out.println(<span class="hljs-string">&quot;study 1 å°æ—¶&quot;</span>);<br>    &#125;<br>    <br>&#125;<br><br><br><span class="hljs-comment">// å¼•å…¥å¤šæŠŠé”è¿›è¡Œä¼˜åŒ–</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Room</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Object</span> <span class="hljs-variable">studyRoom</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();<br>    <br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Object</span> <span class="hljs-variable">bedRoom</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sleep</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">synchronized</span> (bedRoom) &#123;<br>            System.out.println(<span class="hljs-string">&quot;sleeping 2 å°æ—¶&quot;</span>);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">study</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">synchronized</span> (studyRoom) &#123;<br>            System.out.println(<span class="hljs-string">&quot;study 1 å°æ—¶&quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹<br>5. å³ä¾¿ä¸€ä¸ªæ–¹æ³•ä¸­ï¼Œåªæ¶‰åŠåˆ°äº†å…±äº«å˜é‡çš„è¯»æ“ä½œï¼Œæˆ‘ä»¬ä»ç„¶è¦ä¸ºå…¶åŠ é”ã€‚è¿™ä¸»è¦æ˜¯ä¸ºäº†å…¶å¯è§æ€§ã€åŸå­æ€§ã€‚å¯è§æ€§å¯ä»¥é€šè¿‡å¤šç§æ–¹å¼æ¥ä¿è¯ï¼Œå› æ­¤å¹¶ä¸ä¸€å®šéœ€è¦åŠ é”ã€‚ä½†åŸå­æ€§å¿…é¡»ä¾èµ–é”æ¥ç¡®ä¿ï¼Œé¿å… <code>B</code> çº¿ç¨‹åœ¨è¿›è¡Œè¯»æ“ä½œæ—¶ï¼Œ<code>A</code> çº¿ç¨‹è¿›è¡Œå†™æ“ä½œï¼Œä»æ ¹æœ¬ä¸Šæœç»è„è¯»ã€ä¸å¯é‡å¤è¯»ã€å¹»è¯»ç­‰é—®é¢˜<br>6. å¯¹äº <code>synchronized</code> çš„æœ¬è´¨ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•çš„ç†è§£ä¸ºï¼šé€šè¿‡ä¸ºæŸå¯¹è±¡æˆ–æŸç±»å¯¹è±¡çš„åŠ é”ï¼Œä»è€Œæ§åˆ¶å¤šçº¿ç¨‹å¯¹å…±äº«èµ„æºçš„è¯»å†™æ“ä½œ</p></blockquote><hr><h3 id="2-4-synchrnoized-é”å‡çº§"><a href="#2-4-synchrnoized-é”å‡çº§" class="headerlink" title="2.4. synchrnoized é”å‡çº§"></a>2.4. synchrnoized é”å‡çº§</h3><p>é”å‡çº§çš„æµç¨‹ä¸ºï¼š<code>åå‘é” â” è½»é‡çº§é” â” é‡é‡çº§é”</code></p><h4 id="2-4-1-åå‘é”"><a href="#2-4-1-åå‘é”" class="headerlink" title="2.4.1. åå‘é”"></a>2.4.1. åå‘é”</h4><p>åå‘é”çš„è®¾è®¡åˆè¡·ï¼Œæ˜¯åœ¨æ— ç«äº‰åœºæ™¯ä¸‹è¿›ä¸€æ­¥é™ä½ç«äº‰é”çš„å¼€é”€ï¼Œä»è€Œæå‡é”æ“ä½œçš„æ€§èƒ½</p><p>å½“æŸçº¿ç¨‹ï¼ˆä¾‹å¦‚ $T_1$ï¼‰ è¦å»æ‰§è¡Œä¸´ç•ŒåŒºä»£ç ï¼Œ<code>JVM</code> ä¼šé€šè¿‡ <code>CAS</code> å°è¯•å°† $T_1$ çš„ <code>Thread ID</code> å†™å…¥è¢«åŠ é”å¯¹è±¡æˆ–è¢«åŠ é”ç±»å¯¹è±¡çš„å¯¹è±¡å¤´ä¸­çš„ <code>Mark Word</code> ä¸­ã€‚</p><p>å¦‚æœå†™å…¥æˆåŠŸï¼Œ $T_1$ é¡ºåˆ©æ‰§è¡Œä¸´ç•ŒåŒºä»£ç ã€‚å¦‚æœ $T_1$ åç»­å†æ¬¡æ‰§è¡Œä¸´ç•ŒåŒºä»£ç ï¼Œåªéœ€æ£€æŸ¥ <code>Mark Word</code> ä¸­çš„ <code>Thread ID</code> æ˜¯å¦ä¸è‡ªèº«ä¸€è‡´ï¼ˆç”±äºåå‘é”åœ¨é‡Šæ”¾æ—¶å¹¶ä¸ä¼šä¸»åŠ¨é‡ç½®å¯¹è±¡å¤´ï¼Œå› æ­¤åœ¨æ— ç«äº‰åœºæ™¯ä¸‹ï¼Œ<code>Mark Word</code> ä¸­ä¾æ—§ä¿ç•™ç€ $T_1$ çš„ <code>Thread ID</code>ï¼Œæ‰€ä»¥èƒ½ç›´æ¥æ‰§è¡Œï¼‰</p><p>å¦‚æœå†™å…¥å¤±è´¥ï¼Œåˆ™æ˜¯å…¶ä»–çº¿ç¨‹ï¼ˆä¾‹å¦‚ $T_2$ï¼‰æ­£åœ¨æŒæœ‰åå‘é”ï¼ˆæ— è®º $T_2$ æ˜¯å¦åœ¨æ‰§è¡Œä¸´ç•ŒåŒºä»£ç ï¼‰ï¼Œè€Œè¿™å°±å‘ç”Ÿäº†ç«äº‰ï¼Œåå‘é”æ¨¡å¼å°±ä¼šå®£å‘Šå¤±è´¥ã€‚æ­¤æ—¶ <code>JVM</code> ä¼šå°†åå‘é”å‡çº§ä¸ºè½»é‡çº§é”</p><p>æˆ‘ä»¬å¯ä»¥ç®€å•çš„ç†è§£ä¸ºï¼šä¸€æ—¦æŸä¸ªçº¿ç¨‹æŒæœ‰äº†åå‘é”ï¼Œå®ƒå°± â€œåå‘â€ è¿™ä¸ªçº¿ç¨‹ï¼Œä»å¤´åˆ°å°¾éƒ½åªè®¤å®ƒï¼Œæ— è®ºè¯¥çº¿ç¨‹æ˜¯å¦åœ¨æ‰§è¡Œä¸´ç•ŒåŒºä»£ç ã€‚ä½†æ˜¯ä¸€æ—¦å‡ºç°ç¬¬äºŒä¸ªçº¿ç¨‹å°è¯•ç«äº‰é”ï¼Œåå‘é”å°±ä¼šè¢«æ’¤é”€å¹¶å‡çº§ä¸ºè½»é‡çº§é”</p><p>ç„¶è€Œï¼Œéšç€ç¡¬ä»¶æ€§èƒ½æå‡å’Œè™šæ‹Ÿæœºå…¶ä»–ä¼˜åŒ–æ‰‹æ®µçš„å‘å±•ï¼Œåå‘é”å¸¦æ¥çš„æ€§èƒ½æ”¶ç›Šå·²é€æ¸å‡å¼±ï¼ŒåŒæ—¶å…¶å®ç°çš„å¤æ‚æ€§ä¹Ÿæˆä¸ºé˜»ç¢ <code>JVM</code> è¿›ä¸€æ­¥ä¼˜åŒ–çš„è´Ÿæ‹…ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œåœ¨é«˜å¹¶å‘åœºæ™¯ä¸­ï¼Œåå‘é”æ’¤é”€çš„å¼€é”€å¾€å¾€å¤§äºå…¶å¸¦æ¥çš„æ”¶ç›Šã€‚å› æ­¤ï¼Œ<code>Oracle</code> åœ¨ <code>Java15</code> ä¹‹åå°†åå‘é”æ ‡è®°ä¸ºåºŸå¼ƒï¼Œå¹¶åœ¨ <code>Java17</code> ä¸­å°†å…¶å½»åº•ç§»é™¤ã€‚</p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>å¦‚æœä½¿ç”¨çš„æ˜¯ <code>Java8</code>ï¼Œåå‘é”é»˜è®¤æ˜¯å¼€å¯çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>JVM</code> å¯åŠ¨å‚æ•°æ¥å…³é—­åå‘é”</li></ol></blockquote><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby">-<span class="hljs-variable constant_">XX</span><span class="hljs-symbol">:-UseBiasedLocking</span><br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹<br>2. ç”±äº <code>Mark Word</code> çš„ç©ºé—´æ˜¯æœ‰é™çš„ï¼Œå­˜å‚¨äº† <code>HashCode</code> å°±æ²¡åœ°æ–¹å­˜ <code>Thread ID</code> äº†ã€‚å› æ­¤ï¼Œå¦‚æœåœ¨æ— é”çŠ¶æ€è®¡ç®—äº† <code>HashCode</code>ï¼Œå°±æ— æ³•å†ä½¿ç”¨åå‘é”ï¼Œè€Œæ˜¯ç›´æ¥ä½¿ç”¨è½»é‡çº§é”ã€‚å¦‚æœåœ¨æŒæœ‰åå‘é”æ—¶è®¡ç®—äº† <code>HashCode</code>ï¼Œåå‘é”ä¼šè¢«ç«‹å³æ’¤é”€ï¼Œå¹¶ç›´æ¥å‡çº§ä¸ºé‡é‡çº§é”ï¼ˆå› ä¸ºé‡é‡çº§é”çš„ <code>Monitor</code> ä¸­å¯ä»¥å­˜å‚¨ <code>HashCode</code>ï¼‰</p></blockquote><hr><h4 id="2-4-2-è½»é‡çº§é”"><a href="#2-4-2-è½»é‡çº§é”" class="headerlink" title="2.4.2. è½»é‡çº§é”"></a>2.4.2. è½»é‡çº§é”</h4><p>è½»é‡çº§é”çš„è®¾è®¡åˆè¡·ï¼Œæ˜¯åœ¨è½»é‡ç«äº‰åœºæ™¯ä¸‹è¿›ä¸€æ­¥é™ä½ç«äº‰é”çš„å¼€é”€ï¼Œä»è€Œæå‡é”æ“ä½œçš„æ€§èƒ½</p><p>å½“æŸçº¿ç¨‹ï¼ˆä¾‹å¦‚ $T_1$ï¼‰è¦å»æ‰§è¡Œä¸´ç•ŒåŒºä»£ç ï¼Œ<code>JVM</code> ä¼šåœ¨ $T_1$ çš„è™šæ‹Ÿæœºæ ˆçš„æ ˆå¸§ä¸­åˆ›å»ºä¸€ä¸ªé”è®°å½•ï¼ˆ<code>Lock Record</code>ï¼‰<br><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJUC/%E7%AC%94%E8%AE%B0%EF%BC%9AJUC-4.png"></p><p>ç„¶å <code>JVM</code> å°† <code>Lock Record</code> çš„ <code>Object reference</code> æŒ‡å‘è¢«åŠ é”å¯¹è±¡æˆ–è¢«åŠ é”ç±»å¯¹è±¡ï¼Œå¹¶ä¸”é€šè¿‡ <code>CAS</code> å°è¯•å°† <code>Lock Record</code> çš„ <code>lock record</code> åœ°å€ <code>00</code> ä¸è¢«åŠ é”å¯¹è±¡æˆ–è¢«åŠ é”ç±»å¯¹è±¡çš„ <code>MarkWord</code>ï¼ˆå³ <code>Hashcode Age Bias 01</code>ï¼‰è¿›è¡Œäº¤æ¢</p><p>å¦‚æœäº¤æ¢æˆåŠŸï¼Œ $T_1$ é¡ºåˆ©æ‰§è¡Œä¸´ç•ŒåŒºä»£ç ã€‚å¦‚æœåœ¨ $T_1$ æ‰§è¡Œä¸´ç•ŒåŒºä»£ç æ—¶å‘ç”Ÿäº†é‡å…¥ï¼ŒåŒæ ·ä¼šæ·»åŠ æ–°çš„ <code>Lock Record</code>ã€‚$T_1$ çš„è™šæ‹Ÿæœºæ ˆçš„æ ˆå¸§ä¸­æœ‰å¤šå°‘ä¸ª <code>Lock Record</code>ï¼Œè¯´æ˜å‘ç”Ÿäº†å¤šå°‘æ¬¡é‡å…¥<br><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJUC/%E7%AC%94%E8%AE%B0%EF%BC%9AJUC-5.png"></p><p>å½“ $T_1$ æ‰§è¡Œå®Œä¸´ç•ŒåŒºçš„ä»£ç ï¼Œ<code>JVM</code> ä¼šå°†ä¸¤è€…å†äº¤æ¢å›æ¥<br><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJUC/%E7%AC%94%E8%AE%B0%EF%BC%9AJUC-6.png"></p><p>å¦‚æœäº¤æ¢å¤±è´¥ï¼Œåˆ™æ˜¯å…¶ä»–çº¿ç¨‹ï¼ˆä¾‹å¦‚ $T_2$ï¼‰æŒæœ‰è½»é‡çº§é”ï¼Œé‚£ä¹ˆ $T_1$ ä¼šè¿›è¡Œå¤šæ¬¡è‡ªæ—‹ã€‚å¦‚æœå¤šæ¬¡è‡ªæ—‹ä»çƒ­æœªæˆåŠŸï¼Œ<code>JVM</code> ä¼šå°†è½»é‡çº§é”å‡çº§ä¸ºé‡é‡çº§é”<br><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJUC/%E7%AC%94%E8%AE%B0%EF%BC%9AJUC-7.png"></p><hr><h4 id="2-4-3-é‡é‡çº§é”"><a href="#2-4-3-é‡é‡çº§é”" class="headerlink" title="2.4.3. é‡é‡çº§é”"></a>2.4.3. é‡é‡çº§é”</h4><p>ç›‘è§†å™¨ï¼ˆ<code>Monitor</code>ã€ç®¡ç¨‹ï¼‰æ˜¯ <code>JVM</code> å†…éƒ¨ä¸“é—¨ç”¨äºå®ç°é‡é‡çº§é”çš„ç»“æ„ã€‚å½“å‡çº§ä¸ºé‡é‡çº§é”æ—¶ï¼Œ<code>JVM</code> ä¼šä¸ºè¢«åŠ é”å¯¹è±¡æˆ–è¢«åŠ é”ç±»å¯¹è±¡åˆ›å»ºä¸€ä¸ª <code>Monitor</code> å¯¹è±¡<br><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJUC/%E7%AC%94%E8%AE%B0%EF%BC%9AJUC-8.png"></p><p>å½“ $T_1$ æ‰§è¡Œå®Œä¸´ç•ŒåŒºä»£ç åï¼Œä¼šæ ¹æ®çº¿ç¨‹ä¸­ä¿å­˜çš„æŒ‡å‘è¢«åŠ é”å¯¹è±¡æˆ–è¢«åŠ é”ç±»å¯¹è±¡çš„åœ°å€ï¼Œæ‰¾åˆ°è¯¥å¯¹è±¡æˆ–ç±»å¯¹è±¡ï¼Œç„¶åå†æ ¹æ®è¯¥å¯¹è±¡çš„å¯¹è±¡å¤´çš„ <code>Mark Word</code> æ‰¾åˆ° <code>Monitor</code>ï¼Œå°†å…¶ <code>Owner</code> è®¾ç½®ä¸º <code>null</code>ï¼Œå¹¶å”¤é†’ <code>Monitor</code> ä¸­ <code>EntryList</code> ä¸­æ‰€æœ‰ç­‰å¾…çš„çº¿ç¨‹ï¼Œè¿™äº›çº¿ç¨‹éšåå¼€å§‹ç«äº‰é‡é‡çº§é”ï¼ˆ <code>Monitor</code> çš„ <code>Owner</code>ï¼‰</p><hr><h2 id="3-ReentrantLock"><a href="#3-ReentrantLock" class="headerlink" title="3. ReentrantLock"></a>3. ReentrantLock</h2><p>è¯¦è§æºç ï¼š<code>ReentrantLock</code></p><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.ReentrantLock%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.locks.ReentrantLockæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/08/31/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.ReentrantLock%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/08/31/æºç ï¼šjava.util.concurrent.locks.ReentrantLockæºç è§£æ/</a></li></ol></li></ol><hr><h2 id="4-ReentrantReadWriteLock"><a href="#4-ReentrantReadWriteLock" class="headerlink" title="4. ReentrantReadWriteLock"></a>4. ReentrantReadWriteLock</h2><p>è¯¦è§æºç ï¼š<code>ReentrantReadWriteLock</code></p><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.ReentrantReadWriteLock%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.locks.ReentrantReadWriteLockæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/11/09/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.ReentrantReadWriteLock%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/09/æºç ï¼šjava.util.concurrent.locks.ReentrantReadWriteLockæºç è§£æ/</a></li></ol></li></ol><hr><h2 id="5-CAS"><a href="#5-CAS" class="headerlink" title="5. CAS"></a>5. CAS</h2><h3 id="5-1-CAS-æ¦‚è¿°"><a href="#5-1-CAS-æ¦‚è¿°" class="headerlink" title="5.1. CAS æ¦‚è¿°"></a>5.1. CAS æ¦‚è¿°</h3><p><code>CAS</code> æ˜¯ä¸€ç§æ€æƒ³ï¼Œå…¶æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šå½“å‰çº¿ç¨‹åœ¨è¿›è¡Œå†™æ“ä½œæ—¶ï¼Œå½“ <code>V = E</code> æ—¶ï¼Œä¿®æ”¹ä¸º <code>N</code>ã€‚å½“ <code>V â‰  E</code> æ—¶ï¼Œä¸è¿›è¡Œä»»ä½•æ“ä½œã€‚å…¶ä¸­ <code>V</code>ã€<code>E</code>ã€<code>N</code> æ˜¯æŒ‡ï¼š</p><ol><li><code>V</code>ï¼ˆ<code>Current Value</code>ï¼‰<ol><li>å½“å‰çº¿ç¨‹åœ¨è¿›è¡Œå†™æ“ä½œæ—¶ï¼Œå…±äº«å˜é‡åœ¨ä¸»å†…å­˜ä¸­çš„å®é™…å€¼</li></ol></li><li><code>E</code>ï¼ˆ<code>Expected Value</code>ï¼‰<ol><li>å½“å‰çº¿ç¨‹åœ¨è¿›è¡Œå†™æ“ä½œæ—¶ï¼ŒæœŸæœ›å…±äº«å˜é‡åœ¨ä¸»å†…å­˜ä¸­çš„å®é™…å€¼</li><li>ç®€å•æ¥è¯´å°±æ˜¯ï¼š$t_1$ æ—¶ä»ä¸»å†…å­˜æ‹¿åˆ°çš„å…±äº«å˜é‡ï¼Œæˆ‘ä»¬æœŸæœ› $t_2$ æ—¶ä¸»å†…å­˜ä¸­çš„å…±äº«å˜é‡ä»ç„¶æ˜¯è¿™ä¸ªå€¼</li></ol></li><li><code>N</code>ï¼ˆ<code>New Value</code>ï¼‰<ol><li>å½“å‰çº¿ç¨‹åœ¨è¿›è¡Œå†™æ“ä½œæ—¶ï¼Œè¦æŠŠå…±äº«å˜é‡ä¿®æ”¹ä¸ºè¯¥å€¼</li></ol></li></ol><p>ä¸ºäº†å®ç° <code>CAS</code> æ€æƒ³ï¼Œä¸åŒçš„ <code>CPU</code> å‚å•†æä¾›äº†ä¸åŒçš„åŸå­æ€§çš„æœºå™¨ç æŒ‡ä»¤ï¼ˆä¾‹å¦‚ <code>x86</code> æ˜¯ <code>CMPXCHG</code>ï¼Œ<code>ARM</code> æ˜¯ <code>LDXR/STXR</code> ç»„åˆï¼‰ï¼Œæˆ‘ä»¬ä¸€èˆ¬æŠŠè¿™äº›æœºå™¨ç æŒ‡ä»¤ç§°ä¹‹ä¸º â€œ<code>CAS</code> æŒ‡ä»¤â€</p><p>åœ¨æ—¥å¸¸äº¤æµä¸­ï¼Œæˆ‘ä»¬å¸¸æŠŠæŠŠ <code>CAS</code> å’Œ <code>CAS</code> æŒ‡ä»¤æ··ä¸ºä¸€è°ˆã€‚åœ¨ <code>Java</code> ä¸­ï¼Œè¯´åˆ° â€œä½¿ç”¨ <code>CAS</code>â€ï¼Œå…¶å®å°±æ˜¯é€šè¿‡ <code>Unsafe</code> è°ƒç”¨äº† <code>CAS</code> æŒ‡ä»¤</p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li><code>CAS</code> æœ¬è´¨ä¸Šå¹¶ä¸æ˜¯ä¸€ç§é”ï¼Œè€Œæ˜¯ä¸€ç§æ›´æ–°æœºåˆ¶</li><li>è™½ç„¶ <code>V</code> è¯´æ˜¯ â€å½“å‰çº¿ç¨‹åœ¨è¿›è¡Œå†™æ“ä½œæ—¶ï¼Œå…±äº«å˜é‡åœ¨ä¸»å†…å­˜ä¸­çš„å®é™…å€¼â€œï¼Œä½†æ˜¯ç”±äº <code>JMM</code> çš„å­˜åœ¨ï¼Œæˆ‘ä»¬å¯èƒ½ä»ä»å·¥ä½œå†…å­˜è¯» <code>V</code>ï¼Œæ‰€ä»¥æœ‰å¯è§æ€§é—®é¢˜ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰æœ‰åºæ€§é—®é¢˜ã€‚å› æ­¤å³ä¾¿ä½¿ç”¨ <code>CAS</code>ï¼Œé€šå¸¸ç»“åˆ <code>volatile</code> ä¿®é¥°ç¬¦ä½¿ç”¨ï¼Œ<code>CAS</code> ä¿è¯åŸå­æ€§ï¼Œ<code>volatile</code> ä¿è¯å¯è§æ€§ã€é¡ºåºæ€§</li><li>å½“æˆ‘ä»¬ä½¿ç”¨ <code>CAS</code> æ—¶ï¼Œç›®æ ‡è‚¯å®šæ˜¯å¸Œæœ›å†™æ“ä½œæˆåŠŸã€‚æ‰€ä»¥æˆ‘ä»¬é€šå¸¸ä¼šå¾ªç¯æ‰§è¡Œ <code>CAS</code>ï¼Œç›´åˆ°å†™æ“ä½œæˆåŠŸ</li></ol></blockquote><hr><h3 id="5-2-CAS-é—®é¢˜çˆ†ç ´"><a href="#5-2-CAS-é—®é¢˜çˆ†ç ´" class="headerlink" title="5.2. CAS é—®é¢˜çˆ†ç ´"></a>5.2. CAS é—®é¢˜çˆ†ç ´</h3><h4 id="5-2-1-ABA-é—®é¢˜"><a href="#5-2-1-ABA-é—®é¢˜" class="headerlink" title="5.2.1. ABA é—®é¢˜"></a>5.2.1. ABA é—®é¢˜</h4><h5 id="5-2-1-1-ABA-é—®é¢˜æ¦‚è¿°"><a href="#5-2-1-1-ABA-é—®é¢˜æ¦‚è¿°" class="headerlink" title="5.2.1.1. ABA é—®é¢˜æ¦‚è¿°"></a>5.2.1.1. ABA é—®é¢˜æ¦‚è¿°</h5><p><code>ABA</code> é—®é¢˜æ˜¯æŒ‡ï¼šå½“ <code>V = E</code> æ—¶ï¼Œå°½ç®¡ <code>CAS</code> æ“ä½œæˆåŠŸäº†ï¼Œä½†å®é™…ä¸Šè¯¥ä½ç½®çš„æ•°æ®å¯èƒ½æ›¾ç»å‘ç”Ÿè¿‡å˜åŒ–ã€‚ä¾‹å¦‚æˆ‘ä»¬æ¡Œå­ä¸Šæœ‰ä¸€æ¯æ°´ï¼ˆ<code>A</code>ï¼‰ï¼Œä½ ç¦»å¼€äº†ä¸€ä¼šå„¿ã€‚æœŸé—´åˆ«äººæŠŠä½ æ¯å­é‡Œçš„æ°´å–äº†ï¼ˆå˜æˆ <code>B</code>ï¼‰ï¼Œç„¶ååˆé‡æ–°å€’æ»¡æ°´ï¼ˆå˜å› <code>A</code>ï¼‰ã€‚ç­‰ä½ å›æ¥æ—¶ï¼Œçœ‹åˆ°æ°´è¿˜æ˜¯æ»¡çš„ï¼Œä½ ä»¥ä¸ºæ²¡äººåŠ¨è¿‡ï¼Œä½†å®é™…ä¸Šé‡Œé¢çš„æ°´å·²ç»å˜äº†</p><p>å¾ˆå¤šæ—¶å€™ <code>ABA</code> é—®é¢˜å¯èƒ½æ— ä¼¤å¤§é›…ã€‚ä½†æ˜¯åœ¨ä¸€äº›ä¸šåŠ¡é€»è¾‘æ—¶ï¼Œè¿™ä¸ªé—®é¢˜å¯èƒ½æ˜¯è‡´å‘½çš„</p><hr><h5 id="5-2-1-2-ABA-é—®é¢˜è§£å†³æ–¹æ¡ˆ"><a href="#5-2-1-2-ABA-é—®é¢˜è§£å†³æ–¹æ¡ˆ" class="headerlink" title="5.2.1.2. ABA é—®é¢˜è§£å†³æ–¹æ¡ˆ"></a>5.2.1.2. ABA é—®é¢˜è§£å†³æ–¹æ¡ˆ</h5><h6 id="5-2-1-2-1-ç‰ˆæœ¬å·"><a href="#5-2-1-2-1-ç‰ˆæœ¬å·" class="headerlink" title="5.2.1.2.1. ç‰ˆæœ¬å·"></a>5.2.1.2.1. ç‰ˆæœ¬å·</h6><p>ç‰ˆæœ¬å·æ˜¯æŒ‡ï¼šä¸ä»…æ¯”è¾ƒå€¼ï¼ˆå³ <code>V = E</code>ï¼‰ï¼Œè¿˜è¦æ¯”è¾ƒç‰ˆæœ¬å·ã€‚å³ $CAS(E, N)â”CAS(E + Version_E, B + Version_B)$ï¼Œå½“çº¿ç¨‹åœ¨è¿›è¡Œå†™æ“ä½œæ—¶ï¼Œä¸ä»…è¦ <code>V = E</code>ï¼Œè¿˜è¦ $Version_V&#x3D;Version_E$</p><p>è€Œ <code>AtomicStampedReference</code> å°±é‡‡ç”¨äº†è¿™ç§æ–¹å¼è§£å†³äº† <code>ABA</code> é—®é¢˜ã€‚</p><p>é™¤æ­¤ä¹‹å¤–ï¼Œ<code>AtomicMarkableReference</code> å¯ä»¥çœ‹ä½œæ˜¯ <code>AtomicStampedReference</code> çš„ç®€åŒ–ç‰ˆï¼Œä½†æ˜¯å®ƒå¹¶æ²¡æœ‰ä¸¥æ ¼ä½¿ç”¨ç‰ˆæœ¬å·ã€‚<code>AtomicMarkableReference</code> æ˜¯ä¸ºäº†è§£å†³ â€œå¾ˆå¤šæ—¶å€™æˆ‘ä»¬å¹¶ä¸éœ€è¦çŸ¥é“å®ƒè¢«ä¿®æ”¹äº†å¤šå°‘æ¬¡ï¼Œè€Œæ˜¯åªéœ€è¦çŸ¥é“å®ƒæ˜¯å¦è¢«ä¿®æ”¹è¿‡â€ çš„é—®é¢˜</p><hr><h3 id="5-3-Atomic-åŸå­ç±»"><a href="#5-3-Atomic-åŸå­ç±»" class="headerlink" title="5.3. Atomic* åŸå­ç±»"></a>5.3. Atomic* åŸå­ç±»</h3><h4 id="5-3-1-Atomic-åŸå­ç±»æ¦‚è¿°"><a href="#5-3-1-Atomic-åŸå­ç±»æ¦‚è¿°" class="headerlink" title="5.3.1. Atomic* åŸå­ç±»æ¦‚è¿°"></a>5.3.1. Atomic* åŸå­ç±»æ¦‚è¿°</h4><p><code>Atomic*</code> åŸå­ç±»æ˜¯ä½¿ç”¨ <code>CAS</code> å®ç°å¤šçº¿ç¨‹å¹¶å‘å®‰å…¨çš„ä¸€äº›ç±»</p><hr><h4 id="5-3-2-Atomic-åŸå­ç±»ç›¸å…³åˆ†ç±»"><a href="#5-3-2-Atomic-åŸå­ç±»ç›¸å…³åˆ†ç±»" class="headerlink" title="5.3.2. Atomic* åŸå­ç±»ç›¸å…³åˆ†ç±»"></a>5.3.2. Atomic* åŸå­ç±»ç›¸å…³åˆ†ç±»</h4><ol><li><code>AtomicBoolean</code></li><li><code>AtomicInteger</code></li><li><code>AtomicIntegerArray</code></li><li><code>AtomicIntegerFieldUpdater</code></li><li><code>AtomicIntegerFieldUpdaterImpl</code></li><li><code>AtomicLong</code></li><li><code>AtomicLongArray</code></li><li><code>AtomicLongFieldUpdater</code></li><li><code>AtomicReference</code></li><li><code>AtomicReferenceArray</code></li><li><code>AtomicReferenceFieldUpdater</code></li><li><code>AtomicReferenceFieldUpdaterImpl</code></li><li><code>AtomicMarkableReference</code></li><li><code>AtomicStampedReference</code></li><li><code>LongAdder</code></li><li><code>DoubleAdder</code></li></ol><hr><h1 id="å…­ã€å¹¶å‘å·¥å…·"><a href="#å…­ã€å¹¶å‘å·¥å…·" class="headerlink" title="å…­ã€å¹¶å‘å·¥å…·"></a>å…­ã€å¹¶å‘å·¥å…·</h1><h2 id="1-CountDownLatch"><a href="#1-CountDownLatch" class="headerlink" title="1. CountDownLatch"></a>1. CountDownLatch</h2><p>è¯¦è§æºç ï¼š<code>CountDownLatch</code></p><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.CountDownLatch%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.CountDownLatchæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/11/16/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.CountDownLatch%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/16/æºç ï¼šjava.util.concurrent.CountDownLatchæºç è§£æ/</a></li></ol></li></ol><hr><h2 id="2-CyclicBarrier"><a href="#2-CyclicBarrier" class="headerlink" title="2. CyclicBarrier"></a>2. CyclicBarrier</h2><p>è¯¦è§æºç ï¼š<code>CyclicBarrier</code></p><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.CyclicBarrier%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.CyclicBarrieræºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/11/19/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.CyclicBarrier%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/19/æºç ï¼šjava.util.concurrent.CyclicBarrieræºç è§£æ/</a></li></ol></li></ol><hr><h2 id="3-Semaphore"><a href="#3-Semaphore" class="headerlink" title="3. Semaphore"></a>3. Semaphore</h2><p>è¯¦è§æºç ï¼š<code>Semaphore</code></p><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.Semaphore%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.Semaphoreæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/11/19/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.Semaphore%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/19/æºç ï¼šjava.util.concurrent.Semaphoreæºç è§£æ/</a></li></ol></li></ol><hr><h1 id="ä¸ƒã€çº¿ç¨‹æ± "><a href="#ä¸ƒã€çº¿ç¨‹æ± " class="headerlink" title="ä¸ƒã€çº¿ç¨‹æ± "></a>ä¸ƒã€çº¿ç¨‹æ± </h1><h2 id="1-çº¿ç¨‹æ± åŸºç¡€ä½“ç³»"><a href="#1-çº¿ç¨‹æ± åŸºç¡€ä½“ç³»" class="headerlink" title="1. çº¿ç¨‹æ± åŸºç¡€ä½“ç³»"></a>1. çº¿ç¨‹æ± åŸºç¡€ä½“ç³»</h2><p><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJUC/%E7%AC%94%E8%AE%B0%EF%BC%9AJUC-9.png"></p><ol><li>è¯¦è§æºç ï¼š<code>Executor</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.Executor%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.Executoræºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/08/31/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.Executor%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/08/31/æºç ï¼šjava.util.concurrent.Executoræºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>ExecutorService</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ExecutorService%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.ExecutorServiceæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/09/03/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ExecutorService%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/09/03/æºç ï¼šjava.util.concurrent.ExecutorServiceæºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>AbstractExecutorService</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.AbstractExecutorService%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.AbstractExecutorServiceæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/11/03/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.AbstractExecutorService%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/03/æºç ï¼šjava.util.concurrent.AbstractExecutorServiceæºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>ScheduledExecutorService</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ScheduledExecutorService%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.ScheduledExecutorServiceæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/11/03/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ScheduledExecutorService%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/03/æºç ï¼šjava.util.concurrent.ScheduledExecutorServiceæºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>ThreadPoolExecutor</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ThreadPoolExecutor%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.ThreadPoolExecutoræºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/09/03/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ThreadPoolExecutor%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/09/03/æºç ï¼šjava.util.concurrent.ThreadPoolExecutoræºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>ScheduledThreadPoolExecutor</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ScheduledThreadPoolExecutor%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.ScheduledThreadPoolExecutoræºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/11/04/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ScheduledThreadPoolExecutor%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/04/æºç ï¼šjava.util.concurrent.ScheduledThreadPoolExecutoræºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>ForkJoinPool</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ForkJoinPool%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.ForkJoinPoolæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/11/14/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ForkJoinPool%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/14/æºç ï¼šjava.util.concurrent.ForkJoinPoolæºç è§£æ/</a></li></ol></li></ol></li></ol><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>çº¿ç¨‹æ± çš„ä¸‰æ¶é©¬è½¦ï¼š<code>ThreadPoolExecutor</code>ã€<code>ScheduledThreadPoolExecutor</code>ã€<code>ForkJoinPool</code></li></ol></blockquote><hr><h1 id="å…«ã€å¼‚æ­¥ç¼–ç¨‹"><a href="#å…«ã€å¼‚æ­¥ç¼–ç¨‹" class="headerlink" title="å…«ã€å¼‚æ­¥ç¼–ç¨‹"></a>å…«ã€å¼‚æ­¥ç¼–ç¨‹</h1><h2 id="1-å¼‚æ­¥ç¼–ç¨‹åŸºç¡€ä½“ç³»"><a href="#1-å¼‚æ­¥ç¼–ç¨‹åŸºç¡€ä½“ç³»" class="headerlink" title="1. å¼‚æ­¥ç¼–ç¨‹åŸºç¡€ä½“ç³»"></a>1. å¼‚æ­¥ç¼–ç¨‹åŸºç¡€ä½“ç³»</h2><p><img src="/source/_posts/%E7%AC%94%E8%AE%B0%EF%BC%9AJUC/%E7%AC%94%E8%AE%B0%EF%BC%9AJUC-10.png"></p><ol><li>è¯¦è§æºç ï¼š<code>Serializable</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.io.Serializable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.io.Serializableæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/10/28/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.io.Serializable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/10/28/æºç ï¼šjava.io.Serializableæºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>Comparable&lt;T&gt;</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.Comparable%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.lang.Comparableï¼œTï¼æºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/11/06/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.Comparable%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/06/æºç ï¼šjava.lang.Comparableï¼œTï¼æºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>Callable&lt;V&gt;</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.Callable%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.Callableï¼œVï¼æºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/09/02/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.Callable%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/09/02/æºç ï¼šjava.util.concurrent.Callableï¼œVï¼æºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>Runnable</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.Runnable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.Runnableæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/09/02/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.Runnable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/09/02/æºç ï¼šjava.util.concurrent.Runnableæºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>Delayed</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.Delayed%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.Delayedæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/11/06/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.Delayed%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/06/æºç ï¼šjava.util.concurrent.Delayedæºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>Futureï¼œVï¼</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurren.Future%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurren.Futureï¼œVï¼æºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/09/02/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurren.Future%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/09/02/æºç ï¼šjava.util.concurren.Futureï¼œVï¼æºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>RunnableFuture&lt;V&gt;</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.RunnableFuture%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.RunnableFutureï¼œVï¼æºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/11/03/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.RunnableFuture%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/03/æºç ï¼šjava.util.concurrent.RunnableFutureï¼œVï¼æºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>ScheduledFutureï¼œVï¼</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ScheduledFuture%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.ScheduledFutureï¼œVï¼æºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/11/04/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ScheduledFuture%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/04/æºç ï¼šjava.util.concurrent.ScheduledFutureï¼œVï¼æºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>ForkJoinTask&lt;V&gt;</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ForkJoinTask%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.ForkJoinTaskï¼œVï¼æºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/11/15/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ForkJoinTask%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/15/æºç ï¼šjava.util.concurrent.ForkJoinTaskï¼œVï¼æºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>FutureTask&lt;V&gt;</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.FutureTask%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.FutureTaskï¼œVï¼æºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/11/03/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.FutureTask%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/03/æºç ï¼šjava.util.concurrent.FutureTaskï¼œVï¼æºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>RunnableScheduledFutureï¼œVï¼</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.RunnableScheduledFuture%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.RunnableScheduledFutureï¼œVï¼æºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/05/05/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.RunnableScheduledFuture%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/05/05/æºç ï¼šjava.util.concurrent.RunnableScheduledFutureï¼œVï¼æºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>ScheduledFutureTaskï¼œVï¼</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ScheduledThreadPoolExecutor.ScheduledFutureTask%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.ScheduledThreadPoolExecutor.ScheduledFutureTaskï¼œVï¼æºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/11/15/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ScheduledThreadPoolExecutor.ScheduledFutureTask%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/15/æºç ï¼šjava.util.concurrent.ScheduledThreadPoolExecutor.ScheduledFutureTaskï¼œVï¼æºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>RecursiveAction</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.RecursiveAction%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.RecursiveActionæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/11/15/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.RecursiveAction%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/15/æºç ï¼šjava.util.concurrent.RecursiveActionæºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>RecursiveTask&lt;V&gt;</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.RecursiveTask%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.RecursiveTaskï¼œVï¼æºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/11/15/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.RecursiveTask%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/15/æºç ï¼šjava.util.concurrent.RecursiveTaskï¼œVï¼æºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>CountedCompleter&lt;T&gt;</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.CountedCompleter%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.CountedCompleterï¼œTï¼æºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/11/15/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.CountedCompleter%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/15/æºç ï¼šjava.util.concurrent.CountedCompleterï¼œTï¼æºç è§£æ/</a></li></ol></li></ol></li></ol><hr><h2 id="2-å¼‚æ­¥ç¼–ç¨‹çš„å®ç°æ–¹å¼"><a href="#2-å¼‚æ­¥ç¼–ç¨‹çš„å®ç°æ–¹å¼" class="headerlink" title="2. å¼‚æ­¥ç¼–ç¨‹çš„å®ç°æ–¹å¼"></a>2. å¼‚æ­¥ç¼–ç¨‹çš„å®ç°æ–¹å¼</h2><h3 id="2-1-ä¼ªå¼‚æ­¥"><a href="#2-1-ä¼ªå¼‚æ­¥" class="headerlink" title="2.1. ä¼ªå¼‚æ­¥"></a>2.1. ä¼ªå¼‚æ­¥</h3><p>ä¼ªå¼‚æ­¥æ˜¯æŒ‡ï¼šå½“å‰çº¿ç¨‹å°†æˆ‘ä»¬æ‰§è¡Œçš„ <code>Java</code> ä»£ç ä¸­ï¼Œä¸€äº›è€—æ—¶çš„æ“ä½œäº¤ç»™å…¶ä»–çº¿ç¨‹ï¼ˆé€šå¸¸ä½¿ç”¨ä¸“é—¨çš„çº¿ç¨‹æ± ï¼‰å»æ‰§è¡Œï¼Œå½“å‰çº¿ç¨‹å¯ä»¥ç›´æ¥ç»§ç»­å‘ä¸‹æ‰§è¡Œ</p><hr><h3 id="2-2-ä¼ªå¼‚æ­¥-å¼‚æ­¥ç¼–ç¨‹ç­‰å¾…"><a href="#2-2-ä¼ªå¼‚æ­¥-å¼‚æ­¥ç¼–ç¨‹ç­‰å¾…" class="headerlink" title="2.2. ä¼ªå¼‚æ­¥ + å¼‚æ­¥ç¼–ç¨‹ç­‰å¾…"></a>2.2. ä¼ªå¼‚æ­¥ + å¼‚æ­¥ç¼–ç¨‹ç­‰å¾…</h3><p> ä¼ªå¼‚æ­¥ + å¼‚æ­¥ç¼–ç¨‹ç­‰å¾…æ˜¯æŒ‡ï¼šè™½ç„¶å½“å‰çº¿ç¨‹å°†æˆ‘ä»¬æ‰§è¡Œçš„ <code>Java</code> ä»£ç ä¸­ï¼Œä¸€äº›è€—æ—¶çš„æ“ä½œäº¤ç»™å…¶ä»–çº¿ç¨‹ï¼ˆé€šå¸¸ä½¿ç”¨ä¸“é—¨çš„çº¿ç¨‹æ± ï¼‰å»æ‰§è¡Œï¼Œä½†å½“å‰çº¿ç¨‹ä»ç„¶éœ€è¦è¯¥ä»»åŠ¡çš„è¿”å›ç»“æœï¼Œæ‰€ä»¥å½“å‰çº¿ç¨‹å¿…é¡»åœ¨åç»­æŸä¸ªæ—¶åˆ»è·å–è¯¥ä»»åŠ¡çš„è¿”å›ç»“æœ</p><p>é€šå¸¸çš„åšæ³•æ˜¯ï¼šæäº¤ä»»åŠ¡åè¿”å›ä¸€ä¸ªå‡­è¯ï¼ˆå³ <code>Future</code>ï¼Œå¸¸è§å…·ä½“å®ç°ç±»ä¸»è¦åŒ…æ‹¬ <code>FutureTask</code>ã€<code>ScheduledFutureTask</code>ã€<code>ForkJoinTask</code>ï¼‰ï¼Œç„¶åæ ¹æ®è¿™ä¸ªå‡­è¯åœ¨éœ€è¦ç»“æœæ—¶è·å–ç»“æœï¼Œç„¶åå†ç»§ç»­å‘ä¸‹æ‰§è¡Œ</p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>å¼‚æ­¥ç¼–ç¨‹ç­‰å¾…æ—¢å¯èƒ½æ˜¯é˜»å¡çš„ä¹Ÿå¯èƒ½æ˜¯é™æ—¶é˜»å¡çš„</li></ol></blockquote><hr><h3 id="2-3-ä¼ªå¼‚æ­¥-å¼‚æ­¥ç¼–ç¨‹å›è°ƒ"><a href="#2-3-ä¼ªå¼‚æ­¥-å¼‚æ­¥ç¼–ç¨‹å›è°ƒ" class="headerlink" title="2.3. ä¼ªå¼‚æ­¥ + å¼‚æ­¥ç¼–ç¨‹å›è°ƒ"></a>2.3. ä¼ªå¼‚æ­¥ + å¼‚æ­¥ç¼–ç¨‹å›è°ƒ</h3><p>è¿™éƒ¨åˆ†å†…å®¹æ¶‰åŠåˆ°äº† <code>CompletableFuture</code>ï¼Œè¯¦è§ç¬”è®°ï¼š<code>Java</code> å‡½æ•°å¼ç¼–ç¨‹ï¼ˆ<code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<a href="%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B.md">ç¬”è®°ï¼šJavaå‡½æ•°å¼ç¼–ç¨‹</a>ï¼Œ<code>Hexo</code> é“¾æ¥ï¼šï¼‰</p><hr><h3 id="ä¼ªå¼‚æ­¥-å¼‚æ­¥æµå¼å›è°ƒï¼ˆå“åº”å¼ï¼‰"><a href="#ä¼ªå¼‚æ­¥-å¼‚æ­¥æµå¼å›è°ƒï¼ˆå“åº”å¼ï¼‰" class="headerlink" title="ä¼ªå¼‚æ­¥ + å¼‚æ­¥æµå¼å›è°ƒï¼ˆå“åº”å¼ï¼‰"></a>ä¼ªå¼‚æ­¥ + å¼‚æ­¥æµå¼å›è°ƒï¼ˆå“åº”å¼ï¼‰</h3><hr>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
      <category>JUC</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.util.concurrent.CyclicBarrier æºç è§£æ</title>
    <link href="/2025/11/19/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.CyclicBarrier%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/11/19/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.CyclicBarrier%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/11/19/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.CyclicBarrier%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/19/æºç ï¼šjava.util.concurrent.CyclicBarrieræºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-CyclicBarrier-æ¦‚è¿°"><a href="#3-1-CyclicBarrier-æ¦‚è¿°" class="headerlink" title="3.1. CyclicBarrier æ¦‚è¿°"></a>3.1. CyclicBarrier æ¦‚è¿°</h3><p><code>CyclicBarrier</code> æ˜¯ä¸€ä¸ªå…·ä½“ç±»</p><p>å¾ªç¯æ …æ ï¼ˆ<code>CyclicBarrier</code>ï¼‰å¯ä»¥ç®€å•çš„ç†è§£ä¸º <code>CountDownLatch</code> çš„ä¸€ä¸ªå˜ç§ã€‚æˆ‘ä»¬ä½¿ç”¨ <code>CountDownLatch</code> å®ç°æ±‡æ€»æ¨¡å¼ï¼ˆä¸»çº¿ç¨‹ç­‰å¾…ã€å­çº¿ç¨‹å‡æ•°ï¼‰ã€å‘ä»¤æªæ¨¡å¼ï¼ˆå­çº¿ç¨‹ç­‰å¾…ï¼Œä¸»çº¿ç¨‹å‡æ•°ï¼‰æ—¶ï¼Œä¼šå‘ç°å®ƒä»¬æ€»æ˜¯éœ€è¦å¦ä¸€æ–¹æ¥è§¦å‘å‡æ•°ï¼Œåƒæ˜¯ç¼ºå°‘ä¸€ä¸ª â€œç‚¹ç«â€ é”®</p><p>è€Œ <code>CyclicBarrier</code> æ˜¯å‚ä¸çº¿ç¨‹æ—¢å‡æ•°ï¼Œä¹Ÿç­‰å¾…ã€‚å‡è®¾éœ€è¦ <code>10</code> ä¸ªçº¿ç¨‹åˆ°è¾¾åŒæ­¥ç‚¹ï¼Œå‰ <code>9</code> ä¸ªçº¿ç¨‹åœ¨åˆ°è¾¾åŒæ­¥ç‚¹åï¼Œéƒ½ä¼šå‡æ•°ç„¶åç­‰å¾…ï¼Œæ­¤æ—¶è®¡æ•°ä» <code>10 â” 1</code>ã€‚å½“æœ€åä¸€ä¸ªçº¿ç¨‹åˆ°è¾¾åŒæ­¥ç‚¹æ—¶ï¼Œä¹Ÿä¼šå‡æ•°ç„¶åç­‰å¾…ï¼Œæ­¤æ—¶è®¡æ•°ä» <code>1 â” 0</code>ï¼Œæ‰€æœ‰çº¿ç¨‹åŒæ—¶ç»§ç»­å‘ä¸‹æ‰§è¡Œã€‚æ•´ä¸ªè¿‡ç¨‹ä¸éœ€è¦é¢å¤–çš„ â€œç‚¹ç«â€ é”®ï¼Œå®ç°äº† â€œçº¿ç¨‹äº’ç›¸ç­‰å¾…â€</p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li><code>CountDownLatch</code> æ˜¯ä½¿ç”¨ <code>AQS</code> å®ç°çš„ï¼Œè€Œ <code>CyclicBarrier</code> æ˜¯ä½¿ç”¨ <code>ReentrantLock</code> å®ç°çš„</li><li><code>CountDownLatch</code> æ˜¯ä¸€æ¬¡æ€§çš„ï¼Œè€Œ <code>CyclicBarrier</code> æ˜¯å¯é‡å¤ä½¿ç”¨çš„</li><li>ç®€å•ç†è§£ <code>CountDownLatch</code>ã€<code>CyclicBarrier</code>ã€<code>Semaphore</code>ï¼š<ol><li><code>CountDownLatch</code> æ˜¯é—¨é—©å¼€å¯æ‰èƒ½ç»§ç»­æ‰§è¡Œ</li><li><code>CyclicBarrier</code> æ˜¯ â€œäº’ç›¸ç­‰å¾…â€ éƒ½å‡†å¤‡å¥½æ‰èƒ½ç»§ç»­æ‰§è¡Œ</li><li><code>Semaphore</code> æ˜¯æ‹¿åˆ° â€œè®¸å¯è¯â€ æ‰èƒ½ç»§ç»­æ‰§è¡Œ</li></ol></li></ol></blockquote><hr><h3 id="3-2-CyclicBarrier-åº”ç”¨åœºæ™¯"><a href="#3-2-CyclicBarrier-åº”ç”¨åœºæ™¯" class="headerlink" title="3.2. CyclicBarrier åº”ç”¨åœºæ™¯"></a>3.2. CyclicBarrier åº”ç”¨åœºæ™¯</h3><h4 id="3-2-1-å¹¶å‘å‹åŠ›æµ‹è¯•"><a href="#3-2-1-å¹¶å‘å‹åŠ›æµ‹è¯•" class="headerlink" title="3.2.1. å¹¶å‘å‹åŠ›æµ‹è¯•"></a>3.2.1. å¹¶å‘å‹åŠ›æµ‹è¯•</h4><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.util.concurrent.Semaphore æºç è§£æ</title>
    <link href="/2025/11/19/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.Semaphore%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/11/19/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.Semaphore%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/11/19/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.Semaphore%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/19/æºç ï¼šjava.util.concurrent.Semaphoreæºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-Semaphore-æ¦‚è¿°"><a href="#3-1-Semaphore-æ¦‚è¿°" class="headerlink" title="3.1. Semaphore æ¦‚è¿°"></a>3.1. Semaphore æ¦‚è¿°</h3><p><code>Semaphore</code> æ˜¯ä¸€ä¸ªå…·ä½“ç±»</p><p>ä¿¡å·é‡ï¼ˆ<code>Semaphore</code>ï¼‰æ˜¯ä½¿ç”¨ <code>AQS</code> å®ç°çš„å…±äº«æ¨¡å¼çš„åŒæ­¥å™¨ã€‚<code>State</code> å’Œå…±äº«èµ„æºåˆ†åˆ«è¡¨ç¤ºä»¥ä¸‹å«ä¹‰ï¼š</p><ol><li><code>State</code> è¡¨ç¤ºå‰©ä½™çš„ â€œè®¸å¯è¯â€ çš„æ•°é‡</li><li>å…±äº«èµ„æºè¡¨ç¤ºæŒæœ‰ â€œè®¸å¯è¯â€ æœŸé—´è¢«å…è®¸æ‰§è¡Œçš„æ“ä½œ</li></ol><p>æˆ‘ä»¬å¯ä»¥å°† <code>Semaphore</code> ç®€å•çš„ç†è§£ä¸ºï¼šå¯é‡å¤çš„ã€æ—¢èƒ½åšå‡æ³•ä¹Ÿèƒ½åšåŠ æ³•çš„è®¡æ•°å™¨ï¼Œè®¡çš„æ•°å°±æ˜¯ â€œè®¸å¯è¯â€</p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>ç®€å•ç†è§£ <code>CountDownLatch</code>ã€<code>CyclicBarrier</code>ã€<code>Semaphore</code>ï¼š<ol><li><code>CountDownLatch</code> æ˜¯é—¨é—©å¼€å¯æ‰èƒ½ç»§ç»­æ‰§è¡Œ</li><li><code>CyclicBarrier</code> æ˜¯ â€œäº’ç›¸ç­‰å¾…â€ éƒ½å‡†å¤‡å¥½æ‰èƒ½ç»§ç»­æ‰§è¡Œ</li><li><code>Semaphore</code> æ˜¯æ‹¿åˆ° â€œè®¸å¯è¯â€ æ‰èƒ½ç»§ç»­æ‰§è¡Œ</li></ol></li></ol></blockquote><hr><h3 id="3-2-Semaphore-åº”ç”¨åœºæ™¯"><a href="#3-2-Semaphore-åº”ç”¨åœºæ™¯" class="headerlink" title="3.2. Semaphore åº”ç”¨åœºæ™¯"></a>3.2. Semaphore åº”ç”¨åœºæ™¯</h3><h4 id="3-2-1-å¹¶å‘æ§åˆ¶"><a href="#3-2-1-å¹¶å‘æ§åˆ¶" class="headerlink" title="3.2.1. å¹¶å‘æ§åˆ¶"></a>3.2.1. å¹¶å‘æ§åˆ¶</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyFlowControl</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Semaphore</span> <span class="hljs-variable">mySemaphore</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Semaphore</span>(<span class="hljs-number">10</span>);<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleRequest</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            mySemaphore.acquire(); <br>            <span class="hljs-comment">// ...</span><br>        &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>            e.printStackTrace();<br>        &#125; <span class="hljs-keyword">finally</span> &#123;<br>            mySemaphore.release();<br>        &#125;<br>    &#125;<br>    <br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>æµé‡æ§åˆ¶ä¸»è¦åŒ…æ‹¬å¹¶å‘æ§åˆ¶å’Œé€Ÿç‡é™åˆ¶</li></ol></blockquote><hr><h4 id="3-2-2-èµ„æºæ± ç®¡ç†"><a href="#3-2-2-èµ„æºæ± ç®¡ç†" class="headerlink" title="3.2.2. èµ„æºæ± ç®¡ç†"></a>3.2.2. èµ„æºæ± ç®¡ç†</h4><p>å¸¸è§çš„èµ„æºæ± åŒ…æ‹¬è¿æ¥æ± ã€çº¿ç¨‹æ± ã€å¯¹è±¡æ± </p><p>ä»¥è¿æ¥æ± ä¸ºä¾‹ï¼Œå¯ä»¥å°†è¿æ¥æ± ä¸­çš„è¿æ¥çš„æ•°é‡ä¸ <code>Semaphore</code> çš„ â€è®¸å¯è¯â€œ çš„æ•°é‡å…³è”èµ·æ¥ã€‚åœ¨è·å–è¿æ¥ä¹‹å‰å…ˆè·å– â€è®¸å¯è¯â€œï¼Œåœ¨å½’è¿˜è¿æ¥ä¹‹åå†å½’è¿˜ â€è®¸å¯è¯â€œ</p><hr><h2 id="4-å†…éƒ¨ç±»"><a href="#4-å†…éƒ¨ç±»" class="headerlink" title="4. å†…éƒ¨ç±»"></a>4. å†…éƒ¨ç±»</h2><h3 id="4-1-Sync"><a href="#4-1-Sync" class="headerlink" title="4.1. Sync"></a>4.1. Sync</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Sync</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractQueuedSynchronizer</span> &#123;<br><br>Sync(<span class="hljs-type">int</span> <span class="hljs-keyword">permits</span>) &#123;<br>setState(<span class="hljs-keyword">permits</span>);<br>&#125;<br><br><span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getPermits</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-keyword">return</span> getState();<br>&#125;<br><br><span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-title function_">nonfairTryAcquireShared</span><span class="hljs-params">(<span class="hljs-type">int</span> acquires)</span> &#123;<br><span class="hljs-keyword">for</span> (;;) &#123;<br><span class="hljs-type">int</span> <span class="hljs-variable">available</span> <span class="hljs-operator">=</span> getState();<br><span class="hljs-type">int</span> <span class="hljs-variable">remaining</span> <span class="hljs-operator">=</span> available - acquires;<br><span class="hljs-keyword">if</span> (remaining &lt; <span class="hljs-number">0</span> ||<br>compareAndSetState(available, remaining))<br><span class="hljs-keyword">return</span> remaining;<br>&#125;<br>&#125;<br><br><span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryReleaseShared</span><span class="hljs-params">(<span class="hljs-type">int</span> releases)</span> &#123;<br><span class="hljs-keyword">for</span> (;;) &#123;<br><span class="hljs-type">int</span> <span class="hljs-variable">current</span> <span class="hljs-operator">=</span> getState();<br><span class="hljs-type">int</span> <span class="hljs-variable">next</span> <span class="hljs-operator">=</span> current + releases;<br><span class="hljs-keyword">if</span> (next &lt; current) <span class="hljs-comment">// overflow</span><br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&quot;Maximum permit count exceeded&quot;</span>);<br><span class="hljs-keyword">if</span> (compareAndSetState(current, next))<br><span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br>&#125;<br><br><span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">reducePermits</span><span class="hljs-params">(<span class="hljs-type">int</span> reductions)</span> &#123;<br><span class="hljs-keyword">for</span> (;;) &#123;<br><span class="hljs-type">int</span> <span class="hljs-variable">current</span> <span class="hljs-operator">=</span> getState();<br><span class="hljs-type">int</span> <span class="hljs-variable">next</span> <span class="hljs-operator">=</span> current - reductions;<br><span class="hljs-keyword">if</span> (next &gt; current) <span class="hljs-comment">// underflow</span><br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&quot;Permit count underflow&quot;</span>);<br><span class="hljs-keyword">if</span> (compareAndSetState(current, next))<br><span class="hljs-keyword">return</span>;<br>&#125;<br>&#125;<br><br><span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-title function_">drainPermits</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-keyword">for</span> (;;) &#123;<br><span class="hljs-type">int</span> <span class="hljs-variable">current</span> <span class="hljs-operator">=</span> getState();<br><span class="hljs-keyword">if</span> (current == <span class="hljs-number">0</span> || compareAndSetState(current, <span class="hljs-number">0</span>))<br><span class="hljs-keyword">return</span> current;<br>&#125;<br>&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h3 id="4-2-FairSync"><a href="#4-2-FairSync" class="headerlink" title="4.2. FairSync"></a>4.2. FairSync</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FairSync</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Sync</span> &#123;<br><br>FairSync(<span class="hljs-type">int</span> <span class="hljs-keyword">permits</span>) &#123;<br><span class="hljs-built_in">super</span>(<span class="hljs-keyword">permits</span>);<br>&#125;<br><br><span class="hljs-keyword">protected</span> <span class="hljs-type">int</span> <span class="hljs-title function_">tryAcquireShared</span><span class="hljs-params">(<span class="hljs-type">int</span> acquires)</span> &#123;<br><span class="hljs-keyword">for</span> (;;) &#123;<br><span class="hljs-keyword">if</span> (hasQueuedPredecessors())<br><span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;<br><span class="hljs-type">int</span> <span class="hljs-variable">available</span> <span class="hljs-operator">=</span> getState();<br><span class="hljs-type">int</span> <span class="hljs-variable">remaining</span> <span class="hljs-operator">=</span> available - acquires;<br><span class="hljs-keyword">if</span> (remaining &lt; <span class="hljs-number">0</span> ||<br>compareAndSetState(available, remaining))<br><span class="hljs-keyword">return</span> remaining;<br>&#125;<br>&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h3 id="4-3-NonfairSync"><a href="#4-3-NonfairSync" class="headerlink" title="4.3. NonfairSync"></a>4.3. NonfairSync</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NonfairSync</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Sync</span> &#123;<br><br>NonfairSync(<span class="hljs-type">int</span> <span class="hljs-keyword">permits</span>) &#123;<br><span class="hljs-built_in">super</span>(<span class="hljs-keyword">permits</span>);<br>&#125;<br><br><span class="hljs-keyword">protected</span> <span class="hljs-type">int</span> <span class="hljs-title function_">tryAcquireShared</span><span class="hljs-params">(<span class="hljs-type">int</span> acquires)</span> &#123;<br><span class="hljs-keyword">return</span> nonfairTryAcquireShared(acquires);<br>&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h2 id="5-æ„é€ æ–¹æ³•"><a href="#5-æ„é€ æ–¹æ³•" class="headerlink" title="5. æ„é€ æ–¹æ³•"></a>5. æ„é€ æ–¹æ³•</h2><h3 id="5-1-Semaphore-int-permits"><a href="#5-1-Semaphore-int-permits" class="headerlink" title="5.1. Semaphore(int permits)"></a>5.1. Semaphore(int permits)</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-title function_">Semaphore</span><span class="hljs-params">(<span class="hljs-type">int</span> <span class="hljs-keyword">permits</span>)</span> &#123;<br><br>sync = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NonfairSync</span>(<span class="hljs-keyword">permits</span>);<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h3 id="5-2-Semaphore-int-permits-boolean-fair"><a href="#5-2-Semaphore-int-permits-boolean-fair" class="headerlink" title="5.2. Semaphore(int permits, boolean fair)"></a>5.2. Semaphore(int permits, boolean fair)</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-title function_">Semaphore</span><span class="hljs-params">(<span class="hljs-type">int</span> <span class="hljs-keyword">permits</span>, <span class="hljs-type">boolean</span> fair)</span> &#123;<br><br>sync = fair ? <span class="hljs-keyword">new</span> <span class="hljs-title class_">FairSync</span>(<span class="hljs-keyword">permits</span>) : <span class="hljs-keyword">new</span> <span class="hljs-title class_">NonfairSync</span>(<span class="hljs-keyword">permits</span>);<br><br>&#125;<br></code></pre></td></tr></table></figure><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.util.concurrent.locks.AbstractQueuedLongSynchronizer æºç è§£æ</title>
    <link href="/2025/11/19/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedLongSynchronizer%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/11/19/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedLongSynchronizer%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/11/19/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedLongSynchronizer%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/19/æºç ï¼šjava.util.concurrent.locks.AbstractQueuedLongSynchronizeræºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-AbstractQueuedLongSynchronizer-æ¦‚è¿°"><a href="#3-1-AbstractQueuedLongSynchronizer-æ¦‚è¿°" class="headerlink" title="3.1. AbstractQueuedLongSynchronizer æ¦‚è¿°"></a>3.1. AbstractQueuedLongSynchronizer æ¦‚è¿°</h3><p><code>AbstractQueuedLongSynchronizer</code> æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œç»§æ‰¿äº† <code>java.util.concurrent.locks.AbstractOwnableSynchronizer</code>ï¼Œå®ç°äº† <code>java.io.Serializable</code><br><img src="/source/_posts/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedLongSynchronizer%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedLongSynchronizer%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.png"></p><p><code>AbstractQueuedLongSynchronizer</code> å’Œ <code>AbstractQueuedSynchronizer</code> æ˜¯ä¸€æ ·çš„ï¼Œåªä¸è¿‡ <code>State</code> ä» <code>32 bit â” 64 bit</code></p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>è¯¦è§æºç ï¼š<code>AbstractOwnableSynchronizer</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractOwnableSynchronizer%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.locks.AbstractOwnableSynchronizeræºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/09/02/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractOwnableSynchronizer%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/09/02/æºç ï¼šjava.util.concurrent.locks.AbstractOwnableSynchronizeræºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>Serializable</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.io.Serializable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.io.Serializableæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/10/28/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.io.Serializable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/10/28/æºç ï¼šjava.io.Serializableæºç è§£æ/</a></li></ol></li></ol></li></ol></blockquote><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.util.function.Consumerï¼œTï¼ æºç è§£æ</title>
    <link href="/2025/11/18/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.function.Consumer%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/11/18/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.function.Consumer%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/11/18/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.function.Consumer%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/18/æºç ï¼šjava.util.function.Consumerï¼œTï¼æºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-Consumerï¼œTï¼-æ¦‚è¿°"><a href="#3-1-Consumerï¼œTï¼-æ¦‚è¿°" class="headerlink" title="3.1. Consumerï¼œTï¼ æ¦‚è¿°"></a>3.1. Consumerï¼œTï¼ æ¦‚è¿°</h3><p><code>Consumerï¼œTï¼</code> æ˜¯ä¸€ä¸ªæ¥å£</p><p><code>Consumerï¼œTï¼</code> æ˜¯ä¸€ä¸ªå…·æœ‰ â€œæ¶ˆè´¹â€ åŠŸèƒ½çš„å†…ç½®å‡½æ•°å¼æ¥å£ï¼Œè¡¨ç¤º â€œç»™ä½ ä¸€ä¸ªæ–¹æ³•å‚æ•° <code>T</code>ï¼Œå¤„ç†æ‰å®ƒï¼Œæ²¡æœ‰è¿”å›ç»“æœâ€</p><hr><h2 id="4-æºç éƒ¨åˆ†"><a href="#4-æºç éƒ¨åˆ†" class="headerlink" title="4. æºç éƒ¨åˆ†"></a>4. æºç éƒ¨åˆ†</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@FunctionalInterface</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Consumer</span>&lt;T&gt; &#123;<br><br><span class="hljs-comment">// ç”¨äºå®šä¹‰å½“å‰å›è°ƒå‡½æ•°çš„å…·ä½“é€»è¾‘ï¼Œå¹¶æ‰§è¡Œå½“å‰å›è°ƒå‡½æ•°ï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼šé˜»å¡ã€éé˜»å¡ã€é™æ—¶é˜»å¡çœ‹å›è°ƒå‡½æ•°çš„å…·ä½“é€»è¾‘ï¼‰</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">accept</span><span class="hljs-params">(T t)</span>;<br><br><span class="hljs-comment">// ç”¨äºéé˜»å¡ç»„åˆä¸¤ä¸ªå›è°ƒå‡½æ•°ä¸ºä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œè¯¥å›è°ƒå‡½æ•°çš„å…·ä½“é€»è¾‘ä¸ºï¼šå…ˆæ‰§è¡Œå½“å‰å›è°ƒå‡½æ•°ï¼Œä¼ å…¥çš„æ–¹æ³•å‚æ•° afterï¼ˆå³ä¸€ä¸ª Consumerï¼œTï¼ ç±»å‹çš„å›è°ƒå‡½æ•°ï¼‰</span><br>    <span class="hljs-keyword">default</span> Consumer&lt;T&gt; <span class="hljs-title function_">andThen</span><span class="hljs-params">(Consumer&lt;? <span class="hljs-built_in">super</span> T&gt; after)</span> &#123;<br>        Objects.requireNonNull(after);<br>        <span class="hljs-keyword">return</span> (T t) -&gt; &#123; accept(t); after.accept(t); &#125;;<br>    &#125;<br>    <br>&#125;<br></code></pre></td></tr></table></figure><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.util.function.Functionï¼œT,Rï¼ æºç è§£æ</title>
    <link href="/2025/11/18/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.function.Function%EF%BC%9CT,R%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/11/18/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.function.Function%EF%BC%9CT,R%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/11/18/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.function.Function%EF%BC%9CT,R%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/18/æºç ï¼šjava.util.function.Functionï¼œT,Rï¼æºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="Functionï¼œT-Rï¼-æ¦‚è¿°"><a href="#Functionï¼œT-Rï¼-æ¦‚è¿°" class="headerlink" title="Functionï¼œT, Rï¼ æ¦‚è¿°"></a>Functionï¼œT, Rï¼ æ¦‚è¿°</h3><p><code>Functionï¼œT, Rï¼</code> æ˜¯ä¸€ä¸ªæ¥å£</p><p><code>Functionï¼œT, Rï¼</code> æ˜¯ä¸€ä¸ªå…·æœ‰ â€œè½¬æ¢â€ æˆ– â€œè®¡ç®—â€ åŠŸèƒ½çš„å†…ç½®å‡½æ•°å¼æ¥å£ï¼Œè¡¨ç¤º â€œç»™ä½ ä¸€ä¸ªæ–¹æ³•å‚æ•° <code>T</code>ï¼Œè½¬æ¢æˆ–è®¡ç®—å®ƒï¼Œè¿”å›ä¸€ä¸ª <code>R</code> ç±»å‹çš„ç»“æœâ€</p><hr><h2 id="4-æºç éƒ¨åˆ†"><a href="#4-æºç éƒ¨åˆ†" class="headerlink" title="4. æºç éƒ¨åˆ†"></a>4. æºç éƒ¨åˆ†</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@FunctionalInterface</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Function</span>&lt;T, R&gt; &#123;<br><br><span class="hljs-comment">// ç”¨äºå®šä¹‰å½“å‰å›è°ƒå‡½æ•°çš„å…·ä½“é€»è¾‘ï¼Œå¹¶æ‰§è¡Œå½“å‰å›è°ƒå‡½æ•°ï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼šé˜»å¡ã€éé˜»å¡ã€é™æ—¶é˜»å¡çœ‹å›è°ƒå‡½æ•°çš„å…·ä½“é€»è¾‘ï¼‰</span><br>    R <span class="hljs-title function_">apply</span><span class="hljs-params">(T t)</span>;<br><br><span class="hljs-comment">// ç”¨äºéé˜»å¡ç»„åˆä¸¤ä¸ªå›è°ƒå‡½æ•°ä¸ºä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œè¯¥å›è°ƒå‡½æ•°çš„å…·ä½“é€»è¾‘ä¸ºï¼šå…ˆæ‰§è¡Œä¼ å…¥çš„æ–¹æ³•å‚æ•° beforeï¼ˆå³ä¸€ä¸ª Functionï¼œT, Rï¼ ç±»å‹çš„å›è°ƒå‡½æ•°ï¼‰ï¼Œå†æ‰§è¡Œå½“å‰å›è°ƒå‡½æ•°</span><br>    <span class="hljs-keyword">default</span> &lt;V&gt; Function&lt;V, R&gt; <span class="hljs-title function_">compose</span><span class="hljs-params">(Function&lt;? <span class="hljs-built_in">super</span> V, ? extends T&gt; before)</span> &#123;<br>        Objects.requireNonNull(before);<br>        <span class="hljs-keyword">return</span> (V v) -&gt; apply(before.apply(v));<br>    &#125;<br><br><span class="hljs-comment">// ç”¨äºéé˜»å¡ç»„åˆä¸¤ä¸ªå›è°ƒå‡½æ•°ä¸ºä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œè¯¥å›è°ƒå‡½æ•°çš„å…·ä½“é€»è¾‘ä¸ºï¼šå…ˆæ‰§è¡Œå½“å‰å›è°ƒå‡½æ•°ï¼Œä¼ å…¥çš„æ–¹æ³•å‚æ•° afterï¼ˆå³ä¸€ä¸ª Functionï¼œT, Rï¼ ç±»å‹çš„å›è°ƒå‡½æ•°ï¼‰</span><br>    <span class="hljs-keyword">default</span> &lt;V&gt; Function&lt;T, V&gt; <span class="hljs-title function_">andThen</span><span class="hljs-params">(Function&lt;? <span class="hljs-built_in">super</span> R, ? extends V&gt; after)</span> &#123;<br>        Objects.requireNonNull(after);<br>        <span class="hljs-keyword">return</span> (T t) -&gt; after.apply(apply(t));<br>    &#125;<br><br><span class="hljs-comment">// ç”¨äºéé˜»å¡åŸæ ·è¿”å›å½“å‰å›è°ƒå‡½æ•°çš„æ–¹æ³•å‚æ•°</span><br>    <span class="hljs-keyword">static</span> &lt;T&gt; Function&lt;T, T&gt; <span class="hljs-title function_">identity</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> t -&gt; t;<br>    &#125;<br>    <br>&#125;<br></code></pre></td></tr></table></figure><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.util.function.Predicateï¼œTï¼ æºç è§£æ</title>
    <link href="/2025/11/18/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.function.Predicate%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/11/18/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.function.Predicate%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/11/18/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.function.Predicate%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/18/æºç ï¼šjava.util.function.Predicateï¼œTï¼æºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="Predicateï¼œTï¼-æ¦‚è¿°"><a href="#Predicateï¼œTï¼-æ¦‚è¿°" class="headerlink" title="Predicateï¼œTï¼ æ¦‚è¿°"></a>Predicateï¼œTï¼ æ¦‚è¿°</h3><p><code>Predicateï¼œTï¼</code> æ˜¯ä¸€ä¸ªæ¥å£</p><p><code>Predicateï¼œTï¼</code> æ˜¯ä¸€ä¸ªå…·æœ‰ â€œåˆ¤æ–­â€ åŠŸèƒ½çš„å†…ç½®å‡½æ•°å¼æ¥å£ï¼Œè¡¨ç¤º â€œç»™ä½ ä¸€ä¸ªæ–¹æ³•å‚æ•° <code>T</code>ï¼Œåˆ¤æ–­å®ƒæ˜¯å¦æ»¡è¶³æ¡ä»¶ï¼Œè¿”å›ä¸€ä¸ª <code>boolean</code> ç±»å‹çš„ç»“æœâ€</p><hr><h2 id="4-æºç éƒ¨åˆ†"><a href="#4-æºç éƒ¨åˆ†" class="headerlink" title="4. æºç éƒ¨åˆ†"></a>4. æºç éƒ¨åˆ†</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@FunctionalInterface</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Predicate</span>&lt;T&gt; &#123;<br><br><span class="hljs-comment">// ç”¨äºå®šä¹‰å½“å‰å›è°ƒå‡½æ•°çš„å…·ä½“é€»è¾‘ï¼Œå¹¶æ‰§è¡Œå½“å‰å›è°ƒå‡½æ•°ï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼šé˜»å¡ã€éé˜»å¡ã€é™æ—¶é˜»å¡çœ‹å›è°ƒå‡½æ•°çš„å…·ä½“é€»è¾‘ï¼‰</span><br>    <span class="hljs-type">boolean</span> <span class="hljs-title function_">test</span><span class="hljs-params">(T t)</span>;<br><br><span class="hljs-comment">// ç”¨äºéé˜»å¡ç»„åˆä¸¤ä¸ªå›è°ƒå‡½æ•°ä¸ºä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œè¯¥å›è°ƒå‡½æ•°çš„å…·ä½“é€»è¾‘ä¸ºï¼šå…ˆæ‰§è¡Œå½“å‰å›è°ƒå‡½æ•°ï¼Œå¦‚æœå›è°ƒå‡½æ•°çš„æ‰§è¡Œç»“æœä¸º trueï¼Œå†æ‰§è¡Œä¼ å…¥çš„æ–¹æ³•å‚æ•° otherï¼ˆå³ä¸€ä¸ª Predicateï¼œTï¼ ç±»å‹çš„å›è°ƒå‡½æ•°ï¼‰</span><br>    <span class="hljs-keyword">default</span> Predicate&lt;T&gt; <span class="hljs-title function_">and</span><span class="hljs-params">(Predicate&lt;? <span class="hljs-built_in">super</span> T&gt; other)</span> &#123;<br>        Objects.requireNonNull(other);<br>        <span class="hljs-keyword">return</span> (t) -&gt; test(t) &amp;&amp; other.test(t);<br>    &#125;<br><br><span class="hljs-comment">// ç”¨äºéé˜»å¡ç»„åˆä¸¤ä¸ªå›è°ƒå‡½æ•°ä¸ºä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œè¯¥å›è°ƒå‡½æ•°çš„å…·ä½“é€»è¾‘ä¸ºï¼šå…ˆæ‰§è¡Œå½“å‰å›è°ƒå‡½æ•°ï¼Œå¦‚æœå›è°ƒå‡½æ•°çš„æ‰§è¡Œç»“æœä¸º falseï¼Œå†æ‰§è¡Œä¼ å…¥çš„æ–¹æ³•å‚æ•° otherï¼ˆä¸€ä¸ª Predicateï¼œTï¼ ç±»å‹çš„å›è°ƒå‡½æ•°ï¼‰</span><br>    <span class="hljs-keyword">default</span> Predicate&lt;T&gt; <span class="hljs-title function_">or</span><span class="hljs-params">(Predicate&lt;? <span class="hljs-built_in">super</span> T&gt; other)</span> &#123;<br>        Objects.requireNonNull(other);<br>        <span class="hljs-keyword">return</span> (t) -&gt; test(t) || other.test(t);<br>    &#125;<br>    <br>    <span class="hljs-comment">// ç”¨äºéé˜»å¡æ‰§è¡Œå½“å‰å›è°ƒå‡½æ•°ï¼Œå¹¶å¯¹å›è°ƒå‡½æ•°çš„æ‰§è¡Œç»“æœå–å</span><br>    <span class="hljs-comment">//</span><br>    <span class="hljs-comment">// å³å¦‚æœå›è°ƒå‡½æ•°çš„æ‰§è¡Œç»“æœä¸º trueï¼Œé‚£ä¹ˆè¯¥æ–¹æ³•å°±è¿”å› false</span><br>    <span class="hljs-keyword">default</span> Predicate&lt;T&gt; <span class="hljs-title function_">negate</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> (t) -&gt; !test(t);<br>    &#125;<br><br>    <span class="hljs-keyword">static</span> &lt;T&gt; Predicate&lt;T&gt; <span class="hljs-title function_">isEqual</span><span class="hljs-params">(Object targetRef)</span> &#123;<br>        <span class="hljs-keyword">return</span> (<span class="hljs-literal">null</span> == targetRef)<br>                ? Objects::isNull<br>                : object -&gt; targetRef.equals(object);<br>    &#125;<br><br>    <span class="hljs-meta">@SuppressWarnings(&quot;unchecked&quot;)</span><br>    <span class="hljs-keyword">static</span> &lt;T&gt; Predicate&lt;T&gt; <span class="hljs-title function_">not</span><span class="hljs-params">(Predicate&lt;? <span class="hljs-built_in">super</span> T&gt; target)</span> &#123;<br>        Objects.requireNonNull(target);<br>        <span class="hljs-keyword">return</span> (Predicate&lt;T&gt;)target.negate();<br>    &#125;<br>    <br>&#125;<br></code></pre></td></tr></table></figure><hr>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.util.function.Supplierï¼œTï¼ æºç è§£æ</title>
    <link href="/2025/11/18/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.function.Supplier%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/11/18/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.function.Supplier%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/11/18/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.function.Supplier%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/18/æºç ï¼šjava.util.function.Supplierï¼œTï¼æºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><p><code>Supplierï¼œTï¼</code> æ˜¯ä¸€ä¸ªæ¥å£</p><p><code>Supplierï¼œTï¼</code> æ˜¯ä¸€ä¸ªå…·æœ‰ â€œç”Ÿäº§â€ åŠŸèƒ½çš„å†…ç½®å‡½æ•°å¼æ¥å£ï¼Œè¡¨ç¤º â€œä¸ç»™ä½ ä»»ä½•æ–¹æ³•å‚æ•°ï¼Œè¿”å›ä¸€ä¸ª <code>T</code> ç±»å‹çš„ç»“æœâ€</p><hr><h2 id="4-æºç éƒ¨åˆ†"><a href="#4-æºç éƒ¨åˆ†" class="headerlink" title="4. æºç éƒ¨åˆ†"></a>4. æºç éƒ¨åˆ†</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@FunctionalInterface</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Supplier</span>&lt;T&gt; &#123;<br><br><span class="hljs-comment">//ç”¨äºå®šä¹‰å½“å‰å›è°ƒå‡½æ•°çš„å…·ä½“é€»è¾‘ï¼Œå¹¶æ‰§è¡Œå½“å‰å›è°ƒå‡½æ•°ï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼šé˜»å¡ã€éé˜»å¡ã€é™æ—¶é˜»å¡çœ‹å›è°ƒå‡½æ•°çš„å…·ä½“é€»è¾‘ï¼‰</span><br>    T <span class="hljs-title function_">get</span><span class="hljs-params">()</span>;<br>    <br>&#125;<br></code></pre></td></tr></table></figure><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.lang.ThreadLocalï¼œTï¼.ThreadLocalMap æºç è§£æ</title>
    <link href="/2025/11/16/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.ThreadLocal%EF%BC%9CT%EF%BC%9E.ThreadLocalMap%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/11/16/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.ThreadLocal%EF%BC%9CT%EF%BC%9E.ThreadLocalMap%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw<br><img src="/source/_posts/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.ThreadLocal%EF%BC%9CT%EF%BC%9E.ThreadLocalMap%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.ThreadLocal%EF%BC%9CT%EF%BC%9E.ThreadLocalMap%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.eddx"></p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/11/16/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.ThreadLocal%EF%BC%9CT%EF%BC%9E.ThreadLocalMap%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/16/æºç ï¼šjava.lang.ThreadLocalï¼œTï¼.ThreadLocalMapæºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-ThreadLocal-ThreadLocalMap-è¿°"><a href="#3-1-ThreadLocal-ThreadLocalMap-è¿°" class="headerlink" title="3.1. ThreadLocal.ThreadLocalMap è¿°"></a>3.1. ThreadLocal.ThreadLocalMap è¿°</h3><p><code>ThreadLocal.ThreadLocalMap</code> æ˜¯ä¸€ä¸ªå…·ä½“ç±»ï¼Œæ˜¯ <code>ThreadLocal</code> çš„é™æ€å†…éƒ¨ç±»</p><p><code>ThreadLocal.ThreadLocalMap</code> æ˜¯é€šè¿‡ <code>ThreadLocal.ThreadLocalMap-&gt;table</code> å­˜å‚¨æ•°æ®çš„ï¼Œè€Œå®ƒåˆæ˜¯ä¸€ä¸ªç”± <code>Entry</code> æ„å»ºçš„æ•°ç»„ï¼Œå…¶åŸºæœ¬å±æ€§å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Entry</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">WeakReference</span>&lt;ThreadLocal&lt;?&gt;&gt; &#123;<br><br>Object value;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>æ¯ä¸ª <code>Entry</code> çš„ <code>key</code> å¿…é¡»æ˜¯ <code>ThreadLocal</code> ç±»å‹ï¼Œè€Œ <code>value</code> æ˜¯ <code>Object</code> ç±»å‹ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå®ƒç®€å•ç†è§£ä¸ºï¼š<br><img src="/source/_posts/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.ThreadLocal%EF%BC%9CT%EF%BC%9E.ThreadLocalMap%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.ThreadLocal%EF%BC%9CT%EF%BC%9E.ThreadLocalMap%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.png"></p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>çŒ´å“¥çš„çƒ¦æ¼ç®± <code>(ï½¡â€¢Ìï¸¿â€¢Ì€ï½¡)</code>ï¼š<ol><li>ä¸ºä»€ä¹ˆ <code>ThreadLocal.ThreadLocalMap</code> è¦ä½¿ç”¨ <code>ThreadLocal</code> å®ä¾‹ä½œä¸º <code>Key</code>ï¼Ÿèƒ½ä¸èƒ½ä½¿ç”¨å…¶ä»–ç±»çš„å®ä¾‹ï¼Ÿ<ol><li>åœ¨ä¸€ä¸ªå¤æ‚çš„ <code>Java</code> åº”ç”¨ä¸­ï¼Œä¼šå¼•å…¥å¤§é‡ç¬¬ä¸‰æ–¹ä¾èµ–ï¼Œå®ƒä»¬å†…éƒ¨å¯èƒ½éƒ½ä¼šä½¿ç”¨ <code>ThreadLocal</code> å­˜å‚¨ä¸Šä¸‹æ–‡æ•°æ®</li><li>å¦‚æœ <code>Key</code> ä½¿ç”¨å­—ç¬¦ä¸²ï¼ˆä¾‹å¦‚ â€œ<code>myName</code>â€ï¼‰ï¼Œä¸åŒä¾èµ–å¯èƒ½æ°å¥½ç”¨åˆ°åŒåçš„ <code>Key</code>ï¼Œæœ€ç»ˆå¯¼è‡´æ•°æ®è¢«è¦†ç›–</li><li>è€Œä½¿ç”¨ <code>ThreadLocal</code> å®ä¾‹ä½œä¸º <code>Key</code> ä¾èµ–äºå®ƒçš„å¯¹è±¡åœ°å€ï¼Œå› ä¸ºä½ å³ä¾¿åˆ›å»ºäº†åŒåçš„ <code>ThreadLocal</code> å®ä¾‹ï¼Œå®ƒä»¬çš„å¯¹è±¡åœ°å€ä»ç„¶æ˜¯ä¸åŒçš„</li><li>é‚£ä¹ˆåˆ°åº•èƒ½ä¸èƒ½ä½¿ç”¨å…¶ä»–ç±»çš„å®ä¾‹å‘¢ï¼Ÿä»å®ç°çš„è§’åº¦æ¥çœ‹ï¼Œåªè¦æ˜¯å®ä¾‹ï¼Œå°±éƒ½èƒ½å½“ <code>Key</code>ï¼Œå½“ç„¶ä¸é™åˆ¶å¿…é¡»æ˜¯ <code>ThreadLocal</code> å®ä¾‹ã€‚ä½†æ˜¯ Entry çš„æ„é€ æ–¹æ³•è¢«è®¾è®¡çš„å°±æ˜¯ä½¿ç”¨ <code>ThreadLocal</code> å®ä¾‹ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±ä½¿ç”¨è¿™ä¸ªå¥½äº†</li></ol></li><li>ä¸ºä»€ä¹ˆ <code>Thread</code> ä¸ç›´æ¥ä½¿ç”¨å…¶ä»–çš„ <code>Map</code>ï¼Œè€Œæ˜¯ä½¿ç”¨ <code>ThreadLocal.ThreadLocalMap</code>ï¼Ÿ<ol><li>è¿™ä¸»è¦æ˜¯ä¸ºäº†å°½é‡é¿å…å†…å­˜æ³„æ¼ï¼Œè™½ç„¶æ²¡æœ‰å½»åº•æœç»ï¼Œä½†æ˜¯æ¯”å…¶ä»–çš„ <code>Map</code> è¦å¥½å¾—å¤š</li><li>å› ä¸ºå…¶ä»–çš„ <code>Map</code> çš„ <code>Key</code> æ˜¯å¼ºå¼•ç”¨ï¼Œåªè¦çº¿ç¨‹å­˜æ´»ï¼Œé‚£ä¹ˆ <code>ThreadLocal</code> å®ä¾‹å°±æ°¸è¿œæ— æ³•è¢«å›æ”¶</li><li>è€Œ <code>ThreadLocal.ThreadLocalMap</code> çš„ <code>Key</code> æ˜¯å¼±å¼•ç”¨ï¼Œå¯ä»¥åœ¨ <code>ThreadLocal</code> å®ä¾‹ä¸å†è¢«ä½¿ç”¨æ—¶è¢«å›æ”¶</li><li>è™½ç„¶ <code>ThreadLocal#set</code>ã€<code>ThreadLocal#get</code> èƒ½åœ¨ <code>Key</code> ä¸º <code>null</code> æ—¶æ¸…ç† <code>Value</code>ï¼Œä½†æ˜¯è¿™æ˜¯ â€œè¢«åŠ¨æ¸…ç†â€ï¼Œå¹¶ä¸å¯é </li></ol></li><li><code>ThreadLocal.ThreadLocalMap</code> æœ‰æ²¡æœ‰ä½ç½®å†²çªï¼Ÿå®ƒæ˜¯å¦‚ä½•è§£å†³ä½ç½®å†²çªçš„ï¼Ÿ<ol><li>æœ‰ï¼Œå®ƒæ˜¯é‡‡å– â€œçº¿æ€§æ¢æµ‹â€ çš„æ–¹å¼è§£å†³ä½ç½®å†²çªçš„ã€‚å³ å¦‚æœ <code>i</code> å·²ç»è¢«å ç”¨ï¼Œå°±å°è¯• <code>i + 1</code>ï¼Œä»¥æ­¤ç±»æ¨â€¦</li><li>åœ¨è°ƒç”¨ <code>ThreadLocal#set</code> æˆ– <code>ThreadLocal#get</code> åï¼Œå¦‚æœå‘ç”Ÿäº†çº¿æ€§æ¢æµ‹ï¼Œé‚£ä¹ˆåœ¨æ¢æµ‹çš„è¿‡ç¨‹ä¸­é‡åˆ°æŸä½ç½®çš„ <code>Key</code> ä¸º <code>null</code> æ—¶ï¼Œä¼šé¡ºæ‰‹æŠŠè¿™ä¸ªä½ç½®çš„ <code>Value</code> æ¸…ç†äº†</li></ol></li></ol></li></ol></blockquote><hr><h3 id="3-2-ThreadLocal-ThreadLocalMap-ä½¿ç”¨æ–¹å¼"><a href="#3-2-ThreadLocal-ThreadLocalMap-ä½¿ç”¨æ–¹å¼" class="headerlink" title="3.2. ThreadLocal.ThreadLocalMap ä½¿ç”¨æ–¹å¼"></a>3.2. ThreadLocal.ThreadLocalMap ä½¿ç”¨æ–¹å¼</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadLocalDemo</span> &#123;<br><br>    <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ª ThreadLocal å®ä¾‹ï¼Œé€šå¸¸ç”± static final ä¿®é¥°</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> ThreadLocal&lt;String&gt; userContext = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadLocal</span>&lt;&gt;();<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; &#123;<br>            <span class="hljs-comment">// å­˜æ•°æ®</span><br>            userContext.set(<span class="hljs-string">&quot;ç”¨æˆ·Açš„æ•°æ®&quot;</span>);<br>            <span class="hljs-comment">// å–æ•°æ®</span><br>            System.out.println(Thread.currentThread().getName() + <span class="hljs-string">&quot; è·å–: &quot;</span> + userContext.get());<br>            <span class="hljs-comment">// åˆ æ•°æ®</span><br>            userContext.remove();<br>        &#125;, <span class="hljs-string">&quot;Thread-A&quot;</span>).start();<br><br>        <span class="hljs-comment">// æ¨¡æ‹Ÿçº¿ç¨‹ B</span><br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; &#123;<br>            userContext.set(<span class="hljs-string">&quot;ç”¨æˆ·Bçš„æ•°æ®&quot;</span>);<br>            System.out.println(Thread.currentThread().getName() + <span class="hljs-string">&quot; è·å–: &quot;</span> + userContext.get());<br>            userContext.remove();<br>        &#125;, <span class="hljs-string">&quot;Thread-B&quot;</span>).start();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œçœ‹èµ·æ¥åƒæ˜¯åœ¨å¯¹ <code>ThreadLocal</code> å®ä¾‹æœ¬èº«è¿›è¡Œè¯»å†™ï¼Œä½†çœŸæ­£çš„é€»è¾‘æ˜¯ï¼šé€šè¿‡å½“å‰çº¿ç¨‹æ‰¾åˆ°å®ƒæ‰€æŒæœ‰çš„ <code>ThreadLocal.ThreadLocalMap</code>ï¼Œç„¶ååœ¨è¿™ä¸ª <code>Map</code> çš„ <code>Entry[]</code> ä¸­ï¼Œä»¥å½“å‰ <code>ThreadLocal</code> å®ä¾‹ä¸º <code>Key</code> è¿›è¡Œè¯»å†™ã€‚</li><li>çŒ´å“¥çš„çƒ¦æ¼ç®± <code>(ï½¡â€¢Ìï¸¿â€¢Ì€ï½¡)</code><ol><li>ä¸ºä»€ä¹ˆ <code>ThreadLocal</code> å®ä¾‹é€šå¸¸ç”± <code>static final</code> ä¿®é¥°ï¼Ÿ<ol><li>è¿™ä¸»è¦æ˜¯ä¸ºäº†å‡å°‘å†…å­˜å ç”¨ï¼Œå› ä¸ºå³ä¾¿å¤šä¸ª <code>ThreadLocal.ThreadLocalMap</code> ä½¿ç”¨åŒä¸€ä¸ª <code>ThreadLocal</code> å®ä¾‹å½“ <code>Key</code>ï¼Œä½†æ˜¯å®ƒä»¬äº’ä¸å½±å“ã€‚æ‰€ä»¥æ²¡å¿…è¦ä¸“é—¨ä¸ºæ¯ä¸€ä¸ª <code>ThreadLocal.ThreadLocalMap</code> åˆ›å»ºä¸€ä¸ª <code>ThreadLocal</code> å®ä¾‹</li></ol></li></ol></li></ol></blockquote><hr><h3 id="3-3-ThreadLocal-ThreadLocalMap-é—®é¢˜çˆ†ç ´"><a href="#3-3-ThreadLocal-ThreadLocalMap-é—®é¢˜çˆ†ç ´" class="headerlink" title="3.3. ThreadLocal.ThreadLocalMap é—®é¢˜çˆ†ç ´"></a>3.3. ThreadLocal.ThreadLocalMap é—®é¢˜çˆ†ç ´</h3><h4 id="3-3-1-æ•°æ®-â€œè„è¯»â€"><a href="#3-3-1-æ•°æ®-â€œè„è¯»â€" class="headerlink" title="3.3.1. æ•°æ® â€œè„è¯»â€"></a>3.3.1. æ•°æ® â€œè„è¯»â€</h4><p>æŸçº¿ç¨‹åœ¨å¤„ç†ä¸Šä¸€ä¸ªä»»åŠ¡æ—¶ï¼Œå‘ <code>ThreadLocal</code> å†™å…¥äº†æ•°æ®ï¼Œä½†æ˜¯ä»»åŠ¡ç»“æŸåæ²¡æœ‰æ¸…ç†æ•°æ®ã€‚å½“è¯¥çº¿ç¨‹å»å¤„ç†ä¸‹ä¸€ä¸ªä»»åŠ¡çš„æ—¶å€™ï¼Œè°ƒç”¨ <code>ThreadLocal#get</code> ä¼šè¯»åˆ°ä¸Šä¸€ä¸ªä»»åŠ¡é—ç•™ä¸‹æ¥çš„æ•°æ®</p><p>ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦ä»»åŠ¡ç»“æŸåè°ƒç”¨ <code>Thread#remove</code> åˆ é™¤æ•°æ®</p><hr><h4 id="3-3-2-å†…å­˜æ³„æ¼"><a href="#3-3-2-å†…å­˜æ³„æ¼" class="headerlink" title="3.3.2. å†…å­˜æ³„æ¼"></a>3.3.2. å†…å­˜æ³„æ¼</h4><p>ç”±äº <code>ThreadLocal.ThreadLocalMap</code> çš„ <code>Key</code> æ˜¯å¼±å¼•ç”¨ï¼Œè€Œ <code>Value</code> æ˜¯å¼ºå¼•ç”¨ã€‚æ‰€ä»¥å½“ <code>ThreadLocal</code> å®ä¾‹è¢«å›æ”¶åï¼Œ<code>Key</code> ä¼šå˜æˆ <code>null</code>ï¼Œä½†æ˜¯å¯¹åº”çš„ <code>Value</code> ä»ç„¶å­˜åœ¨ï¼Œæ— æ³•è¢«å›æ”¶</p><p>ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦ä»»åŠ¡ç»“æŸåè°ƒç”¨ <code>Thread#remove</code> åˆ é™¤æ•°æ®</p><hr><h2 id="4-å†…éƒ¨ç±»"><a href="#4-å†…éƒ¨ç±»" class="headerlink" title="4. å†…éƒ¨ç±»"></a>4. å†…éƒ¨ç±»</h2><h3 id="4-1-Entry"><a href="#4-1-Entry" class="headerlink" title="4.1. Entry"></a>4.1. Entry</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Entry</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">WeakReference</span>&lt;ThreadLocal&lt;?&gt;&gt; &#123;<br><br>Object value;<br><br>Entry(ThreadLocal&lt;?&gt; k, Object v) &#123;<br><span class="hljs-built_in">super</span>(k);<br>value = v;<br>&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h2 id="5-æ ¸å¿ƒå±æ€§"><a href="#5-æ ¸å¿ƒå±æ€§" class="headerlink" title="5. æ ¸å¿ƒå±æ€§"></a>5. æ ¸å¿ƒå±æ€§</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">INITIAL_CAPACITY</span> <span class="hljs-operator">=</span> <span class="hljs-number">16</span>;<br><br><span class="hljs-keyword">private</span> Entry[] table;<br><br><span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">size</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br><br><span class="hljs-keyword">private</span> <span class="hljs-type">int</span> threshold;<br></code></pre></td></tr></table></figure><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.util.concurrent.CountDownLatch æºç è§£æ</title>
    <link href="/2025/11/16/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.CountDownLatch%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/11/16/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.CountDownLatch%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/11/16/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.CountDownLatch%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/16/æºç ï¼šjava.util.concurrent.CountDownLatchæºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-CountDownLatch-æ¦‚è¿°"><a href="#3-1-CountDownLatch-æ¦‚è¿°" class="headerlink" title="3.1. CountDownLatch æ¦‚è¿°"></a>3.1. CountDownLatch æ¦‚è¿°</h3><p><code>CountDownLatch</code> æ˜¯ä¸€ä¸ªå…·ä½“ç±»</p><p>å€’è®¡æ—¶é—¨é—©ï¼ˆ<code>CountDownLatch</code>ï¼‰æ˜¯ä½¿ç”¨ <code>AQS</code> å®ç°çš„å…±äº«æ¨¡å¼çš„åŒæ­¥å™¨ã€‚<code>State</code> å’Œå…±äº«èµ„æºåˆ†åˆ«è¡¨ç¤ºä»¥ä¸‹å«ä¹‰ï¼š</p><ol><li><code>State</code> è¡¨ç¤ºé—¨é—©æ˜¯å¦å¼€å¯<ol><li><code>0</code><ol><li>é—¨é—©å¼€å¯</li></ol></li><li><code>n</code>ï¼ˆ<code>n &gt; 0</code>ï¼‰<ol><li>é—¨é—©å…³é—­</li></ol></li></ol></li><li>å…±äº«èµ„æºè¡¨ç¤ºé—¨é—©å¼€å¯åï¼Œè¢«å…è®¸æ‰§è¡Œçš„æ“ä½œ</li></ol><p>æˆ‘ä»¬å¯ä»¥å°† <code>CountDownLatch</code> ç®€å•çš„ç†è§£ä¸ºï¼šä¸€æ¬¡æ€§çš„ã€åªåšå‡æ³•çš„è®¡æ•°å™¨ã€‚</p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>ç®€å•ç†è§£ <code>CountDownLatch</code>ã€<code>CyclicBarrier</code>ã€<code>Semaphore</code>ï¼š<ol><li><code>CountDownLatch</code> æ˜¯é—¨é—©å¼€å¯æ‰èƒ½ç»§ç»­æ‰§è¡Œ</li><li><code>CyclicBarrier</code> æ˜¯ â€œäº’ç›¸ç­‰å¾…â€ éƒ½å‡†å¤‡å¥½æ‰èƒ½ç»§ç»­æ‰§è¡Œ</li><li><code>Semaphore</code> æ˜¯æ‹¿åˆ° â€œè®¸å¯è¯â€ æ‰èƒ½ç»§ç»­æ‰§è¡Œ</li></ol></li></ol></blockquote><hr><h3 id="3-2-CountDownLatch-åº”ç”¨åœºæ™¯"><a href="#3-2-CountDownLatch-åº”ç”¨åœºæ™¯" class="headerlink" title="3.2. CountDownLatch åº”ç”¨åœºæ™¯"></a>3.2. CountDownLatch åº”ç”¨åœºæ™¯</h3><h4 id="3-2-1-æ±‡æ€»æ¨¡å¼"><a href="#3-2-1-æ±‡æ€»æ¨¡å¼" class="headerlink" title="3.2.1. æ±‡æ€»æ¨¡å¼"></a>3.2.1. æ±‡æ€»æ¨¡å¼</h4><p>æ±‡æ€»æ¨¡å¼æ˜¯æŒ‡ï¼šä¸»çº¿ç¨‹ç­‰å¾…å¤šä¸ªå­çº¿ç¨‹å‡†å¤‡å¥½åï¼Œæ‰èƒ½ç»§ç»­æ‰§è¡Œ</p><p>æˆ‘ä»¬å¯ä»¥ç®€å•çš„ç†è§£ä¸ºï¼šä¸»çº¿ç¨‹ç­‰å¾…ï¼Œå­çº¿ç¨‹å‡æ•°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> InterruptedException &#123;<br><br>        <span class="hljs-type">CountDownLatch</span> <span class="hljs-variable">myCountDownlatch</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CountDownLatch</span>(<span class="hljs-number">3</span>);<br><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++) &#123;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">finalI</span> <span class="hljs-operator">=</span> i;<br>            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; &#123;<br>                System.out.println(finalI);<br>                <br>                <span class="hljs-comment">// è°ƒç”¨ CountDownLatch#countDown</span><br>                myCountDownlatch.countDown();<br>            &#125;).start();<br>        &#125;<br><br><span class="hljs-comment">// è°ƒç”¨ CountDownLatch#await</span><br>        myCountDownlatch.await();<br>        <br>        System.out.println(<span class="hljs-string">&quot;å¤©ä¸‹è´¤æ‰å°½æ•°ä¼šäºéº¾ä¸‹ï¼&quot;</span>);<br><br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><h4 id="3-2-2-å‘ä»¤æªæ¨¡å¼"><a href="#3-2-2-å‘ä»¤æªæ¨¡å¼" class="headerlink" title="3.2.2. å‘ä»¤æªæ¨¡å¼"></a>3.2.2. å‘ä»¤æªæ¨¡å¼</h4><p>å‘ä»¤æªæ¨¡å¼æ˜¯æŒ‡ï¼šå¤šä¸ªå­çº¿ç¨‹å‡†å¤‡å¥½åï¼Œç­‰å¾…ä¸»çº¿ç¨‹ â€œå‘æªâ€ï¼Œæ‰èƒ½ç»§ç»­æ‰§è¡Œ</p><p>æˆ‘ä»¬å¯ä»¥ç®€å•çš„ç†è§£ä¸ºï¼šå­çº¿ç¨‹ç­‰å¾…ï¼Œä¸»çº¿ç¨‹å‡æ•°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> InterruptedException &#123;<br><br>        <span class="hljs-type">CountDownLatch</span> <span class="hljs-variable">myCountDownlatch</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CountDownLatch</span>(<span class="hljs-number">1</span>);<br><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++) &#123;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">finalI</span> <span class="hljs-operator">=</span> i;<br>            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; &#123;<br>                <span class="hljs-keyword">try</span> &#123;<br>                <br>                <span class="hljs-comment">// è°ƒç”¨ CountDownLatch#await</span><br>                    myCountDownlatch.await();<br>                    System.out.println(finalI);<br>                    myCountDownlatch.countDown();<br>                &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(e);<br>                &#125;<br>            &#125;).start();<br>        &#125;<br><br>        Thread.sleep(<span class="hljs-number">1000</span>);<br><br>        System.out.println(<span class="hljs-string">&quot;å¤©ä¸‹è´¤æ‰å°½æ•°å¬ä»¤è€ŒåŠ¨ï¼&quot;</span>);<br><br><span class="hljs-comment">// è°ƒç”¨ CountDownLatch#countDown</span><br>        myCountDownlatch.countDown();<br><br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h2 id="4-æºç éƒ¨åˆ†"><a href="#4-æºç éƒ¨åˆ†" class="headerlink" title="4. æºç éƒ¨åˆ†"></a>4. æºç éƒ¨åˆ†</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CountDownLatch</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Sync</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractQueuedSynchronizer</span> &#123;<br>    <br>        Sync(<span class="hljs-type">int</span> count) &#123;<br>            setState(count);<br>        &#125;<br><br>        <span class="hljs-type">int</span> <span class="hljs-title function_">getCount</span><span class="hljs-params">()</span> &#123;<br>            <span class="hljs-keyword">return</span> getState();<br>        &#125;<br><br>        <span class="hljs-keyword">protected</span> <span class="hljs-type">int</span> <span class="hljs-title function_">tryAcquireShared</span><span class="hljs-params">(<span class="hljs-type">int</span> acquires)</span> &#123;<br>            <span class="hljs-keyword">return</span> (getState() == <span class="hljs-number">0</span>) ? <span class="hljs-number">1</span> : -<span class="hljs-number">1</span>;<br>        &#125;<br><br>        <span class="hljs-keyword">protected</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryReleaseShared</span><span class="hljs-params">(<span class="hljs-type">int</span> releases)</span> &#123;<br>            <span class="hljs-keyword">for</span> (;;) &#123;<br>                <span class="hljs-type">int</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> getState();<br>                <span class="hljs-keyword">if</span> (c == <span class="hljs-number">0</span>)<br>                    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>                <span class="hljs-type">int</span> <span class="hljs-variable">nextc</span> <span class="hljs-operator">=</span> c - <span class="hljs-number">1</span>;<br>                <span class="hljs-keyword">if</span> (compareAndSetState(c, nextc))<br>                    <span class="hljs-keyword">return</span> nextc == <span class="hljs-number">0</span>;<br>            &#125;<br>        &#125;<br>        <br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Sync sync;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">CountDownLatch</span><span class="hljs-params">(<span class="hljs-type">int</span> count)</span> &#123;<br>        <span class="hljs-keyword">if</span> (count &lt; <span class="hljs-number">0</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">&quot;count &lt; 0&quot;</span>);<br>        <span class="hljs-built_in">this</span>.sync = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Sync</span>(count);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">await</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException &#123;<br>        sync.acquireSharedInterruptibly(<span class="hljs-number">1</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">await</span><span class="hljs-params">(<span class="hljs-type">long</span> timeout, TimeUnit unit)</span><br>        <span class="hljs-keyword">throws</span> InterruptedException &#123;<br>        <span class="hljs-keyword">return</span> sync.tryAcquireSharedNanos(<span class="hljs-number">1</span>, unit.toNanos(timeout));<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">countDown</span><span class="hljs-params">()</span> &#123;<br>        sync.releaseShared(<span class="hljs-number">1</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">long</span> <span class="hljs-title function_">getCount</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> sync.getCount();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">toString</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>.toString() + <span class="hljs-string">&quot;[Count = &quot;</span> + sync.getCount() + <span class="hljs-string">&quot;]&quot;</span>;<br>    &#125;<br>    <br>&#125;<br></code></pre></td></tr></table></figure><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.util.concurrent.CountedCompleterï¼œTï¼ æºç è§£æ</title>
    <link href="/2025/11/15/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.CountedCompleter%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/11/15/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.CountedCompleter%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/11/15/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.CountedCompleter%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/15/æºç ï¼šjava.util.concurrent.CountedCompleterï¼œTï¼æºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-CountedCompleter-æ¦‚è¿°"><a href="#3-1-CountedCompleter-æ¦‚è¿°" class="headerlink" title="3.1. CountedCompleter æ¦‚è¿°"></a>3.1. CountedCompleter æ¦‚è¿°</h3><p><code>CountedCompleter</code> æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œç»§æ‰¿äº† <code>java.util.concurrent.ForkJoinTaskï¼œVï¼</code><br><img src="/source/_posts/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.CountedCompleter%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.CountedCompleter%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.png"></p><p><code>CountedCompleter</code> æ˜¯ä¸€ä¸ª â€å¤©ä¹¦â€œ çº§åˆ«çš„ç±»ï¼Œå®ƒè®¾è®¡çš„åˆè¡·æ˜¯ï¼šè§£å†³ â€å½“ä¸€ç»„ä»»åŠ¡å®Œæˆåè§¦å‘ä¸€ä¸ªå›è°ƒâ€œ çš„é—®é¢˜ï¼Œä½†æ˜¯å®ƒç”¨èµ·æ¥éå¸¸çš„åç›´è§‰ï¼Œå¹¶ä¸”ææ˜“å‡ºé”™</p><p>è€Œ <code>CompletableFuture</code> å°±æ˜¯ <code>CountedCompleter</code> çš„ â€ç°ä»£æ˜“ç”¨ç‰ˆâ€œï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨ <code>CompletableFuture</code></p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>è¯¦è§æºç ï¼š<code>ForkJoinTaskï¼œVï¼</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ForkJoinTask%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.ForkJoinTaskï¼œVï¼æºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/11/15/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ForkJoinTask%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/15/æºç ï¼šjava.util.concurrent.ForkJoinTaskï¼œVï¼æºç è§£æ/</a></li></ol></li></ol></li></ol></blockquote><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.util.concurrent.ForkJoinTaskï¼œVï¼ æºç è§£æ</title>
    <link href="/2025/11/15/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ForkJoinTask%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/11/15/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ForkJoinTask%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/11/15/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ForkJoinTask%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/15/æºç ï¼šjava.util.concurrent.ForkJoinTaskï¼œVï¼æºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-ForkJoinTask-æ¦‚è¿°"><a href="#3-1-ForkJoinTask-æ¦‚è¿°" class="headerlink" title="3.1. ForkJoinTask æ¦‚è¿°"></a>3.1. ForkJoinTask æ¦‚è¿°</h3><p><code>ForkJoinTask</code> æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå®ç°äº† <code>java.util.concurren.Futureï¼œVï¼</code>ã€<code>java.io.Serializable</code><br><img src="/source/_posts/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ForkJoinTask%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ForkJoinTask%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.png"></p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>è¯¦è§æºç ï¼š<code>Futureï¼œVï¼</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurren.Future%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurren.Futureï¼œVï¼æºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/09/02/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurren.Future%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/09/02/æºç ï¼šjava.util.concurren.Futureï¼œVï¼æºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>Serializableæºç è§£æ</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.io.Serializable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.io.Serializableæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/10/28/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.io.Serializable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/10/28/æºç ï¼šjava.io.Serializableæºç è§£æ/</a></li></ol></li></ol></li><li>å¯¹äº <code>ForkJoinPool</code>ã€<code>ForkJoinTask</code>ã€<code>RecursiveAction</code>ã€<code>RecursiveTask&lt;V&gt;</code>ï¼Œå¯ä»¥è¯´æ˜¯æ•´ä¸ª <code>JUC</code> ä¸­æœ€å¤æ‚çš„ä¸€éƒ¨åˆ†ï¼Œ<code>Doug Lea</code> å½“åˆä¸ºå®ƒä»¬æŠ•å…¥äº†å¤§é‡å¿ƒè¡€ã€‚å¯¹äºæˆ‘ä»¬è€Œè¨€ï¼Œåªéœ€è¦æŒæ¡å®ƒä»¬çš„ä½¿ç”¨æ–¹å¼å³å¯ï¼Œæ²¡å¿…è¦å¯¹æºç è¿›è¡Œè¿‡åº¦æ·±ç©¶ã€‚è¯¦è§æºç ï¼š<code>ForkJoinPool</code>ï¼ˆ<code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ForkJoinPool%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.ForkJoinPoolæºç è§£æ</a>ï¼Œ<code>Hexo</code> é“¾æ¥ï¼š <a href="http://blog.wangjia.ink/2025/11/14/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ForkJoinPool%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/14/æºç ï¼šjava.util.concurrent.ForkJoinPoolæºç è§£æ/</a> ï¼‰</li></ol></blockquote><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.util.concurrent.RecursiveAction æºç è§£æ</title>
    <link href="/2025/11/15/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.RecursiveAction%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/11/15/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.RecursiveAction%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/11/15/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.RecursiveAction%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/15/æºç ï¼šjava.util.concurrent.RecursiveActionæºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-RecursiveAction-æ¦‚è¿°"><a href="#3-1-RecursiveAction-æ¦‚è¿°" class="headerlink" title="3.1. RecursiveAction æ¦‚è¿°"></a>3.1. RecursiveAction æ¦‚è¿°</h3><p><code>RecursiveAction</code> æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œç»§æ‰¿äº† <code>java.util.concurrent.ForkJoinTaskï¼œVï¼</code><br><img src="/source/_posts/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.RecursiveAction%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.RecursiveAction%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.png"></p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>è¯¦è§æºç ï¼š<code>ForkJoinTaskï¼œVï¼</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ForkJoinTask%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.ForkJoinTaskï¼œVï¼æºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/11/15/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ForkJoinTask%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/15/æºç ï¼šjava.util.concurrent.ForkJoinTaskï¼œVï¼æºç è§£æ/</a></li></ol></li></ol></li><li>å¯¹äº <code>ForkJoinPool</code>ã€<code>ForkJoinTask</code>ã€<code>RecursiveAction</code>ã€<code>RecursiveTask&lt;V&gt;</code>ï¼Œå¯ä»¥è¯´æ˜¯æ•´ä¸ª <code>JUC</code> ä¸­æœ€å¤æ‚çš„ä¸€éƒ¨åˆ†ï¼Œ<code>Doug Lea</code> å½“åˆä¸ºå®ƒä»¬æŠ•å…¥äº†å¤§é‡å¿ƒè¡€ã€‚å¯¹äºæˆ‘ä»¬è€Œè¨€ï¼Œåªéœ€è¦æŒæ¡å®ƒä»¬çš„ä½¿ç”¨æ–¹å¼å³å¯ï¼Œæ²¡å¿…è¦å¯¹æºç è¿›è¡Œè¿‡åº¦æ·±ç©¶ã€‚è¯¦è§æºç ï¼š<code>ForkJoinPool</code>ï¼ˆ<code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ForkJoinPool%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.ForkJoinPoolæºç è§£æ</a>ï¼Œ<code>Hexo</code> é“¾æ¥ï¼š <a href="http://blog.wangjia.ink/2025/11/14/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ForkJoinPool%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/14/æºç ï¼šjava.util.concurrent.ForkJoinPoolæºç è§£æ/</a> ï¼‰</li></ol></blockquote><hr><h2 id="4-æºç éƒ¨åˆ†"><a href="#4-æºç éƒ¨åˆ†" class="headerlink" title="4. æºç éƒ¨åˆ†"></a>4. æºç éƒ¨åˆ†</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RecursiveAction</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ForkJoinTask</span>&lt;Void&gt; &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-variable">serialVersionUID</span> <span class="hljs-operator">=</span> <span class="hljs-number">5232453952276485070L</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">RecursiveAction</span><span class="hljs-params">()</span> &#123;&#125;<br><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">compute</span><span class="hljs-params">()</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> Void <span class="hljs-title function_">getRawResult</span><span class="hljs-params">()</span> &#123; <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>; &#125;<br><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setRawResult</span><span class="hljs-params">(Void mustBeNull)</span> &#123; &#125;<br><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">exec</span><span class="hljs-params">()</span> &#123;<br>        compute();<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.util.concurrent.RecursiveTaskï¼œVï¼ æºç è§£æ</title>
    <link href="/2025/11/15/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.RecursiveTask%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/11/15/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.RecursiveTask%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/11/15/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.RecursiveTask%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/15/æºç ï¼šjava.util.concurrent.RecursiveTaskï¼œVï¼æºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="RecursiveTask-æ¦‚è¿°"><a href="#RecursiveTask-æ¦‚è¿°" class="headerlink" title="RecursiveTask æ¦‚è¿°"></a>RecursiveTask æ¦‚è¿°</h3><p><code>RecursiveTask</code> æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œç»§æ‰¿äº† <code>java.util.concurrent.ForkJoinTaskï¼œVï¼</code><br><img src="/source/_posts/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.RecursiveTask%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.RecursiveTask%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.png"></p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>è¯¦è§æºç ï¼š<code>ForkJoinTaskï¼œVï¼</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ForkJoinTask%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.ForkJoinTaskï¼œVï¼æºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/11/15/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ForkJoinTask%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/15/æºç ï¼šjava.util.concurrent.ForkJoinTaskï¼œVï¼æºç è§£æ/</a></li></ol></li></ol></li><li>å¯¹äº <code>ForkJoinPool</code>ã€<code>ForkJoinTask</code>ã€<code>RecursiveAction</code>ã€<code>RecursiveTask&lt;V&gt;</code>ï¼Œå¯ä»¥è¯´æ˜¯æ•´ä¸ª <code>JUC</code> ä¸­æœ€å¤æ‚çš„ä¸€éƒ¨åˆ†ï¼Œ<code>Doug Lea</code> å½“åˆä¸ºå®ƒä»¬æŠ•å…¥äº†å¤§é‡å¿ƒè¡€ã€‚å¯¹äºæˆ‘ä»¬è€Œè¨€ï¼Œåªéœ€è¦æŒæ¡å®ƒä»¬çš„ä½¿ç”¨æ–¹å¼å³å¯ï¼Œæ²¡å¿…è¦å¯¹æºç è¿›è¡Œè¿‡åº¦æ·±ç©¶ã€‚è¯¦è§æºç ï¼š<code>ForkJoinPool</code>ï¼ˆ<code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ForkJoinPool%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.ForkJoinPoolæºç è§£æ</a>ï¼Œ<code>Hexo</code> é“¾æ¥ï¼šï¼‰</li></ol></blockquote><hr><h2 id="æºç éƒ¨åˆ†"><a href="#æºç éƒ¨åˆ†" class="headerlink" title="æºç éƒ¨åˆ†"></a>æºç éƒ¨åˆ†</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RecursiveTask</span>&lt;V&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ForkJoinTask</span>&lt;V&gt; &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-variable">serialVersionUID</span> <span class="hljs-operator">=</span> <span class="hljs-number">5232453952276485270L</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">RecursiveTask</span><span class="hljs-params">()</span> &#123;&#125;<br><br>    <span class="hljs-meta">@SuppressWarnings(&quot;serial&quot;)</span><br>    V result;<br>    <br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">abstract</span> V <span class="hljs-title function_">compute</span><span class="hljs-params">()</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> V <span class="hljs-title function_">getRawResult</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;<br><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setRawResult</span><span class="hljs-params">(V value)</span> &#123;<br>        result = value;<br>    &#125;<br><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">exec</span><span class="hljs-params">()</span> &#123;<br>        result = compute();<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.util.concurrent.ScheduledThreadPoolExecutor.ScheduledFutureTaskï¼œVï¼ æºç è§£æ</title>
    <link href="/2025/11/15/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ScheduledThreadPoolExecutor.ScheduledFutureTask%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/11/15/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ScheduledThreadPoolExecutor.ScheduledFutureTask%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/11/15/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ScheduledThreadPoolExecutor.ScheduledFutureTask%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/15/æºç ï¼šjava.util.concurrent.ScheduledThreadPoolExecutor.ScheduledFutureTaskï¼œVï¼æºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-ScheduledThreadPoolExecutor-ScheduledFutureTask-æ¦‚è¿°"><a href="#3-1-ScheduledThreadPoolExecutor-ScheduledFutureTask-æ¦‚è¿°" class="headerlink" title="3.1. ScheduledThreadPoolExecutor.ScheduledFutureTask æ¦‚è¿°"></a>3.1. ScheduledThreadPoolExecutor.ScheduledFutureTask æ¦‚è¿°</h3><p><code>ScheduledThreadPoolExecutor.ScheduledFutureTask</code> æ˜¯ä¸€ä¸ªå…·ä½“ç±»ï¼Œæ˜¯ <code>java.util.concurrent.ScheduledThreadPoolExecutor</code> çš„æ™®é€šå†…éƒ¨ç±»ï¼Œç»§æ‰¿äº† <code>java.util.concurrent.FutureTaskï¼œVï¼</code>ã€<code>java.util.concurrent.RunnableScheduledFutureï¼œVï¼</code><br><img src="/source/_posts/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ScheduledThreadPoolExecutor.ScheduledFutureTask%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ScheduledThreadPoolExecutor.ScheduledFutureTask%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.png"></p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>è¯¦è§æºç ï¼š<code>FutureTaskï¼œVï¼</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.FutureTask%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.FutureTaskï¼œVï¼æºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/11/03/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.FutureTask%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/03/æºç ï¼šjava.util.concurrent.FutureTaskï¼œVï¼æºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>RunnableScheduledFutureï¼œVï¼</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.RunnableScheduledFuture%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.RunnableScheduledFutureï¼œVï¼æºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/05/05/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.RunnableScheduledFuture%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/05/05/æºç ï¼šjava.util.concurrent.RunnableScheduledFutureï¼œVï¼æºç è§£æ/</a></li></ol></li></ol></li></ol></blockquote><hr><h2 id="4-æ ¸å¿ƒå±æ€§"><a href="#4-æ ¸å¿ƒå±æ€§" class="headerlink" title="4. æ ¸å¿ƒå±æ€§"></a>4. æ ¸å¿ƒå±æ€§</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// è¡¨ç¤ºä»»åŠ¡æ‰§è¡Œç‚¹</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// å“ªäº›éœ€è¦æ’åºçš„ Java æ•°æ®ç±»å‹å°±æ˜¯ä»¥ä»»åŠ¡æ‰§è¡Œç‚¹è¿›è¡Œæ’åºçš„</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">long</span> time;<br><br><span class="hljs-comment">// è¡¨ç¤ºä»»åŠ¡åºå·</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// å¦‚æœå¤šä¸ª FutureTask çš„ä»»åŠ¡æ‰§è¡Œç‚¹ç›¸åŒï¼Œä»»åŠ¡åºå·å°çš„ä»»åŠ¡ä¼šæ’åœ¨å‰é¢</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> sequenceNumber;<br><br><span class="hljs-comment">// è¡¨ç¤ºä»»åŠ¡æ˜¯å¦æ˜¯å‘¨æœŸæ€§ä»»åŠ¡ï¼Œä»¥åŠå¦‚ä½•è¿›è¡Œå‘¨æœŸæ€§</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// å¯é€‰å‚æ•°åŒ…æ‹¬ï¼š</span><br><span class="hljs-comment">//     1. 0</span><br><span class="hljs-comment">//         1. â€œä¸€æ¬¡æ€§â€ ä»»åŠ¡</span><br><span class="hljs-comment">//     2. nï¼ˆn &gt; 0ï¼‰</span><br><span class="hljs-comment">//         1. ä»¥ period çš„å›ºå®šé€Ÿç‡ï¼Œå‘¨æœŸæ€§æ‰§è¡Œä»»åŠ¡</span><br><span class="hljs-comment">//     2. nï¼ˆn &lt; 0ï¼‰</span><br><span class="hljs-comment">//         1. ä»¥ period çš„å›ºå®šå»¶è¿Ÿï¼Œå‘¨æœŸæ€§æ‰§è¡Œä»»åŠ¡</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> period;<br><br><span class="hljs-comment">// è¡¨ç¤ºä»»åŠ¡å¯¹åº”çš„äºŒå‰å †ç´¢å¼•</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// å †ç´¢å¼•æ˜¯ä¸ºäº†å®ç°å¿«é€Ÿ Future#cancel æ“ä½œçš„é‡å¤§ä¼˜åŒ–</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// å› ä¸º DelayQueue ä½¿ç”¨äº† PriorityQueue,è€Œ PriorityQueue åº•å±‚åŸºäºäºŒå‰å †ï¼Œè€ŒäºŒå‰å †åº•å±‚åˆåŸºäºæ•°ç»„</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// å¦‚æœæ²¡æœ‰ heapIndex å¹¶è°ƒç”¨ Future#cancelï¼Œå°±éœ€è¦éå†æ•°ç»„å»æ‰¾åˆ°è¿™ä¸ªä»»åŠ¡ï¼Œç„¶åå†è¿›è¡Œåˆ é™¤</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// å¦‚æœæ‹¥æœ‰ heapIndexï¼Œå½“ä»»åŠ¡åœ¨ DelayQueue å˜åŒ–ä½ç½®æ—¶ï¼Œä¼šè‡ªåŠ¨æ›´æ–°è¿™ä¸ª heapIndexï¼Œé‚£ä¹ˆ heapIndex æ˜¯ç›´æŒ‡è¿™ä¸ªä»»åŠ¡çš„ã€‚æ‰€ä»¥è°ƒç”¨ Future#cancel çš„æ—¶å€™ï¼Œå°±å¯ä»¥ç›´æ¥æ ¹æ® heapIndex æ‰¾åˆ°è¿™ä¸ªä»»åŠ¡ï¼Œç„¶åå†è¿›è¡Œåˆ é™¤</span><br><span class="hljs-type">int</span> heapIndex;<br></code></pre></td></tr></table></figure><hr><h2 id="5-æ„é€ æ–¹æ³•"><a href="#5-æ„é€ æ–¹æ³•" class="headerlink" title="5. æ„é€ æ–¹æ³•"></a>5. æ„é€ æ–¹æ³•</h2><h3 id="5-1-ScheduledFutureTask-Callableï¼œVï¼-callable-long-triggerTime-long-sequenceNumber"><a href="#5-1-ScheduledFutureTask-Callableï¼œVï¼-callable-long-triggerTime-long-sequenceNumber" class="headerlink" title="5.1. ScheduledFutureTask(Callableï¼œVï¼ callable, long triggerTime, long sequenceNumber)"></a>5.1. ScheduledFutureTask(Callableï¼œVï¼ callable, long triggerTime, long sequenceNumber)</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java">ScheduledFutureTask(Callable&lt;V&gt; callable, <span class="hljs-type">long</span> triggerTime,<br><span class="hljs-type">long</span> sequenceNumber) &#123;<br><span class="hljs-built_in">super</span>(callable);<br><span class="hljs-built_in">this</span>.time = triggerTime;<br><span class="hljs-built_in">this</span>.period = <span class="hljs-number">0</span>;<br><span class="hljs-built_in">this</span>.sequenceNumber = sequenceNumber;<br>&#125;<br></code></pre></td></tr></table></figure><hr><h3 id="5-2-ScheduledFutureTask-Runnable-r-V-result-long-triggerTime-long-sequenceNumber"><a href="#5-2-ScheduledFutureTask-Runnable-r-V-result-long-triggerTime-long-sequenceNumber" class="headerlink" title="5.2. ScheduledFutureTask(Runnable r, V result, long triggerTime, long sequenceNumber)"></a>5.2. ScheduledFutureTask(Runnable r, V result, long triggerTime, long sequenceNumber)</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java">ScheduledFutureTask(Runnable r, V result, <span class="hljs-type">long</span> triggerTime,<br><span class="hljs-type">long</span> sequenceNumber) &#123;<br><span class="hljs-built_in">super</span>(r, result);<br><span class="hljs-built_in">this</span>.time = triggerTime;<br><span class="hljs-built_in">this</span>.period = <span class="hljs-number">0</span>;<br><span class="hljs-built_in">this</span>.sequenceNumber = sequenceNumber;<br>&#125;<br></code></pre></td></tr></table></figure><hr><h3 id="5-3-ScheduledFutureTask-Runnable-r-V-result-long-triggerTime-long-period-long-sequenceNumber"><a href="#5-3-ScheduledFutureTask-Runnable-r-V-result-long-triggerTime-long-period-long-sequenceNumber" class="headerlink" title="5.3. ScheduledFutureTask(Runnable r, V result, long triggerTime, long period, long sequenceNumber)"></a>5.3. ScheduledFutureTask(Runnable r, V result, long triggerTime, long period, long sequenceNumber)</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java">ScheduledFutureTask(Runnable r, V result, <span class="hljs-type">long</span> triggerTime,<br><span class="hljs-type">long</span> period, <span class="hljs-type">long</span> sequenceNumber) &#123;<br><span class="hljs-built_in">super</span>(r, result);<br><span class="hljs-built_in">this</span>.time = triggerTime;<br><span class="hljs-built_in">this</span>.period = period;<br><span class="hljs-built_in">this</span>.sequenceNumber = sequenceNumber;<br>&#125;<br></code></pre></td></tr></table></figure><hr><h2 id="6-å®ä¾‹æ–¹æ³•"><a href="#6-å®ä¾‹æ–¹æ³•" class="headerlink" title="6. å®ä¾‹æ–¹æ³•"></a>6. å®ä¾‹æ–¹æ³•</h2><h3 id="6-1-å®ä¾‹å…·ä½“æ–¹æ³•"><a href="#6-1-å®ä¾‹å…·ä½“æ–¹æ³•" class="headerlink" title="6.1. å®ä¾‹å…·ä½“æ–¹æ³•"></a>6.1. å®ä¾‹å…·ä½“æ–¹æ³•</h3><h4 id="6-1-1-å…·ä½“æ–¹æ³•ï¼ˆæ™®é€šï¼‰"><a href="#6-1-1-å…·ä½“æ–¹æ³•ï¼ˆæ™®é€šï¼‰" class="headerlink" title="6.1.1. å…·ä½“æ–¹æ³•ï¼ˆæ™®é€šï¼‰"></a>6.1.1. å…·ä½“æ–¹æ³•ï¼ˆæ™®é€šï¼‰</h4><h5 id="6-1-1-1-void-setNextRunTime"><a href="#6-1-1-1-void-setNextRunTime" class="headerlink" title="6.1.1.1. void setNextRunTime()"></a>6.1.1.1. void setNextRunTime()</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setNextRunTime</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-type">long</span> <span class="hljs-variable">p</span> <span class="hljs-operator">=</span> period;<br><span class="hljs-keyword">if</span> (p &gt; <span class="hljs-number">0</span>)<br>time += p;<br><span class="hljs-keyword">else</span><br>time = triggerTime(-p);<br>&#125;<br></code></pre></td></tr></table></figure><hr><h4 id="6-1-2-å…·ä½“æ–¹æ³•ï¼ˆå®ç°ï¼‰"><a href="#6-1-2-å…·ä½“æ–¹æ³•ï¼ˆå®ç°ï¼‰" class="headerlink" title="6.1.2. å…·ä½“æ–¹æ³•ï¼ˆå®ç°ï¼‰"></a>6.1.2. å…·ä½“æ–¹æ³•ï¼ˆå®ç°ï¼‰</h4><h5 id="6-1-2-1-Comparableï¼œTï¼-ä¸­æ¥å£æ–¹æ³•çš„å®ç°"><a href="#6-1-2-1-Comparableï¼œTï¼-ä¸­æ¥å£æ–¹æ³•çš„å®ç°" class="headerlink" title="6.1.2.1. Comparableï¼œTï¼ ä¸­æ¥å£æ–¹æ³•çš„å®ç°"></a>6.1.2.1. Comparableï¼œTï¼ ä¸­æ¥å£æ–¹æ³•çš„å®ç°</h5><h6 id="6-1-2-1-1-int-compareTo-Delayed-other"><a href="#6-1-2-1-1-int-compareTo-Delayed-other" class="headerlink" title="6.1.2.1.1. int compareTo(Delayed other)"></a>6.1.2.1.1. int compareTo(Delayed other)</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">compareTo</span><span class="hljs-params">(Delayed other)</span> &#123;<br><span class="hljs-keyword">if</span> (other == <span class="hljs-built_in">this</span>) <span class="hljs-comment">// compare zero if same object</span><br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br><span class="hljs-keyword">if</span> (other <span class="hljs-keyword">instanceof</span> ScheduledFutureTask) &#123;<br>ScheduledFutureTask&lt;?&gt; x = (ScheduledFutureTask&lt;?&gt;)other;<br><span class="hljs-type">long</span> <span class="hljs-variable">diff</span> <span class="hljs-operator">=</span> time - x.time;<br><span class="hljs-keyword">if</span> (diff &lt; <span class="hljs-number">0</span>)<br><span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;<br><span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (diff &gt; <span class="hljs-number">0</span>)<br><span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br><span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (sequenceNumber &lt; x.sequenceNumber)<br><span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;<br><span class="hljs-keyword">else</span><br><span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>&#125;<br><span class="hljs-type">long</span> <span class="hljs-variable">diff</span> <span class="hljs-operator">=</span> getDelay(NANOSECONDS) - other.getDelay(NANOSECONDS);<br><span class="hljs-keyword">return</span> (diff &lt; <span class="hljs-number">0</span>) ? -<span class="hljs-number">1</span> : (diff &gt; <span class="hljs-number">0</span>) ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><hr><h5 id="6-1-2-2-Runnable-ä¸­æ¥å£æ–¹æ³•çš„å®ç°"><a href="#6-1-2-2-Runnable-ä¸­æ¥å£æ–¹æ³•çš„å®ç°" class="headerlink" title="6.1.2.2. Runnable ä¸­æ¥å£æ–¹æ³•çš„å®ç°"></a>6.1.2.2. Runnable ä¸­æ¥å£æ–¹æ³•çš„å®ç°</h5><h6 id="6-1-2-2-1-void-run"><a href="#6-1-2-2-1-void-run" class="headerlink" title="6.1.2.2.1. void run()"></a>6.1.2.2.1. void run()</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-keyword">if</span> (!canRunInCurrentRunState(<span class="hljs-built_in">this</span>))<br>cancel(<span class="hljs-literal">false</span>);<br><span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!isPeriodic())<br><span class="hljs-built_in">super</span>.run();<br><span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">super</span>.runAndReset()) &#123;<br>setNextRunTime();<br>reExecutePeriodic(outerTask);<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><hr><h5 id="6-1-2-3-Delayed-ä¸­æ¥å£æ–¹æ³•çš„å®ç°"><a href="#6-1-2-3-Delayed-ä¸­æ¥å£æ–¹æ³•çš„å®ç°" class="headerlink" title="6.1.2.3. Delayed ä¸­æ¥å£æ–¹æ³•çš„å®ç°"></a>6.1.2.3. Delayed ä¸­æ¥å£æ–¹æ³•çš„å®ç°</h5><h6 id="6-1-2-3-1-long-getDelay-TimeUnit-unit"><a href="#6-1-2-3-1-long-getDelay-TimeUnit-unit" class="headerlink" title="6.1.2.3.1. long getDelay(TimeUnit unit)"></a>6.1.2.3.1. long getDelay(TimeUnit unit)</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-type">long</span> <span class="hljs-title function_">getDelay</span><span class="hljs-params">(TimeUnit unit)</span> &#123;<br><span class="hljs-keyword">return</span> unit.convert(time - System.nanoTime(), NANOSECONDS);<br>&#125;<br></code></pre></td></tr></table></figure><hr><h5 id="6-1-2-4-Futureï¼œVï¼-ä¸­æ¥å£æ–¹æ³•çš„å®ç°"><a href="#6-1-2-4-Futureï¼œVï¼-ä¸­æ¥å£æ–¹æ³•çš„å®ç°" class="headerlink" title="6.1.2.4. Futureï¼œVï¼ ä¸­æ¥å£æ–¹æ³•çš„å®ç°"></a>6.1.2.4. Futureï¼œVï¼ ä¸­æ¥å£æ–¹æ³•çš„å®ç°</h5><h6 id="6-1-2-4-1-boolean-cancel-boolean-mayInterruptIfRunning"><a href="#6-1-2-4-1-boolean-cancel-boolean-mayInterruptIfRunning" class="headerlink" title="6.1.2.4.1. boolean cancel(boolean mayInterruptIfRunning)"></a>6.1.2.4.1. boolean cancel(boolean mayInterruptIfRunning)</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">cancel</span><span class="hljs-params">(<span class="hljs-type">boolean</span> mayInterruptIfRunning)</span> &#123;<br><span class="hljs-comment">// The racy read of heapIndex below is benign:</span><br><span class="hljs-comment">// if heapIndex &lt; 0, then OOTA guarantees that we have surely</span><br><span class="hljs-comment">// been removed; else we recheck under lock in remove()</span><br><span class="hljs-type">boolean</span> <span class="hljs-variable">cancelled</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">super</span>.cancel(mayInterruptIfRunning);<br><span class="hljs-keyword">if</span> (cancelled &amp;&amp; removeOnCancel &amp;&amp; heapIndex &gt;= <span class="hljs-number">0</span>)<br>remove(<span class="hljs-built_in">this</span>);<br><span class="hljs-keyword">return</span> cancelled;<br>&#125;<br></code></pre></td></tr></table></figure><hr><h5 id="6-1-2-5-RunnableScheduledFutureï¼œVï¼-ä¸­æ¥å£æ–¹æ³•çš„å®ç°"><a href="#6-1-2-5-RunnableScheduledFutureï¼œVï¼-ä¸­æ¥å£æ–¹æ³•çš„å®ç°" class="headerlink" title="6.1.2.5. RunnableScheduledFutureï¼œVï¼ ä¸­æ¥å£æ–¹æ³•çš„å®ç°"></a>6.1.2.5. RunnableScheduledFutureï¼œVï¼ ä¸­æ¥å£æ–¹æ³•çš„å®ç°</h5><h6 id="6-1-2-5-1-boolean-isPeriodic"><a href="#6-1-2-5-1-boolean-isPeriodic" class="headerlink" title="6.1.2.5.1. boolean isPeriodic()"></a>6.1.2.5.1. boolean isPeriodic()</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isPeriodic</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-keyword">return</span> period != <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.util.concurrent.ForkJoinPool æºç è§£æ</title>
    <link href="/2025/11/14/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ForkJoinPool%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/11/14/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ForkJoinPool%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><ul><li><input disabled="" type="checkbox"> ä½¿ç”¨åœºæ™¯å’Œä¸¥ç¦ XXXX</li><li><input disabled="" type="checkbox"> ForkJoinPool.commonPool()</li><li><input disabled="" type="checkbox"> æ•°æ®çš„è¿­ä»£æ‹†åˆ†</li></ul><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw<br><img src="/source/_posts/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ForkJoinPool%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ForkJoinPool%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.eddx"></p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/11/14/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ForkJoinPool%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/14/æºç ï¼šjava.util.concurrent.ForkJoinPoolæºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-ForkJoinPool-æ¦‚è¿°"><a href="#3-1-ForkJoinPool-æ¦‚è¿°" class="headerlink" title="3.1. ForkJoinPool æ¦‚è¿°"></a>3.1. ForkJoinPool æ¦‚è¿°</h3><p><code>ForkJoinPool</code> æ˜¯ä¸€ä¸ªå…·ä½“ç±»ï¼Œç»§æ‰¿äº† <code>java.util.concurrent.AbstractExecutorService</code></p><p><code>ForkJoinPool</code> è¢«è®¾è®¡ç”¨äºé«˜æ•ˆæ‰§è¡Œé‚£äº›å¯ä»¥è¢« â€è¿­ä»£æ‹†åˆ†â€œ çš„ä»»åŠ¡ï¼Œå…¶æ ¸å¿ƒç‰¹æ€§æ˜¯ï¼š</p><ol><li>åˆ†è€Œæ²»ä¹‹</li><li>è¿­ä»£æ‹†åˆ†</li><li>å·¥ä½œçªƒå–</li></ol><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>è¯¦è§æºç ï¼š<code>AbstractExecutorService</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.AbstractExecutorService%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.AbstractExecutorServiceæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/11/03/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.AbstractExecutorService%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/03/æºç ï¼šjava.util.concurrent.AbstractExecutorServiceæºç è§£æ/</a></li></ol></li></ol></li><li>å¯¹äº <code>ForkJoinPool</code>ã€<code>ForkJoinTask&lt;V&gt;</code>ã€<code>RecursiveAction</code>ã€<code>RecursiveTask&lt;V&gt;</code>ï¼Œå¯ä»¥è¯´æ˜¯æ•´ä¸ª <code>JUC</code> ä¸­æœ€å¤æ‚çš„ä¸€éƒ¨åˆ†ï¼Œ<code>Doug Lea</code> å½“åˆä¸ºå®ƒä»¬æŠ•å…¥äº†å¤§é‡å¿ƒè¡€ã€‚å¯¹äºæˆ‘ä»¬è€Œè¨€ï¼Œåªéœ€è¦æŒæ¡å®ƒä»¬çš„ä½¿ç”¨æ–¹å¼å³å¯ï¼Œæ²¡å¿…è¦å¯¹æºç è¿›è¡Œè¿‡åº¦æ·±ç©¶</li></ol></blockquote><hr><h3 id="3-2-ForkJoinPool-ç›¸å…³æµç¨‹"><a href="#3-2-ForkJoinPool-ç›¸å…³æµç¨‹" class="headerlink" title="3.2. ForkJoinPool ç›¸å…³æµç¨‹"></a>3.2. ForkJoinPool ç›¸å…³æµç¨‹</h3><p>æˆ‘ä»¬çŸ¥é“ï¼š<code>ThreadPoolExecutor</code> å’Œ <code>ScheduledThreadPoolExecutor</code> çš„çº¿ç¨‹æ‰§è¡Œæµç¨‹å¤§è‡´ä¸ºï¼š<code>æœ¬åœ°çº¿ç¨‹ â” Thread#run â” Worker#run</code></p><p>è€Œ <code>ForkJoinPool</code> å¹¶æ²¡æœ‰ä½¿ç”¨ <code>Worker</code>ï¼Œç”šè‡³æ²¡æœ‰ä½¿ç”¨åŸç”Ÿçš„ <code>Thread</code>ï¼Œè€Œæ˜¯ç›´æ¥ä½¿ç”¨äº† <code>ForkJoinWorkerThread</code>ï¼ˆ<code>ForkJoinWorkerThread</code> ç»§æ‰¿äº† <code>Thread</code>ï¼‰</p><p>ä½ å¯èƒ½ä¼šç–‘æƒ‘ï¼šä¸ºä»€ä¹ˆè¦è®© <code>ForkJoinWorkerThread</code> ç»§æ‰¿ <code>Thread</code>ï¼Œè€Œä¸æ˜¯ç»§ç»­ä½¿ç”¨ <code>Worker</code> æˆ–è€…åœ¨ <code>Worker</code> çš„åŸºç¡€ä¸Š â€œé­”æ”¹â€ å‘¢ï¼ŸåŸå› å¾ˆç®€å•ï¼Œå› ä¸ºæˆ‘ä»¬è¦ä¸ºæ¯ä¸ªçº¿ç¨‹å•ç‹¬ç»´æŠ¤ä¸€ä¸ªä»»åŠ¡é˜Ÿåˆ—</p><p>æ¯ä¸ªçº¿ç¨‹éƒ½ä¼šç»´æŠ¤ä¸€ä¸ª <code>ForkJoinPool.WorkQueue</code>ï¼Œè¿™æ˜¯ä¸€ä¸ªåŒç«¯é˜Ÿåˆ—ã€‚å¹¶ä¸”è¿™äº›é˜Ÿåˆ—éƒ½ä¼šè¢«æ³¨å†Œåˆ° <code>ForkJoinPool-&gt;queues</code> ä¸­<br><img src="/source/_posts/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ForkJoinPool%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ForkJoinPool%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.png"></p><p>å½“çº¿ç¨‹å»æ‰§è¡Œä¸€ä¸ªå¤§ä»»åŠ¡ <code>A</code> æ—¶ï¼Œå¯ä»¥æŠŠ <code>A</code> æ‹†åˆ†æˆå¤šä¸ªå­ä»»åŠ¡ï¼ˆä¾‹å¦‚ <code>B</code>ã€<code>C</code>ã€<code>D</code>ï¼‰ï¼Œè¿™äº›å­ä»»åŠ¡ä¼šè¢«æŠ•é€’åˆ°è¯¥æœ¬åœ°çº¿ç¨‹ç»´æŠ¤çš„ä»»åŠ¡é˜Ÿåˆ—ä¸­ã€‚ç„¶åä½ æ˜¯ä¸æ˜¯è®¤ä¸º â€œçº¿ç¨‹éœ€è¦é˜»å¡ç­‰å¾… <code>B</code>ã€<code>C</code>ã€<code>D</code> çš„å®Œæˆå‘¢ï¼Ÿâ€</p><p>æ¥ä¸‹æ¥çš„ä¸€éƒ¨åˆ†ï¼Œæ˜¯ <code>ForkJoinPool</code> è®¾è®¡æœ€ç²¾å¦™çš„åœ°æ–¹ï¼š</p><ol><li>å½“ä¸€ä¸ªä»»åŠ¡ <code>A</code> è¢«æ‹†åˆ†æˆå­ä»»åŠ¡ <code>B</code>ã€<code>C</code>ã€<code>D</code>ï¼Œå¹¶è¢«æŠ•é€’åˆ°ä»»åŠ¡é˜Ÿåˆ—åï¼ŒæŒ‰ç†è¯´å½“å‰çº¿ç¨‹åº”è¯¥é˜»å¡å¹¶ç­‰å¾… <code>B</code>ã€<code>C</code>ã€<code>D</code> çš„å®Œæˆã€‚ç„¶è€Œå¹¶éå¦‚æ­¤ï¼šå½“å‰çº¿ç¨‹ç¡®å®åœ¨ç­‰å¾…ï¼Œä½†å¹¶æ²¡æœ‰é˜»å¡ã€‚ç›¸åï¼Œå®ƒä¼šç»§ç»­æ‰§è¡Œå½“å‰çº¿ç¨‹ç»´æŠ¤çš„ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„å…¶ä»–ä»»åŠ¡</li><li>å‡å¦‚æ‰§è¡Œåˆ°äº† <code>B</code>ï¼Œåœ¨æ‰§è¡Œ <code>B</code> çš„è¿‡ç¨‹ä¸­ï¼Œ<code>B</code> åˆå¯ä»¥è¿›ä¸€æ­¥æ‹†åˆ†æˆæ›´å°çš„å­ä»»åŠ¡ <code>E</code>ã€<code>F</code>ã€<code>G</code>ï¼Œå¹¶è¢«æŠ•é€’åˆ°ä»»åŠ¡é˜Ÿåˆ—åï¼ŒåŒæ ·åœ¨ç­‰å¾…å­ä»»åŠ¡çš„ç»“æœçš„åŒæ—¶ï¼Œå½“å‰çº¿ç¨‹å¹¶ä¸ä¼šç«‹å³é˜»å¡ï¼Œè€Œæ˜¯ä¼šç»§ç»­æ‰§è¡Œå½“å‰çº¿ç¨‹ç»´æŠ¤çš„ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„å…¶ä»–ä»»åŠ¡ã€‚ä»¥æ­¤ç±»æ¨â€¦ç›´åˆ°ä»»åŠ¡è¢«æ‹†åˆ†åˆ°è¶³å¤Ÿå°</li><li>å½“å­ä»»åŠ¡å®Œæˆåï¼Œå®ƒçš„ç»“æœä¼šè¿”å›ç»™çˆ¶ä»»åŠ¡ã€‚çˆ¶ä»»åŠ¡åœ¨æ”¶åˆ°æ‰€æœ‰å­ä»»åŠ¡ç»“æœåï¼Œå†å°†æ±‡æ€»ç»“æœè¿”å›ç»™è‡ªå·±çš„çˆ¶ä»»åŠ¡ã€‚ä»¥æ­¤ç±»æ¨â€¦ç›´åˆ°æœ€åˆçš„å¤§ä»»åŠ¡æœ€ç»ˆå¾—åˆ°å®Œæ•´çš„è®¡ç®—ç»“æœ</li><li>éœ€è¦æ³¨æ„çš„æ˜¯ï¼š<ol><li>å¦‚æœå½“å‰çº¿ç¨‹ç»´æŠ¤çš„ä»»åŠ¡é˜Ÿåˆ—ä¸­æ²¡æœ‰å…¶ä»–ä»»åŠ¡äº†ï¼Œå®ƒä¼šæ ¹æ® <code>ForkJoinPool-&gt;queues</code> éšæœºé€‰æ‹©ä¸€ä¸ªå…¶ä»–çº¿ç¨‹ç»´æŠ¤çš„ä»»åŠ¡é˜Ÿåˆ—ï¼Œä»é˜Ÿå°¾ â€œçªƒå–â€ ä¸€ä¸ªä»»åŠ¡æ¥æ‰§è¡Œ</li><li>å¦‚æœå½“å‰çº¿ç¨‹ç»´æŠ¤çš„ä»»åŠ¡é˜Ÿåˆ—ä¸­æ²¡æœ‰å…¶ä»–ä»»åŠ¡äº†ï¼Œä¹Ÿ â€œçªƒå–â€ ä¸åˆ°ä»»åŠ¡äº†ï¼Œå°±ä¼šæœ‰ä»¥ä¸‹ä¸¤ç§æƒ…å†µï¼š<ol><li>å¦‚æœå½“å‰çº¿ç¨‹è¿˜åœ¨ç­‰å¾…ä»»åŠ¡<ol><li>æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œ<code>Thread</code> å®ä¾‹è¿›å…¥ <code>WAITING</code> çŠ¶æ€ï¼Œå¹¶è¢«æŠ•é€’åˆ°ï¼ˆXXXXXï¼Œè‚¯å®šæ˜¯ ForkJOinPoolTask çš„é˜Ÿåˆ—å•Šï¼‰ <code>Task</code> çš„æŸé˜Ÿåˆ—ï¼Œç­‰å¾…è¢«å”¤é†’ï¼ˆ<code>LockSupport.unpark</code>ï¼‰ã€è¢«ä¸­æ–­</li><li>æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œ<code>Thread</code> å®ä¾‹è¿›å…¥ <code>WAITING</code> çŠ¶æ€åï¼Œèƒ½å“åº”ä¸­æ–­ã€‚çº¿ç¨‹è¢«å”¤é†’ï¼Œé‡æ–°è·å¾— <code>CPU</code> æ—¶é—´ç‰‡åï¼Œä¼šæŠ›å‡º <code>InterruptedException</code> å¼‚å¸¸ï¼Œå¹¶æ¸…é™¤ <code>Thread</code> å®ä¾‹çš„ä¸­æ–­çŠ¶æ€ï¼ˆå¼‚å¸¸é€€å‡ºæˆ–æ­£å¸¸é€€å‡ºï¼ˆå‘ç”Ÿå¼‚å¸¸ï¼‰ï¼Œè¦çœ‹æˆ‘ä»¬æ˜¯å¦å¯¹è¯¥å¼‚å¸¸è¿›è¡Œæ•è·å¹¶å¤„ç†ï¼‰ã€‚ä¸è¿‡æˆ‘ä»¬æ— éœ€å¯¹æ­¤è¿‡å¤šå…³æ³¨ï¼Œå› ä¸ºç›¸å…³é€»è¾‘å·²ç”± <code>ForkJoinPool</code> å¤„ç†å¥½äº†ã€‚ä¸€æ—¦å‘ç”Ÿä¸­æ–­ï¼Œä¸ºäº†ä¸æ±¡æŸ“æˆ‘ä»¬çš„ä»£ç ï¼Œ<code>ForkJoinPool</code> ä¼šæŠ›å‡º <code>CancellationException</code> éå—æ£€å¼‚å¸¸</li></ol></li><li>å¦‚æœå½“å‰çº¿ç¨‹æœªåœ¨ç­‰å¾…ä»»åŠ¡ï¼ˆâ€œç©ºé—²â€ï¼‰<ol><li>å¦‚æœçº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹çš„æ•°é‡ â‰¤ <code>corePoolSize</code><ol><li>æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œ<code>Thread</code> å®ä¾‹è¿›å…¥ <code>WAITING</code> çŠ¶æ€ï¼Œå¹¶è¢«æŠ•é€’åˆ° ForkJoinPool çš„æŸé˜Ÿåˆ—ï¼Œç­‰å¾…è¢«å”¤é†’ï¼ˆ<code>LockSupport.unpark</code>ï¼‰ã€è¢«ä¸­æ–­ï¼ˆ<code>Thread#interrupt</code>ï¼‰</li><li>æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œ<code>Thread</code> å®ä¾‹è¿›å…¥ <code>WAITING</code> çŠ¶æ€åï¼Œèƒ½å“åº”ä¸­æ–­ã€‚çº¿ç¨‹è¢«å”¤é†’ï¼Œé‡æ–°è·å¾— <code>CPU</code> æ—¶é—´ç‰‡åï¼Œä¼šæŠ›å‡º <code>InterruptedException</code> å¼‚å¸¸ï¼Œå¹¶æ¸…é™¤ <code>Thread</code> å®ä¾‹çš„ä¸­æ–­çŠ¶æ€ï¼ˆå¼‚å¸¸é€€å‡ºæˆ–æ­£å¸¸é€€å‡ºï¼ˆå‘ç”Ÿå¼‚å¸¸ï¼‰ï¼Œè¦çœ‹æˆ‘ä»¬æ˜¯å¦å¯¹è¯¥å¼‚å¸¸è¿›è¡Œæ•è·å¹¶å¤„ç†ï¼‰ã€‚ä¸è¿‡æˆ‘ä»¬æ— éœ€å¯¹æ­¤è¿‡å¤šå…³æ³¨ï¼Œå› ä¸ºç›¸å…³é€»è¾‘å·²ç”± <code>ForkJoinPool</code> å¤„ç†å¥½äº†ã€‚ä¸€æ—¦å‘ç”Ÿä¸­æ–­ï¼Œæˆ‘ä»¬ä¸ä¼šæ„ŸçŸ¥åˆ°ä»»ä½•å¼‚å¸¸</li></ol></li><li>å¦‚æœçº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹çš„æ•°é‡ ï¼<code>corePoolSize</code><ol><li>æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œ<code>Thread</code> å®ä¾‹è¿›å…¥ <code>TIMED_WAITING</code> çŠ¶æ€ï¼Œå¹¶è¢«æŠ•é€’åˆ° <code>ForkJoinPool</code> çš„æŸé˜Ÿåˆ—ï¼Œç­‰å¾…è¢«å”¤é†’ï¼ˆ<code>LockSupport.unpark</code>ï¼‰ã€è¢«ä¸­æ–­ï¼ˆ<code>Thread#interrupt</code>ï¼‰ã€é˜»å¡è¶…æ—¶<ol><li>å¦‚æœè¶…æ—¶ï¼Œ<code>ForkJoinPool</code> ä¼šé”€æ¯è¯¥çº¿ç¨‹</li></ol></li><li>æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œ<code>Thread</code> å®ä¾‹è¿›å…¥ <code>TIMED_WAITING</code> çŠ¶æ€åï¼Œèƒ½å“åº”ä¸­æ–­ã€‚çº¿ç¨‹è¢«å”¤é†’ï¼Œé‡æ–°è·å¾— <code>CPU</code> æ—¶é—´ç‰‡åï¼Œä¼šæŠ›å‡º <code>InterruptedException</code> å¼‚å¸¸ï¼Œå¹¶æ¸…é™¤ <code>Thread</code> å®ä¾‹çš„ä¸­æ–­çŠ¶æ€ï¼ˆå¼‚å¸¸é€€å‡ºæˆ–æ­£å¸¸é€€å‡ºï¼ˆå‘ç”Ÿå¼‚å¸¸ï¼‰ï¼Œè¦çœ‹æˆ‘ä»¬æ˜¯å¦å¯¹è¯¥å¼‚å¸¸è¿›è¡Œæ•è·å¹¶å¤„ç†ï¼‰ã€‚ä¸è¿‡æˆ‘ä»¬æ— éœ€å¯¹æ­¤è¿‡å¤šå…³æ³¨ï¼Œå› ä¸ºç›¸å…³é€»è¾‘å·²ç”± <code>ForkJoinPool</code> å¤„ç†å¥½äº†ã€‚ä¸€æ—¦å‘ç”Ÿä¸­æ–­ï¼Œæˆ‘ä»¬ä¸ä¼šæ„ŸçŸ¥åˆ°ä»»ä½•å¼‚å¸¸</li></ol></li></ol></li></ol></li></ol></li></ol><p>æˆ‘ä»¬ä»¥ <code>1</code> ç´¯åŠ åˆ° <code>10000</code> ä¸ºä¾‹ï¼Œæ¥çœ‹ä¸€çœ‹ç©¶ç«Ÿæ˜¯æ€ä¹ˆæ‰§è¡Œçš„ï¼š<br><img src="/source/_posts/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ForkJoinPool%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ForkJoinPool%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90-1.png"></p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>çŒ´å“¥çš„çƒ¦æ¼ç®± <code>(ï½¡â€¢Ìï¸¿â€¢Ì€ï½¡)</code>ï¼š<ol><li>ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸èƒ½é‡‡å– <code>ForkJoinPool</code> çš„ â€œä¸€ä¸ªä»»åŠ¡å°šæœªå®Œæˆï¼Œä½†æ˜¯å¯ä»¥å»æ‰§è¡Œå…¶ä»–ä»»åŠ¡â€ æ€æƒ³ï¼Œç”¨äºåŒæ­¥é˜»å¡ <code>IO</code> å·¥ä½œæ¨¡å¼ä¸‹çš„æœåŠ¡ç«¯ï¼Œä»è€Œé¿å… â€œä¼ªå¼‚æ­¥ + å¼‚æ­¥ç¼–ç¨‹å›è°ƒâ€ï¼Ÿ</li><li>ä¸ºä»€ä¹ˆä¸ â€œé­”æ”¹â€ <code>Worker</code>ï¼Œåœ¨ <code>Worker</code> ä¸­æ·»åŠ ä»»åŠ¡é˜Ÿåˆ—å‘¢ï¼Ÿ</li><li>ä¸ºä»€ä¹ˆå½“å‰çº¿ç¨‹ç»´æŠ¤çš„ä»»åŠ¡é˜Ÿåˆ—ä¸­æ²¡æœ‰å…¶ä»–ä»»åŠ¡äº†ï¼Œä¹Ÿ â€œçªƒå–â€ ä¸åˆ°ä»»åŠ¡äº†ï¼Œå°±è¦é˜»å¡ï¼Ÿ<ol><li>é˜²æ­¢ CPU ç©ºè½¬</li></ol></li></ol></li></ol></blockquote><hr><h2 id="4-æ„é€ æ–¹æ³•"><a href="#4-æ„é€ æ–¹æ³•" class="headerlink" title="4. æ„é€ æ–¹æ³•"></a>4. æ„é€ æ–¹æ³•</h2><h3 id="4-1-public-ForkJoinPool-int-parallelism-ForkJoinWorkerThreadFactory-factory-UncaughtExceptionHandler-handler-boolean-asyncMode-int-corePoolSize-int-maximumPoolSize-int-minimumRunnable-Predicateï¼œ-super-ForkJoinPoolï¼-saturate-long-keepAliveTime-TimeUnit-unit"><a href="#4-1-public-ForkJoinPool-int-parallelism-ForkJoinWorkerThreadFactory-factory-UncaughtExceptionHandler-handler-boolean-asyncMode-int-corePoolSize-int-maximumPoolSize-int-minimumRunnable-Predicateï¼œ-super-ForkJoinPoolï¼-saturate-long-keepAliveTime-TimeUnit-unit" class="headerlink" title="4.1. public ForkJoinPool(int parallelism, ForkJoinWorkerThreadFactory factory, UncaughtExceptionHandler handler, boolean asyncMode, int corePoolSize, int maximumPoolSize, int minimumRunnable, Predicateï¼œ? super ForkJoinPoolï¼ saturate, long keepAliveTime,TimeUnit unit)"></a>4.1. public ForkJoinPool(int parallelism, ForkJoinWorkerThreadFactory factory, UncaughtExceptionHandler handler, boolean asyncMode, int corePoolSize, int maximumPoolSize, int minimumRunnable, Predicateï¼œ? super ForkJoinPoolï¼ saturate, long keepAliveTime,TimeUnit unit)</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * ============================================</span><br><span class="hljs-comment"> * æ„é€ æ–¹æ³•ï¼š</span><br><span class="hljs-comment"> * public ForkJoinPool(int parallelism,</span><br><span class="hljs-comment"> *         ForkJoinWorkerThreadFactory factory,</span><br><span class="hljs-comment"> *         UncaughtExceptionHandler handler,</span><br><span class="hljs-comment"> *         boolean asyncMode,</span><br><span class="hljs-comment"> *         int corePoolSize,</span><br><span class="hljs-comment"> *         int maximumPoolSize,</span><br><span class="hljs-comment"> *         int minimumRunnable,</span><br><span class="hljs-comment"> *         Predicate&lt;? super ForkJoinPool&gt; saturate,</span><br><span class="hljs-comment"> *         long keepAliveTime,</span><br><span class="hljs-comment"> *         TimeUnit unit)</span><br><span class="hljs-comment"> * --------------------------------------------</span><br><span class="hljs-comment"> * 1. è®¿é—®ä¿®é¥°ç¬¦</span><br><span class="hljs-comment"> *      1. public</span><br><span class="hljs-comment"> *          1. å¤©ä¸‹çš†å…¬ï¼ˆEveryWhereï¼‰</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 2. éè®¿é—®ä¿®é¥°ç¬¦</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 3. æ–¹æ³•å‚æ•°</span><br><span class="hljs-comment"> *      1. int parallelism</span><br><span class="hljs-comment"> *          1. æŒ‡å®šæˆ‘ä»¬æœŸæœ›çº¿ç¨‹æ± ä¸­ â€æ´»è·ƒâ€œ çº¿ç¨‹çš„çº¿ç¨‹æ•°é‡</span><br><span class="hljs-comment"> *          2. æ‰€è°“çš„ â€œæ´»è·ƒâ€ æ˜¯æŒ‡ï¼šæ­£åœ¨æ‰§è¡Œä»»åŠ¡æˆ–æ­£åœ¨ â€çªƒå–â€œ ä»»åŠ¡çš„çº¿ç¨‹çš„çº¿ç¨‹æ•°é‡</span><br><span class="hljs-comment"> *          3. ForkJoinPool ä¼šå°½åŠ›ç»´æŒè¿™ä¸ªæ•°é‡ï¼Œä½†ä¸èƒ½ä¿è¯</span><br><span class="hljs-comment"> *      2. ForkJoinWorkerThreadFactory factory</span><br><span class="hljs-comment"> *          1. æŒ‡å®šåˆ›å»º ForkJoinWorkerThread å®ä¾‹çš„çº¿ç¨‹å·¥å‚</span><br><span class="hljs-comment"> *      3. UncaughtExceptionHandler handler</span><br><span class="hljs-comment"> *          1. æŒ‡å®šæœªæ•è·å¼‚å¸¸çš„å¤„ç†å™¨</span><br><span class="hljs-comment"> *          2. å½“ä¸€ä¸ªæœ¬åœ°çº¿ç¨‹åœ¨æ‰§è¡Œä»»åŠ¡æ—¶å› æœªæ•è·çš„å¼‚å¸¸è€Œç»ˆæ­¢ï¼ˆå¼‚å¸¸é€€å‡ºï¼‰æ—¶ï¼Œä¼šè°ƒç”¨æœªæ•è·å¼‚å¸¸çš„å¤„ç†å™¨</span><br><span class="hljs-comment"> *      4. boolean asyncMode</span><br><span class="hljs-comment"> *          1. æŒ‡å®šæœ¬åœ°çº¿ç¨‹ä»å…¶ç»´æŠ¤çš„ä»»åŠ¡é˜Ÿåˆ—è·å–ä»»åŠ¡çš„é¡ºåº</span><br><span class="hljs-comment"> *          2. å¯é€‰å‚æ•°åŒ…æ‹¬ï¼š</span><br><span class="hljs-comment"> *              1. true</span><br><span class="hljs-comment"> *                  1. FIFO</span><br><span class="hljs-comment"> *              2. false</span><br><span class="hljs-comment"> *                  1. LIFO</span><br><span class="hljs-comment"> *      5. int corePoolSize</span><br><span class="hljs-comment"> *          1. æŒ‡å®šçº¿ç¨‹æ± ä¸­ â€œå­˜æ´»â€ çš„çº¿ç¨‹è¢«å…è®¸çš„æœ€å°æ•°é‡</span><br><span class="hljs-comment"> *          2. å½“æŸæœ¬åœ°çº¿ç¨‹ â€œç©ºé—²â€ çš„æ—¶é—´è¶…è¿‡ keepAliveTime unitï¼Œä¼šåœ¨é”€æ¯å‰æ£€æŸ¥è¯¥å‚æ•°ï¼Œç„¶åå†å†³å®šæ˜¯å¦é”€æ¯</span><br><span class="hljs-comment"> *          3. éœ€è¦æ³¨æ„çš„æ˜¯ï¼šè¯¥å‚æ•°å¯ä»¥ä¸º 0</span><br><span class="hljs-comment"> *      6. int maximumPoolSize</span><br><span class="hljs-comment"> *          1. æŒ‡å®šçº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹è¢«å…è®¸çš„æœ€å¤§æ•°é‡</span><br><span class="hljs-comment"> *      7. int minimumRunnable</span><br><span class="hljs-comment"> *          1. æŒ‡å®šçº¿ç¨‹æ± ä¸­æ²¡æœ‰è°ƒç”¨ ForkJoinTask#join çš„çº¿ç¨‹è¢«å…è®¸çš„æœ€å°æ•°é‡</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> *          1. æŒ‡å®šå¯è¿è¡Œçš„å·¥ä½œçº¿ç¨‹è¢«å…è®¸çš„æœ€å°æ•°é‡</span><br><span class="hljs-comment"> *          2. å¦‚æœä½äºï¼Œå°†åˆ›å»ºæ–°çš„å·¥ä½œçº¿ç¨‹ï¼Œç›´åˆ°è¾¾åˆ° maximumPoolSize</span><br><span class="hljs-comment"> *      8. Predicate&lt;? super ForkJoinPool&gt; saturate</span><br><span class="hljs-comment"> *          1. æŒ‡å®šé¥±å’Œç­–ç•¥</span><br><span class="hljs-comment"> *          2. å½“æ²¡æœ‰è°ƒç”¨ ForkJoinTask#join çš„çº¿ç¨‹ä½äº minimumRunnableï¼Œä½†æ˜¯ä¹Ÿè¾¾åˆ°äº† maximumPoolSize æ—¶ï¼Œä¼šè°ƒç”¨é¥±å’Œç­–ç•¥</span><br><span class="hljs-comment"> *      9. long keepAliveTime</span><br><span class="hljs-comment"> *          1. æŒ‡å®šçº¿ç¨‹ â€œç©ºé—²â€è¢«å…è®¸çš„æœ€é•¿æ—¶é—´ä¸ºï¼škeepAliveTime unit</span><br><span class="hljs-comment"> *          2. æ‰€è°“çš„ â€œç©ºé—²â€ æ˜¯æŒ‡ï¼šæŸæœ¬åœ°çº¿ç¨‹ç»´æŠ¤çš„ä»»åŠ¡é˜Ÿåˆ—æ²¡æœ‰ä»»åŠ¡äº†ï¼Œå¹¶ä¸”ä¹Ÿ â€œçªƒå–â€ ä¸åˆ°ä»»åŠ¡äº†</span><br><span class="hljs-comment"> *          3. å½“æŸæœ¬åœ°çº¿ç¨‹ â€œç©ºé—²â€ çš„æ—¶é—´è¶…è¿‡ keepAliveTime unitï¼Œ</span><br><span class="hljs-comment"> *      10. TimeUnit unit</span><br><span class="hljs-comment"> *          1. æŒ‡å®šçº¿ç¨‹ â€œç©ºé—²â€è¢«å…è®¸çš„æœ€é•¿æ—¶é—´ä¸ºï¼škeepAliveTime unit</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 4. æŠ›å‡ºå¼‚å¸¸</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 5. æ„é€ ç¤ºä¾‹</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * ============================================</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-title function_">ForkJoinPool</span><span class="hljs-params">(<span class="hljs-type">int</span> parallelism,</span><br><span class="hljs-params">ForkJoinWorkerThreadFactory factory,</span><br><span class="hljs-params">UncaughtExceptionHandler handler,</span><br><span class="hljs-params"><span class="hljs-type">boolean</span> asyncMode,</span><br><span class="hljs-params"><span class="hljs-type">int</span> corePoolSize,</span><br><span class="hljs-params"><span class="hljs-type">int</span> maximumPoolSize,</span><br><span class="hljs-params"><span class="hljs-type">int</span> minimumRunnable,</span><br><span class="hljs-params">Predicate&lt;? <span class="hljs-built_in">super</span> ForkJoinPool&gt; saturate,</span><br><span class="hljs-params"><span class="hljs-type">long</span> keepAliveTime,</span><br><span class="hljs-params">TimeUnit unit)</span> &#123;<br><br>checkPermission();<br><span class="hljs-type">int</span> <span class="hljs-variable">p</span> <span class="hljs-operator">=</span> parallelism;<br><span class="hljs-keyword">if</span> (p &lt;= <span class="hljs-number">0</span> || p &gt; MAX_CAP || p &gt; maximumPoolSize || keepAliveTime &lt;= <span class="hljs-number">0L</span>)<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>();<br><span class="hljs-keyword">if</span> (factory == <span class="hljs-literal">null</span> || unit == <span class="hljs-literal">null</span>)<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NullPointerException</span>();<br><span class="hljs-built_in">this</span>.factory = factory;<br><span class="hljs-built_in">this</span>.ueh = handler;<br><span class="hljs-built_in">this</span>.saturate = saturate;<br><span class="hljs-built_in">this</span>.keepAlive = Math.max(unit.toMillis(keepAliveTime), TIMEOUT_SLOP);<br><span class="hljs-type">int</span> <span class="hljs-variable">size</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span> &lt;&lt; (<span class="hljs-number">33</span> - Integer.numberOfLeadingZeros(p - <span class="hljs-number">1</span>));<br><span class="hljs-type">int</span> <span class="hljs-variable">corep</span> <span class="hljs-operator">=</span> Math.min(Math.max(corePoolSize, p), MAX_CAP);<br><span class="hljs-type">int</span> <span class="hljs-variable">maxSpares</span> <span class="hljs-operator">=</span> Math.min(maximumPoolSize, MAX_CAP) - p;<br><span class="hljs-type">int</span> <span class="hljs-variable">minAvail</span> <span class="hljs-operator">=</span> Math.min(Math.max(minimumRunnable, <span class="hljs-number">0</span>), MAX_CAP);<br><span class="hljs-built_in">this</span>.bounds = ((minAvail - p) &amp; SMASK) | (maxSpares &lt;&lt; SWIDTH);<br><span class="hljs-built_in">this</span>.mode = p | (asyncMode ? FIFO : <span class="hljs-number">0</span>);<br><span class="hljs-built_in">this</span>.ctl = ((((<span class="hljs-type">long</span>)(-corep) &lt;&lt; TC_SHIFT) &amp; TC_MASK) |<br>(((<span class="hljs-type">long</span>)(-p)     &lt;&lt; RC_SHIFT) &amp; RC_MASK));<br><span class="hljs-built_in">this</span>.registrationLock = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();<br><span class="hljs-built_in">this</span>.queues = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WorkQueue</span>[size];<br><span class="hljs-type">String</span> <span class="hljs-variable">pid</span> <span class="hljs-operator">=</span> Integer.toString(getAndAddPoolIds(<span class="hljs-number">1</span>) + <span class="hljs-number">1</span>);<br><span class="hljs-built_in">this</span>.workerNamePrefix = <span class="hljs-string">&quot;ForkJoinPool-&quot;</span> + pid + <span class="hljs-string">&quot;-worker-&quot;</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.util.concurrent.locks.LockSupport æºç è§£æ</title>
    <link href="/2025/11/13/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.LockSupport%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/11/13/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.LockSupport%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/11/13/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.LockSupport%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/13/æºç ï¼šjava.util.concurrent.locks.LockSupportæºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-LockSupport-æ¦‚è¿°"><a href="#3-1-LockSupport-æ¦‚è¿°" class="headerlink" title="3.1. LockSupport æ¦‚è¿°"></a>3.1. LockSupport æ¦‚è¿°</h3><p>æƒ³è±¡è¿™æ ·å‡ ä¸ªé—®é¢˜ï¼š</p><ol><li><code>Object#wait</code>ã€<code>Object#notify</code> å’Œ <code>synchronized</code> æ˜¯ç»‘å®šçš„ï¼Œå®ƒä»¬å¿…é¡»å‡ºç°åœ¨ <code>synchronized</code> ä»£ç å—ä¸­ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼šä¸ºäº†å®ç°ä¸€æ¬¡ â€œç­‰å¾…â€ æˆ– â€œé€šçŸ¥â€ï¼Œçº¿ç¨‹å¿…é¡»å…ˆå»ç«äº‰åˆ° <code>Monitor</code> é”ã€‚è€Œåœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œè¿™ç§å¯¹ <code>Monitor</code> é”çš„ç«äº‰æ˜¯é‡é‡çº§çš„</li><li><code>Object#notify()</code> æ˜¯å”¤é†’ <code>Monitor</code> çš„ <code>WaitSet</code> ä¸­çš„ â€œä»»æ„â€ ä¸€ä¸ª <code>Thread</code> å®ä¾‹ã€‚è€Œ <code>Object#notifyAll()</code> æ˜¯å”¤é†’ <code>Monitor</code> çš„ <code>WaitSet</code> ä¸­çš„æ‰€æœ‰ <code>Thread</code> å®ä¾‹ï¼Œå¯¼è‡´ â€œæƒŠç¾¤æ•ˆåº”â€ã€‚å®ƒä»¬éƒ½æ²¡æœ‰åŠæ³•ç²¾ç¡®å”¤é†’æˆ‘ä»¬æŒ‡å®šè¦å”¤é†’çš„çº¿ç¨‹</li><li>é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªç»å…¸çš„ç«æ€æ¡ä»¶ï¼šå¦‚æœæœ¬åœ°çº¿ç¨‹ <code>B</code> è°ƒç”¨ <code>Object#notify</code> å…ˆäºæœ¬åœ°çº¿ç¨‹ <code>A</code> è°ƒç”¨ <code>Object#wait</code>ï¼Œé‚£ä¹ˆè¿™ä¸ª <code>Object#notify</code> å°±æ°¸ä¹…æ¶ˆå¤±äº†ï¼Œæœ¬åœ°çº¿ç¨‹ <code>A</code> å°† â€æ— é™æœŸâ€œ åœ°ç­‰å¾…ä¸€ä¸ªæ°¸è¿œä¸ä¼šå†æ¥çš„ <code>Object#notify</code>ã€‚è€Œæˆ‘ä»¬å¾€å¸¸è§£å†³çš„æ–¹æ³•æ˜¯ï¼šåœ¨ä½¿ç”¨ <code>Object#wait</code>ã€<code>Object#notify</code> å‰ï¼Œè¦å…ˆç”¨ <code>while(condition)</code> å¾ªç¯æ¥æ£€æŸ¥çŠ¶æ€ï¼Œéå¸¸çš„ç¹ç</li></ol><p>ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼Œ<code>Doug Lea</code> å°±å°è£…äº† <code>LockSupport</code>ï¼Œæˆ‘ä»¬åœ¨ <code>AQS</code> ä¸­å®ç°çš„é˜»å¡ã€å”¤é†’éƒ½æ˜¯åŸºäº <code>LockSupport</code></p><p>åœ¨ <code>LockSupport</code> ä½“ç³»ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæ¯ä¸ªæœ¬åœ°çº¿ç¨‹æƒ³è±¡æˆä¸€ä¸ªéœ€è¦æŒæœ‰ â€œè®¸å¯è¯â€ æ‰èƒ½ç»§ç»­è¿è¡Œçš„äººã€‚è¿™ä¸ªè®¸å¯è¯ä¸æ˜¯è®¡æ•°å™¨ï¼Œä¸ä¼šç´¯åŠ ï¼Œåªæœ‰ä¸¤ç§çŠ¶æ€ï¼š<code>1</code> å’Œ <code>0</code></p><p>å½“æˆ‘ä»¬è°ƒç”¨ <code>LockSupport.unpark</code> å”¤é†’æŸæœ¬åœ°çº¿ç¨‹æ—¶ï¼Œæ— è®ºè¯¥æœ¬åœ°çº¿ç¨‹æ˜¯é˜»å¡è¿˜æ˜¯è¿è¡Œï¼Œéƒ½ä¼šä¸ºå®ƒå‘æ”¾ä¸€ä¸ª â€œè®¸å¯è¯â€</p><p>è€Œå½“æˆ‘ä»¬è°ƒç”¨ <code>LockSupport.park</code> æ—¶ï¼Œæœ¬åœ°çº¿ç¨‹ä¼šå…ˆæ£€æŸ¥è‡ªå·±æ˜¯å¦æŒæœ‰è®¸å¯è¯ï¼š</p><ol><li>å¦‚æœæŒæœ‰è®¸å¯è¯<ol><li>æ¶ˆè€—è®¸å¯è¯ï¼ˆè®¸å¯è¯ä» <code>1 â” 0</code>ï¼‰ï¼Œç»§ç»­å‘ä¸‹æ‰§è¡Œ</li></ol></li><li>å¦‚æœæœªæŒæœ‰è®¸å¯è¯<ol><li>è®©æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œ<code>Thread</code> å®ä¾‹è¿›å…¥ <code>BWTW</code> çŠ¶æ€ï¼Œç­‰å¾…è¢«å”¤é†’ï¼ˆ<code>LockSupport.unpark</code>ï¼‰ã€è¢«ä¸­æ–­ï¼ˆ<code>Thread#interrupt</code>ï¼‰ã€é˜»å¡è¶…æ—¶</li></ol></li></ol><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li><code>LockSupport.unpark</code> å¯ä»¥å…ˆäº <code>LockSupport.park</code> æ‰§è¡Œï¼Œè€Œä¸ä¼š â€æ¡ä»¶æ¶ˆå¤±â€œï¼Œè¿™æ˜¯ <code>Doug Lea</code> å°è£…å®ƒçš„æ ¸å¿ƒåŸå› </li></ol></blockquote><hr><h2 id="4-æºç éƒ¨åˆ†"><a href="#4-æºç éƒ¨åˆ†" class="headerlink" title="4. æºç éƒ¨åˆ†"></a>4. æºç éƒ¨åˆ†</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LockSupport</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-title function_">LockSupport</span><span class="hljs-params">()</span> &#123;&#125;<br><br><span class="hljs-comment">// ç”¨äºéé˜»å¡è®¾ç½®æŸæœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ BWTW çŠ¶æ€çš„åŸå› </span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// è¯¥åŸå› ä¼šè¢«è®¾ç½®åˆ° Thread-&gt;parkBlocker</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setBlocker</span><span class="hljs-params">(Thread t, Object arg)</span> &#123;<br>        U.putReferenceOpaque(t, PARKBLOCKER, arg);<br>    &#125;<br><br><span class="hljs-comment">// ç”¨äºéé˜»å¡è®¾ç½®æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ BWTW çŠ¶æ€çš„åŸå› </span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// è¯¥åŸå› ä¼šè¢«è®¾ç½®åˆ° Thread-&gt;parkBlocker</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setCurrentBlocker</span><span class="hljs-params">(Object blocker)</span> &#123;<br>        U.putReferenceOpaque(Thread.currentThread(), PARKBLOCKER, blocker);<br>    &#125;<br><br><span class="hljs-comment">// ç”¨äºéé˜»å¡å”¤é†’æŸæœ¬åœ°çº¿ç¨‹</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">unpark</span><span class="hljs-params">(Thread thread)</span> &#123;<br>        <span class="hljs-keyword">if</span> (thread != <span class="hljs-literal">null</span>)<br>            U.unpark(thread);<br>    &#125;<br><br><span class="hljs-comment">// ç”¨äºè®©æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ WAITING çŠ¶æ€ï¼Œå¹¶è¢«æŠ•é€’åˆ°ä½¿ç”¨äº† LockSupport çš„å…·ä½“äº§å“ç»´æŠ¤çš„æ•°æ®ç»“æ„ï¼Œç­‰å¾…è¢«å”¤é†’ï¼ˆLockSupport.unparkï¼‰ã€è¢«ä¸­æ–­ï¼ˆThread#interruptï¼‰ã€é˜»å¡è¶…æ—¶ï¼Œå¹¶è®¾ç½®åŸå› </span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ WAITING çŠ¶æ€åï¼Œèƒ½å“åº”ä¸­æ–­ã€‚çº¿ç¨‹è¢«å”¤é†’ï¼Œé‡æ–°è·å¾— CPU æ—¶é—´ç‰‡åï¼Œä¸ä¼šæŠ›å‡º InterruptedException å—æ£€å¼‚å¸¸ï¼Œä½†ä¼šä¿ç•™ Thread å®ä¾‹çš„ä¸­æ–­çŠ¶æ€ï¼Œç»§ç»­å‘ä¸‹æ‰§è¡Œï¼ˆæ­£å¸¸é€€å‡ºï¼ˆæœªå‘ç”Ÿå¼‚å¸¸ï¼‰ï¼‰</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">park</span><span class="hljs-params">(Object blocker)</span> &#123;<br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> Thread.currentThread();<br>        setBlocker(t, blocker);<br>        U.park(<span class="hljs-literal">false</span>, <span class="hljs-number">0L</span>);<br>        setBlocker(t, <span class="hljs-literal">null</span>);<br>    &#125;<br><br><span class="hljs-comment">// ç”¨äºè®©æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ TIMED_WAITING çŠ¶æ€ï¼Œå¹¶è¢«æŠ•é€’åˆ°ä½¿ç”¨äº† LockSupport çš„å…·ä½“äº§å“ç»´æŠ¤çš„æ•°æ®ç»“æ„ï¼Œç­‰å¾…è¢«å”¤é†’ï¼ˆLockSupport.unparkï¼‰ã€è¢«ä¸­æ–­ï¼ˆThread#interruptï¼‰ã€é˜»å¡è¶…æ—¶ï¼Œå¹¶è®¾ç½®åŸå› </span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ TIMED_WAITING çŠ¶æ€åï¼Œèƒ½å“åº”ä¸­æ–­ã€‚çº¿ç¨‹è¢«å”¤é†’ï¼Œé‡æ–°è·å¾— CPU æ—¶é—´ç‰‡åï¼Œä¸ä¼šæŠ›å‡º InterruptedException å—æ£€å¼‚å¸¸ï¼Œä½†ä¼šä¿ç•™ Thread å®ä¾‹çš„ä¸­æ–­çŠ¶æ€ï¼Œç»§ç»­å‘ä¸‹æ‰§è¡Œï¼ˆæ­£å¸¸é€€å‡ºï¼ˆæœªå‘ç”Ÿå¼‚å¸¸ï¼‰ï¼‰</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">parkNanos</span><span class="hljs-params">(Object blocker, <span class="hljs-type">long</span> nanos)</span> &#123;<br>        <span class="hljs-keyword">if</span> (nanos &gt; <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-type">Thread</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> Thread.currentThread();<br>            setBlocker(t, blocker);<br>            U.park(<span class="hljs-literal">false</span>, nanos);<br>            setBlocker(t, <span class="hljs-literal">null</span>);<br>        &#125;<br>    &#125;<br><br><span class="hljs-comment">// ç”¨äºè®©æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ TIMED_WAITING çŠ¶æ€ï¼Œå¹¶è¢«æŠ•é€’åˆ°ä½¿ç”¨äº† LockSupport çš„å…·ä½“äº§å“ç»´æŠ¤çš„æ•°æ®ç»“æ„ï¼Œç­‰å¾…è¢«å”¤é†’ï¼ˆLockSupport.unparkï¼‰ã€è¢«ä¸­æ–­ï¼ˆThread#interruptï¼‰ã€é˜»å¡è¶…æ—¶ï¼Œå¹¶è®¾ç½®åŸå› </span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ TIMED_WAITING çŠ¶æ€åï¼Œèƒ½å“åº”ä¸­æ–­ã€‚çº¿ç¨‹è¢«å”¤é†’ï¼Œé‡æ–°è·å¾— CPU æ—¶é—´ç‰‡åï¼Œä¸ä¼šæŠ›å‡º InterruptedException å—æ£€å¼‚å¸¸ï¼Œä½†ä¼šä¿ç•™ Thread å®ä¾‹çš„ä¸­æ–­çŠ¶æ€ï¼Œç»§ç»­å‘ä¸‹æ‰§è¡Œï¼ˆæ­£å¸¸é€€å‡ºï¼ˆæœªå‘ç”Ÿå¼‚å¸¸ï¼‰ï¼‰</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">parkUntil</span><span class="hljs-params">(Object blocker, <span class="hljs-type">long</span> deadline)</span> &#123;<br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> Thread.currentThread();<br>        setBlocker(t, blocker);<br>        U.park(<span class="hljs-literal">true</span>, deadline);<br>        setBlocker(t, <span class="hljs-literal">null</span>);<br>    &#125;<br>    <br><span class="hljs-comment">// ç”¨äºéé˜»å¡è·å–æŸæœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ BWTW çŠ¶æ€çš„åŸå› </span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Object <span class="hljs-title function_">getBlocker</span><span class="hljs-params">(Thread t)</span> &#123;<br>        <span class="hljs-keyword">if</span> (t == <span class="hljs-literal">null</span>)<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NullPointerException</span>();<br>        <span class="hljs-keyword">return</span> U.getReferenceOpaque(t, PARKBLOCKER);<br>    &#125;<br><br><span class="hljs-comment">// ç”¨äºè®©æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ WAITING çŠ¶æ€ï¼Œå¹¶è¢«æŠ•é€’åˆ°ä½¿ç”¨äº† LockSupport çš„å…·ä½“äº§å“ç»´æŠ¤çš„æ•°æ®ç»“æ„ï¼Œç­‰å¾…è¢«å”¤é†’ï¼ˆLockSupport.unparkï¼‰ã€è¢«ä¸­æ–­ï¼ˆThread#interruptï¼‰</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ WAITING çŠ¶æ€åï¼Œèƒ½å“åº”ä¸­æ–­ã€‚çº¿ç¨‹è¢«å”¤é†’ï¼Œé‡æ–°è·å¾— CPU æ—¶é—´ç‰‡åï¼Œä¸ä¼šæŠ›å‡º InterruptedException å—æ£€å¼‚å¸¸ï¼Œä½†ä¼šä¿ç•™ Thread å®ä¾‹çš„ä¸­æ–­çŠ¶æ€ï¼Œç»§ç»­å‘ä¸‹æ‰§è¡Œï¼ˆæ­£å¸¸é€€å‡ºï¼ˆæœªå‘ç”Ÿå¼‚å¸¸ï¼‰ï¼‰</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">park</span><span class="hljs-params">()</span> &#123;<br>        U.park(<span class="hljs-literal">false</span>, <span class="hljs-number">0L</span>);<br>    &#125;<br><br><span class="hljs-comment">// ç”¨äºè®©æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ TIMED_WAITING çŠ¶æ€ï¼Œå¹¶è¢«æŠ•é€’åˆ°ä½¿ç”¨äº† LockSupport çš„å…·ä½“äº§å“ç»´æŠ¤çš„æ•°æ®ç»“æ„ï¼Œç­‰å¾…è¢«å”¤é†’ï¼ˆLockSupport.unparkï¼‰ã€è¢«ä¸­æ–­ï¼ˆThread#interruptï¼‰ã€é˜»å¡è¶…æ—¶</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ TIMED_WAITING çŠ¶æ€åï¼Œèƒ½å“åº”ä¸­æ–­ã€‚çº¿ç¨‹è¢«å”¤é†’ï¼Œé‡æ–°è·å¾— CPU æ—¶é—´ç‰‡åï¼Œä¸ä¼šæŠ›å‡º InterruptedException å—æ£€å¼‚å¸¸ï¼Œä½†ä¼šä¿ç•™ Thread å®ä¾‹çš„ä¸­æ–­çŠ¶æ€ï¼Œç»§ç»­å‘ä¸‹æ‰§è¡Œï¼ˆæ­£å¸¸é€€å‡ºï¼ˆæœªå‘ç”Ÿå¼‚å¸¸ï¼‰ï¼‰</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">parkNanos</span><span class="hljs-params">(<span class="hljs-type">long</span> nanos)</span> &#123;<br>        <span class="hljs-keyword">if</span> (nanos &gt; <span class="hljs-number">0</span>)<br>            U.park(<span class="hljs-literal">false</span>, nanos);<br>    &#125;<br><br><span class="hljs-comment">// ç”¨äºè®©æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ TIMED_WAITING çŠ¶æ€ï¼Œå¹¶è¢«æŠ•é€’åˆ°ä½¿ç”¨äº† LockSupport çš„å…·ä½“äº§å“ç»´æŠ¤çš„æ•°æ®ç»“æ„ï¼Œç­‰å¾…è¢«å”¤é†’ï¼ˆLockSupport.unparkï¼‰ã€è¢«ä¸­æ–­ï¼ˆThread#interruptï¼‰ã€é˜»å¡è¶…æ—¶</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ TIMED_WAITING çŠ¶æ€åï¼Œèƒ½å“åº”ä¸­æ–­ã€‚çº¿ç¨‹è¢«å”¤é†’ï¼Œé‡æ–°è·å¾— CPU æ—¶é—´ç‰‡åï¼Œä¸ä¼šæŠ›å‡º InterruptedException å—æ£€å¼‚å¸¸ï¼Œä½†ä¼šä¿ç•™ Thread å®ä¾‹çš„ä¸­æ–­çŠ¶æ€ï¼Œç»§ç»­å‘ä¸‹æ‰§è¡Œï¼ˆæ­£å¸¸é€€å‡ºï¼ˆæœªå‘ç”Ÿå¼‚å¸¸ï¼‰ï¼‰</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">parkUntil</span><span class="hljs-params">(<span class="hljs-type">long</span> deadline)</span> &#123;<br>        U.park(<span class="hljs-literal">true</span>, deadline);<br>    &#125;<br><br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-title function_">getThreadId</span><span class="hljs-params">(Thread thread)</span> &#123;<br>        <span class="hljs-keyword">return</span> U.getLong(thread, TID);<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Unsafe</span> <span class="hljs-variable">U</span> <span class="hljs-operator">=</span> Unsafe.getUnsafe();<br>    <br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-variable">PARKBLOCKER</span><br>        <span class="hljs-operator">=</span> U.objectFieldOffset(Thread.class, <span class="hljs-string">&quot;parkBlocker&quot;</span>);<br>        <br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-variable">TID</span><br>        <span class="hljs-operator">=</span> U.objectFieldOffset(Thread.class, <span class="hljs-string">&quot;tid&quot;</span>);<br><br>&#125;<br></code></pre></td></tr></table></figure><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.lang.Thread æºç è§£æ</title>
    <link href="/2025/11/12/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.Thread%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/11/12/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.Thread%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/11/12/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.Thread%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/12/æºç ï¼šjava.lang.Threadæºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-Thread-æ¦‚è¿°"><a href="#3-1-Thread-æ¦‚è¿°" class="headerlink" title="3.1. Thread æ¦‚è¿°"></a>3.1. Thread æ¦‚è¿°</h3><p><code>Thread</code> æ˜¯ä¸€ä¸ªå…·ä½“ç±»ï¼Œå®ç°äº† <code>java.util.concurrent.Runnable</code><br><img src="/source/_posts/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.Thread%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.Thread%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.png"></p><p><code>Thread</code> å®ä¾‹æ˜¯ä¸€ä¸ª <code>Runnable</code> ä»»åŠ¡ï¼Œå½“æˆ‘ä»¬è°ƒç”¨ <code>Thread#start</code> åï¼Œ<code>JVM</code> ä¼šåœ¨æ“ä½œç³»ç»Ÿå±‚é¢è¯·æ±‚åˆ›å»ºä¸€ä¸ªæœ¬åœ°çº¿ç¨‹ã€‚ä¸€æ—¦æ“ä½œç³»ç»Ÿåˆ›å»ºäº†è¿™ä¸ªæœ¬åœ°çº¿ç¨‹ï¼Œå¹¶å°†å…¶ä¸ <code>Thread</code> å®ä¾‹ â€œç»‘å®šâ€ï¼Œ<code>Thread</code> å®ä¾‹å°±ä¼šè¿›å…¥å¯è¿è¡ŒçŠ¶æ€ã€‚å½“æœ¬åœ°çº¿ç¨‹è¢«åˆ†é…åˆ° <code>CPU</code> æ—¶é—´ç‰‡åï¼Œå¼€å§‹æ‰§è¡Œ <code>Java</code> ä»£ç ï¼Œæ‰§è¡Œçš„å°±æ˜¯ <code>Thread#run</code> </p><p>ç„¶è€Œï¼Œç”±äº <code>Thread#run</code> çš„æºç åˆæ˜¯ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br><br><span class="hljs-keyword">if</span> (target != <span class="hljs-literal">null</span>) &#123;<br>target.run();<br>&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>æ‰€ä»¥çº¿ç¨‹æ‰§è¡Œçš„æµç¨‹å¤§è‡´ä¸ºï¼š<code>æœ¬åœ°çº¿ç¨‹ â” Thread#run â” target#run</code></p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>è¯¦è§æºç ï¼š<code>Runnable</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.Runnable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.Runnableæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/09/02/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.Runnable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/09/02/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.Runnable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</a></li></ol></li></ol></li><li>è™½ç„¶çº¿ç¨‹æ‰§è¡Œçš„æµç¨‹å¤§è‡´ä¸ºï¼š<code>æœ¬åœ°çº¿ç¨‹ â” Thread#run â” target#run</code>ã€‚ä½†æ˜¯åœ¨æŸäº›åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬ä¸å¸Œæœ›åœ¨åˆ›å»º <code>Thread</code> å®ä¾‹æ—¶ä¼ å…¥ä¸€ä¸ª <code>Runnable</code> å®ä¾‹ï¼Œå› ä¸ºæˆ‘ä»¬å·²ç»æ˜ç¡®çŸ¥é“è¯¥çº¿ç¨‹è¦æ‰§è¡Œçš„å…·ä½“é€»è¾‘ã€‚æ­¤æ—¶ï¼Œå¸¸è§çš„åšæ³•æ˜¯ç›´æ¥ç»§æ‰¿ <code>Thread</code> å…·ä½“ç±»ï¼Œå¹¶é‡å†™ <code>Thread#run</code>ï¼Œæˆ‘ä»¬ç›´æ¥ä½¿ç”¨è¿™ä¸ª <code>Thread</code> å…·ä½“ç±»çš„å­ç±»ã€‚è¿™æ ·çº¿ç¨‹æ‰§è¡Œçš„æµç¨‹å¤§è‡´ä¸ºï¼š<code>æœ¬åœ°çº¿ç¨‹ â” Thread#run</code></li></ol></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyThread</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Thread</span>&#123;  <br>  <br>    <span class="hljs-meta">@Override</span>  <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-comment">// ...</span><br>    &#125;  <br>    <br>&#125;<br><br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> &#123;  <br>  <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;  <br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">myThread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyThread</span>();  <br>        myThread.start();  <br>    &#125;  <br>  <br>&#125;<br></code></pre></td></tr></table></figure><hr><h3 id="3-2-åˆ›å»º-Thread-å®ä¾‹å¸¸è§æ–¹å¼"><a href="#3-2-åˆ›å»º-Thread-å®ä¾‹å¸¸è§æ–¹å¼" class="headerlink" title="3.2. åˆ›å»º Thread å®ä¾‹å¸¸è§æ–¹å¼"></a>3.2. åˆ›å»º Thread å®ä¾‹å¸¸è§æ–¹å¼</h3><h4 id="3-2-1-ç»§æ‰¿-Thread-å…·ä½“ç±»ï¼Œé‡å†™-Thread-runï¼Œåˆ›å»º-Thread-å…·ä½“ç±»çš„å­ç±»å®ä¾‹"><a href="#3-2-1-ç»§æ‰¿-Thread-å…·ä½“ç±»ï¼Œé‡å†™-Thread-runï¼Œåˆ›å»º-Thread-å…·ä½“ç±»çš„å­ç±»å®ä¾‹" class="headerlink" title="3.2.1. ç»§æ‰¿ Thread å…·ä½“ç±»ï¼Œé‡å†™ Thread#runï¼Œåˆ›å»º Thread å…·ä½“ç±»çš„å­ç±»å®ä¾‹"></a>3.2.1. ç»§æ‰¿ Thread å…·ä½“ç±»ï¼Œé‡å†™ Thread#runï¼Œåˆ›å»º Thread å…·ä½“ç±»çš„å­ç±»å®ä¾‹</h4><p>æ­£å¦‚æˆ‘ä»¬ä¸Šé¢è®¨è®ºçš„ï¼Œç›´æ¥ç»§æ‰¿ <code>Thread</code> ç±»ï¼Œé‡å†™ <code>Thread#run</code>ï¼Œåˆ›å»º <code>Thread</code> å…·ä½“ç±»çš„å­ç±»å®ä¾‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyThread</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Thread</span>&#123;  <br>  <br>    <span class="hljs-meta">@Override</span>  <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-comment">// ...</span><br>    &#125;  <br>    <br>&#125;<br><br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> &#123;  <br>  <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;  <br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">myThread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyThread</span>();  <br>        myThread.start();  <br>    &#125;  <br>  <br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨åŒ¿åå†…éƒ¨ç±»ç»§æ‰¿ <code>Thread</code> å…·ä½“ç±»ï¼š</li></ol></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> &#123;  <br>  <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;  <br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">myThread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(<span class="hljs-string">&quot;myThread&quot;</span>) &#123;  <br>            <span class="hljs-meta">@Override</span>  <br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;  <br>                <span class="hljs-comment">// ...</span><br>            &#125;  <br>        &#125;;  <br>        myThread.start();  <br>    &#125;  <br>    <br>&#125;<br></code></pre></td></tr></table></figure><hr><h4 id="3-2-2-åˆ›å»º-Runnable-å®ä¾‹ï¼Œåˆ›å»º-Thread-å®ä¾‹ï¼Œå¹¶å°†-Runnable-å®ä¾‹ä½œä¸º-Thread-å®ä¾‹çš„æ„é€ æ–¹æ³•å‚æ•°ä¼ é€’è¿›å»"><a href="#3-2-2-åˆ›å»º-Runnable-å®ä¾‹ï¼Œåˆ›å»º-Thread-å®ä¾‹ï¼Œå¹¶å°†-Runnable-å®ä¾‹ä½œä¸º-Thread-å®ä¾‹çš„æ„é€ æ–¹æ³•å‚æ•°ä¼ é€’è¿›å»" class="headerlink" title="3.2.2. åˆ›å»º Runnable å®ä¾‹ï¼Œåˆ›å»º Thread å®ä¾‹ï¼Œå¹¶å°† Runnable å®ä¾‹ä½œä¸º Thread å®ä¾‹çš„æ„é€ æ–¹æ³•å‚æ•°ä¼ é€’è¿›å»"></a>3.2.2. åˆ›å»º Runnable å®ä¾‹ï¼Œåˆ›å»º Thread å®ä¾‹ï¼Œå¹¶å°† Runnable å®ä¾‹ä½œä¸º Thread å®ä¾‹çš„æ„é€ æ–¹æ³•å‚æ•°ä¼ é€’è¿›å»</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> &#123;  <br>  <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;  <br>    <span class="hljs-type">Runnable</span> <span class="hljs-variable">runnable</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Runnable</span>() &#123;<br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-comment">// ...</span><br>&#125;<br>&#125;;<br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">myThread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(runnable, <span class="hljs-string">&quot;myThread&quot;</span>);<br>        myThread.start();  <br>    &#125;  <br>  <br>&#125;<br></code></pre></td></tr></table></figure><hr><h4 id="3-2-3-ä½¿ç”¨çº¿ç¨‹æ± "><a href="#3-2-3-ä½¿ç”¨çº¿ç¨‹æ± " class="headerlink" title="3.2.3. ä½¿ç”¨çº¿ç¨‹æ± "></a>3.2.3. ä½¿ç”¨çº¿ç¨‹æ± </h4><p>è¯¦è§ç¬”è®°ï¼š<code>JUC</code></p><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥<ol><li><a href="%E7%AC%94%E8%AE%B0%EF%BC%9AJUC.md">ç¬”è®°ï¼šJUC</a></li></ol></li><li><code>Hexo</code> é“¾æ¥<ol><li><a href="http://blog.wangjia.ink/2025/11/23/%E7%AC%94%E8%AE%B0%EF%BC%9AJUC/">http://blog.wangjia.ink/2025/11/23/ç¬”è®°ï¼šJUC/</a></li></ol></li></ol><hr><h2 id="4-æ„é€ æ–¹æ³•"><a href="#4-æ„é€ æ–¹æ³•" class="headerlink" title="4. æ„é€ æ–¹æ³•"></a>4. æ„é€ æ–¹æ³•</h2><h3 id="4-1-Thread-String-name"><a href="#4-1-Thread-String-name" class="headerlink" title="4.1. Thread(String name)"></a>4.1. Thread(String name)</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-title function_">Thread</span><span class="hljs-params">(String name)</span> &#123;<br><br><span class="hljs-built_in">this</span>(<span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, name, <span class="hljs-number">0</span>);<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h3 id="4-2-Thread-Runnable-target"><a href="#4-2-Thread-Runnable-target" class="headerlink" title="4.2. Thread(Runnable target)"></a>4.2. Thread(Runnable target)</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-title function_">Thread</span><span class="hljs-params">(Runnable target)</span> &#123;<br><br><span class="hljs-built_in">this</span>(<span class="hljs-literal">null</span>, target, <span class="hljs-string">&quot;Thread-&quot;</span> + nextThreadNum(), <span class="hljs-number">0</span>);<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h3 id="4-3-Thread-Runnable-target-String-name"><a href="#4-3-Thread-Runnable-target-String-name" class="headerlink" title="4.3. Thread(Runnable target, String name)"></a>4.3. Thread(Runnable target, String name)</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-title function_">Thread</span><span class="hljs-params">(Runnable target, String name)</span> &#123;<br><br><span class="hljs-built_in">this</span>(<span class="hljs-literal">null</span>, target, name, <span class="hljs-number">0</span>);<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h3 id="4-4-Thread-ThreadGroup-group-Runnable-target-String-name-long-stackSize"><a href="#4-4-Thread-ThreadGroup-group-Runnable-target-String-name-long-stackSize" class="headerlink" title="4.4. Thread(ThreadGroup group, Runnable target, String name, long stackSize)"></a>4.4. Thread(ThreadGroup group, Runnable target, String name, long stackSize)</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-title function_">Thread</span><span class="hljs-params">(ThreadGroup group, Runnable target, String name,</span><br><span class="hljs-params">  <span class="hljs-type">long</span> stackSize)</span> &#123;<br><br><span class="hljs-built_in">this</span>(group, target, name, stackSize, <span class="hljs-literal">null</span>, <span class="hljs-literal">true</span>);<br><br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li><code>ThreadGroup</code> æ˜¯ä¸€ä¸ªéå¸¸å¤è€ä¸”å¾ˆå°‘è¢«æ­£ç¡®ä½¿ç”¨çš„åŠŸèƒ½ï¼Œåœ¨ç°ä»£å¼€å‘ä¸­å‡ ä¹æ°¸è¿œä¸ä¼šç¢°å®ƒ</li></ol></blockquote><hr><h2 id="5-å®ä¾‹æ–¹æ³•"><a href="#5-å®ä¾‹æ–¹æ³•" class="headerlink" title="5. å®ä¾‹æ–¹æ³•"></a>5. å®ä¾‹æ–¹æ³•</h2><h3 id="5-1-å®ä¾‹å…·ä½“æ–¹æ³•"><a href="#5-1-å®ä¾‹å…·ä½“æ–¹æ³•" class="headerlink" title="5.1. å®ä¾‹å…·ä½“æ–¹æ³•"></a>5.1. å®ä¾‹å…·ä½“æ–¹æ³•</h3><h4 id="5-1-1-å…·ä½“æ–¹æ³•ï¼ˆæ™®é€šï¼‰"><a href="#5-1-1-å…·ä½“æ–¹æ³•ï¼ˆæ™®é€šï¼‰" class="headerlink" title="5.1.1. å…·ä½“æ–¹æ³•ï¼ˆæ™®é€šï¼‰"></a>5.1.1. å…·ä½“æ–¹æ³•ï¼ˆæ™®é€šï¼‰</h4><h5 id="5-1-1-1-void-start"><a href="#5-1-1-1-void-start" class="headerlink" title="5.1.1.1. void start()"></a>5.1.1.1. void start()</h5><p>è¯¥æ–¹æ³•ç”¨äºéé˜»å¡å¯åŠ¨ä¸€ä¸ª <code>Thread</code> å®ä¾‹</p><p>å½“æˆ‘ä»¬è°ƒç”¨ <code>Thread#start</code> åï¼Œ<code>JVM</code> ä¼šåœ¨æ“ä½œç³»ç»Ÿå±‚é¢è¯·æ±‚åˆ›å»ºä¸€ä¸ªæœ¬åœ°çº¿ç¨‹ã€‚ä¸€æ—¦æ“ä½œç³»ç»Ÿåˆ›å»ºäº†è¿™ä¸ªæœ¬åœ°çº¿ç¨‹ï¼Œå¹¶å°†å…¶ä¸ <code>Thread</code> å®ä¾‹ â€œç»‘å®šâ€ï¼Œ<code>Thread</code> å®ä¾‹å°±ä¼šè¿›å…¥å¯è¿è¡ŒçŠ¶æ€</p><p>å½“æœ¬åœ°çº¿ç¨‹è¢«åˆ†é…åˆ° <code>CPU</code> æ—¶é—´ç‰‡åï¼Œå¼€å§‹æ‰§è¡Œ <code>Java</code> ä»£ç ï¼Œæ‰§è¡Œçš„å°±æ˜¯ <code>Thread#run</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * ============================================</span><br><span class="hljs-comment"> * å®ä¾‹å…·ä½“æ–¹æ³•ï¼ˆæ™®é€šï¼‰ï¼š</span><br><span class="hljs-comment"> * public synchronized void start()</span><br><span class="hljs-comment"> * --------------------------------------------</span><br><span class="hljs-comment"> * 1. è®¿é—®ä¿®é¥°ç¬¦</span><br><span class="hljs-comment"> *      1. public</span><br><span class="hljs-comment"> *          1. å¤©ä¸‹çš†å…¬ï¼ˆEveryWhereï¼‰</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 2. éè®¿é—®ä¿®é¥°ç¬¦</span><br><span class="hljs-comment"> *      1. synchronized</span><br><span class="hljs-comment"> *          1. æ–¹æ³•åŠ  synchronized é”</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 3. æ–¹æ³•å‚æ•°</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 4. è¿”å›å€¼</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 5. æŠ›å‡ºå¼‚å¸¸</span><br><span class="hljs-comment"> *      1. IllegalThreadStateException</span><br><span class="hljs-comment"> *          1. å¦‚æœ Thread å®ä¾‹å·²å¯åŠ¨ï¼Œä½†æ˜¯åˆè¢«å¯åŠ¨ï¼Œå°±ä¼šæŠ›å‡º IllegalThreadStateException å¼‚å¸¸</span><br><span class="hljs-comment"> *          2. ç®€å•æ¥è¯´å°±æ˜¯ï¼šä¸€ä¸ª Thread å®ä¾‹åªèƒ½è°ƒç”¨ä¸€æ¬¡ Thread#start</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 6. ä½¿ç”¨ç¤ºä¾‹</span><br><span class="hljs-comment"> * Thread myThread = new Thread(&quot;myThread&quot;) &#123;</span><br><span class="hljs-comment"> *     <span class="hljs-doctag">@Override</span></span><br><span class="hljs-comment"> *     public void run() &#123;</span><br><span class="hljs-comment"> *         // ...</span><br><span class="hljs-comment"> *     &#125;</span><br><span class="hljs-comment"> * &#125;;</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * myThread.start();</span><br><span class="hljs-comment"> * ============================================</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">start</span><span class="hljs-params">()</span> &#123;<br><br><span class="hljs-keyword">if</span> (threadStatus != <span class="hljs-number">0</span>)<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalThreadStateException</span>();<br>group.add(<span class="hljs-built_in">this</span>);<br><span class="hljs-type">boolean</span> <span class="hljs-variable">started</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;<br><span class="hljs-keyword">try</span> &#123;<br>start0();<br>started = <span class="hljs-literal">true</span>;<br>&#125; <span class="hljs-keyword">finally</span> &#123;<br><span class="hljs-keyword">try</span> &#123;<br><span class="hljs-keyword">if</span> (!started) &#123;<br>group.threadStartFailed(<span class="hljs-built_in">this</span>);<br>&#125;<br>&#125; <span class="hljs-keyword">catch</span> (Throwable ignore) &#123;<br>&#125;<br>&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h5 id="5-1-1-2-void-interrupt"><a href="#5-1-1-2-void-interrupt" class="headerlink" title="5.1.1.2. void interrupt()"></a>5.1.1.2. void interrupt()</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ç”¨äºéé˜»å¡ä¸­æ–­çº¿ç¨‹</span><br><span class="hljs-comment">// </span><br><span class="hljs-comment">// è¯¥æ–¹æ³•ä¼šä¸ºè¢«ä¸­æ–­çš„ Thread å®ä¾‹è®¾ç½®ä¸­æ–­çŠ¶æ€</span><br><span class="hljs-comment">// </span><br><span class="hljs-comment">// å¦‚æœè¢«ä¸­æ–­çš„ Thread å®ä¾‹å¤„äº RUNNABLE çŠ¶æ€ï¼Œå°±åªä¼šè®¾ç½® Thread å®ä¾‹çš„ä¸­æ–­çŠ¶æ€</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// å¦‚æœè¢«ä¸­æ–­çš„ Thread å®ä¾‹å¤„äº BLOCKEDã€WAITINGã€TIMED_WAITING çŠ¶æ€ï¼Œå¯èƒ½æœ‰ä»¥ä¸‹å‡ ç§æƒ…å†µï¼š</span><br><span class="hljs-comment">//     1. æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ BWTW çŠ¶æ€åï¼Œèƒ½å“åº”ä¸­æ–­ã€‚çº¿ç¨‹è¢«å”¤é†’ï¼Œé‡æ–°è·å¾— CPU æ—¶é—´ç‰‡åï¼Œä¼šæŠ›å‡º InterruptedException å—æ£€å¼‚å¸¸ï¼Œå¹¶æ¸…é™¤ Thread å®ä¾‹çš„ä¸­æ–­çŠ¶æ€ï¼ˆå¼‚å¸¸é€€å‡ºæˆ–æ­£å¸¸é€€å‡ºï¼ˆå‘ç”Ÿå¼‚å¸¸ï¼‰ï¼Œè¦çœ‹æˆ‘ä»¬æ˜¯å¦å¯¹è¯¥å¼‚å¸¸è¿›è¡Œæ•è·å¹¶å¤„ç†ï¼‰</span><br><span class="hljs-comment">//     2. æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ BWTW çŠ¶æ€åï¼Œèƒ½å“åº”ä¸­æ–­ã€‚çº¿ç¨‹è¢«å”¤é†’ï¼Œé‡æ–°è·å¾— CPU æ—¶é—´ç‰‡åï¼Œä¸ä¼šæŠ›å‡º InterruptedException å—æ£€å¼‚å¸¸ï¼Œä½†ä¼šä¿ç•™ Thread å®ä¾‹çš„ä¸­æ–­çŠ¶æ€ï¼Œç»§ç»­å‘ä¸‹æ‰§è¡Œï¼ˆæ­£å¸¸é€€å‡ºï¼ˆæœªå‘ç”Ÿå¼‚å¸¸ï¼‰ï¼‰</span><br><span class="hljs-comment">//     3. æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ BWTW çŠ¶æ€åï¼Œä¸èƒ½èƒ½å“åº”ä¸­æ–­ã€‚çº¿ç¨‹ä¼šç»§ç»­é˜»å¡ï¼Œå¹¶ä¼šä¿ç•™ Thread ç¤ºä¾‹çš„ä¸­æ–­çŠ¶æ€ã€‚å½“çº¿ç¨‹è¢«å”¤é†’åï¼Œä¼šç»§ç»­å‘ä¸‹æ‰§è¡Œï¼ˆæ­£å¸¸é€€å‡ºï¼ˆæœªå‘ç”Ÿå¼‚å¸¸ï¼‰ï¼‰</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">interrupt</span><span class="hljs-params">()</span> &#123;<br><br><span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span> != Thread.currentThread()) &#123;<br>checkAccess();<br><br><span class="hljs-keyword">synchronized</span> (blockerLock) &#123;<br><span class="hljs-type">Interruptible</span> <span class="hljs-variable">b</span> <span class="hljs-operator">=</span> blocker;<br><span class="hljs-keyword">if</span> (b != <span class="hljs-literal">null</span>) &#123;<br>interrupted = <span class="hljs-literal">true</span>;<br>interrupt0();<br>b.interrupt(<span class="hljs-built_in">this</span>);<br><span class="hljs-keyword">return</span>;<br>&#125;<br>&#125;<br>&#125;<br>interrupted = <span class="hljs-literal">true</span>;<br>interrupt0();<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h5 id="5-1-1-3-void-setPriority-int-newPriority"><a href="#5-1-1-3-void-setPriority-int-newPriority" class="headerlink" title="5.1.1.3. void setPriority(int newPriority)"></a>5.1.1.3. void setPriority(int newPriority)</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ç”¨äºéé˜»å¡è®¾ç½®æœ¬åœ°çº¿ç¨‹çš„ä¼˜å…ˆçº§</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// JVM è§„å®šæœ¬åœ°çº¿ç¨‹çš„ä¼˜å…ˆçº§ä¸º 1 - 10 ä¹‹é—´çš„æ•´æ•°ï¼Œä¼˜å…ˆçº§è¶Šé«˜ï¼Œæœ¬åœ°çº¿ç¨‹è¢« CPU è°ƒåº¦çš„å¯èƒ½æ€§è¶Šå¤§</span><br><span class="hljs-comment">// </span><br><span class="hljs-comment">// è¿™é‡Œçš„ä¼˜å…ˆçº§ä»…æ˜¯å»ºè®®æ€§æç¤ºï¼Œæ˜¯å¦ç”Ÿæ•ˆå–å†³äºå…·ä½“çš„è°ƒåº¦ç­–ç•¥</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setPriority</span><span class="hljs-params">(<span class="hljs-type">int</span> newPriority)</span> &#123;<br><br>ThreadGroup g;<br>checkAccess();<br><span class="hljs-keyword">if</span> (newPriority &gt; MAX_PRIORITY || newPriority &lt; MIN_PRIORITY) &#123;<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>();<br>&#125;<br><span class="hljs-keyword">if</span>((g = getThreadGroup()) != <span class="hljs-literal">null</span>) &#123;<br><span class="hljs-keyword">if</span> (newPriority &gt; g.getMaxPriority()) &#123;<br>newPriority = g.getMaxPriority();<br>&#125;<br>setPriority0(priority = newPriority);<br>&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h5 id="5-1-1-4-int-getPriority"><a href="#5-1-1-4-int-getPriority" class="headerlink" title="5.1.1.4. int getPriority()"></a>5.1.1.4. int getPriority()</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ç”¨äºéé˜»å¡è·å–æœ¬åœ°çº¿ç¨‹çš„ä¼˜å…ˆçº§</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getPriority</span><span class="hljs-params">()</span> &#123;<br><br><span class="hljs-keyword">return</span> priority;<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h5 id="5-1-1-5-void-join"><a href="#5-1-1-5-void-join" class="headerlink" title="5.1.1.5. void join()"></a>5.1.1.5. void join()</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ç”¨äºè®©æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ WAITING çŠ¶æ€ï¼Œå¹¶è¢«æŠ•é€’åˆ° Monitor ä¸­çš„ WaitSet é˜Ÿåˆ—ï¼Œç­‰å¾…è¢«å”¤é†’ï¼ˆObect#notifyï¼‰ã€è¢«ä¸­æ–­</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ WAITING çŠ¶æ€åï¼Œèƒ½å“åº”ä¸­æ–­ã€‚çº¿ç¨‹è¢«å”¤é†’ï¼Œé‡æ–°è·å¾— CPU æ—¶é—´ç‰‡åï¼Œä¼šæŠ›å‡º InterruptedException å—æ£€å¼‚å¸¸ï¼Œå¹¶æ¸…é™¤ Thread å®ä¾‹çš„ä¸­æ–­çŠ¶æ€ï¼ˆå¼‚å¸¸é€€å‡ºæˆ–æ­£å¸¸é€€å‡ºï¼ˆå‘ç”Ÿå¼‚å¸¸ï¼‰ï¼Œè¦çœ‹æˆ‘ä»¬æ˜¯å¦å¯¹è¯¥å¼‚å¸¸è¿›è¡Œæ•è·å¹¶å¤„ç†ï¼‰</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">join</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException &#123;<br><br>join(<span class="hljs-number">0</span>);<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h5 id="5-1-1-6-void-join-final-long-millis"><a href="#5-1-1-6-void-join-final-long-millis" class="headerlink" title="5.1.1.6. void join(final long millis)"></a>5.1.1.6. void join(final long millis)</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ç”¨äºè®©æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ TIMED_WAITING çŠ¶æ€ï¼Œå¹¶è¢«æŠ•é€’åˆ° Monitor ä¸­çš„ WaitSet é˜Ÿåˆ—ï¼Œç­‰å¾…è¢«å”¤é†’ï¼ˆObect#notifyï¼‰ã€è¢«ä¸­æ–­ã€é˜»å¡è¶…æ—¶</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ TIMED_WAITING çŠ¶æ€åï¼Œèƒ½å“åº”ä¸­æ–­ã€‚çº¿ç¨‹è¢«å”¤é†’ï¼Œé‡æ–°è·å¾— CPU æ—¶é—´ç‰‡åï¼Œä¼šæŠ›å‡º InterruptedException å—æ£€å¼‚å¸¸ï¼Œå¹¶æ¸…é™¤ Thread å®ä¾‹çš„ä¸­æ–­çŠ¶æ€ï¼ˆå¼‚å¸¸é€€å‡ºæˆ–æ­£å¸¸é€€å‡ºï¼ˆå‘ç”Ÿå¼‚å¸¸ï¼‰ï¼Œè¦çœ‹æˆ‘ä»¬æ˜¯å¦å¯¹è¯¥å¼‚å¸¸è¿›è¡Œæ•è·å¹¶å¤„ç†ï¼‰</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">join</span><span class="hljs-params">(<span class="hljs-keyword">final</span> <span class="hljs-type">long</span> millis)</span><br><br><span class="hljs-keyword">throws</span> InterruptedException &#123;<br><span class="hljs-keyword">if</span> (millis &gt; <span class="hljs-number">0</span>) &#123;<br><span class="hljs-keyword">if</span> (isAlive()) &#123;<br><span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-variable">startTime</span> <span class="hljs-operator">=</span> System.nanoTime();<br><span class="hljs-type">long</span> <span class="hljs-variable">delay</span> <span class="hljs-operator">=</span> millis;<br><span class="hljs-keyword">do</span> &#123;<br>wait(delay);<br>&#125; <span class="hljs-keyword">while</span> (isAlive() &amp;&amp; (delay = millis -<br>TimeUnit.NANOSECONDS.toMillis(System.nanoTime() - startTime)) &gt; <span class="hljs-number">0</span>);<br>&#125;<br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (millis == <span class="hljs-number">0</span>) &#123;<br><span class="hljs-keyword">while</span> (isAlive()) &#123;<br>wait(<span class="hljs-number">0</span>);<br>&#125;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">&quot;timeout value is negative&quot;</span>);<br>&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>æ¨èä½¿ç”¨ <code>TimeUnit#timedJoin</code> æ›¿ä»£è¯¥æ–¹æ³•ï¼Œå› ä¸ºå…¶å¯è¯»æ€§æ›´å¥½</li></ol></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">TimeUnit.MINUTES.timedJoin(worker, <span class="hljs-number">1</span>);<br></code></pre></td></tr></table></figure><hr><h5 id="void-join-long-millis-int-nanos"><a href="#void-join-long-millis-int-nanos" class="headerlink" title="void join(long millis, int nanos)"></a>void join(long millis, int nanos)</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ç”¨äºè®©æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ TIMED_WAITING çŠ¶æ€ï¼Œå¹¶è¢«æŠ•é€’åˆ° Monitor ä¸­çš„ WaitSet é˜Ÿåˆ—ï¼Œç­‰å¾…è¢«å”¤é†’ï¼ˆObect#notifyï¼‰ã€è¢«ä¸­æ–­ã€é˜»å¡è¶…æ—¶</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ TIMED_WAITING çŠ¶æ€åï¼Œèƒ½å“åº”ä¸­æ–­ã€‚çº¿ç¨‹è¢«å”¤é†’ï¼Œé‡æ–°è·å¾— CPU æ—¶é—´ç‰‡åï¼Œä¼šæŠ›å‡º InterruptedException å—æ£€å¼‚å¸¸ï¼Œå¹¶æ¸…é™¤ Thread å®ä¾‹çš„ä¸­æ–­çŠ¶æ€ï¼ˆå¼‚å¸¸é€€å‡ºæˆ–æ­£å¸¸é€€å‡ºï¼ˆå‘ç”Ÿå¼‚å¸¸ï¼‰ï¼Œè¦çœ‹æˆ‘ä»¬æ˜¯å¦å¯¹è¯¥å¼‚å¸¸è¿›è¡Œæ•è·å¹¶å¤„ç†ï¼‰</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">join</span><span class="hljs-params">(<span class="hljs-type">long</span> millis, <span class="hljs-type">int</span> nanos)</span> <span class="hljs-keyword">throws</span> InterruptedException &#123;<br><br><span class="hljs-keyword">if</span> (millis &lt; <span class="hljs-number">0</span>) &#123;<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">&quot;timeout value is negative&quot;</span>);<br>&#125;<br><br><span class="hljs-keyword">if</span> (nanos &lt; <span class="hljs-number">0</span> || nanos &gt; <span class="hljs-number">999999</span>) &#123;<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<br><span class="hljs-string">&quot;nanosecond timeout value out of range&quot;</span>);<br>&#125;<br><br><span class="hljs-keyword">if</span> (nanos &gt; <span class="hljs-number">0</span> &amp;&amp; millis &lt; Long.MAX_VALUE) &#123;<br>millis++;<br>&#125;<br><br>join(millis);<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h5 id="5-1-1-7-void-setDaemon-boolean-on"><a href="#5-1-1-7-void-setDaemon-boolean-on" class="headerlink" title="5.1.1.7. void setDaemon(boolean on)"></a>5.1.1.7. void setDaemon(boolean on)</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ç”¨äºéé˜»å¡è®¾ç½® Thread å®ä¾‹ä¸ºå®ˆæŠ¤çº¿ç¨‹</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setDaemon</span><span class="hljs-params">(<span class="hljs-type">boolean</span> on)</span> &#123;<br><br>checkAccess();<br><span class="hljs-keyword">if</span> (isAlive()) &#123;<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalThreadStateException</span>();<br>&#125;<br>daemon = on;<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h5 id="5-1-1-8-boolean-isInterrupted"><a href="#5-1-1-8-boolean-isInterrupted" class="headerlink" title="5.1.1.8. boolean isInterrupted()"></a>5.1.1.8. boolean isInterrupted()</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ç”¨äºéé˜»å¡æŸ¥çœ‹ Thread å®ä¾‹çš„ä¸­æ–­çŠ¶æ€</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// å¦‚æœä¸º trueï¼Œè¯´æ˜ Thread å®ä¾‹è¢«ä¸­æ–­è¿‡</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// å¦‚æœä¸º falseï¼Œè¯´æ˜ Thread å®ä¾‹æ²¡æœ‰è¢«ä¸­æ–­è¿‡</span><br><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isInterrupted</span><span class="hljs-params">()</span> &#123;<br><br><span class="hljs-keyword">return</span> interrupted;<br><br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li><code>Thread.interrupted</code> ä¸ <code>Thread#isInterrupted</code> çš„åŒºåˆ«åœ¨äºï¼š<code>Thread.interrupted</code> ä¼šæ¸…é™¤ <code>Thread</code> å®ä¾‹çš„ä¸­æ–­çŠ¶æ€ï¼Œè€Œ <code>Thread#isInterrupted</code> ä¸ä¼š</li></ol></blockquote><hr><h5 id="5-1-1-9-boolean-isAlive"><a href="#5-1-1-9-boolean-isAlive" class="headerlink" title="5.1.1.9. boolean isAlive()"></a>5.1.1.9. boolean isAlive()</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ç”¨äºéé˜»å¡æŸ¥çœ‹æœ¬åœ°çº¿ç¨‹æ˜¯å¦å­˜æ´»</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isAlive</span><span class="hljs-params">()</span> &#123;<br><br><span class="hljs-keyword">return</span> eetop != <span class="hljs-number">0</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h4 id="5-1-2-å…·ä½“æ–¹æ³•ï¼ˆå®ç°ï¼‰"><a href="#5-1-2-å…·ä½“æ–¹æ³•ï¼ˆå®ç°ï¼‰" class="headerlink" title="5.1.2. å…·ä½“æ–¹æ³•ï¼ˆå®ç°ï¼‰"></a>5.1.2. å…·ä½“æ–¹æ³•ï¼ˆå®ç°ï¼‰</h4><h5 id="5-1-2-1-Runnable-ä¸­æ¥å£æ–¹æ³•çš„å®ç°"><a href="#5-1-2-1-Runnable-ä¸­æ¥å£æ–¹æ³•çš„å®ç°" class="headerlink" title="5.1.2.1. Runnable ä¸­æ¥å£æ–¹æ³•çš„å®ç°"></a>5.1.2.1. Runnable ä¸­æ¥å£æ–¹æ³•çš„å®ç°</h5><h6 id="5-1-2-1-1-void-run"><a href="#5-1-2-1-1-void-run" class="headerlink" title="5.1.2.1.1. void run()"></a>5.1.2.1.1. void run()</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br><br><span class="hljs-keyword">if</span> (target != <span class="hljs-literal">null</span>) &#123;<br>target.run();<br>&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h2 id="6-é™æ€æ–¹æ³•"><a href="#6-é™æ€æ–¹æ³•" class="headerlink" title="6. é™æ€æ–¹æ³•"></a>6. é™æ€æ–¹æ³•</h2><h3 id="6-1-é™æ€å…·ä½“æ–¹æ³•"><a href="#6-1-é™æ€å…·ä½“æ–¹æ³•" class="headerlink" title="6.1. é™æ€å…·ä½“æ–¹æ³•"></a>6.1. é™æ€å…·ä½“æ–¹æ³•</h3><h4 id="6-1-1-å…·ä½“æ–¹æ³•ï¼ˆæ™®é€šï¼‰"><a href="#6-1-1-å…·ä½“æ–¹æ³•ï¼ˆæ™®é€šï¼‰" class="headerlink" title="6.1.1. å…·ä½“æ–¹æ³•ï¼ˆæ™®é€šï¼‰"></a>6.1.1. å…·ä½“æ–¹æ³•ï¼ˆæ™®é€šï¼‰</h4><h5 id="6-1-1-1-void-sleep-long-millis"><a href="#6-1-1-1-void-sleep-long-millis" class="headerlink" title="6.1.1.1. void sleep(long millis)"></a>6.1.1.1. void sleep(long millis)</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ç”¨äºè®©æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥é˜»å¡ï¼ˆTIMED_WAITINGï¼‰çŠ¶æ€ï¼Œç­‰å¾…è¢«ä¸­æ–­ã€é˜»å¡è¶…æ—¶</span><br><span class="hljs-comment">// </span><br><span class="hljs-comment">// æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥é˜»å¡ï¼ˆTIMED_WAITINGï¼‰çŠ¶æ€åï¼Œèƒ½å“åº”ä¸­æ–­ã€‚çº¿ç¨‹è¢«å”¤é†’ï¼Œé‡æ–°è·å¾— CPU æ—¶é—´ç‰‡åï¼Œä¼šæŠ›å‡º InterruptedException å—æ£€å¼‚å¸¸ï¼Œå¹¶æ¸…é™¤ Thread å®ä¾‹çš„ä¸­æ–­çŠ¶æ€ï¼ˆå¼‚å¸¸é€€å‡ºæˆ–æ­£å¸¸é€€å‡ºï¼ˆå‘ç”Ÿå¼‚å¸¸ï¼‰ï¼Œè¦çœ‹æˆ‘ä»¬æ˜¯å¦å¯¹è¯¥å¼‚å¸¸è¿›è¡Œæ•è·å¹¶å¤„ç†ï¼‰</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">native</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sleep</span><span class="hljs-params">(<span class="hljs-type">long</span> millis)</span> <span class="hljs-keyword">throws</span> InterruptedException;<br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>æ¨èä½¿ç”¨ <code>TimeUnit#sleep</code> æ›¿ä»£è¯¥æ–¹æ³•ï¼Œå› ä¸ºå…¶å¯è¯»æ€§æ›´å¥½</li></ol></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">TimeUnit.HOURS.sleep(<span class="hljs-number">5</span>);<br></code></pre></td></tr></table></figure><hr><h5 id="6-1-1-2-void-yield"><a href="#6-1-1-2-void-yield" class="headerlink" title="6.1.1.2. void yield()"></a>6.1.1.2. void yield()</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ç”¨äºéé˜»å¡æç¤ºçº¿ç¨‹è°ƒåº¦å™¨è®©å‡ºå½“å‰æœ¬åœ°çº¿ç¨‹çš„ CPU æ—¶é—´ç‰‡</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// è®©å‡º CPU æ—¶é—´ç‰‡åï¼ŒThread å®ä¾‹çš„çŠ¶æ€ä¼šä» è¿è¡ŒçŠ¶æ€ â” å¯è¿è¡ŒçŠ¶æ€</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// æ‰€è°“çš„ â€œæç¤ºâ€ æ˜¯æŒ‡ï¼šä»…æ˜¯å»ºè®®æ€§æç¤ºï¼Œæ˜¯å¦ç”Ÿæ•ˆå–å†³äºå…·ä½“çš„è°ƒåº¦ç­–ç•¥</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">native</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">yield</span><span class="hljs-params">()</span>;<br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>æœ¬åœ°çº¿ç¨‹è®©å‡º <code>CPU</code> æ—¶é—´ç‰‡åï¼Œç”±äºæ˜¯å¯è¿è¡ŒçŠ¶æ€ï¼Œå¯èƒ½ä¼šç«‹å³è¢«å…¶ä»– <code>CPU</code> æ ¸é‡æ–°è°ƒåº¦ã€‚å› æ­¤ï¼Œåœ¨å¤šæ ¸å¤„ç†å™¨æˆ–ç³»ç»Ÿè´Ÿè½½è¾ƒä½çš„æƒ…å†µä¸‹ï¼Œè¯¥æ–¹æ³•çš„æ•ˆæœå¯èƒ½å¹¶ä¸æ˜æ˜¾ã€‚ä½†æ˜¯åœ¨å•æ ¸ç¯å¢ƒæˆ–ç³»ç»Ÿè´Ÿè½½è¾ƒé«˜æ—¶ï¼Œå…¶è°ƒåº¦è¡Œä¸ºä¼šæ¯”è¾ƒæ˜æ˜¾</li></ol></blockquote><hr><h5 id="6-1-1-3-Thread-currentThread"><a href="#6-1-1-3-Thread-currentThread" class="headerlink" title="6.1.1.3. Thread currentThread()"></a>6.1.1.3. Thread currentThread()</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ç”¨äºéé˜»å¡è·å–æ‰§è¡Œå½“å‰ Java ä»£ç çš„æœ¬åœ°çº¿ç¨‹å¯¹åº”çš„ Thread å®ä¾‹</span><br><span class="hljs-meta">@IntrinsicCandidate</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">native</span> Thread <span class="hljs-title function_">currentThread</span><span class="hljs-params">()</span>;<br></code></pre></td></tr></table></figure><hr><h5 id="6-1-1-4-boolean-interrupted"><a href="#6-1-1-4-boolean-interrupted" class="headerlink" title="6.1.1.4. boolean interrupted()"></a>6.1.1.4. boolean interrupted()</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ç”¨äºéé˜»å¡æŸ¥çœ‹ Thread å®ä¾‹çš„ä¸­æ–­çŠ¶æ€</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// å¦‚æœä¸º trueï¼Œè¯´æ˜ Thread å®ä¾‹è¢«ä¸­æ–­è¿‡</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// å¦‚æœä¸º falseï¼Œè¯´æ˜ Thread å®ä¾‹æ²¡æœ‰è¢«ä¸­æ–­è¿‡</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">interrupted</span><span class="hljs-params">()</span> &#123;<br><br><span class="hljs-type">Thread</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> currentThread();<br><span class="hljs-type">boolean</span> <span class="hljs-variable">interrupted</span> <span class="hljs-operator">=</span> t.interrupted;<br><span class="hljs-keyword">if</span> (interrupted) &#123;<br><span class="hljs-comment">// æ¸…é™¤ Thread å®ä¾‹ä¸­çš„ä¸­æ–­çŠ¶æ€</span><br>t.interrupted = <span class="hljs-literal">false</span>;<br>clearInterruptEvent();<br>&#125;<br><span class="hljs-keyword">return</span> interrupted;<br><br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li><code>Thread.interrupted</code> ä¸ <code>Thread#isInterrupted</code> çš„åŒºåˆ«åœ¨äºï¼š<code>Thread.interrupted</code> ä¼šæ¸…é™¤ <code>Thread</code> å®ä¾‹çš„ä¸­æ–­çŠ¶æ€ï¼Œè€Œ <code>Thread#isInterrupted</code> ä¸ä¼š</li></ol></blockquote><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.util.concurrent.RunnableScheduledFutureï¼œVï¼ æºç è§£æ</title>
    <link href="/2025/11/10/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.RunnableScheduledFuture%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/11/10/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.RunnableScheduledFuture%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/05/05/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.RunnableScheduledFuture%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/05/05/æºç ï¼šjava.util.concurrent.RunnableScheduledFutureï¼œVï¼æºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-RunnableScheduledFutureï¼œVï¼-æ¦‚è¿°"><a href="#3-1-RunnableScheduledFutureï¼œVï¼-æ¦‚è¿°" class="headerlink" title="3.1. RunnableScheduledFutureï¼œVï¼ æ¦‚è¿°"></a>3.1. RunnableScheduledFutureï¼œVï¼ æ¦‚è¿°</h3><p><code>RunnableScheduledFutureï¼œVï¼</code> æ˜¯ä¸€ä¸ªæ¥å£ï¼Œç»§æ‰¿äº†<code> java.util.concurrent.RunnableFutureï¼œVï¼</code>ã€<code>java.util.concurrent.ScheduledFutureï¼œVï¼</code></p><p><code>RunnableScheduledFutureï¼œVï¼</code> åœ¨ <code>RunnableFutureï¼œVï¼</code> çš„åŸºç¡€ä¸Šï¼Œæä¾›äº†ä»¥ä¸‹æ–¹æ³•ï¼š</p><ol><li>æŸ¥çœ‹ä»»åŠ¡æ˜¯å¦æ˜¯å‘¨æœŸæ€§ä»»åŠ¡</li></ol><p>å¦‚æœæŸå®ç°ç±»å®ç°äº† <code>RunnableScheduledFutureï¼œVï¼</code> æ¥å£ï¼Œå°±å®ç°äº†ä»¥ä¸‹æ¥å£ï¼š<br><img src="/source/_posts/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.RunnableScheduledFuture%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.RunnableScheduledFuture%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.png"></p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>è¯¦è§æºç ï¼š<code>RunnableFutureï¼œVï¼</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.RunnableFuture%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.RunnableFutureï¼œVï¼æºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/11/03/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.RunnableFuture%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/03/æºç ï¼šjava.util.concurrent.RunnableFutureï¼œVï¼æºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>ScheduledFutureï¼œVï¼</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ScheduledFuture%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.ScheduledFutureï¼œVï¼æºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/11/04/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ScheduledFuture%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/04/æºç ï¼šjava.util.concurrent.ScheduledFutureï¼œVï¼æºç è§£æ/</a></li></ol></li></ol></li></ol></blockquote><hr><h2 id="4-æºç éƒ¨åˆ†"><a href="#4-æºç éƒ¨åˆ†" class="headerlink" title="4. æºç éƒ¨åˆ†"></a>4. æºç éƒ¨åˆ†</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">RunnableScheduledFuture</span>&lt;V&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title class_">RunnableFuture</span>&lt;V&gt;, ScheduledFuture&lt;V&gt; &#123;<br><br><span class="hljs-comment">// ç”¨äºéé˜»å¡æŸ¥çœ‹ä»»åŠ¡æ˜¯å¦æ˜¯å‘¨æœŸæ€§ä»»åŠ¡</span><br>    <span class="hljs-type">boolean</span> <span class="hljs-title function_">isPeriodic</span><span class="hljs-params">()</span>;<br>    <br>&#125;<br></code></pre></td></tr></table></figure><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.util.concurrent.locks.ReentrantReadWriteLock æºç è§£æ</title>
    <link href="/2025/11/09/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.ReentrantReadWriteLock%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/11/09/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.ReentrantReadWriteLock%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/11/09/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.ReentrantReadWriteLock%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/09/æºç ï¼šjava.util.concurrent.locks.ReentrantReadWriteLockæºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-ReentrantReadWriteLock-æ¦‚è¿°"><a href="#3-1-ReentrantReadWriteLock-æ¦‚è¿°" class="headerlink" title="3.1. ReentrantReadWriteLock æ¦‚è¿°"></a>3.1. ReentrantReadWriteLock æ¦‚è¿°</h3><p><code>ReentrantReadWriteLock</code> æ˜¯ä¸€ä¸ªå…·ä½“ç±»ï¼Œå®ç°äº† <code>java.util.concurrent.locks.ReadWriteLock</code>ã€<code>java.io.Serializable</code><br><img src="/source/_posts/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.ReentrantReadWriteLock%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.ReentrantReadWriteLock%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.png"></p><p><code>ReentrantReadWriteLock</code> æ˜¯ä¸€ç§å¯é‡å…¥ã€æ‚²è§‚ã€å…¬å¹³æˆ–éå…¬å¹³ã€äº’æ–¥æˆ–å…±äº«çš„é”ï¼Œå¹¶ä¸”æ˜¯ä½¿ç”¨ <code>AQS</code> å®ç°çš„æ··åˆæ¨¡å¼çš„åŒæ­¥å™¨ã€‚<code>State</code> å’Œå…±äº«èµ„æºåˆ†åˆ«è¡¨ç¤ºä»¥ä¸‹å«ä¹‰ï¼š</p><ol><li><code>State</code> è¡¨ç¤ºå†™é”æˆ–è¯»é”çš„é‡å…¥æ¬¡æ•°<ol><li><code>State</code> è¢« <code>ReentrantReadWriteLock</code> æ‹†åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œåˆ†åˆ«è¡¨ç¤ºå†™é”å’Œè¯»é”çš„é‡å…¥æ¬¡æ•°<ol><li>ä½ <code>16</code> ä½è¡¨ç¤ºå†™é”çš„é‡å…¥æ¬¡æ•°</li><li>é«˜ <code>16</code> ä½è¡¨ç¤ºè¯»é”çš„é‡å…¥æ¬¡æ•°</li></ol></li><li>éœ€è¦æ³¨æ„çš„æ˜¯ï¼šå¦‚æœä¸º <code>0</code>ï¼Œè¡¨ç¤ºé”ç©ºé—²ï¼Œæ—¢æ²¡æœ‰å†™é”ï¼Œä¹Ÿæ²¡æœ‰è¯»é”</li></ol></li><li>å…±äº«èµ„æºè¡¨ç¤ºåŠ é”æœŸé—´çš„æ“ä½œ</li></ol><p>æˆ‘ä»¬å¯ä»¥ç®€å•çš„ç†è§£ä¸ºï¼š<code>ReentrantReadWriteLock</code> ä¸ºæˆ‘ä»¬å‡†å¤‡äº†ä¸¤æŠŠé”ï¼Œä¸€æŠŠæ˜¯è¯»é”ï¼Œä¸€æŠŠæ˜¯å†™é”ï¼Œæˆ‘ä»¬å°±æ˜¯ä¾èµ–è¿™ä¸¤æŠŠé”è¿›è¡Œåè°ƒï¼Œè¿™ä¸¤æŠŠé”éµå¾ªè¿™æ ·çš„è§„å¾‹ï¼š</p><ol><li>å†™å†™äº’æ–¥<ol><li>å½“ä¸€ä¸ªçº¿ç¨‹æŒæœ‰å†™é”åï¼Œå…¶ä»–çº¿ç¨‹å¦‚æœè¦ç«äº‰å†™é”ï¼Œå¿…é¡»ç­‰å¾…è¯¥çº¿ç¨‹é‡Šæ”¾å†™é”</li></ol></li><li>è¯»å†™äº’æ–¥<ol><li>å½“ä¸€ä¸ªçº¿ç¨‹æŒæœ‰å†™é”åï¼Œå…¶ä»–çº¿ç¨‹å¦‚æœè¦ç«äº‰è¯»é”ï¼Œå¿…é¡»ç­‰å¾…è¯¥çº¿ç¨‹é‡Šæ”¾å†™é”</li><li>å½“ä¸€ä¸ªçº¿ç¨‹æŒæœ‰è¯»é”åï¼Œå…¶ä»–çº¿ç¨‹å¦‚æœè¦ç«äº‰å†™é”ï¼Œå¿…é¡»ç­‰å¾…è¯¥çº¿ç¨‹é‡Šæ”¾è¯»é”</li></ol></li><li>è¯»è¯»å…±äº«<ol><li>å½“ä¸€ä¸ªçº¿ç¨‹æŒæœ‰è¯»é”åï¼Œå…¶ä»–çº¿ç¨‹å¦‚æœè¦ç«äº‰è¯»é”ï¼Œå¯ä»¥ç›´æ¥æŒæœ‰è¯»é”</li><li>ä¹Ÿå°±æ˜¯è¯´ï¼šä¸€ä¸ªè¯»é”å¯ä»¥è¢«å¤šä¸ªçº¿ç¨‹å…±äº«</li></ol></li></ol><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>è¯¦è§æºç ï¼š<code>ReadWriteLock</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.ReadWriteLock%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.locks.ReadWriteLockæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/11/07/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.ReadWriteLock%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/07/æºç ï¼šjava.util.concurrent.locks.ReadWriteLockæºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>Serializable</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.io.Serializable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.io.Serializableæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/10/28/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.io.Serializable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/10/28/æºç ï¼šjava.io.Serializableæºç è§£æ/</a></li></ol></li></ol></li></ol></blockquote><hr><h3 id="3-2-ReentrantReadWriteLock-é”é™çº§"><a href="#3-2-ReentrantReadWriteLock-é”é™çº§" class="headerlink" title="3.2. ReentrantReadWriteLock é”é™çº§"></a>3.2. ReentrantReadWriteLock é”é™çº§</h3><p><code>ReentrantLock</code> å…è®¸ä¸€ä¸ªçº¿ç¨‹åœ¨æŒæœ‰å†™é”çš„æƒ…å†µä¸‹ç«äº‰è¯»é”ï¼Œç«äº‰åˆ°è¯»é”åå†é‡Šæ”¾å†™é”ã€‚</p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>çŒ´å“¥çš„çƒ¦æ¼ç®± <code>(ï½¡â€¢Ìï¸¿â€¢Ì€ï½¡)</code><ol><li>ä¸ºä»€ä¹ˆä¸å…ˆé‡Šæ”¾å†™é”ï¼Œå†ç«äº‰è¯»é”ï¼Ÿ<ol><li>å¦‚æœçº¿ç¨‹ <code>A</code> å†™æ•°æ®åï¼Œéœ€è¦ç«‹åˆ»è¯»æ•°æ®</li><li>å¦‚æœå…ˆé‡Šæ”¾å†™é”ï¼Œå†ç«äº‰è¯»é”ï¼Œé‚£ä¹ˆçº¿ç¨‹ <code>A</code> é‡Šæ”¾å†™é”åï¼Œçº¿ç¨‹ <code>B</code> å¯èƒ½ç«‹å³ç«äº‰åˆ°äº†å†™é”</li><li>å¦‚æœçº¿ç¨‹ <code>B</code> ä¹Ÿå†™äº†æ•°æ®ï¼Œåˆ™å½“çº¿ç¨‹ <code>A</code> å†ç«äº‰åˆ°è¯»é”çš„æ—¶å€™ï¼Œè¯»åˆ°çš„æ•°æ®å°±ä¸æ˜¯åˆšåˆšå†™çš„æ•°æ®äº†</li></ol></li><li>ä¸ºä»€ä¹ˆä¸å¹²è„† â€œä¸é‡Šæ”¾å†™é”â€ï¼Œç›´åˆ°è¯»å®Œæ•°æ®ï¼Ÿ<ol><li>å¯ä»¥è¿™æ ·åšï¼Œä½†æ˜¯æ€§èƒ½å·®ï¼Œè€Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯ï¼šåœ¨ä¿è¯æ•°æ®ä¸€è‡´æ€§çš„å‰æä¸‹ï¼Œå°½å¯èƒ½åœ°æå‡å¹¶å‘åº¦</li></ol></li></ol></li></ol></blockquote><hr><h3 id="3-3-ReentrantReadWriteLock-é€‚ç”¨åœºæ™¯"><a href="#3-3-ReentrantReadWriteLock-é€‚ç”¨åœºæ™¯" class="headerlink" title="3.3. ReentrantReadWriteLock é€‚ç”¨åœºæ™¯"></a>3.3. ReentrantReadWriteLock é€‚ç”¨åœºæ™¯</h3><h4 id="3-3-1-è¯»å¤šå†™å°‘"><a href="#3-3-1-è¯»å¤šå†™å°‘" class="headerlink" title="3.3.1. è¯»å¤šå†™å°‘"></a>3.3.1. è¯»å¤šå†™å°‘</h4><hr><h2 id="4-å†…éƒ¨ç±»"><a href="#4-å†…éƒ¨ç±»" class="headerlink" title="4. å†…éƒ¨ç±»"></a>4. å†…éƒ¨ç±»</h2><h3 id="4-1-Sync"><a href="#4-1-Sync" class="headerlink" title="4.1. Sync"></a>4.1. Sync</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ...</span><br></code></pre></td></tr></table></figure><hr><h3 id="4-2-FairSync"><a href="#4-2-FairSync" class="headerlink" title="4.2. FairSync"></a>4.2. FairSync</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FairSync</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Sync</span> &#123;<br><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-variable">serialVersionUID</span> <span class="hljs-operator">=</span> -<span class="hljs-number">2274990926593161451L</span>;<br><br><span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">writerShouldBlock</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-keyword">return</span> hasQueuedPredecessors();<br>&#125;<br><br><span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">readerShouldBlock</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-keyword">return</span> hasQueuedPredecessors();<br>&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h3 id="4-3-NonfairSync"><a href="#4-3-NonfairSync" class="headerlink" title="4.3. NonfairSync"></a>4.3. NonfairSync</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NonfairSync</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Sync</span> &#123;<br><br><span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">writerShouldBlock</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>&#125;<br><br><span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">readerShouldBlock</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-keyword">return</span> apparentlyFirstQueuedIsExclusive();<br>&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h3 id="4-4-ReadLock"><a href="#4-4-ReadLock" class="headerlink" title="4.4. ReadLock"></a>4.4. ReadLock</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ReadLock</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Lock</span>, java.io.Serializable &#123;<br><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Sync sync;<br><br><span class="hljs-keyword">protected</span> <span class="hljs-title function_">ReadLock</span><span class="hljs-params">(ReentrantReadWriteLock lock)</span> &#123;<br>sync = lock.sync;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">lock</span><span class="hljs-params">()</span> &#123;<br>sync.acquireShared(<span class="hljs-number">1</span>);<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">lockInterruptibly</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException &#123;<br>sync.acquireSharedInterruptibly(<span class="hljs-number">1</span>);<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryLock</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-keyword">return</span> sync.tryReadLock();<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryLock</span><span class="hljs-params">(<span class="hljs-type">long</span> timeout, TimeUnit unit)</span><br><span class="hljs-keyword">throws</span> InterruptedException &#123;<br><span class="hljs-keyword">return</span> sync.tryAcquireSharedNanos(<span class="hljs-number">1</span>, unit.toNanos(timeout));<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">unlock</span><span class="hljs-params">()</span> &#123;<br>sync.releaseShared(<span class="hljs-number">1</span>);<br>&#125;<br><br><span class="hljs-keyword">public</span> Condition <span class="hljs-title function_">newCondition</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UnsupportedOperationException</span>();<br>&#125;<br><br><span class="hljs-keyword">public</span> String <span class="hljs-title function_">toString</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-type">int</span> <span class="hljs-variable">r</span> <span class="hljs-operator">=</span> sync.getReadLockCount();<br><span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>.toString() +<br><span class="hljs-string">&quot;[Read locks = &quot;</span> + r + <span class="hljs-string">&quot;]&quot;</span>;<br>&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h3 id="4-5-WriteLock"><a href="#4-5-WriteLock" class="headerlink" title="4.5. WriteLock"></a>4.5. WriteLock</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WriteLock</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Lock</span>, java.io.Serializable &#123;<br><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Sync sync;<br><br><span class="hljs-keyword">protected</span> <span class="hljs-title function_">WriteLock</span><span class="hljs-params">(ReentrantReadWriteLock lock)</span> &#123;<br>sync = lock.sync;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">lock</span><span class="hljs-params">()</span> &#123;<br>sync.acquire(<span class="hljs-number">1</span>);<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">lockInterruptibly</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException &#123;<br>sync.acquireInterruptibly(<span class="hljs-number">1</span>);<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryLock</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-keyword">return</span> sync.tryWriteLock();<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryLock</span><span class="hljs-params">(<span class="hljs-type">long</span> timeout, TimeUnit unit)</span><br><span class="hljs-keyword">throws</span> InterruptedException &#123;<br><span class="hljs-keyword">return</span> sync.tryAcquireNanos(<span class="hljs-number">1</span>, unit.toNanos(timeout));<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">unlock</span><span class="hljs-params">()</span> &#123;<br>sync.release(<span class="hljs-number">1</span>);<br>&#125;<br><br><span class="hljs-keyword">public</span> Condition <span class="hljs-title function_">newCondition</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-keyword">return</span> sync.newCondition();<br>&#125;<br><br><span class="hljs-keyword">public</span> String <span class="hljs-title function_">toString</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-type">Thread</span> <span class="hljs-variable">o</span> <span class="hljs-operator">=</span> sync.getOwner();<br><span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>.toString() + ((o == <span class="hljs-literal">null</span>) ?<br>   <span class="hljs-string">&quot;[Unlocked]&quot;</span> :<br>   <span class="hljs-string">&quot;[Locked by thread &quot;</span> + o.getName() + <span class="hljs-string">&quot;]&quot;</span>);<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isHeldByCurrentThread</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-keyword">return</span> sync.isHeldExclusively();<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getHoldCount</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-keyword">return</span> sync.getWriteHoldCount();<br>&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h2 id="5-å®ä¾‹æ–¹æ³•"><a href="#5-å®ä¾‹æ–¹æ³•" class="headerlink" title="5. å®ä¾‹æ–¹æ³•"></a>5. å®ä¾‹æ–¹æ³•</h2><h3 id="5-1-å®ä¾‹å…·ä½“æ–¹æ³•"><a href="#5-1-å®ä¾‹å…·ä½“æ–¹æ³•" class="headerlink" title="5.1. å®ä¾‹å…·ä½“æ–¹æ³•"></a>5.1. å®ä¾‹å…·ä½“æ–¹æ³•</h3><h4 id="5-1-1-å…·ä½“æ–¹æ³•ï¼ˆå®ç°ï¼‰"><a href="#5-1-1-å…·ä½“æ–¹æ³•ï¼ˆå®ç°ï¼‰" class="headerlink" title="5.1.1. å…·ä½“æ–¹æ³•ï¼ˆå®ç°ï¼‰"></a>5.1.1. å…·ä½“æ–¹æ³•ï¼ˆå®ç°ï¼‰</h4><h5 id="5-1-1-1-ReadWriteLock-ä¸­æ¥å£æ–¹æ³•çš„å®ç°"><a href="#5-1-1-1-ReadWriteLock-ä¸­æ¥å£æ–¹æ³•çš„å®ç°" class="headerlink" title="5.1.1.1. ReadWriteLock ä¸­æ¥å£æ–¹æ³•çš„å®ç°"></a>5.1.1.1. ReadWriteLock ä¸­æ¥å£æ–¹æ³•çš„å®ç°</h5><h6 id="5-1-1-1-1-WriteLock-writeLock"><a href="#5-1-1-1-1-WriteLock-writeLock" class="headerlink" title="5.1.1.1.1. WriteLock writeLock()"></a>5.1.1.1.1. WriteLock writeLock()</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> ReentrantReadWriteLock.WriteLock <span class="hljs-title function_">writeLock</span><span class="hljs-params">()</span> &#123; <br><br><span class="hljs-keyword">return</span> writerLock; <br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h6 id="5-1-1-1-2-ReadLock-readLock"><a href="#5-1-1-1-2-ReadLock-readLock" class="headerlink" title="5.1.1.1.2. ReadLock  readLock()"></a>5.1.1.1.2. ReadLock  readLock()</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> ReentrantReadWriteLock.ReadLock <span class="hljs-title function_">readLock</span><span class="hljs-params">()</span> &#123; <br><br><span class="hljs-keyword">return</span> readerLock; <br><br>&#125;<br></code></pre></td></tr></table></figure><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.util.concurrent.locks.Lock æºç è§£æ</title>
    <link href="/2025/11/07/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.Lock%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/11/07/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.Lock%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/11/07/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.Lock%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/07/æºç ï¼šjava.util.concurrent.locks.Lockæºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-Lock-æ¦‚è¿°"><a href="#3-1-Lock-æ¦‚è¿°" class="headerlink" title="3.1. Lock æ¦‚è¿°"></a>3.1. Lock æ¦‚è¿°</h3><p><code>Lock</code> æ˜¯ä¸€ä¸ªæ¥å£</p><p><code>Lock</code> ä¸ºæˆ‘ä»¬æä¾›äº†ä»¥ä¸‹æ–¹æ³•</p><ol><li>ç«äº‰é”ï¼ˆé˜»å¡ã€éé˜»å¡ã€é™æ—¶é˜»å¡ï¼‰</li><li>é‡Šæ”¾é”ï¼ˆéé˜»å¡ï¼‰</li><li>åˆ›å»ºæ¡ä»¶é˜Ÿåˆ—ï¼ˆéé˜»å¡ï¼‰</li></ol><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li><code>Monitor</code> ä¸­æœ‰ç«äº‰é˜Ÿåˆ—ã€ç­‰å¾…é˜Ÿåˆ—ï¼Œ<code>AQS</code> ä¸­æœ‰åŒæ­¥é˜Ÿåˆ—ã€æ¡ä»¶é˜Ÿåˆ—</li></ol></blockquote><hr><h2 id="4-æºç éƒ¨åˆ†"><a href="#4-æºç éƒ¨åˆ†" class="headerlink" title="4. æºç éƒ¨åˆ†"></a>4. æºç éƒ¨åˆ†</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Lock</span> &#123;<br>    <br>    <span class="hljs-comment">// ç”¨äºé˜»å¡ç«äº‰é”</span><br>    <span class="hljs-comment">//</span><br>    <span class="hljs-comment">// å¦‚æœé”è¢«å…¶ä»–çº¿ç¨‹æŒæœ‰ï¼Œæœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ WAITING çŠ¶æ€ï¼Œå¹¶è¢«æŠ•é€’åˆ° AQS çš„åŒæ­¥é˜Ÿåˆ—ï¼Œç­‰å¾…è¢«å”¤é†’ï¼ˆLockSupport.unparkï¼‰</span><br>    <span class="hljs-comment">//</span><br>    <span class="hljs-comment">// æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ WAITING çŠ¶æ€åï¼Œä¸èƒ½èƒ½å“åº”ä¸­æ–­ã€‚çº¿ç¨‹ä¼šç»§ç»­é˜»å¡ï¼Œå¹¶ä¼šä¿ç•™ Thread ç¤ºä¾‹çš„ä¸­æ–­çŠ¶æ€ã€‚å½“çº¿ç¨‹è¢«å”¤é†’åï¼Œä¼šç»§ç»­å‘ä¸‹æ‰§è¡Œï¼ˆæ­£å¸¸é€€å‡ºï¼ˆæœªå‘ç”Ÿå¼‚å¸¸ï¼‰ï¼‰</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">lock</span><span class="hljs-params">()</span>;<br>    <br>    <span class="hljs-comment">// ç”¨äºé˜»å¡ç«äº‰é”</span><br>    <span class="hljs-comment">//</span><br>    <span class="hljs-comment">// å¦‚æœé”è¢«å…¶ä»–çº¿ç¨‹æŒæœ‰ï¼Œæœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ WAITING çŠ¶æ€ï¼Œå¹¶è¢«æŠ•é€’åˆ° AQS çš„åŒæ­¥é˜Ÿåˆ—ï¼Œç­‰å¾…è¢«å”¤é†’ï¼ˆLockSupport.unparkï¼‰ã€è¢«ä¸­æ–­ï¼ˆThread#interruptï¼‰</span><br>    <span class="hljs-comment">//</span><br>    <span class="hljs-comment">// æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ WAITING çŠ¶æ€åï¼Œèƒ½å“åº”ä¸­æ–­ã€‚çº¿ç¨‹è¢«å”¤é†’ï¼Œé‡æ–°è·å¾— CPU æ—¶é—´ç‰‡åï¼Œä¼šæŠ›å‡º InterruptedException å—æ£€å¼‚å¸¸ï¼Œå¹¶æ¸…é™¤ Thread å®ä¾‹çš„ä¸­æ–­çŠ¶æ€ï¼ˆå¼‚å¸¸é€€å‡ºæˆ–æ­£å¸¸é€€å‡ºï¼ˆå‘ç”Ÿå¼‚å¸¸ï¼‰ï¼Œè¦çœ‹æˆ‘ä»¬æ˜¯å¦å¯¹è¯¥å¼‚å¸¸è¿›è¡Œæ•è·å¹¶å¤„ç†ï¼‰</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">lockInterruptibly</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException;<br><br>    <span class="hljs-comment">// ç”¨äºéé˜»å¡ç«äº‰é”</span><br>    <span class="hljs-comment">//</span><br>    <span class="hljs-comment">// å¦‚æœæˆåŠŸï¼Œè¿”å› true</span><br>    <span class="hljs-comment">//</span><br>    <span class="hljs-comment">// å¦‚æœå¤±è´¥ï¼Œè¿”å› false</span><br>    <span class="hljs-comment">//</span><br>    <span class="hljs-comment">// æ‰€è°“çš„ â€œéé˜»å¡â€ æ˜¯æŒ‡ï¼šå°è¯•ä¸€ä¸‹ï¼Œè¡Œå°±è¡Œï¼Œä¸è¡Œå°±ä¸è¡Œï¼Œä¸è¦è®©å½“å‰çº¿ç¨‹è¿›å…¥é˜»å¡ï¼ˆBWTWï¼‰çŠ¶æ€</span><br>    <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryLock</span><span class="hljs-params">()</span>;<br><br><span class="hljs-comment">// ç”¨äºé™æ—¶é˜»å¡ç«äº‰é”</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// é™æ—¶é˜»å¡è¢«å…è®¸çš„æœ€é•¿æ—¶é—´ä¸ºï¼štime unit</span><br><span class="hljs-comment">//    1. å¦‚æœè¶…æ—¶ï¼Œå°†è¿”å› false</span><br><span class="hljs-comment">//</span><br>    <span class="hljs-comment">// å¦‚æœé”è¢«å…¶ä»–çº¿ç¨‹æŒæœ‰ï¼Œæœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ TIMED_WAITING çŠ¶æ€ï¼Œå¹¶è¢«æŠ•é€’åˆ° AQS çš„åŒæ­¥é˜Ÿåˆ—ï¼Œç­‰å¾…è¢«å”¤é†’ï¼ˆLockSupport.unparkï¼‰</span><br>    <span class="hljs-comment">//</span><br>    <span class="hljs-comment">// æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ TIMED_WAITING çŠ¶æ€åï¼Œèƒ½å“åº”ä¸­æ–­ã€‚çº¿ç¨‹è¢«å”¤é†’ï¼Œé‡æ–°è·å¾— CPU æ—¶é—´ç‰‡åï¼Œä¼šæŠ›å‡º InterruptedException å—æ£€å¼‚å¸¸ï¼Œå¹¶æ¸…é™¤ Thread å®ä¾‹çš„ä¸­æ–­çŠ¶æ€ï¼ˆå¼‚å¸¸é€€å‡ºæˆ–æ­£å¸¸é€€å‡ºï¼ˆå‘ç”Ÿå¼‚å¸¸ï¼‰ï¼Œè¦çœ‹æˆ‘ä»¬æ˜¯å¦å¯¹è¯¥å¼‚å¸¸è¿›è¡Œæ•è·å¹¶å¤„ç†ï¼‰</span><br>    <span class="hljs-comment">//</span><br>    <span class="hljs-comment">// å¦‚æœæˆåŠŸï¼Œè¿”å› true</span><br>    <span class="hljs-comment">//</span><br>    <span class="hljs-comment">// å¦‚æœå¤±è´¥ï¼Œè¿”å› false</span><br>    <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryLock</span><span class="hljs-params">(<span class="hljs-type">long</span> time, TimeUnit unit)</span> <span class="hljs-keyword">throws</span> InterruptedException;<br><br><span class="hljs-comment">// ç”¨äºéé˜»å¡é‡Šæ”¾å½“å‰çº¿ç¨‹æŒæœ‰çš„é”</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// å¦‚æœä¸æŒæœ‰é”çš„çº¿ç¨‹é‡Šæ”¾é”ï¼ŒæŠ›å‡º IllegalMonitorStateException éå—æ£€å¼‚å¸¸</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">unlock</span><span class="hljs-params">()</span>;<br><br><span class="hljs-comment">// ç”¨äºéé˜»å¡åˆ›å»ºæ¡ä»¶é˜Ÿåˆ—</span><br>    Condition <span class="hljs-title function_">newCondition</span><span class="hljs-params">()</span>;<br>    <br>&#125;<br></code></pre></td></tr></table></figure><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.util.concurrent.locks.ReadWriteLock æºç è§£æ</title>
    <link href="/2025/11/07/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.ReadWriteLock%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/11/07/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.ReadWriteLock%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/11/07/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.ReadWriteLock%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/07/æºç ï¼šjava.util.concurrent.locks.ReadWriteLockæºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-ReadWriteLock-æ¦‚è¿°"><a href="#3-1-ReadWriteLock-æ¦‚è¿°" class="headerlink" title="3.1. ReadWriteLock æ¦‚è¿°"></a>3.1. ReadWriteLock æ¦‚è¿°</h3><p><code>ReadWriteLock</code> æ˜¯ä¸€ä¸ªæ¥å£</p><p><code>ReadWriteLock</code> ä¸ºæˆ‘ä»¬æä¾›äº†ä»¥ä¸‹æ–¹æ³•ï¼š</p><ol><li>è·å– <code>ReadLock</code>ï¼ˆéé˜»å¡ï¼‰</li><li>è·å– <code>WriteLock</code>ï¼ˆéé˜»å¡ï¼‰</li></ol><hr><h1 id="æºç éƒ¨åˆ†"><a href="#æºç éƒ¨åˆ†" class="headerlink" title="æºç éƒ¨åˆ†"></a>æºç éƒ¨åˆ†</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">ReadWriteLock</span> &#123;<br><br>    <span class="hljs-comment">// ç”¨äºéé˜»å¡è·å– ReadLock</span><br>    <span class="hljs-comment">//</span><br>    <span class="hljs-comment">// éœ€è¦æ³¨æ„çš„æ˜¯ï¼šè¯¥æ–¹æ³•å¹¶ä¸æ˜¯ç›´æ¥ç«äº‰è¯»é”ï¼Œè€Œæ˜¯æˆ‘ä»¬è·å– ReadLock åï¼Œè¿˜éœ€è¦è°ƒç”¨ ReadLock çš„æ–¹æ³•ç«äº‰è¯»é”</span><br>    Lock <span class="hljs-title function_">readLock</span><span class="hljs-params">()</span>;<br><br>    <span class="hljs-comment">// ç”¨äºéé˜»å¡è·å– WriteLock</span><br>    <span class="hljs-comment">//</span><br>    <span class="hljs-comment">// éœ€è¦æ³¨æ„çš„æ˜¯ï¼šè¯¥æ–¹æ³•å¹¶ä¸æ˜¯ç›´æ¥ç«äº‰è¯»é”ï¼Œè€Œæ˜¯æˆ‘ä»¬è·å– WriteLock åï¼Œè¿˜éœ€è¦è°ƒç”¨ WriteLock çš„æ–¹æ³•ç«äº‰å†™é”</span><br>    Lock <span class="hljs-title function_">writeLock</span><span class="hljs-params">()</span>;<br>    <br>&#125;<br></code></pre></td></tr></table></figure><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.lang.Cloneable æºç è§£æ</title>
    <link href="/2025/11/06/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.Cloneable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/11/06/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.Cloneable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/11/06/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.Cloneable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/06/æºç ï¼šjava.lang.Cloneableæºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-Cloneable-æ¦‚è¿°"><a href="#3-1-Cloneable-æ¦‚è¿°" class="headerlink" title="3.1. Cloneable æ¦‚è¿°"></a>3.1. Cloneable æ¦‚è¿°</h3><p><code>Cloneable</code> æ˜¯ä¸€ä¸ªæ¥å£</p><p><code>Cloneable</code> æ˜¯ä¸€ä¸ªæ ‡è®°æ¥å£ï¼Œåªè¦æˆ‘ä»¬ <code>Implements Cloneable</code>ï¼Œä»–å°±å‘Šè¯‰ <code>JVM</code> è¿™ä¸ªç±»çš„å¯¹è±¡å¯ä»¥å…‹éš†</p><hr><h2 id="4-æºç éƒ¨åˆ†"><a href="#4-æºç éƒ¨åˆ†" class="headerlink" title="4. æºç éƒ¨åˆ†"></a>4. æºç éƒ¨åˆ†</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Cloneable</span> &#123;<br><br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.lang.Comparableï¼œTï¼ æºç è§£æ</title>
    <link href="/2025/11/06/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.Comparable%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/11/06/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.Comparable%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/11/06/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.Comparable%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/06/æºç ï¼šjava.lang.Comparableï¼œTï¼æºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-Comparableï¼œTï¼-æ¦‚è¿°"><a href="#3-1-Comparableï¼œTï¼-æ¦‚è¿°" class="headerlink" title="3.1. Comparableï¼œTï¼ æ¦‚è¿°"></a>3.1. Comparableï¼œTï¼ æ¦‚è¿°</h3><p><code>Comparableï¼œTï¼</code> æ˜¯ä¸€ä¸ªæ¥å£</p><p><code>Comparableï¼œTï¼</code> ä¸ºæˆ‘ä»¬æä¾›äº†ä»¥ä¸‹æ–¹æ³•ï¼š</p><ol><li>é…ç½®è‡ªç„¶æ’åºçš„è§„åˆ™</li></ol><p>ä¸€äº›éœ€è¦æ’åºçš„ <code>Java</code> æ•°æ®ç±»å‹ï¼ˆä¾‹å¦‚ <code>TreeSetï¼œEï¼</code>ã€<code>TreeMapï¼œK, Vï¼</code>ã€<code>ConcurrentSkipListMapï¼œK, Vï¼</code>ã€<code>PriorityQueueï¼œEï¼</code>ã€<code>PriorityBlockingQueueï¼œEï¼</code>ã€<code>DelayQueueï¼œEï¼</code>ã€<code>ScheduledThreadPoolExecutor.DelayedWorkQueueï¼œEï¼</code>ï¼‰ï¼Œé»˜è®¤ä¼šä½¿ç”¨ <code>Comparableï¼œTï¼#compareTo</code> è¿›è¡Œæ¯”è¾ƒï¼Œä»è€Œè¿›è¡Œè‡ªç„¶æ’åº</p><hr><h2 id="4-æºç éƒ¨åˆ†"><a href="#4-æºç éƒ¨åˆ†" class="headerlink" title="4. æºç éƒ¨åˆ†"></a>4. æºç éƒ¨åˆ†</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Comparable</span>&lt;T&gt; &#123;<br><br><span class="hljs-comment">// ç”¨äºé…ç½®è‡ªç„¶æ’åºçš„è§„åˆ™</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">compareTo</span><span class="hljs-params">(T o)</span>;<br>    <br>&#125;<br></code></pre></td></tr></table></figure><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.util.concurrent.Delayed æºç è§£æ</title>
    <link href="/2025/11/06/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.Delayed%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/11/06/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.Delayed%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/11/06/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.Delayed%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/06/æºç ï¼šjava.util.concurrent.Delayedæºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-Delayed-æ¦‚è¿°"><a href="#3-1-Delayed-æ¦‚è¿°" class="headerlink" title="3.1. Delayed æ¦‚è¿°"></a>3.1. Delayed æ¦‚è¿°</h3><p><code>Delayed</code> æ˜¯ä¸€ä¸ªæ¥å£ï¼Œç»§æ‰¿äº†<code> java.lang.Comparableï¼œTï¼</code><br><img src="/source/_posts/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.Delayed%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.Delayed%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.png"></p><p><code>Delayed</code> åœ¨ <code>Comparableï¼œTï¼</code> çš„åŸºç¡€ä¸Šï¼Œæä¾›äº†ä»¥ä¸‹æ–¹æ³•ï¼š</p><ol><li>è·å–å‰©ä½™å»¶è¿Ÿçš„æ—¶é—´ï¼ˆéé˜»å¡ï¼‰</li></ol><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>è¯¦è§æºç ï¼š<code>Comparableï¼œTï¼</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.Comparable%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.lang.Comparableï¼œTï¼æºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/11/06/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.Comparable%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/06/æºç ï¼šjava.lang.Comparableï¼œTï¼æºç è§£æ/</a></li></ol></li></ol></li></ol></blockquote><hr><h2 id="4-æºç éƒ¨åˆ†"><a href="#4-æºç éƒ¨åˆ†" class="headerlink" title="4. æºç éƒ¨åˆ†"></a>4. æºç éƒ¨åˆ†</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Delayed</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Comparable</span>&lt;Delayed&gt; &#123;<br><br><span class="hljs-comment">// ç”¨äºéé˜»å¡è·å–å‰©ä½™å»¶è¿Ÿçš„æ—¶é—´</span><br>    <span class="hljs-type">long</span> <span class="hljs-title function_">getDelay</span><span class="hljs-params">(TimeUnit unit)</span>;<br>    <br>&#125;<br></code></pre></td></tr></table></figure><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.util.concurrent.ScheduledFutureï¼œVï¼ æºç è§£æ</title>
    <link href="/2025/11/04/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ScheduledFuture%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/11/04/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ScheduledFuture%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/11/04/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ScheduledFuture%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/04/æºç ï¼šjava.util.concurrent.ScheduledFutureï¼œVï¼æºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-ScheduledFutureï¼œVï¼-æ¦‚è¿°"><a href="#3-1-ScheduledFutureï¼œVï¼-æ¦‚è¿°" class="headerlink" title="3.1. ScheduledFutureï¼œVï¼ æ¦‚è¿°"></a>3.1. ScheduledFutureï¼œVï¼ æ¦‚è¿°</h3><p><code>ScheduledFuture</code> æ˜¯ä¸€ä¸ªæ¥å£ï¼Œç»§æ‰¿äº†<code> java.util.concurrent.Delayed</code>ã€<code>java.util.concurren.Futureï¼œVï¼</code><br><img src="/source/_posts/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ScheduledFuture%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ScheduledFuture%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.png"></p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>è¯¦è§æºç ï¼š<code>Delayed</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.Delayed%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.Delayedæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/11/06/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.Delayed%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/06/æºç ï¼šjava.util.concurrent.Delayedæºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>Futureï¼œVï¼</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurren.Future%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurren.Futureï¼œVï¼æºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/09/02/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurren.Future%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/09/02/æºç ï¼šjava.util.concurren.Futureï¼œVï¼æºç è§£æ/</a></li></ol></li></ol></li></ol></blockquote><hr><h2 id="4-æºç éƒ¨åˆ†"><a href="#4-æºç éƒ¨åˆ†" class="headerlink" title="4. æºç éƒ¨åˆ†"></a>4. æºç éƒ¨åˆ†</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">ScheduledFuture</span>&lt;V&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Delayed</span>, Future&lt;V&gt; &#123;<br><br>&#125;<br></code></pre></td></tr></table></figure><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.util.concurrent.ScheduledThreadPoolExecutor æºç è§£æ</title>
    <link href="/2025/11/04/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ScheduledThreadPoolExecutor%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/11/04/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ScheduledThreadPoolExecutor%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/11/04/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ScheduledThreadPoolExecutor%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/04/æºç ï¼šjava.util.concurrent.ScheduledThreadPoolExecutoræºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-ScheduledThreadPoolExecutor-æ¦‚è¿°"><a href="#3-1-ScheduledThreadPoolExecutor-æ¦‚è¿°" class="headerlink" title="3.1. ScheduledThreadPoolExecutor æ¦‚è¿°"></a>3.1. ScheduledThreadPoolExecutor æ¦‚è¿°</h3><p><code>ScheduledThreadPoolExecutor</code> æ˜¯ä¸€ä¸ªå…·ä½“ç±»ï¼Œç»§æ‰¿äº† <code>java.util.concurrent.ThreadPoolExecutor</code>ï¼Œå®ç°äº† <code>java.util.concurrent.ScheduledExecutorService</code></p><p><code>ScheduledThreadPoolExecutor</code> åœ¨ <code>ThreadPoolExecutor</code> çš„åŸºç¡€ä¸Šï¼Œåªåšäº†ä¸‰ä»¶äº‹ï¼š</p><ol><li>ä½¿ç”¨ <code>ScheduledThreadPoolExecutor.DelayedWorkQueue</code> ä½œä¸ºä»»åŠ¡é˜Ÿåˆ—</li><li>ä½¿ç”¨ <code>ScheduledThreadPoolExecutor.ScheduledFutureTask</code> è€Œä¸æ˜¯ <code>FutureTask</code></li></ol><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>è¯¦è§æºç ï¼š<code>ThreadPoolExecutor</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ThreadPoolExecutor%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.ThreadPoolExecutoræºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/09/03/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ThreadPoolExecutor%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/09/03/æºç ï¼šjava.util.concurrent.ThreadPoolExecutoræºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>ScheduledExecutorService</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ScheduledExecutorService%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.ScheduledExecutorServiceæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/11/03/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ScheduledExecutorService%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/03/æºç ï¼šjava.util.concurrent.ScheduledExecutorServiceæºç è§£æ/</a></li></ol></li></ol></li></ol></blockquote><hr><h2 id="4-å†…éƒ¨ç±»"><a href="#4-å†…éƒ¨ç±»" class="headerlink" title="4. å†…éƒ¨ç±»"></a>4. å†…éƒ¨ç±»</h2><h3 id="4-1-DelayedWorkQueue"><a href="#4-1-DelayedWorkQueue" class="headerlink" title="4.1. DelayedWorkQueue"></a>4.1. DelayedWorkQueue</h3><p>è¯¦è§ç¬”è®°ï¼š<code>Java æ•°æ®ç±»å‹</code></p><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥<ol><li><a href="%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B.md">ç¬”è®°ï¼šJavaæ•°æ®ç±»å‹</a></li></ol></li><li><code>Hexo</code> é“¾æ¥<ol><li></li></ol></li></ol><hr><h3 id="4-2-ScheduledFutureTask"><a href="#4-2-ScheduledFutureTask" class="headerlink" title="4.2. ScheduledFutureTask"></a>4.2. ScheduledFutureTask</h3><p>è¯¦è§æºç ï¼š<code>ScheduledFutureTaskï¼œVï¼</code></p><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ScheduledThreadPoolExecutor.ScheduledFutureTask%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.ScheduledThreadPoolExecutor.ScheduledFutureTaskï¼œVï¼æºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/11/15/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ScheduledThreadPoolExecutor.ScheduledFutureTask%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/15/æºç ï¼šjava.util.concurrent.ScheduledThreadPoolExecutor.ScheduledFutureTaskï¼œVï¼æºç è§£æ/</a></li></ol></li></ol><hr><h2 id="5-æ„é€ æ–¹æ³•"><a href="#5-æ„é€ æ–¹æ³•" class="headerlink" title="5. æ„é€ æ–¹æ³•"></a>5. æ„é€ æ–¹æ³•</h2><h3 id="5-1-ScheduledThreadPoolExecutor-int-corePoolSize-ThreadFactory-threadFactory-RejectedExecutionHandler-handler"><a href="#5-1-ScheduledThreadPoolExecutor-int-corePoolSize-ThreadFactory-threadFactory-RejectedExecutionHandler-handler" class="headerlink" title="5.1. ScheduledThreadPoolExecutor(int corePoolSize, ThreadFactory threadFactory, RejectedExecutionHandler handler)"></a>5.1. ScheduledThreadPoolExecutor(int corePoolSize, ThreadFactory threadFactory, RejectedExecutionHandler handler)</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-title function_">ScheduledThreadPoolExecutor</span><span class="hljs-params">(<span class="hljs-type">int</span> corePoolSize,</span><br><span class="hljs-params">   ThreadFactory threadFactory,</span><br><span class="hljs-params">   RejectedExecutionHandler handler)</span> &#123;<br><span class="hljs-built_in">super</span>(corePoolSize, Integer.MAX_VALUE,<br>  DEFAULT_KEEPALIVE_MILLIS, MILLISECONDS,<br>  <span class="hljs-keyword">new</span> <span class="hljs-title class_">DelayedWorkQueue</span>(), threadFactory, handler);<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li><code>DEFAULT_KEEPALIVE_MILLIS</code> æ˜¯ <code>ScheduledThreadPoolExecutor::DEFAULT_KEEPALIVE_MILLIS</code> ï¼Œå€¼ä¸ºï¼š<code>10L</code></li></ol></blockquote><hr><h2 id="6-å®ä¾‹æ–¹æ³•"><a href="#6-å®ä¾‹æ–¹æ³•" class="headerlink" title="6. å®ä¾‹æ–¹æ³•"></a>6. å®ä¾‹æ–¹æ³•</h2><h3 id="6-1-å®ä¾‹å…·ä½“æ–¹æ³•"><a href="#6-1-å®ä¾‹å…·ä½“æ–¹æ³•" class="headerlink" title="6.1. å®ä¾‹å…·ä½“æ–¹æ³•"></a>6.1. å®ä¾‹å…·ä½“æ–¹æ³•</h3><h4 id="6-1-1-å…·ä½“æ–¹æ³•ï¼ˆå®ç°ï¼‰"><a href="#6-1-1-å…·ä½“æ–¹æ³•ï¼ˆå®ç°ï¼‰" class="headerlink" title="6.1.1. å…·ä½“æ–¹æ³•ï¼ˆå®ç°ï¼‰"></a>6.1.1. å…·ä½“æ–¹æ³•ï¼ˆå®ç°ï¼‰</h4><h5 id="6-1-1-1-Executor-ä¸­æ¥å£æ–¹æ³•çš„å®ç°"><a href="#6-1-1-1-Executor-ä¸­æ¥å£æ–¹æ³•çš„å®ç°" class="headerlink" title="6.1.1.1. Executor ä¸­æ¥å£æ–¹æ³•çš„å®ç°"></a>6.1.1.1. Executor ä¸­æ¥å£æ–¹æ³•çš„å®ç°</h5><h6 id="6-1-1-1-1-void-execute-Runnable-command"><a href="#6-1-1-1-1-void-execute-Runnable-command" class="headerlink" title="6.1.1.1.1. void execute(Runnable command)"></a>6.1.1.1.1. void execute(Runnable command)</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">execute</span><span class="hljs-params">(Runnable command)</span> &#123;<br><br>schedule(command, <span class="hljs-number">0</span>, NANOSECONDS);<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h5 id="6-1-1-2-ExecutorService-ä¸­æ¥å£æ–¹æ³•çš„å®ç°"><a href="#6-1-1-2-ExecutorService-ä¸­æ¥å£æ–¹æ³•çš„å®ç°" class="headerlink" title="6.1.1.2. ExecutorService ä¸­æ¥å£æ–¹æ³•çš„å®ç°"></a>6.1.1.2. ExecutorService ä¸­æ¥å£æ–¹æ³•çš„å®ç°</h5><h6 id="6-1-1-2-1-Futureï¼œ-ï¼-submit-Runnable-task"><a href="#6-1-1-2-1-Futureï¼œ-ï¼-submit-Runnable-task" class="headerlink" title="6.1.1.2.1. Futureï¼œ?ï¼ submit(Runnable task)"></a>6.1.1.2.1. Futureï¼œ?ï¼ submit(Runnable task)</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> Future&lt;?&gt; submit(Runnable task) &#123;<br><br><span class="hljs-keyword">return</span> schedule(task, <span class="hljs-number">0</span>, NANOSECONDS);<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h6 id="6-1-1-2-2-ï¼œTï¼-Futureï¼œTï¼-submit-Runnable-task-T-result"><a href="#6-1-1-2-2-ï¼œTï¼-Futureï¼œTï¼-submit-Runnable-task-T-result" class="headerlink" title="6.1.1.2.2. ï¼œTï¼ Futureï¼œTï¼ submit(Runnable task, T result)"></a>6.1.1.2.2. ï¼œTï¼ Futureï¼œTï¼ submit(Runnable task, T result)</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> &lt;T&gt; Future&lt;T&gt; <span class="hljs-title function_">submit</span><span class="hljs-params">(Runnable task, T result)</span> &#123;<br><br><span class="hljs-keyword">return</span> schedule(Executors.callable(task, result), <span class="hljs-number">0</span>, NANOSECONDS);<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h6 id="6-1-1-2-3-ï¼œTï¼-Futureï¼œTï¼-submit-Callableï¼œTï¼-task"><a href="#6-1-1-2-3-ï¼œTï¼-Futureï¼œTï¼-submit-Callableï¼œTï¼-task" class="headerlink" title="6.1.1.2.3. ï¼œTï¼ Futureï¼œTï¼ submit(Callableï¼œTï¼ task)"></a>6.1.1.2.3. ï¼œTï¼ Futureï¼œTï¼ submit(Callableï¼œTï¼ task)</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> &lt;T&gt; Future&lt;T&gt; <span class="hljs-title function_">submit</span><span class="hljs-params">(Callable&lt;T&gt; task)</span> &#123;<br><br><span class="hljs-keyword">return</span> schedule(task, <span class="hljs-number">0</span>, NANOSECONDS);<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h5 id="6-1-1-3-ScheduledExecutorService-ä¸­æ¥å£æ–¹æ³•çš„å®ç°"><a href="#6-1-1-3-ScheduledExecutorService-ä¸­æ¥å£æ–¹æ³•çš„å®ç°" class="headerlink" title="6.1.1.3. ScheduledExecutorService ä¸­æ¥å£æ–¹æ³•çš„å®ç°"></a>6.1.1.3. ScheduledExecutorService ä¸­æ¥å£æ–¹æ³•çš„å®ç°</h5><h6 id="6-1-1-3-1-ScheduledFutureï¼œ-ï¼-schedule-Runnable-comm-long-delay-TimeUnit-unit"><a href="#6-1-1-3-1-ScheduledFutureï¼œ-ï¼-schedule-Runnable-comm-long-delay-TimeUnit-unit" class="headerlink" title="6.1.1.3.1. ScheduledFutureï¼œ?ï¼ schedule(Runnable comm, long delay, TimeUnit unit)"></a>6.1.1.3.1. ScheduledFutureï¼œ?ï¼ schedule(Runnable comm, long delay, TimeUnit unit)</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> ScheduledFuture&lt;?&gt; schedule(Runnable command,<br>   <span class="hljs-type">long</span> delay,<br>   TimeUnit unit) &#123;<br><br><span class="hljs-keyword">if</span> (command == <span class="hljs-literal">null</span> || unit == <span class="hljs-literal">null</span>)<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NullPointerException</span>();<br><br>RunnableScheduledFuture&lt;Void&gt; t = decorateTask(command,<br><span class="hljs-keyword">new</span> <span class="hljs-title class_">ScheduledFutureTask</span>&lt;Void&gt;(command, <span class="hljs-literal">null</span>,<br>  triggerTime(delay, unit),<br>  sequencer.getAndIncrement()));<br>  <br>delayedExecute(t);<br><br><span class="hljs-keyword">return</span> t;<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h6 id="6-1-1-3-2-ï¼œVï¼-ScheduledFutureï¼œVï¼-schedule-Callableï¼œVï¼-callable-long-delay-TimeUnit-unit"><a href="#6-1-1-3-2-ï¼œVï¼-ScheduledFutureï¼œVï¼-schedule-Callableï¼œVï¼-callable-long-delay-TimeUnit-unit" class="headerlink" title="6.1.1.3.2. ï¼œVï¼ ScheduledFutureï¼œVï¼ schedule(Callableï¼œVï¼ callable, long delay, TimeUnit unit)"></a>6.1.1.3.2. ï¼œVï¼ ScheduledFutureï¼œVï¼ schedule(Callableï¼œVï¼ callable, long delay, TimeUnit unit)</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> &lt;V&gt; ScheduledFuture&lt;V&gt; <span class="hljs-title function_">schedule</span><span class="hljs-params">(Callable&lt;V&gt; callable,</span><br><span class="hljs-params">   <span class="hljs-type">long</span> delay,</span><br><span class="hljs-params">   TimeUnit unit)</span> &#123;<br><span class="hljs-keyword">if</span> (callable == <span class="hljs-literal">null</span> || unit == <span class="hljs-literal">null</span>)<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NullPointerException</span>();<br>RunnableScheduledFuture&lt;V&gt; t = decorateTask(callable,<br><span class="hljs-keyword">new</span> <span class="hljs-title class_">ScheduledFutureTask</span>&lt;V&gt;(callable,<br>   triggerTime(delay, unit),<br>   sequencer.getAndIncrement()));<br>delayedExecute(t);<br><span class="hljs-keyword">return</span> t;<br>&#125;<br></code></pre></td></tr></table></figure><hr><h6 id="6-1-1-3-3-ScheduledFutureï¼œ-ï¼-scheduleAtFixedRate-Runnable-command-long-initialDelay-long-period-TimeUnit-unit"><a href="#6-1-1-3-3-ScheduledFutureï¼œ-ï¼-scheduleAtFixedRate-Runnable-command-long-initialDelay-long-period-TimeUnit-unit" class="headerlink" title="6.1.1.3.3. ScheduledFutureï¼œ?ï¼ scheduleAtFixedRate(Runnable command, long initialDelay, long period, TimeUnit unit)"></a>6.1.1.3.3. ScheduledFutureï¼œ?ï¼ scheduleAtFixedRate(Runnable command, long initialDelay, long period, TimeUnit unit)</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> ScheduledFuture&lt;?&gt; scheduleAtFixedRate(Runnable command,<br>  <span class="hljs-type">long</span> initialDelay,<br>  <span class="hljs-type">long</span> period,<br>  TimeUnit unit) &#123;<br><span class="hljs-keyword">if</span> (command == <span class="hljs-literal">null</span> || unit == <span class="hljs-literal">null</span>)<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NullPointerException</span>();<br><span class="hljs-keyword">if</span> (period &lt;= <span class="hljs-number">0L</span>)<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>();<br>ScheduledFutureTask&lt;Void&gt; sft =<br><span class="hljs-keyword">new</span> <span class="hljs-title class_">ScheduledFutureTask</span>&lt;Void&gt;(command,<br>  <span class="hljs-literal">null</span>,<br>  triggerTime(initialDelay, unit),<br>  unit.toNanos(period),<br>  sequencer.getAndIncrement());<br>RunnableScheduledFuture&lt;Void&gt; t = decorateTask(command, sft);<br>sft.outerTask = t;<br>delayedExecute(t);<br><span class="hljs-keyword">return</span> t;<br>&#125;<br></code></pre></td></tr></table></figure><hr><h6 id="6-1-1-3-4-ScheduledFutureï¼œ-ï¼-scheduleWithFixedDelay-Runnable-command-long-initialDelay-long-delay-TimeUnit-unit"><a href="#6-1-1-3-4-ScheduledFutureï¼œ-ï¼-scheduleWithFixedDelay-Runnable-command-long-initialDelay-long-delay-TimeUnit-unit" class="headerlink" title="6.1.1.3.4. ScheduledFutureï¼œ?ï¼ scheduleWithFixedDelay(Runnable command, long initialDelay, long delay, TimeUnit unit)"></a>6.1.1.3.4. ScheduledFutureï¼œ?ï¼ scheduleWithFixedDelay(Runnable command, long initialDelay, long delay, TimeUnit unit)</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> ScheduledFuture&lt;?&gt; scheduleWithFixedDelay(Runnable command,<br> <span class="hljs-type">long</span> initialDelay,<br> <span class="hljs-type">long</span> delay,<br> TimeUnit unit) &#123;<br><span class="hljs-keyword">if</span> (command == <span class="hljs-literal">null</span> || unit == <span class="hljs-literal">null</span>)<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NullPointerException</span>();<br><span class="hljs-keyword">if</span> (delay &lt;= <span class="hljs-number">0L</span>)<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>();<br>ScheduledFutureTask&lt;Void&gt; sft =<br><span class="hljs-keyword">new</span> <span class="hljs-title class_">ScheduledFutureTask</span>&lt;Void&gt;(command,<br>  <span class="hljs-literal">null</span>,<br>  triggerTime(initialDelay, unit),<br>  -unit.toNanos(delay),<br>  sequencer.getAndIncrement());<br>RunnableScheduledFuture&lt;Void&gt; t = decorateTask(command, sft);<br>sft.outerTask = t;<br>delayedExecute(t);<br><span class="hljs-keyword">return</span> t;<br>&#125;<br></code></pre></td></tr></table></figure><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.util.concurrent.ThreadPoolExecutor.Worker æºç è§£æ</title>
    <link href="/2025/11/04/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ThreadPoolExecutor.Worker%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/11/04/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ThreadPoolExecutor.Worker%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw<br><img src="/source/_posts/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ThreadPoolExecutor.Worker%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ThreadPoolExecutor.Worker%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.eddx"></p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/11/04/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ThreadPoolExecutor.Worker%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/04/æºç ï¼šjava.util.concurrent.ThreadPoolExecutor.Workeræºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-ThreadPoolExecutor-Worker-æ¦‚è¿°"><a href="#3-1-ThreadPoolExecutor-Worker-æ¦‚è¿°" class="headerlink" title="3.1. ThreadPoolExecutor.Worker æ¦‚è¿°"></a>3.1. ThreadPoolExecutor.Worker æ¦‚è¿°</h3><p>æƒ³è±¡è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼šæˆ‘ä»¬çš„ <code>Thread</code> æ˜¯ç”¨æ¥æ‰§è¡Œä¸€ä¸ª <code>Runnable</code> ç±»å‹çš„ä»»åŠ¡ï¼Œä»»åŠ¡æ‰§è¡Œå®Œæ¯•åï¼Œ<code>Thread</code> å°±ä¼šè¿›å…¥ â€œæ­»äº¡â€ çŠ¶æ€ã€‚å¯æ˜¯åœ¨çº¿ç¨‹æ± ä¸­ï¼Œæˆ‘ä»¬å¸Œæœ›çš„æ˜¯èƒ½å¤Ÿå¤ç”¨çº¿ç¨‹ï¼Œè®©å®ƒä»¬æŒç»­åœ°ä»ä»»åŠ¡é˜Ÿåˆ—ä¸­è·å–å¹¶æ‰§è¡Œä»»åŠ¡</p><p>ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼Œ<code>Doug Lea</code> å¼•å…¥äº† <code>Worker</code> çš„æ¦‚å¿µã€‚<code>Worker</code> æœ¬èº«å®ç°äº† <code>Runnable</code> æ¥å£ï¼Œå› æ­¤å®ƒä¹Ÿæ˜¯ä¸€ä¸ª <code>Runnable</code> ç±»å‹çš„ä»»åŠ¡ã€‚æˆ‘ä»¬è®© <code>Thread</code> æ‰§è¡Œè¿™ä¸ª <code>Worker</code>ï¼Œè€Œåœ¨ <code>Worker</code> çš„ <code>run</code> ä¸­ï¼Œä½¿ç”¨ä¸€ä¸ªå¾ªç¯ä¸æ–­åœ°ä»ä»»åŠ¡é˜Ÿåˆ—ä¸­è·å–ä»»åŠ¡å¹¶æ‰§è¡Œã€‚è¿™æ ·ï¼Œå°± â€œå¦è¾Ÿè¹Šå¾„â€ çš„å®ç°äº† â€œå¤ç”¨çº¿ç¨‹â€<br><img src="/source/_posts/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ThreadPoolExecutor.Worker%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ThreadPoolExecutor.Worker%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.png"></p><p><code>Worker</code> æ˜¯ä¸€ä¸ªå…·ä½“ç±»ï¼Œæ˜¯ <code>java.util.concurrent.ThreadPoolExecutor</code> çš„æˆå‘˜å†…éƒ¨ç±»ï¼Œç»§æ‰¿äº† <code>java.util.concurrent.locks.AbstractQueuedSynchronizer</code>ï¼Œå®ç°äº†<code> java.lang.Runnable</code></p><p><code>Worker</code> æ˜¯ä½¿ç”¨ <code>AQS</code> å®ç°çš„çŠ¶æ€æœºï¼Œ<code>State</code> è¡¨ç¤ºä»¥ä¸‹å«ä¹‰ï¼š</p><ol><li><code>-1</code><ol><li><code>Worker</code> æ­£åœ¨è¢«å®ä¾‹åŒ–</li></ol></li><li><code>0</code><ol><li><code>Worker</code> å¹¶æ²¡æœ‰ â€œæ‰§è¡Œâ€ ä»»åŠ¡ï¼ˆæ­£åœ¨ä»ä»»åŠ¡é˜Ÿåˆ—ä¸­è·å–ä»»åŠ¡ï¼‰</li></ol></li><li><code>1</code><ol><li><code>Worker</code> æ­£åœ¨ â€œæ‰§è¡Œâ€ ä»»åŠ¡</li></ol></li></ol><hr><h2 id="4-æºç éƒ¨åˆ†"><a href="#4-æºç éƒ¨åˆ†" class="headerlink" title="4. æºç éƒ¨åˆ†"></a>4. æºç éƒ¨åˆ†</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Worker</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractQueuedSynchronizer</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Runnable</span> &#123;<br><br><span class="hljs-comment">// è¡¨ç¤º Worker å°è£…çš„ Thread å®ä¾‹</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// è¯¥ Thread å®ä¾‹è´Ÿè´£æ‰§è¡Œ Worker#runï¼Œå¹¶ä¸”æ˜¯åœ¨ Worker è¢«å®ä¾‹åŒ–çš„æ—¶å€™è¢«å®ä¾‹åŒ–çš„</span><br><span class="hljs-meta">@SuppressWarnings(&quot;serial&quot;)</span><br><span class="hljs-keyword">final</span> Thread thread;<br><br><span class="hljs-comment">// è¡¨ç¤º Worker çš„ â€œå¯åŠ¨ä»»åŠ¡â€</span><br><span class="hljs-meta">@SuppressWarnings(&quot;serial&quot;)</span> <br>Runnable firstTask;<br><br><span class="hljs-comment">// è¡¨ç¤º Worker å·²å®Œæˆä»»åŠ¡çš„ä»»åŠ¡æ•°é‡</span><br><span class="hljs-keyword">volatile</span> <span class="hljs-type">long</span> completedTasks;<br><br>Worker(Runnable firstTask) &#123;<br>setState(-<span class="hljs-number">1</span>); <br><span class="hljs-built_in">this</span>.firstTask = firstTask;<br><span class="hljs-built_in">this</span>.thread = getThreadFactory().newThread(<span class="hljs-built_in">this</span>);<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-comment">// è°ƒç”¨ ThreadPoolExecutor#runWorkerï¼Œå¹¶æŠŠ this ä½œä¸ºæ–¹æ³•å‚æ•°ä¼ é€’è¿›å»</span><br>runWorker(<span class="hljs-built_in">this</span>);<br>&#125;<br><br><span class="hljs-keyword">protected</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isHeldExclusively</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-keyword">return</span> getState() != <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-keyword">protected</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryAcquire</span><span class="hljs-params">(<span class="hljs-type">int</span> unused)</span> &#123;<br><span class="hljs-keyword">if</span> (compareAndSetState(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>)) &#123;<br>setExclusiveOwnerThread(Thread.currentThread());<br><span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>&#125;<br><br><span class="hljs-keyword">protected</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryRelease</span><span class="hljs-params">(<span class="hljs-type">int</span> unused)</span> &#123;<br>setExclusiveOwnerThread(<span class="hljs-literal">null</span>);<br>setState(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">lock</span><span class="hljs-params">()</span> &#123; <br>acquire(<span class="hljs-number">1</span>); <br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryLock</span><span class="hljs-params">()</span> &#123; <br><span class="hljs-keyword">return</span> tryAcquire(<span class="hljs-number">1</span>); <br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">unlock</span><span class="hljs-params">()</span> &#123; <br>release(<span class="hljs-number">1</span>); <br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isLocked</span><span class="hljs-params">()</span> &#123; <br><span class="hljs-keyword">return</span> isHeldExclusively(); <br>&#125;<br><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">interruptIfStarted</span><span class="hljs-params">()</span> &#123;<br>Thread t;<br><span class="hljs-keyword">if</span> (getState() &gt;= <span class="hljs-number">0</span> &amp;&amp; (t = thread) != <span class="hljs-literal">null</span> &amp;&amp; !t.isInterrupted()) &#123;<br><span class="hljs-keyword">try</span> &#123;<br>t.interrupt();<br>&#125; <span class="hljs-keyword">catch</span> (SecurityException ignore) &#123;<br>&#125;<br>&#125;<br>&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.util.concurrent.AbstractExecutorService æºç è§£æ</title>
    <link href="/2025/11/03/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.AbstractExecutorService%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/11/03/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.AbstractExecutorService%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/11/03/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.AbstractExecutorService%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/03/æºç ï¼šjava.util.concurrent.AbstractExecutorServiceæºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-AbstractExecutorService-æ¦‚è¿°"><a href="#3-1-AbstractExecutorService-æ¦‚è¿°" class="headerlink" title="3.1. AbstractExecutorService æ¦‚è¿°"></a>3.1. AbstractExecutorService æ¦‚è¿°</h3><p><code>AbstractExecutorService</code> æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå®ç°äº† <code>java.util.concurrent.ExecutorService</code><br><img src="/source/_posts/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.AbstractExecutorService%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.AbstractExecutorService%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.png"></p><p><code>AbstractExecutorService</code> ä¸º <code>ExecutorService</code> ä¸­çš„éƒ¨åˆ†é€šç”¨é€»è¾‘æä¾›äº†å®ç°</p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>è¯¦è§æºç ï¼š<code>ExecutorService</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ExecutorService%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.ExecutorServiceæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/09/03/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ExecutorService%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/09/03/æºç ï¼šjava.util.concurrent.ExecutorServiceæºç è§£æ/</a></li></ol></li></ol></li></ol></blockquote><hr><h2 id="4-å®ä¾‹æ–¹æ³•"><a href="#4-å®ä¾‹æ–¹æ³•" class="headerlink" title="4. å®ä¾‹æ–¹æ³•"></a>4. å®ä¾‹æ–¹æ³•</h2><h3 id="4-1-å®ä¾‹å…·ä½“æ–¹æ³•"><a href="#4-1-å®ä¾‹å…·ä½“æ–¹æ³•" class="headerlink" title="4.1. å®ä¾‹å…·ä½“æ–¹æ³•"></a>4.1. å®ä¾‹å…·ä½“æ–¹æ³•</h3><h4 id="4-1-1-å…·ä½“æ–¹æ³•ï¼ˆæ™®é€šï¼‰"><a href="#4-1-1-å…·ä½“æ–¹æ³•ï¼ˆæ™®é€šï¼‰" class="headerlink" title="4.1.1. å…·ä½“æ–¹æ³•ï¼ˆæ™®é€šï¼‰"></a>4.1.1. å…·ä½“æ–¹æ³•ï¼ˆæ™®é€šï¼‰</h4><h5 id="4-1-1-1-ï¼œTï¼-RunnableFutureï¼œTï¼-newTaskFor-Callableï¼œTï¼-callable"><a href="#4-1-1-1-ï¼œTï¼-RunnableFutureï¼œTï¼-newTaskFor-Callableï¼œTï¼-callable" class="headerlink" title="4.1.1.1. ï¼œTï¼ RunnableFutureï¼œTï¼ newTaskFor(Callableï¼œTï¼ callable)"></a>4.1.1.1. ï¼œTï¼ RunnableFutureï¼œTï¼ newTaskFor(Callableï¼œTï¼ callable)</h5><p>è¯¥æ–¹æ³•ç”¨äºéé˜»å¡å°† <code>Callable</code> ä»»åŠ¡å°è£…æˆ <code>RunnableFuture</code> ç±»å‹ï¼ˆå®åˆ™æ˜¯å°è£…æˆ <code>FutureTask</code>ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">protected</span> &lt;T&gt; RunnableFuture&lt;T&gt; <span class="hljs-title function_">newTaskFor</span><span class="hljs-params">(Callable&lt;T&gt; callable)</span> &#123;<br><br><span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FutureTask</span>&lt;T&gt;(callable);<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h5 id="4-1-1-2-ï¼œTï¼-RunnableFutureï¼œTï¼-newTaskFor-Runnable-runnable-T-value"><a href="#4-1-1-2-ï¼œTï¼-RunnableFutureï¼œTï¼-newTaskFor-Runnable-runnable-T-value" class="headerlink" title="4.1.1.2. ï¼œTï¼ RunnableFutureï¼œTï¼ newTaskFor(Runnable runnable, T value)"></a>4.1.1.2. ï¼œTï¼ RunnableFutureï¼œTï¼ newTaskFor(Runnable runnable, T value)</h5><p>è¯¥æ–¹æ³•ç”¨äºéé˜»å¡å°† <code>Runnable</code> ä»»åŠ¡å°è£…æˆ <code>RunnableFuture</code> ç±»å‹ï¼ˆå®åˆ™æ˜¯å°è£…æˆ <code>FutureTask</code>ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">protected</span> &lt;T&gt; RunnableFuture&lt;T&gt; <span class="hljs-title function_">newTaskFor</span><span class="hljs-params">(Runnable runnable, T value)</span> &#123;<br><br><span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FutureTask</span>&lt;T&gt;(runnable, value);<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h4 id="4-1-2-å…·ä½“æ–¹æ³•ï¼ˆå®ç°ï¼‰"><a href="#4-1-2-å…·ä½“æ–¹æ³•ï¼ˆå®ç°ï¼‰" class="headerlink" title="4.1.2. å…·ä½“æ–¹æ³•ï¼ˆå®ç°ï¼‰"></a>4.1.2. å…·ä½“æ–¹æ³•ï¼ˆå®ç°ï¼‰</h4><h5 id="4-1-2-1-ExecutorService-ä¸­æ¥å£æ–¹æ³•çš„å®ç°"><a href="#4-1-2-1-ExecutorService-ä¸­æ¥å£æ–¹æ³•çš„å®ç°" class="headerlink" title="4.1.2.1. ExecutorService ä¸­æ¥å£æ–¹æ³•çš„å®ç°"></a>4.1.2.1. ExecutorService ä¸­æ¥å£æ–¹æ³•çš„å®ç°</h5><h6 id="4-1-2-1-1-Futureï¼œ-ï¼-submit-Runnable-task"><a href="#4-1-2-1-1-Futureï¼œ-ï¼-submit-Runnable-task" class="headerlink" title="4.1.2.1.1. Futureï¼œ?ï¼ submit(Runnable task)"></a>4.1.2.1.1. Futureï¼œ?ï¼ submit(Runnable task)</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * ============================================</span><br><span class="hljs-comment"> * å®ä¾‹å…·ä½“æ–¹æ³•ï¼ˆExecutorService æ¥å£æ–¹æ³• å®ç°ï¼‰ï¼š</span><br><span class="hljs-comment"> * public Future&lt;?&gt; submit(Runnable task)</span><br><span class="hljs-comment"> * --------------------------------------------</span><br><span class="hljs-comment"> * 1. è®¿é—®ä¿®é¥°ç¬¦</span><br><span class="hljs-comment"> *      1. public</span><br><span class="hljs-comment"> *          1. å¤©ä¸‹çš†å…¬ï¼ˆEveryWhereï¼‰</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 2. éè®¿é—®ä¿®é¥°ç¬¦</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 3. æ–¹æ³•å‚æ•°</span><br><span class="hljs-comment"> *      1. Runnable task</span><br><span class="hljs-comment"> *          1. æäº¤çš„ Runnable ä»»åŠ¡</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 4. è¿”å›å€¼</span><br><span class="hljs-comment"> *      1. Runnable ä»»åŠ¡å°è£…æˆçš„ FutureTask å®ä¾‹</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 5. æŠ›å‡ºå¼‚å¸¸</span><br><span class="hljs-comment"> *      1. NullPointerException</span><br><span class="hljs-comment"> *          1. ä¼ å…¥çš„ Runnable ä»»åŠ¡ä¸º null</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 6. ä½¿ç”¨ç¤ºä¾‹</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * ============================================</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> Future&lt;?&gt; submit(Runnable task) &#123;<br><br><span class="hljs-keyword">if</span> (task == <span class="hljs-literal">null</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NullPointerException</span>();<br><br><span class="hljs-comment">// è°ƒç”¨ AbstractExecutorService#newTaskForï¼Œå°† Runnable ä»»åŠ¡å°è£…æˆä¸€ç§ RunnableFutureï¼ˆå®åˆ™æ˜¯å°è£…æˆ FutureTaskï¼‰</span><br>RunnableFuture&lt;Void&gt; ftask = newTaskFor(task, <span class="hljs-literal">null</span>);<br><br><span class="hljs-comment">// è°ƒç”¨ Executor#executeï¼Œæäº¤ä¸€ä¸ª Runnable ä»»åŠ¡</span><br>execute(ftask);<br><br><span class="hljs-comment">// è¿”å› Runnable ä»»åŠ¡å°è£…æˆçš„ FutureTask</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// ä¹‹æ‰€ä»¥è¿”å›è¯¥ FutureTask å®ä¾‹ï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬å¯èƒ½éœ€è¦é€šè¿‡è¯¥ FutureTask å®ä¾‹ï¼Œè°ƒç”¨ Future&lt;V&gt; ç›¸å…³çš„æ–¹æ³•ï¼Œå»å¯¹è¯¥ä»»åŠ¡è¿›è¡Œä¸€ç³»æ‰è¶³ä»¥</span><br><span class="hljs-keyword">return</span> ftask;<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h6 id="4-1-2-1-2-ï¼œTï¼-Futureï¼œTï¼-submit-Runnable-task-T-result"><a href="#4-1-2-1-2-ï¼œTï¼-Futureï¼œTï¼-submit-Runnable-task-T-result" class="headerlink" title="4.1.2.1.2. ï¼œTï¼ Futureï¼œTï¼ submit(Runnable task, T result)"></a>4.1.2.1.2. ï¼œTï¼ Futureï¼œTï¼ submit(Runnable task, T result)</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> &lt;T&gt; Future&lt;T&gt; <span class="hljs-title function_">submit</span><span class="hljs-params">(Runnable task, T result)</span> &#123;<br><br><span class="hljs-keyword">if</span> (task == <span class="hljs-literal">null</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NullPointerException</span>();<br><br>RunnableFuture&lt;T&gt; ftask = newTaskFor(task, result);<br><br>execute(ftask);<br><br><span class="hljs-keyword">return</span> ftask;<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h6 id="4-1-2-1-3-ï¼œTï¼-Futureï¼œTï¼-submit-Callableï¼œTï¼-task"><a href="#4-1-2-1-3-ï¼œTï¼-Futureï¼œTï¼-submit-Callableï¼œTï¼-task" class="headerlink" title="4.1.2.1.3. ï¼œTï¼ Futureï¼œTï¼ submit(Callableï¼œTï¼ task)"></a>4.1.2.1.3. ï¼œTï¼ Futureï¼œTï¼ submit(Callableï¼œTï¼ task)</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> &lt;T&gt; Future&lt;T&gt; <span class="hljs-title function_">submit</span><span class="hljs-params">(Callable&lt;T&gt; task)</span> &#123;<br><br><span class="hljs-keyword">if</span> (task == <span class="hljs-literal">null</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NullPointerException</span>();<br><br>RunnableFuture&lt;T&gt; ftask = newTaskFor(task);<br><br>execute(ftask);<br><br><span class="hljs-keyword">return</span> ftask;<br><br>&#125;<br></code></pre></td></tr></table></figure><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.util.concurrent.FutureTaskï¼œVï¼ æºç è§£æ</title>
    <link href="/2025/11/03/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.FutureTask%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/11/03/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.FutureTask%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/11/03/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.FutureTask%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/03/æºç ï¼šjava.util.concurrent.FutureTaskï¼œVï¼æºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-FutureTask-æ¦‚è¿°"><a href="#3-1-FutureTask-æ¦‚è¿°" class="headerlink" title="3.1. FutureTask æ¦‚è¿°"></a>3.1. FutureTask æ¦‚è¿°</h3><p><code>FutureTask</code> æ˜¯ä¸€ä¸ªå…·ä½“ç±»ï¼Œç»§æ‰¿äº† <code>java.util.concurrent.RunnableFuture&lt;V&gt;</code><br><img src="/source/_posts/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.FutureTask%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.FutureTask%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.png"></p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>è¯¦è§æºç ï¼š<code>RunnableFuture&lt;V&gt;</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.RunnableFuture%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.RunnableFutureï¼œVï¼æºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/11/03/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.RunnableFuture%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/03/æºç ï¼šjava.util.concurrent.RunnableFutureï¼œVï¼æºç è§£æ/</a></li></ol></li></ol></li></ol></blockquote><hr><h3 id="3-2-FutureTask-ç›¸å…³çŠ¶æ€"><a href="#3-2-FutureTask-ç›¸å…³çŠ¶æ€" class="headerlink" title="3.2. FutureTask ç›¸å…³çŠ¶æ€"></a>3.2. FutureTask ç›¸å…³çŠ¶æ€</h3><ol><li><code>NEWï¼ˆ0ï¼‰</code><ol><li>è¡¨ç¤ºä»»åŠ¡çš„åˆå§‹çŠ¶æ€</li></ol></li><li><code>COMPLETINGï¼ˆ1ï¼‰</code><ol><li>è¡¨ç¤ºä»»åŠ¡å·²ç»æ‰§è¡Œå®Œæ¯•ï¼Œåœ¨èµ‹å€¼æœ€ç»ˆç»“æœ</li><li>è¿™æ˜¯ä¸€ä¸ªéå¸¸çŸ­æš‚çš„ç¬é—´çŠ¶æ€</li></ol></li><li><code>NORMALï¼ˆ2ï¼‰</code><ol><li>è¡¨ç¤ºä»»åŠ¡æ­£å¸¸é€€å‡º</li></ol></li><li><code>EXCEPTIONALï¼ˆ3ï¼‰</code><ol><li>è¡¨ç¤ºä»»åŠ¡å¼‚å¸¸é€€å‡º</li></ol></li><li><code>CANCELLEDï¼ˆ4ï¼‰</code><ol><li>è¡¨ç¤ºä»»åŠ¡å·²è¢«å–æ¶ˆ</li></ol></li><li><code>INTERRUPTINGï¼ˆ5ï¼‰</code><ol><li>è¡¨ç¤ºä»»åŠ¡æ­£åœ¨è¢«åœæ­¢</li></ol></li><li><code>INTERRUPTEDï¼ˆ6ï¼‰</code><ol><li>è¡¨ç¤ºä»»åŠ¡å·²è¢«åœæ­¢</li></ol></li></ol><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>å–æ¶ˆä»»åŠ¡å’Œåœæ­¢ä»»åŠ¡è¿˜æ˜¯æœ‰æ‰€åŒºåˆ«çš„ï¼šå–æ¶ˆä»»åŠ¡æ˜¯æŒ‡å–æ¶ˆé‚£äº›å°šæœªæ‰§è¡Œçš„ä»»åŠ¡ã€‚è€Œåœæ­¢ä»»åŠ¡åˆ™æ˜¯ä»»åŠ¡æ­£åœ¨æ‰§è¡Œæ—¶ï¼Œä½ é€šè¿‡ä¸­æ–­å»è®©å®ƒåœä¸‹æ¥ã€‚å¦‚æœä»»åŠ¡èƒ½å¤Ÿå“åº”ä¸­æ–­ï¼Œé‚£å°±ç®—æ˜¯æˆåŠŸåœæ­¢ã€‚ä½†é—®é¢˜åœ¨äºï¼Œå¦‚æœä»»åŠ¡æ²¡æœ‰å“åº”ä¸­æ–­ï¼Œé‚£ä¹ˆå³ä½¿ä½ å‘å‡ºäº†ä¸­æ–­è¯·æ±‚ï¼Œå®ƒä»ç„¶ä¼šç»§ç»­æ‰§è¡Œã€‚æ‰€ä»¥ â€œåœæ­¢ä»»åŠ¡â€ å¹¶ä¸ä¸€å®šèƒ½è®©å®ƒ â€œåœæ­¢ä¸‹æ¥â€</li></ol></blockquote><hr><h2 id="4-å†…éƒ¨ç±»"><a href="#4-å†…éƒ¨ç±»" class="headerlink" title="4. å†…éƒ¨ç±»"></a>4. å†…éƒ¨ç±»</h2><h3 id="4-1-WaitNode"><a href="#4-1-WaitNode" class="headerlink" title="4.1. WaitNode"></a>4.1. WaitNode</h3><p><code>FutureTask</code> çš„ <code>WaitNode</code> é“¾è¡¨å°±æ˜¯ç”± <code>WaitNode</code> æ„å»ºçš„å•å‘é“¾è¡¨ã€‚æ‰€æœ‰å› ä¸ºè°ƒç”¨ <code>Future#get</code> è€Œé˜»å¡çš„ Thread å®ä¾‹éƒ½ä¼šè¢«æŠ•é€’åˆ°è¯¥é˜Ÿåˆ—</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WaitNode</span> &#123;<br><br><span class="hljs-keyword">volatile</span> Thread thread;<br><br><span class="hljs-keyword">volatile</span> WaitNode next;<br><br>WaitNode() &#123; thread = Thread.currentThread(); &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h2 id="5-æ ¸å¿ƒå±æ€§"><a href="#5-æ ¸å¿ƒå±æ€§" class="headerlink" title="5. æ ¸å¿ƒå±æ€§"></a>5. æ ¸å¿ƒå±æ€§</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// è¡¨ç¤º FutureTask çš„çŠ¶æ€</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">int</span> state;<br><br><span class="hljs-comment">// ç”¨äºç•Œå®š FutureTask çš„ NEW çŠ¶æ€</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">NEW</span>          <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br><br><span class="hljs-comment">// ç”¨äºç•Œå®š FutureTask çš„ COMPLETING çŠ¶æ€</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">COMPLETING</span>   <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;<br><br><span class="hljs-comment">// ç”¨äºç•Œå®š FutureTask çš„ NORMAL çŠ¶æ€</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">NORMAL</span>       <span class="hljs-operator">=</span> <span class="hljs-number">2</span>;<br><br><span class="hljs-comment">// ç”¨äºç•Œå®š FutureTask çš„ EXCEPTIONAL çŠ¶æ€</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">EXCEPTIONAL</span>  <span class="hljs-operator">=</span> <span class="hljs-number">3</span>;<br><br><span class="hljs-comment">// ç”¨äºç•Œå®š FutureTask çš„ CANCELLED çŠ¶æ€</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">CANCELLED</span>    <span class="hljs-operator">=</span> <span class="hljs-number">4</span>;<br><br><span class="hljs-comment">// ç”¨äºç•Œå®š FutureTask çš„ INTERRUPTING çŠ¶æ€</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">INTERRUPTING</span> <span class="hljs-operator">=</span> <span class="hljs-number">5</span>;<br><br><span class="hljs-comment">// ç”¨äºç•Œå®š FutureTask çš„ INTERRUPTED çŠ¶æ€</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">INTERRUPTED</span>  <span class="hljs-operator">=</span> <span class="hljs-number">6</span>;<br><br><span class="hljs-comment">// è¡¨ç¤º FutureTask å°è£…çš„ Callable ä»»åŠ¡</span><br><span class="hljs-keyword">private</span> Callable&lt;V&gt; callable;<br><br><span class="hljs-comment">// è¡¨ç¤º FutureTask å°è£…çš„ Callable ä»»åŠ¡çš„ç»“æœ</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿”å›å€¼æ˜¯ Object ç±»å‹ï¼Œè¯´æ˜æ—¢èƒ½åº”å¯¹æ­£å¸¸é€€å‡ºï¼Œåˆèƒ½åº”å¯¹å¼‚å¸¸é€€å‡º</span><br><span class="hljs-keyword">private</span> Object outcome; <br><br><span class="hljs-comment">// è¡¨ç¤ºæ‰§è¡Œ FutureTask çš„ Thread å®ä¾‹</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> Thread runner;<br><br><span class="hljs-comment">// è¡¨ç¤º FutureTask çš„ WaitNode é“¾è¡¨ï¼ˆå•å‘ï¼‰</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> WaitNode waiters;<br></code></pre></td></tr></table></figure><hr><h2 id="6-æ„é€ æ–¹æ³•"><a href="#6-æ„é€ æ–¹æ³•" class="headerlink" title="6. æ„é€ æ–¹æ³•"></a>6. æ„é€ æ–¹æ³•</h2><h3 id="6-1-FutureTask-Callableï¼œVï¼-callable"><a href="#6-1-FutureTask-Callableï¼œVï¼-callable" class="headerlink" title="6.1. FutureTask(Callableï¼œVï¼ callable)"></a>6.1. FutureTask(Callableï¼œVï¼ callable)</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-title function_">FutureTask</span><span class="hljs-params">(Callable&lt;V&gt; callable)</span> &#123;<br><br><span class="hljs-keyword">if</span> (callable == <span class="hljs-literal">null</span>)<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NullPointerException</span>();<br><br><span class="hljs-built_in">this</span>.callable = callable;<br><br><span class="hljs-built_in">this</span>.state = NEW;<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h3 id="6-2-FutureTask-Runnable-runnable-V-result"><a href="#6-2-FutureTask-Runnable-runnable-V-result" class="headerlink" title="6.2. FutureTask(Runnable runnable, V result)"></a>6.2. FutureTask(Runnable runnable, V result)</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-title function_">FutureTask</span><span class="hljs-params">(Runnable runnable, V result)</span> &#123;<br><br><span class="hljs-built_in">this</span>.callable = Executors.callable(runnable, result);<br><br><span class="hljs-built_in">this</span>.state = NEW;<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h2 id="7-å®ä¾‹æ–¹æ³•"><a href="#7-å®ä¾‹æ–¹æ³•" class="headerlink" title="7. å®ä¾‹æ–¹æ³•"></a>7. å®ä¾‹æ–¹æ³•</h2><h3 id="7-1-å®ä¾‹å…·ä½“æ–¹æ³•"><a href="#7-1-å®ä¾‹å…·ä½“æ–¹æ³•" class="headerlink" title="7.1. å®ä¾‹å…·ä½“æ–¹æ³•"></a>7.1. å®ä¾‹å…·ä½“æ–¹æ³•</h3><h4 id="7-1-1-å…·ä½“æ–¹æ³•ï¼ˆå®ç°ï¼‰"><a href="#7-1-1-å…·ä½“æ–¹æ³•ï¼ˆå®ç°ï¼‰" class="headerlink" title="7.1.1. å…·ä½“æ–¹æ³•ï¼ˆå®ç°ï¼‰"></a>7.1.1. å…·ä½“æ–¹æ³•ï¼ˆå®ç°ï¼‰</h4><h5 id="7-1-1-1-Runnable-ä¸­æ¥å£æ–¹æ³•çš„å®ç°"><a href="#7-1-1-1-Runnable-ä¸­æ¥å£æ–¹æ³•çš„å®ç°" class="headerlink" title="7.1.1.1. Runnable ä¸­æ¥å£æ–¹æ³•çš„å®ç°"></a>7.1.1.1. Runnable ä¸­æ¥å£æ–¹æ³•çš„å®ç°</h5><h6 id="7-1-1-1-1-void-run"><a href="#7-1-1-1-1-void-run" class="headerlink" title="7.1.1.1.1. void run()"></a>7.1.1.1.1. void run()</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br><br><span class="hljs-keyword">if</span> (state != NEW ||<br>!RUNNER.compareAndSet(<span class="hljs-built_in">this</span>, <span class="hljs-literal">null</span>, Thread.currentThread()))<br><span class="hljs-keyword">return</span>;<br><br><span class="hljs-keyword">try</span> &#123;<br>Callable&lt;V&gt; c = callable;<br><span class="hljs-keyword">if</span> (c != <span class="hljs-literal">null</span> &amp;&amp; state == NEW) &#123;<br>V result;<br><span class="hljs-type">boolean</span> ran;<br><span class="hljs-keyword">try</span> &#123;<br>result = c.call();<br>ran = <span class="hljs-literal">true</span>;<br>&#125; <span class="hljs-keyword">catch</span> (Throwable ex) &#123;<br>result = <span class="hljs-literal">null</span>;<br>ran = <span class="hljs-literal">false</span>;<br>setException(ex);<br>&#125;<br><span class="hljs-keyword">if</span> (ran)<br>set(result);<br>&#125;<br>&#125; <span class="hljs-keyword">finally</span> &#123;<br>runner = <span class="hljs-literal">null</span>;<br><span class="hljs-type">int</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> state;<br><span class="hljs-keyword">if</span> (s &gt;= INTERRUPTING)<br>handlePossibleCancellationInterrupt(s);<br>&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h5 id="7-1-1-2-Future-ä¸­æ¥å£æ–¹æ³•çš„å®ç°"><a href="#7-1-1-2-Future-ä¸­æ¥å£æ–¹æ³•çš„å®ç°" class="headerlink" title="7.1.1.2. Future ä¸­æ¥å£æ–¹æ³•çš„å®ç°"></a>7.1.1.2. Future ä¸­æ¥å£æ–¹æ³•çš„å®ç°</h5><h6 id="7-1-1-2-1-boolean-cancel-boolean-mayInterruptIfRunning"><a href="#7-1-1-2-1-boolean-cancel-boolean-mayInterruptIfRunning" class="headerlink" title="7.1.1.2.1. boolean cancel(boolean mayInterruptIfRunning)"></a>7.1.1.2.1. boolean cancel(boolean mayInterruptIfRunning)</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">cancel</span><span class="hljs-params">(<span class="hljs-type">boolean</span> mayInterruptIfRunning)</span> &#123;<br><br><span class="hljs-keyword">if</span> (!(state == NEW &amp;&amp; STATE.compareAndSet<br>  (<span class="hljs-built_in">this</span>, NEW, mayInterruptIfRunning ? INTERRUPTING : CANCELLED)))<br><span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br><br><span class="hljs-keyword">try</span> &#123;<br><span class="hljs-keyword">if</span> (mayInterruptIfRunning) &#123;<br><span class="hljs-keyword">try</span> &#123;<br><span class="hljs-type">Thread</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> runner;<br><span class="hljs-keyword">if</span> (t != <span class="hljs-literal">null</span>)<br>t.interrupt();<br>&#125; <span class="hljs-keyword">finally</span> &#123;<br>STATE.setRelease(<span class="hljs-built_in">this</span>, INTERRUPTED);<br>&#125;<br>&#125;<br>&#125; <span class="hljs-keyword">finally</span> &#123;<br>finishCompletion();<br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h6 id="7-1-1-2-2-boolean-isCancelled"><a href="#7-1-1-2-2-boolean-isCancelled" class="headerlink" title="7.1.1.2.2. boolean isCancelled()"></a>7.1.1.2.2. boolean isCancelled()</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isCancelled</span><span class="hljs-params">()</span> &#123;<br><br><span class="hljs-keyword">return</span> state &gt;= CANCELLED;<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h6 id="7-1-1-2-3-boolean-isDone"><a href="#7-1-1-2-3-boolean-isDone" class="headerlink" title="7.1.1.2.3. boolean isDone()"></a>7.1.1.2.3. boolean isDone()</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isDone</span><span class="hljs-params">()</span> &#123;<br><br><span class="hljs-keyword">return</span> state != NEW;<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h6 id="7-1-1-2-4-get"><a href="#7-1-1-2-4-get" class="headerlink" title="7.1.1.2.4. get()"></a>7.1.1.2.4. get()</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> V <span class="hljs-title function_">get</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException, ExecutionException &#123;<br><br><span class="hljs-type">int</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> state;<br><br><span class="hljs-keyword">if</span> (s &lt;= COMPLETING)<br>s = awaitDone(<span class="hljs-literal">false</span>, <span class="hljs-number">0L</span>);<br><br><span class="hljs-keyword">return</span> report(s);<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h6 id="7-1-1-2-5-get-long-timeout-TimeUnit-unit"><a href="#7-1-1-2-5-get-long-timeout-TimeUnit-unit" class="headerlink" title="7.1.1.2.5. get(long timeout, TimeUnit unit)"></a>7.1.1.2.5. get(long timeout, TimeUnit unit)</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> V <span class="hljs-title function_">get</span><span class="hljs-params">(<span class="hljs-type">long</span> timeout, TimeUnit unit)</span><br><span class="hljs-keyword">throws</span> InterruptedException, ExecutionException, TimeoutException &#123;<br><br><span class="hljs-keyword">if</span> (unit == <span class="hljs-literal">null</span>)<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NullPointerException</span>();<br><br><span class="hljs-type">int</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> state;<br><br><span class="hljs-keyword">if</span> (s &lt;= COMPLETING &amp;&amp;<br>(s = awaitDone(<span class="hljs-literal">true</span>, unit.toNanos(timeout))) &lt;= COMPLETING)<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TimeoutException</span>();<br><br><span class="hljs-keyword">return</span> report(s);<br><br>&#125;<br></code></pre></td></tr></table></figure><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.util.concurrent.RunnableFutureï¼œVï¼ æºç è§£æ</title>
    <link href="/2025/11/03/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.RunnableFuture%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/11/03/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.RunnableFuture%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/11/03/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.RunnableFuture%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/03/æºç ï¼šjava.util.concurrent.RunnableFutureï¼œVï¼æºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-RunnableFuture-æ¦‚è¿°"><a href="#3-1-RunnableFuture-æ¦‚è¿°" class="headerlink" title="3.1. RunnableFuture æ¦‚è¿°"></a>3.1. RunnableFuture æ¦‚è¿°</h3><p><code>RunnableFuture</code> æ˜¯ä¸€ä¸ªæ¥å£ï¼Œç»§æ‰¿äº† <code>java.util.concurrent.Runnable</code>ã€<code>java.util.concurrent.Future&lt;V&gt;</code><br><img src="/source/_posts/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.RunnableFuture%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.RunnableFuture%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.png"></p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>è¯¦è§æºç ï¼š<code>Runnable</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.Runnable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.Runnableæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/09/02/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.Runnable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/09/02/æºç ï¼šjava.util.concurrent.Runnableæºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>Future&lt;V&gt;</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurren.Future%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurren.Futureï¼œVï¼æºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/09/02/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurren.Future%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/09/02/æºç ï¼šjava.util.concurren.Futureï¼œVï¼æºç è§£æ/</a></li></ol></li></ol></li></ol></blockquote><hr><h2 id="4-æºç éƒ¨åˆ†"><a href="#4-æºç éƒ¨åˆ†" class="headerlink" title="4. æºç éƒ¨åˆ†"></a>4. æºç éƒ¨åˆ†</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">RunnableFuture</span>&lt;V&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Runnable</span>, Future&lt;V&gt; &#123;<br>    <br>&#125;<br></code></pre></td></tr></table></figure><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.util.concurrent.ScheduledExecutorService æºç è§£æ</title>
    <link href="/2025/11/03/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ScheduledExecutorService%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/11/03/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ScheduledExecutorService%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/11/03/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ScheduledExecutorService%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/03/æºç ï¼šjava.util.concurrent.ScheduledExecutorServiceæºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-ScheduledExecutorService-æ¦‚è¿°"><a href="#3-1-ScheduledExecutorService-æ¦‚è¿°" class="headerlink" title="3.1. ScheduledExecutorService æ¦‚è¿°"></a>3.1. ScheduledExecutorService æ¦‚è¿°</h3><p><code>ScheduledExecutorService</code> æ˜¯ä¸€ä¸ªæ¥å£ï¼Œç»§æ‰¿äº† <code>java.util.concurrent.ExecutorService</code><br><img src="/source/_posts/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ScheduledExecutorService%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ScheduledExecutorService%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.png"></p><p><code>ScheduledExecutorService</code> åœ¨ <code>ExecutorService</code> çš„åŸºç¡€ä¸Šï¼Œä¸ºæˆ‘ä»¬æä¾›äº†ä»¥ä¸‹æ–¹æ³•ï¼š</p><ol><li>æäº¤ä¸€ä¸ª <code>Runnable</code> ä»»åŠ¡å¹¶å»¶è¿Ÿæ‰§è¡Œï¼ˆéé˜»å¡ï¼‰</li><li>æäº¤ä¸€ä¸ª <code>Runnable</code> ä»»åŠ¡å¹¶ä»¥å›ºå®šé€Ÿç‡å‘¨æœŸæ€§æ‰§è¡Œï¼ˆéé˜»å¡ï¼‰</li><li>æäº¤ä¸€ä¸ª <code>Runnable</code> ä»»åŠ¡å¹¶ä»¥å›ºå®šå»¶è¿Ÿå‘¨æœŸæ€§æ‰§è¡Œï¼ˆéé˜»å¡ï¼‰</li><li>æäº¤ä¸€ä¸ª <code>Callable</code> ä»»åŠ¡å¹¶å»¶è¿Ÿæ‰§è¡Œï¼ˆéé˜»å¡ï¼‰</li></ol><p>ç®€å•æ¥è¯´ï¼Œ<code>ExecutorService</code> æä¾›çš„æ–¹æ³•éƒ½æ˜¯ä»»åŠ¡æäº¤å â€œç«‹å³æ‰§è¡Œâ€ï¼Œä½†æ˜¯ <code>ScheduledExecutorService</code> å…è®¸æˆ‘ä»¬å»¶è¿Ÿæ‰§è¡Œä»»åŠ¡ã€å‘¨æœŸæ€§æ‰§è¡Œä»»åŠ¡</p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>è¯¦è§æºç ï¼š<code>ExecutorService</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ExecutorService%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.ExecutorServiceæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/09/03/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ExecutorService%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/09/03/æºç ï¼šjava.util.concurrent.ExecutorServiceæºç è§£æ/</a></li></ol></li></ol></li><li>æ‰€è°“çš„ â€œå»¶è¿Ÿæ‰§è¡Œâ€ æ˜¯æŒ‡ï¼šåœ¨æŒ‡å®šçš„å»¶è¿Ÿæ—¶é—´åˆ°è¾¾åï¼Œä»»åŠ¡ â€œå¯ä»¥è¢«æ‰§è¡Œâ€ã€‚ä½†å®ƒæ˜¯å¦ä¼šç«‹å³çœŸæ­£è¿è¡Œï¼Œè¿˜å–å†³äºæ˜¯å¦æœ‰ç©ºé—²çº¿ç¨‹å¯ä»¥æ‰§è¡Œè¯¥ä»»åŠ¡ã€‚å› æ­¤åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œä»»åŠ¡çš„å®é™…æ‰§è¡Œæ—¶é—´å¯èƒ½ä¼šæ¯”æŒ‡å®šçš„å»¶è¿Ÿæ—¶é—´æ›´æ™šã€‚</li></ol></blockquote><hr><h2 id="4-æºç éƒ¨åˆ†"><a href="#4-æºç éƒ¨åˆ†" class="headerlink" title="4. æºç éƒ¨åˆ†"></a>4. æºç éƒ¨åˆ†</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">ScheduledExecutorService</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ExecutorService</span> &#123;<br><br><span class="hljs-comment">// ç”¨äºéé˜»å¡æäº¤ä¸€ä¸ª Runnable ä»»åŠ¡ï¼Œå¹¶å»¶è¿Ÿ delay unit æ—¶é—´åå†æ‰§è¡Œ</span><br>    <span class="hljs-keyword">public</span> ScheduledFuture&lt;?&gt; schedule(Runnable comm<br>                                       <span class="hljs-type">long</span> delay, TimeUnit unit);<br><br><span class="hljs-comment">// ç”¨äºéé˜»å¡æäº¤ä¸€ä¸ª Callable ä»»åŠ¡ï¼Œå¹¶å»¶è¿Ÿ delay unit æ—¶é—´åå†æ‰§è¡Œ</span><br>    <span class="hljs-keyword">public</span> &lt;V&gt; ScheduledFuture&lt;V&gt; <span class="hljs-title function_">schedule</span><span class="hljs-params">(Callable&lt;V&gt; callable,</span><br><span class="hljs-params">                           <span class="hljs-type">long</span> delay, TimeUnit unit)</span>;<br><br><span class="hljs-comment">// ç”¨äºéé˜»å¡æäº¤ä¸€ä¸ª Runnable ä»»åŠ¡ï¼Œå¹¶å»¶è¿Ÿ delay unit æ—¶é—´åå†æ‰§è¡Œï¼Œå¹¶ä»¥å›ºå®šé€Ÿç‡å‘¨æœŸæ€§æ‰§è¡Œ</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// å»¶è¿Ÿ initialDelay unit æ—¶é—´åé¦–æ¬¡æ‰§è¡Œ</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// ç„¶åä»¥ period unit å›ºå®šé€Ÿç‡å‘¨æœŸæ€§æ‰§è¡Œï¼Œä¾‹å¦‚ initialDelay unit ä¸º 0sï¼Œperiod unit ä¸º 5s</span><br><span class="hljs-comment">//     1. ç¬¬ä¸€æ¬¡æ‰§è¡Œå¼€å§‹çš„æ—¶é—´ä¸º 0s</span><br><span class="hljs-comment">//     2. ç¬¬äºŒæ¬¡æ‰§è¡Œå¿«é€Ÿçš„æ—¶é—´ä¸º 5s</span><br><span class="hljs-comment">//     3. ç¬¬ä¸‰æ¬¡æ‰§è¡Œå¼€å§‹çš„æ—¶é—´ä¸º 10s</span><br><span class="hljs-comment">//     4. ä»¥æ­¤ç±»æ¨...</span><br><span class="hljs-comment">//     5. å¦‚æœç¬¬ä¸€æ¬¡æ‰§è¡Œçš„ä»»åŠ¡ï¼Œè€—æ—¶ 7sï¼Œåˆ™è¯¥ä»»åŠ¡æ‰§è¡Œå®Œæˆåï¼Œéœ€è¦å†æ¬¡ç«‹å³æ‰§è¡Œï¼Œå»å¼¥è¡¥ç¬¬äºŒæ¬¡çš„ç©ºç¼º</span><br><span class="hljs-comment">//     6. å¦‚æœç¬¬äºŒæ¬¡æ‰§è¡Œçš„ä»»åŠ¡ï¼Œä»ç„¶è€—æ—¶ 7sï¼Œåˆ™è¯¥ä»»åŠ¡æ‰§è¡Œå®Œæˆåï¼Œéœ€è¦å†æ¬¡ç«‹å³æ‰§è¡Œï¼Œå»å¼¥è¡¥ç¬¬ä¸‰æ¬¡çš„ç©ºç¼º</span><br><span class="hljs-comment">//     7. å¦‚æœç¬¬ä¸‰æ¬¡æ‰§è¡Œçš„ä»»åŠ¡ï¼Œä¾æ—§è€—æ—¶ 7sï¼Œåˆ™è¯¥ä»»åŠ¡æ‰§è¡Œå®Œæˆåï¼Œéœ€è¦å†æ¬¡ç«‹å³æ‰§è¡Œï¼Œå»å¼¥è¡¥ç¬¬å››æ¬¡çš„ç©ºç¼º</span><br><span class="hljs-comment">//     8. ä»¥æ­¤ç±»æ¨...</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœæ‰§è¡Œä»»åŠ¡çš„è€—æ—¶ ï¼ period unitï¼Œåç»­çš„ä»»åŠ¡æ‰§è¡Œå¯èƒ½ä¼šå¼€å§‹æ¯”è¾ƒæ™šï¼Œä½†æ˜¯ä¸ä¼šå¹¶å‘æ‰§è¡Œã€‚è¿™ç§æƒ…å†µä¸‹å°±æˆä¸€ç§è¿ç»­æ‰§è¡Œäº†ï¼Œä¸Šä¸€ä¸ªä»»åŠ¡åˆšç»“æŸï¼Œä¸‹ä¸€ä¸ªä»»åŠ¡å°±å¼€å§‹ï¼Œä¸­é—´æ²¡æœ‰ä»»ä½•åœé¡¿</span><br>    <span class="hljs-keyword">public</span> ScheduledFuture&lt;?&gt; scheduleAtFixedRate(Runnable command,<br>                                                  <span class="hljs-type">long</span> initialDelay,<br>                                                  <span class="hljs-type">long</span> period,<br>                                                  TimeUnit unit);<br><br><span class="hljs-comment">// ç”¨äºéé˜»å¡æäº¤ä¸€ä¸ª Runnable ä»»åŠ¡ï¼Œå¹¶å»¶è¿Ÿ delay unit æ—¶é—´åå†æ‰§è¡Œï¼Œå¹¶ä»¥å›ºå®šå»¶è¿Ÿå‘¨æœŸæ€§æ‰§è¡Œ</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// å»¶è¿Ÿ initialDelay unit åé¦–æ¬¡æ‰§è¡Œ</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// ç„¶åä»¥ period unit å›ºå®šå»¶è¿Ÿå‘¨æœŸæ€§æ‰§è¡Œï¼Œä¾‹å¦‚ initialDelay unit ä¸º 0sï¼Œperiod unit ä¸º 5s</span><br><span class="hljs-comment">//     1. ç¬¬ä¸€æ¬¡æ‰§è¡Œçš„æ—¶é—´ä¸º 0sï¼Œå¦‚æœè¯¥ä»»åŠ¡è€—æ—¶ 7s</span><br><span class="hljs-comment">//     2. ç¬¬äºŒæ¬¡æ‰§è¡Œçš„æ—¶é—´ä¸º 7s + 5sï¼Œå³ 12sï¼Œå¦‚æœè¯¥ä»»åŠ¡è€—æ—¶ 5s</span><br><span class="hljs-comment">//     3. ç¬¬ä¸‰æ¬¡æ‰§è¡Œçš„æ—¶é—´ä¸º 12s + 5sï¼Œå³ 17s</span><br><span class="hljs-comment">//     4. ä»¥æ­¤ç±»æ¨...</span><br>    <span class="hljs-keyword">public</span> ScheduledFuture&lt;?&gt; scheduleWithFixedDelay(Runnable command,<br>                                                     <span class="hljs-type">long</span> initialDelay,<br>                                                     <span class="hljs-type">long</span> delay,<br>                                                     TimeUnit unit);<br><br>&#125;<br></code></pre></td></tr></table></figure><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.io.Serializable æºç è§£æ</title>
    <link href="/2025/10/28/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.io.Serializable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/10/28/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.io.Serializable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/10/28/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.io.Serializable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/10/28/æºç ï¼šjava.io.Serializableæºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-Serializable-æ¦‚è¿°"><a href="#3-1-Serializable-æ¦‚è¿°" class="headerlink" title="3.1. Serializable æ¦‚è¿°"></a>3.1. Serializable æ¦‚è¿°</h3><p><code>Serializable</code> æ˜¯ä¸€ä¸ªæ¥å£</p><p><code>Serializable</code> æ˜¯ä¸€ä¸ªæ ‡è®°æ¥å£ï¼Œåªè¦æˆ‘ä»¬ <code>Implements Serializable</code>ï¼Œä»–å°±å‘Šè¯‰ <code>JVM</code> è¿™ä¸ªç±»çš„å¯¹è±¡å¯ä»¥è¢«åºåˆ—åŒ–å’Œååºåˆ—åŒ–</p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>ä¸»è¦ç”¨äº <code>JDK</code> åºåˆ—åŒ–ï¼Œå…¶ä»–åºåˆ—åŒ–æ–¹å¼ä¸éœ€è¦å®ç°è¯¥æ¥å£</li></ol></blockquote><hr><h2 id="4-æºç éƒ¨åˆ†"><a href="#4-æºç éƒ¨åˆ†" class="headerlink" title="4. æºç éƒ¨åˆ†"></a>4. æºç éƒ¨åˆ†</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Serializable</span> &#123;<br><br>&#125;<br></code></pre></td></tr></table></figure><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.lang.AutoCloseableæºç è§£æ</title>
    <link href="/2025/10/10/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.AutoCloseable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/10/10/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.AutoCloseable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/10/10/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.AutoCloseable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/10/10/æºç ï¼šjava.lang.AutoCloseableæºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-AutoCloseable-æ¦‚è¿°"><a href="#3-1-AutoCloseable-æ¦‚è¿°" class="headerlink" title="3.1. AutoCloseable æ¦‚è¿°"></a>3.1. AutoCloseable æ¦‚è¿°</h3><p><code>AutoCloseable</code> æ˜¯ä¸€ä¸ªæ¥å£</p><p><code>AutoCloseable</code> æ¥å£é€šå¸¸ä¸ <code>try-with-resources</code> è¯­æ³•ç³–æ­é…ä½¿ç”¨</p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>åœ¨ä¼ ç»Ÿçš„ <code>try-catch-finally</code> è¯­å¥ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸éœ€è¦åœ¨ <code>finally</code> å—ä¸­ç¼–å†™é‡Šæ”¾èµ„æºçš„ <code>Java</code> ä»£ç ï¼Œè¿™ä¸ä»…å¢åŠ äº†ä»£ç å†—ä½™ï¼Œä¹Ÿå®¹æ˜“å› ä¸ºç–å¿½å¯¼è‡´èµ„æºæ³„æ¼</li><li>è€Œ <code>try-with-resources</code> æ˜¯ä¸€ç§è¯­æ³•ç³–ï¼Œåœ¨ç¼–è¯‘é˜¶æ®µä¼šè¢«ç¼–è¯‘å™¨è‡ªåŠ¨è½¬æ¢ä¸ºä»¥ä¸‹é€»è¾‘ï¼š<code>try</code> å—ä¸­ç¼–å†™çš„ <code>Java</code> ä»£ç æ‰§è¡Œå®Œæ¯•ï¼ˆæ— è®ºæ˜¯å¦æŠ›å‡ºå¼‚å¸¸ï¼‰æ—¶ï¼Œ<code>Java</code> ä¼šè‡ªåŠ¨è°ƒç”¨å®ç° <code>AutoCloseable</code> æ¥å£çš„å…·ä½“ç±»çš„ <code>AutoCloseable#close</code>ï¼Œä»¥ä¾¿å®‰å…¨ã€å¯é åœ°é‡Šæ”¾èµ„æºã€‚</li><li>ä½¿ç”¨ <code>try-with-resources</code> è¯­æ³•ç³–æ—¶ï¼Œæ— éœ€ä¹Ÿä¸åº”è¯¥æ‰‹åŠ¨é‡Šæ”¾èµ„æºã€‚ä¸€ä¸ªå…¸å‹çš„ <code>try-with-resources</code> è¯­æ³•ç³–çš„ <code>Java</code> ä»£ç å¦‚ä¸‹ï¼š</li></ol></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">try</span>(<span class="hljs-type">Resource</span> <span class="hljs-variable">resource</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Resource</span>()) &#123;<br>log.info(<span class="hljs-string">&quot;...&quot;</span>);<br>&#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>log.info(<span class="hljs-string">&quot;...&quot;</span>);<br>&#125; <span class="hljs-keyword">finally</span> &#123;<br>log.info(<span class="hljs-string">&quot;...&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><hr><h2 id="4-æºç éƒ¨åˆ†"><a href="#4-æºç éƒ¨åˆ†" class="headerlink" title="4. æºç éƒ¨åˆ†"></a>4. æºç éƒ¨åˆ†</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">AutoCloseable</span> &#123;<br><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">close</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception;<br>    <br>&#125;<br></code></pre></td></tr></table></figure><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.lang.Object æºç è§£æ</title>
    <link href="/2025/09/24/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.Object%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/09/24/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.Object%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/09/24/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.Object%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/09/24/æºç ï¼šjava.lang.Objectæºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-Object-æ¦‚è¿°"><a href="#3-1-Object-æ¦‚è¿°" class="headerlink" title="3.1. Object æ¦‚è¿°"></a>3.1. Object æ¦‚è¿°</h3><p><code>Object</code> æ˜¯ä¸€ä¸ªå…·ä½“ç±»</p><hr><h2 id="4-æºç éƒ¨åˆ†"><a href="#4-æºç éƒ¨åˆ†" class="headerlink" title="4. æºç éƒ¨åˆ†"></a>4. æºç éƒ¨åˆ†</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Object</span> &#123;<br><br>    <span class="hljs-meta">@IntrinsicCandidate</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Object</span><span class="hljs-params">()</span> &#123;&#125;<br><br><span class="hljs-comment">// ç”¨äºéé˜»å¡è·å–ç±»å¯¹è±¡</span><br>    <span class="hljs-meta">@IntrinsicCandidate</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">native</span> Class&lt;?&gt; getClass();<br><br><span class="hljs-comment">// ç”¨äºéé˜»å¡è·å–å“ˆå¸Œç </span><br>    <span class="hljs-meta">@IntrinsicCandidate</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">native</span> <span class="hljs-type">int</span> <span class="hljs-title function_">hashCode</span><span class="hljs-params">()</span>;<br><br><span class="hljs-comment">// ç”¨äºéé˜»å¡æ¯”è¾ƒæ˜¯å¦ â€ç›¸ç­‰â€œ</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// é»˜è®¤æ¯”è¾ƒçš„æ˜¯å†…å­˜åœ°å€</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">equals</span><span class="hljs-params">(Object obj)</span> &#123;<br>        <span class="hljs-keyword">return</span> (<span class="hljs-built_in">this</span> == obj);<br>    &#125;<br><br><span class="hljs-comment">// ç”¨äºé…ç½®å…‹éš†æœºåˆ¶ï¼Œè¯¦è§ç¬”è®°ï¼šGOF è®¾è®¡æ¨¡å¼ï¼ˆobsidian å†…éƒ¨é“¾æ¥ï¼š[ç¬”è®°ï¼šGOFè®¾è®¡æ¨¡å¼](ç¬”è®°ï¼šGOFè®¾è®¡æ¨¡å¼.md)ï¼ŒHexo é“¾æ¥ï¼šï¼‰</span><br>    <span class="hljs-meta">@IntrinsicCandidate</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">native</span> Object <span class="hljs-title function_">clone</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> CloneNotSupportedException;<br><br><span class="hljs-comment">// ç”¨äºéé˜»å¡è·å– â€å­—ç¬¦ä¸²è¡¨ç¤ºå½¢å¼â€œ</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">toString</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> getClass().getName() + <span class="hljs-string">&quot;@&quot;</span> + Integer.toHexString(hashCode());<br>    &#125;<br><br><span class="hljs-comment">// ç”¨äºéé˜»å¡å”¤é†’ Monitor çš„ WaitSet ä¸­çš„ â€œä»»æ„â€ ä¸€ä¸ª Thread å®ä¾‹ï¼Œè¢«å”¤é†’çš„ Thread å®ä¾‹è¢«ç›´æ¥æŠ•é€’åˆ° Monitor çš„ EntryList é˜Ÿåˆ—</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// æ‰€è°“çš„ â€œä»»æ„â€ æ˜¯æŒ‡ï¼šæ—¢ä¸æ˜¯ä¸¥æ ¼çš„éšæœºï¼Œä¹Ÿä¸ä¿è¯æ˜¯ç¬¬ä¸€ä¸ªï¼Œä¸åŒçš„ JVM å®ç°å¯èƒ½é‡‡ç”¨ä¸åŒçš„ç­–ç•¥</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// Object#notify æ˜¯å’Œ synchronized ç»‘å®šçš„ï¼Œå®ƒå¿…é¡»å‡ºç°åœ¨ synchronized ä»£ç å—ä¸­ï¼Œå¦åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼šæœ¬åœ°çº¿ç¨‹è¦æƒ³è°ƒç”¨ Object#notifyï¼Œå¿…é¡»å…ˆè·å– Monitor é”ã€‚</span><br>    <span class="hljs-meta">@IntrinsicCandidate</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">native</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">notify</span><span class="hljs-params">()</span>;<br><br><span class="hljs-comment">// ç”¨äºéé˜»å¡å”¤é†’ Monitor çš„ WaitSet ä¸­çš„æ‰€æœ‰ Thread å®ä¾‹ï¼Œè¢«å”¤é†’çš„ Thread å®ä¾‹è¢«ç›´æ¥æŠ•é€’åˆ° Monitor çš„ EntryList é˜Ÿåˆ—</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// Object#notify æ˜¯å’Œ synchronized ç»‘å®šçš„ï¼Œå®ƒå¿…é¡»å‡ºç°åœ¨ synchronized ä»£ç å—ä¸­ï¼Œå¦åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼šæœ¬åœ°çº¿ç¨‹è¦æƒ³è°ƒç”¨ Object#notifyï¼Œå¿…é¡»å…ˆè·å– Monitor é”ã€‚</span><br>    <span class="hljs-meta">@IntrinsicCandidate</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">native</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">notifyAll</span><span class="hljs-params">()</span>;<br><br><span class="hljs-comment">// ç”¨äºè®©æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ WAITING çŠ¶æ€ï¼Œå¹¶è¢«æŠ•é€’åˆ° Monitor çš„ WaitSet é˜Ÿåˆ—ï¼Œç­‰å¾…è¢«å”¤é†’ï¼ˆObject#notifyï¼‰ã€è¢«ä¸­æ–­</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ WAITING çŠ¶æ€åï¼Œèƒ½å“åº”ä¸­æ–­ã€‚çº¿ç¨‹è¢«å”¤é†’ï¼Œé‡æ–°è·å¾— CPU æ—¶é—´ç‰‡åï¼Œä¼šæŠ›å‡º InterruptedException å—æ£€å¼‚å¸¸ï¼Œå¹¶æ¸…é™¤ Thread å®ä¾‹çš„ä¸­æ–­çŠ¶æ€ï¼ˆå¼‚å¸¸é€€å‡ºæˆ–æ­£å¸¸é€€å‡ºï¼ˆå‘ç”Ÿå¼‚å¸¸ï¼‰ï¼Œè¦çœ‹æˆ‘ä»¬æ˜¯å¦å¯¹è¯¥å¼‚å¸¸è¿›è¡Œæ•è·å¹¶å¤„ç†ï¼‰</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// Object#wait æ˜¯å’Œ synchronized ç»‘å®šçš„ï¼Œå®ƒå¿…é¡»å‡ºç°åœ¨ synchronized ä»£ç å—ä¸­ï¼Œå¦åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼šæœ¬åœ°çº¿ç¨‹è¦æƒ³è°ƒç”¨ Object#waitï¼Œå¿…é¡»å…ˆè·å– Monitor é”ã€‚ä» Object#wait å”¤é†’çš„æœ¬åœ°çº¿ç¨‹ï¼ŒåŒæ ·ä¹Ÿéœ€è¦å…ˆè·å– Monitor é”æ‰èƒ½ç»§ç»­å‘ä¸‹æ‰§è¡Œã€‚ä» Object#wait å“åº”ä¸­æ–­çš„æœ¬åœ°çº¿ç¨‹ï¼ŒåŒæ ·ä¹Ÿéœ€è¦å…ˆè·å– Monitor é”æ‰èƒ½æŠ›å‡ºInterruptedException å¼‚å¸¸ã€‚</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">wait</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException &#123;<br>        wait(<span class="hljs-number">0L</span>);<br>    &#125;<br><br><span class="hljs-comment">// ç”¨äºè®©æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ TIMED_WAITING çŠ¶æ€ï¼Œå¹¶è¢«æŠ•é€’åˆ° Monitor çš„ WaitSet é˜Ÿåˆ—ï¼Œç­‰å¾…è¢«å”¤é†’ï¼ˆObject#notifyï¼‰ã€è¢«ä¸­æ–­</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ TIMED_WAITING çŠ¶æ€åï¼Œèƒ½å“åº”ä¸­æ–­ã€‚çº¿ç¨‹è¢«å”¤é†’ï¼Œé‡æ–°è·å¾— CPU æ—¶é—´ç‰‡åï¼Œä¼šæŠ›å‡º InterruptedException å—æ£€å¼‚å¸¸ï¼Œå¹¶æ¸…é™¤ Thread å®ä¾‹çš„ä¸­æ–­çŠ¶æ€ï¼ˆå¼‚å¸¸é€€å‡ºæˆ–æ­£å¸¸é€€å‡ºï¼ˆå‘ç”Ÿå¼‚å¸¸ï¼‰ï¼Œè¦çœ‹æˆ‘ä»¬æ˜¯å¦å¯¹è¯¥å¼‚å¸¸è¿›è¡Œæ•è·å¹¶å¤„ç†ï¼‰</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// Object#wait æ˜¯å’Œ synchronized ç»‘å®šçš„ï¼Œå®ƒå¿…é¡»å‡ºç°åœ¨ synchronized ä»£ç å—ä¸­ï¼Œå¦åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼šæœ¬åœ°çº¿ç¨‹è¦æƒ³è°ƒç”¨ Object#waitï¼Œå¿…é¡»å…ˆè·å– Monitor é”ã€‚ä» Object#wait å”¤é†’çš„æœ¬åœ°çº¿ç¨‹ï¼ŒåŒæ ·ä¹Ÿéœ€è¦å…ˆè·å– Monitor é”æ‰èƒ½ç»§ç»­å‘ä¸‹æ‰§è¡Œã€‚ä» Object#wait å“åº”ä¸­æ–­çš„æœ¬åœ°çº¿ç¨‹ï¼ŒåŒæ ·ä¹Ÿéœ€è¦å…ˆè·å– Monitor é”æ‰èƒ½æŠ›å‡ºInterruptedException å¼‚å¸¸ã€‚</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// æ¨èä½¿ç”¨ TimeUnit#timedWait æ›¿ä»£è¯¥æ–¹æ³•ï¼Œå› ä¸ºå…¶å¯è¯»æ€§æ›´å¥½ï¼šTimeUnit.SECONDES.timedWait(obj, 5)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">native</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">wait</span><span class="hljs-params">(<span class="hljs-type">long</span> timeoutMillis)</span> <span class="hljs-keyword">throws</span> InterruptedException;<br><br><span class="hljs-comment">// ç”¨äºè®©æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ TIMED_WAITING çŠ¶æ€ï¼Œå¹¶è¢«æŠ•é€’åˆ° Monitor çš„ WaitSet é˜Ÿåˆ—ï¼Œç­‰å¾…è¢«å”¤é†’ï¼ˆObject#notifyï¼‰ã€è¢«ä¸­æ–­</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ TIMED_WAITING çŠ¶æ€åï¼Œèƒ½å“åº”ä¸­æ–­ã€‚çº¿ç¨‹è¢«å”¤é†’ï¼Œé‡æ–°è·å¾— CPU æ—¶é—´ç‰‡åï¼Œä¼šæŠ›å‡º InterruptedException å—æ£€å¼‚å¸¸ï¼Œå¹¶æ¸…é™¤ Thread å®ä¾‹çš„ä¸­æ–­çŠ¶æ€ï¼ˆå¼‚å¸¸é€€å‡ºæˆ–æ­£å¸¸é€€å‡ºï¼ˆå‘ç”Ÿå¼‚å¸¸ï¼‰ï¼Œè¦çœ‹æˆ‘ä»¬æ˜¯å¦å¯¹è¯¥å¼‚å¸¸è¿›è¡Œæ•è·å¹¶å¤„ç†ï¼‰</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// Object#wait æ˜¯å’Œ synchronized ç»‘å®šçš„ï¼Œå®ƒå¿…é¡»å‡ºç°åœ¨ synchronized ä»£ç å—ä¸­ï¼Œå¦åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼šæœ¬åœ°çº¿ç¨‹è¦æƒ³è°ƒç”¨ Object#waitï¼Œå¿…é¡»å…ˆè·å– Monitor é”ã€‚ä» Object#wait å”¤é†’çš„æœ¬åœ°çº¿ç¨‹ï¼ŒåŒæ ·ä¹Ÿéœ€è¦å…ˆè·å– Monitor é”æ‰èƒ½ç»§ç»­å‘ä¸‹æ‰§è¡Œã€‚ä» Object#wait å“åº”ä¸­æ–­çš„æœ¬åœ°çº¿ç¨‹ï¼ŒåŒæ ·ä¹Ÿéœ€è¦å…ˆè·å– Monitor é”æ‰èƒ½æŠ›å‡ºInterruptedException å¼‚å¸¸ã€‚</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// æ¨èä½¿ç”¨ TimeUnit#timedWait æ›¿ä»£è¯¥æ–¹æ³•ï¼Œå› ä¸ºå…¶å¯è¯»æ€§æ›´å¥½ï¼šTimeUnit.SECONDES.timedWait(obj, 5)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">wait</span><span class="hljs-params">(<span class="hljs-type">long</span> timeoutMillis, <span class="hljs-type">int</span> nanos)</span> <span class="hljs-keyword">throws</span> InterruptedException &#123;<br>        <span class="hljs-keyword">if</span> (timeoutMillis &lt; <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">&quot;timeoutMillis value is negative&quot;</span>);<br>        &#125;<br><br>        <span class="hljs-keyword">if</span> (nanos &lt; <span class="hljs-number">0</span> || nanos &gt; <span class="hljs-number">999999</span>) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<br>                                <span class="hljs-string">&quot;nanosecond timeout value out of range&quot;</span>);<br>        &#125;<br><br>        <span class="hljs-keyword">if</span> (nanos &gt; <span class="hljs-number">0</span> &amp;&amp; timeoutMillis &lt; Long.MAX_VALUE) &#123;<br>            timeoutMillis++;<br>        &#125;<br><br>        wait(timeoutMillis);<br>    &#125;<br><br><span class="hljs-comment">// ç”¨äºé…ç½®å®ä¾‹çš„ finalization æœºåˆ¶ï¼Œè¯¦è§ç¬”è®°ï¼šJVM</span><br>    <span class="hljs-meta">@Deprecated(since=&quot;9&quot;)</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">finalize</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Throwable &#123; &#125;<br>    <br>&#125;<br></code></pre></td></tr></table></figure><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šIjava.time.nstant æºç è§£æ</title>
    <link href="/2025/09/16/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.time.Instant%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/09/16/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.time.Instant%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/09/16/%E6%BA%90%E7%A0%81%EF%BC%9AInstant%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/09/16/æºç ï¼šInstantæºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-Instant-æ¦‚è¿°"><a href="#3-1-Instant-æ¦‚è¿°" class="headerlink" title="3.1. Instant æ¦‚è¿°"></a>3.1. Instant æ¦‚è¿°</h3><p><code>Instant</code> è¡¨ç¤ºä¸€ä¸ªæ—¶é—´ç‚¹ï¼Œæ˜¯ä¸€ä¸ªè‡ª <code>1970-01-01 00:00:00 UTC</code> èµ·ç®—çš„ç§’æ•° + çº³ç§’æ•°ï¼Œå¯¹åº” <code>UTC</code> æ—¶é—´çº¿ä¸Šçš„æŸä¸ªåˆ»åº¦</p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>å®ƒç›¸å½“äº <code>Java</code> é‡Œçš„çº³ç§’çº§ <code>Unix</code> æ—¶é—´æˆ³</li></ol></blockquote><hr><h2 id="4-å¸¸ç”¨æ–¹æ³•"><a href="#4-å¸¸ç”¨æ–¹æ³•" class="headerlink" title="4. å¸¸ç”¨æ–¹æ³•"></a>4. å¸¸ç”¨æ–¹æ³•</h2><h3 id="4-1-æ„é€ æ–¹æ³•"><a href="#4-1-æ„é€ æ–¹æ³•" class="headerlink" title="4.1. æ„é€ æ–¹æ³•"></a>4.1. æ„é€ æ–¹æ³•</h3><h4 id="4-1-1-Instant-now"><a href="#4-1-1-Instant-now" class="headerlink" title="4.1.1. Instant.now()"></a>4.1.1. Instant.now()</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// æ„é€ ä¸€ä¸ªå½“å‰æ—¶é—´ç‚¹å¯¹åº”çš„ Instant å®ä¾‹</span><br><span class="hljs-type">Instant</span> <span class="hljs-variable">now</span> <span class="hljs-operator">=</span> Instant.now();<br></code></pre></td></tr></table></figure><hr><h4 id="4-1-2-Instant-ofEpochSecond-long-epochSecond"><a href="#4-1-2-Instant-ofEpochSecond-long-epochSecond" class="headerlink" title="4.1.2. Instant.ofEpochSecond (long epochSecond)"></a>4.1.2. Instant.ofEpochSecond (long epochSecond)</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// æ„é€ ä¸€ä¸ªç§’çº§ Unix æ—¶é—´æˆ³å¯¹åº”çš„ Instant å®ä¾‹</span><br><span class="hljs-type">Instant</span> <span class="hljs-variable">fromSeconds</span> <span class="hljs-operator">=</span> Instant.ofEpochSecond(<span class="hljs-number">1631788800</span>);<br></code></pre></td></tr></table></figure><hr><h4 id="4-1-3-Instant-ofEpochMilli-long-epochMilli"><a href="#4-1-3-Instant-ofEpochMilli-long-epochMilli" class="headerlink" title="4.1.3. Instant.ofEpochMilli (long epochMilli)"></a>4.1.3. Instant.ofEpochMilli (long epochMilli)</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// æ„é€ ä¸€ä¸ªæ¯«ç§’çº§ Unix æ—¶é—´æˆ³å¯¹åº”çš„ Instant å®ä¾‹</span><br><span class="hljs-type">Instant</span> <span class="hljs-variable">fromMillis</span>  <span class="hljs-operator">=</span> Instant.ofEpochMilli(<span class="hljs-number">1631788800000L</span>);<br></code></pre></td></tr></table></figure><hr><h3 id="4-2-å®ä¾‹æ–¹æ³•"><a href="#4-2-å®ä¾‹æ–¹æ³•" class="headerlink" title="4.2. å®ä¾‹æ–¹æ³•"></a>4.2. å®ä¾‹æ–¹æ³•</h3><h4 id="4-2-1-è·å–-Unix-æ—¶é—´æˆ³"><a href="#4-2-1-è·å–-Unix-æ—¶é—´æˆ³" class="headerlink" title="4.2.1. è·å– Unix æ—¶é—´æˆ³"></a>4.2.1. è·å– Unix æ—¶é—´æˆ³</h4><h5 id="4-2-1-1-long-getEpochSecond"><a href="#4-2-1-1-long-getEpochSecond" class="headerlink" title="4.2.1.1. long getEpochSecond()"></a>4.2.1.1. long getEpochSecond()</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * ============================================</span><br><span class="hljs-comment"> * 1. è®¿é—®ä¿®é¥°ç¬¦</span><br><span class="hljs-comment"> *      1. public</span><br><span class="hljs-comment"> *          1. å¤©ä¸‹çš†å…¬ï¼ˆEveryWhereï¼‰</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 2. éè®¿é—®ä¿®é¥°ç¬¦</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 3. æ–¹æ³•å‚æ•°</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 4. æŠ›å‡ºå¼‚å¸¸</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 5. è¿”å›å€¼</span><br><span class="hljs-comment"> *      1. æŸ Instant å®ä¾‹çš„ç§’çº§ Unix æ—¶é—´æˆ³</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 6. ä½œç”¨</span><br><span class="hljs-comment"> *      1. è·å–æŸ Instant å®ä¾‹çš„ç§’çº§ Unix æ—¶é—´æˆ³</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 7. æ³¨æ„äº‹é¡¹</span><br><span class="hljs-comment"> *      1. ä¼šæœ‰ç²¾åº¦æˆªæ–­</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * ============================================</span><br><span class="hljs-comment"> */</span><br><span class="hljs-type">long</span> <span class="hljs-variable">epochSecond</span> <span class="hljs-operator">=</span> xxInstant.getEpochSecond();<br></code></pre></td></tr></table></figure><hr><h5 id="4-2-1-2-long-toEpochMilli"><a href="#4-2-1-2-long-toEpochMilli" class="headerlink" title="4.2.1.2. long toEpochMilli()"></a>4.2.1.2. long toEpochMilli()</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * ============================================</span><br><span class="hljs-comment"> * 1. è®¿é—®ä¿®é¥°ç¬¦</span><br><span class="hljs-comment"> *      1. public</span><br><span class="hljs-comment"> *          1. å¤©ä¸‹çš†å…¬ï¼ˆEveryWhereï¼‰</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 2. éè®¿é—®ä¿®é¥°ç¬¦</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 3. æ–¹æ³•å‚æ•°</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 4. æŠ›å‡ºå¼‚å¸¸</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 5. è¿”å›å€¼</span><br><span class="hljs-comment"> *      1. è·å–æŸ Instant å®ä¾‹çš„æ¯«ç§’çº§ Unix æ—¶é—´æˆ³</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 6. ä½œç”¨</span><br><span class="hljs-comment"> *      1. è·å–æŸ Instant å®ä¾‹çš„æ¯«ç§’çº§ Unix æ—¶é—´æˆ³</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 7. æ³¨æ„äº‹é¡¹</span><br><span class="hljs-comment"> *      1. ä¼šæœ‰ç²¾åº¦æˆªæ–­</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * ============================================</span><br><span class="hljs-comment"> */</span><br><span class="hljs-type">long</span> <span class="hljs-variable">epochMilli</span> <span class="hljs-operator">=</span> xxInstant.toEpochMilli();<br></code></pre></td></tr></table></figure><hr><h5 id="4-2-1-3-int-getNano"><a href="#4-2-1-3-int-getNano" class="headerlink" title="4.2.1.3. int getNano()"></a>4.2.1.3. int getNano()</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * ============================================</span><br><span class="hljs-comment"> * 1. è®¿é—®ä¿®é¥°ç¬¦</span><br><span class="hljs-comment"> *      1. public</span><br><span class="hljs-comment"> *          1. å¤©ä¸‹çš†å…¬ï¼ˆEveryWhereï¼‰</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 2. éè®¿é—®ä¿®é¥°ç¬¦</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 3. æ–¹æ³•å‚æ•°</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 4. æŠ›å‡ºå¼‚å¸¸</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 5. è¿”å›å€¼</span><br><span class="hljs-comment"> *      1. æŸ Instant å®ä¾‹çš„ç§’å†…çš„çº³ç§’åç§»é‡</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 6. ä½œç”¨</span><br><span class="hljs-comment"> *      1. è·å–æŸ Instant å®ä¾‹çš„ç§’å†…çš„çº³ç§’åç§»é‡</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 7. æ³¨æ„äº‹é¡¹</span><br><span class="hljs-comment"> *      1. å¹¶ä¸æ˜¯è·å–æŸ Instant å®ä¾‹çš„çº³ç§’çº§ Unix æ—¶é—´æˆ³</span><br><span class="hljs-comment"> *      2. æƒ³è¦è·å–æŸ Instant å®ä¾‹çš„çº³ç§’çº§æ—¶é—´æˆ³ï¼Œå¯ä»¥ï¼šxxInstant.getEpochSecond() * 1_000_000_000L + xxInstant.getNano()</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * ============================================</span><br><span class="hljs-comment"> */</span><br><span class="hljs-type">int</span> <span class="hljs-variable">nano</span> <span class="hljs-operator">=</span> xxInstant.getNano();<br></code></pre></td></tr></table></figure><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>ç¬”è®°ï¼šJava æ—¥æœŸæ—¶é—´</title>
    <link href="/2025/09/16/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%97%A5%E6%9C%9F%E6%97%B6%E9%97%B4/"/>
    <url>/2025/09/16/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%97%A5%E6%9C%9F%E6%97%B6%E9%97%B4/</url>
    
    <content type="html"><![CDATA[<h1 id="ä¸€ã€TODO"><a href="#ä¸€ã€TODO" class="headerlink" title="ä¸€ã€TODO"></a>ä¸€ã€TODO</h1><ul><li><input disabled="" type="checkbox"> java.util.concurrent.TimeUnit</li><li><input disabled="" type="checkbox"> java.time.Duration</li></ul><hr><h1 id="äºŒã€è„‘å›¾"><a href="#äºŒã€è„‘å›¾" class="headerlink" title="äºŒã€è„‘å›¾"></a>äºŒã€è„‘å›¾</h1><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/09/16/%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E6%97%A5%E6%9C%9F%E6%97%B6%E9%97%B4/">http://blog.wangjia.ink/2025/09/16/ç¬”è®°ï¼šJavaæ—¥æœŸæ—¶é—´/</a></p></li><li><p>ä»£ç æ´ªè’ï¼ˆé¢è¯•å®å…¸ï¼‰<br>ğŸ‘‰ <a href="https://www.notion.so/Java-2b6974fbda5e80579ca9da17eb0c21f5?source=copy_link">https://www.notion.so/Java-2b6974fbda5e80579ca9da17eb0c21f5?source=copy_link</a></p></li></ol><hr><h1 id="ä¸‰ã€Java-æ—¥æœŸæ—¶é—´åŸºç¡€"><a href="#ä¸‰ã€Java-æ—¥æœŸæ—¶é—´åŸºç¡€" class="headerlink" title="ä¸‰ã€Java æ—¥æœŸæ—¶é—´åŸºç¡€"></a>ä¸‰ã€Java æ—¥æœŸæ—¶é—´åŸºç¡€</h1><h2 id="1-UTC-å’Œæ—¶åŒº"><a href="#1-UTC-å’Œæ—¶åŒº" class="headerlink" title="1. UTC å’Œæ—¶åŒº"></a>1. UTC å’Œæ—¶åŒº</h2><p><code>UTC (Coordinated Universal Time)</code> æ˜¯ä¸–ç•Œåè°ƒæ—¶ï¼Œæ˜¯å…¨ä¸–ç•Œç»Ÿä¸€çš„ â€œæ ‡å‡†æ—¶é—´â€ï¼Œåœ¨æœ¬åˆå­åˆçº¿ï¼ˆæ ¼æ—å°¼æ²»ï¼Œç»åº¦ <code>0Â°</code>ï¼‰ï¼Œè®°ä½œ <code>UTC+0</code></p><p>ä½†æ˜¯åœ°çƒæ˜¯åœ†çš„ï¼Œä¸åŒåœ°åŒºçš„æ—¥å‡ºæ—¥è½æ—¶é—´ä¸åŒã€‚å¦‚æœå…¨ä¸–ç•Œéƒ½ç›´æ¥ä½¿ç”¨ <code>UTC</code>ï¼Œå°±ä¼šå¾ˆæ··ä¹±ï¼šæ¯”å¦‚è‹±å›½äººè¯´ â€œæˆ‘æ—©ä¸Š <code>7</code> ç‚¹ä¸Šç­â€ï¼ŒåŒ—äº¬äººä¹Ÿè¯´ â€œæˆ‘æ—©ä¸Š <code>7</code> ç‚¹ä¸Šç­â€ï¼Œä½†å®é™…ä¸ŠåŒ—äº¬é‚£æ—¶å·²ç»æ˜¯ä¸‹åˆï¼Œå¤ªé˜³å¿«è¦è½å±±äº†ã€‚</p><p>å› æ­¤ï¼Œæˆ‘ä»¬å¼•å…¥äº†æ—¶åŒºï¼ˆ<code>Time Zone</code>ï¼‰ çš„æ¦‚å¿µï¼Œç”¨æ¥è§„å®šå„åœ°çš„æœ¬åœ°æ—¶é—´ã€‚ä¸–ç•Œè¢«åˆ’åˆ†ä¸º <code>24</code> ä¸ªæ—¶åŒºï¼Œæ¯ä¸ªæ—¶åŒºç›¸å¯¹äº <code>UTC</code> éƒ½æœ‰ä¸€ä¸ªå›ºå®šçš„åç§»é‡ï¼Œæœ¬åœ°æ—¶é—´å°±æ˜¯åœ¨ <code>UTC</code> çš„åŸºç¡€ä¸ŠåŠ ä¸Šè¿™ä¸ªåç§»é‡ï¼Œé€šå¸¸å†™ä½œ <code>UTC+X </code>æˆ– <code>UTC-X</code></p><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs subunit">UTC æ—¶é—´ï¼š  2025<span class="hljs-string">-09</span><span class="hljs-string">-16</span> 07:00:00<br>çº½çº¦æ—¶é—´ï¼š  2025<span class="hljs-string">-09</span><span class="hljs-string">-16</span> 03:00:00 (UTC<span class="hljs-string">-4</span>)<br>åŒ—äº¬æ—¶é—´ï¼š  2025<span class="hljs-string">-09</span><span class="hljs-string">-16</span> 15:00:00 (UTC<span class="hljs-string">+8</span>)<br>ä¸œäº¬æ—¶é—´ï¼š  2025<span class="hljs-string">-09</span><span class="hljs-string">-16</span> 16:00:00 (UTC<span class="hljs-string">+9</span>)<br></code></pre></td></tr></table></figure><hr><h2 id="2-ISO-8601-æ ‡å‡†"><a href="#2-ISO-8601-æ ‡å‡†" class="headerlink" title="2. ISO 8601 æ ‡å‡†"></a>2. ISO 8601 æ ‡å‡†</h2><p>æƒ³è±¡ä¸€ä¸‹è¿™ä¸ªåœºæ™¯ï¼šå½“æˆ‘ä»¬çœ‹åˆ° â€œ<code>03/04/05</code>â€ è¿™ç§æ—¥æœŸæ ¼å¼æ—¶ï¼Œä¸åŒå›½å®¶çš„äººå¯èƒ½ä¼šæœ‰ä¸åŒçš„ç†è§£ï¼š</p><ol><li>åœ¨ç¾å›½ï¼Œè¿™å¯èƒ½æ„å‘³ç€ <code>2005</code> å¹´<code>3</code> æœˆ <code>4</code> æ—¥ (<code>MM/DD/YY</code>)</li><li>åœ¨æ¬§æ´²ï¼Œè¿™å¯èƒ½æ„å‘³ç€ <code>2005</code> å¹´ <code>4</code> æœˆ <code>3</code> æ—¥ (<code>DD/MM/YY</code>)</li><li>åœ¨æ—¥æœ¬ï¼Œè¿™å¯èƒ½æ„å‘³ç€ <code>2005</code> å¹´ <code>4</code> æœˆ <code>3</code> æ—¥ (<code>YY/MM/DD</code>ï¼‰</li></ol><p>è¿™ç§æ··ä¹±åœ¨å›½é™…åŒ–çš„è½¯ä»¶å¼€å‘å’Œæ—¥å¿—åˆ†æä¸­å¯èƒ½æ˜¯è‡´å‘½çš„ï¼Œå› ä¸ºä¸åŒåœ°åŒºçš„æ—¥æœŸæ ¼å¼å·®å¼‚ææ˜“å¯¼è‡´æ•°æ®è§£æé”™è¯¯ã€æ—¶é—´æ’åºæ··ä¹±ï¼Œç”šè‡³ç³»ç»Ÿè¡Œä¸ºå¼‚å¸¸ã€‚</p><p>ä¸ºäº†è§£å†³è¿™ç§æ—¥æœŸæ ¼å¼ä¸Šçš„æ··ä¹±ï¼Œ<code>ISO 8601</code> æ ‡å‡† åº”è¿è€Œç”Ÿã€‚å®ƒç”±å›½é™…æ ‡å‡†åŒ–ç»„ç»‡ï¼ˆ<code>ISO</code>ï¼‰ åˆ¶å®šï¼Œæ˜¯ä¸€ç§ç”¨äºæ¶ˆé™¤æ—¥æœŸä¸æ—¶é—´è¡¨ç¤ºæ­§ä¹‰çš„å›½é™…é€šç”¨æ ¼å¼ï¼š</p><ol><li><code>YYYY-MM-DDTHH:mm:ssZ</code><ol><li><code>Z</code> è¡¨ç¤ºæ—¶é—´ä¸º <code>UTC</code></li><li>ä¾‹å¦‚ <code>2025-10-24T09:30:00Z</code></li></ol></li><li><code>YYYY-MM-DDTHH:mm:ss.SSSÂ±HH:mm</code><ol><li><code>Â±HH:mm</code> è¡¨ç¤ºç›¸å¯¹äº <code>UTC</code> çš„æ—¶åŒºåç§»é‡</li><li>ä¾‹å¦‚ <code>2025-10-24T01:30:00+09:00</code>ã€<code>2025-10-24T01:30:00-05:00</code></li></ol></li></ol><hr><h2 id="3-Unix-æ—¶é—´æˆ³"><a href="#3-Unix-æ—¶é—´æˆ³" class="headerlink" title="3. Unix æ—¶é—´æˆ³"></a>3. Unix æ—¶é—´æˆ³</h2><p>æœ€æ—©çš„ <code>Unix</code> æ—¶é—´æˆ³æŒ‡çš„æ˜¯ï¼šä» <code>1970-01-01 00:00:00 UTC</code> åˆ°æŸä¸€æ—¶åˆ»ç»è¿‡çš„ç§’æ•°ï¼Œå¯¹åº” <code>UTC</code> æ—¶é—´çº¿ä¸Šçš„æŸä¸ªåˆ»åº¦ã€‚ä½†æ˜¯éšç€ç³»ç»Ÿç²¾åº¦æé«˜ï¼Œå¾ˆå¤šè¯­è¨€ æˆ– åº“ï¼ˆæ¯”å¦‚ <code>Java</code>ã€<code>JavaScript</code>ï¼‰æŠŠæ—¶é—´æˆ³æ‰©å±•åˆ°äº†æ¯«ç§’ç”šè‡³æ˜¯çº³ç§’çº§</p><p>åœ¨ <code>Java</code> ä¸­è·å– <code>Unix</code> æ—¶é—´æˆ³çš„å¸¸ç”¨æ–¹å¼ï¼š</p><ol><li>ç§’çº§ <code>Unix</code> æ—¶é—´æˆ³<ol><li><code>Instant#getEpochSecond</code><ol><li>åªæˆªå–ç§’æ•°éƒ¨åˆ†ï¼Œæˆªæ–­äº†ç²¾åº¦</li></ol></li><li><code>System.currentTimeMillis() / 1000</code></li></ol></li><li>æ¯«ç§’çº§ <code>Unix</code> æ—¶é—´æˆ³<ol><li><code>Instant#toEpochMilli</code><ol><li>åªæˆªå–æ¯«ç§’çº§éƒ¨åˆ†ï¼Œæˆªæ–­äº†ç²¾åº¦</li></ol></li><li><code>System.currentTimeMillis</code></li></ol></li><li>çº³ç§’çº§ <code>Unix</code> æ—¶é—´æˆ³<ol><li><code>Instant#getEpochSecond() * 1_000_000_000L + Instant#getNano()</code>ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸ä¼šä¸¢å¤±æ¯«ç§’çº§ç²¾åº¦ï¼Œåªæ˜¯è¢«åŒ…å«åœ¨çº³ç§’çº§æ—¶é—´æˆ³é‡Œäº†</li></ol></li></ol><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li><code>Unix</code> æ—¶é—´æˆ³æ˜¯ç»å¯¹ä¸å¸¦æ—¶åŒºçš„</li><li><code>UTC</code> æ—¶é—´æˆ³å°±æ˜¯ç§’çº§ <code>Unix</code> æ—¶é—´æˆ³</li></ol></blockquote><hr><h1 id="å››ã€java-time-Instant"><a href="#å››ã€java-time-Instant" class="headerlink" title="å››ã€java.time.Instant"></a>å››ã€java.time.Instant</h1><p>è¯¦è§æºç ï¼š<code>Instant</code></p><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.time.Instant%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.time.Instantæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/09/16/%E6%BA%90%E7%A0%81%EF%BC%9AInstant%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/09/16/æºç ï¼šInstantæºç è§£æ/</a></li></ol></li></ol><hr>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
      <category>Java æ—¥æœŸæ—¶é—´</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.util.concurrent.ExecutorService æºç è§£æ</title>
    <link href="/2025/09/03/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ExecutorService%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/09/03/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ExecutorService%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/09/03/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ExecutorService%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/09/03/æºç ï¼šjava.util.concurrent.ExecutorServiceæºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="ExecutorService-æ¦‚è¿°"><a href="#ExecutorService-æ¦‚è¿°" class="headerlink" title="ExecutorService æ¦‚è¿°"></a>ExecutorService æ¦‚è¿°</h3><p><code>ExecutorService</code> æ˜¯ä¸€ä¸ªæ¥å£ï¼Œç»§æ‰¿äº† <code>java.util.concurrent.Executor</code><br><img src="/source/_posts/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ExecutorService%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ExecutorService%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.png"></p><p><code>ExecutorService</code> åœ¨ <code>Executor</code> çš„åŸºç¡€ä¸Šï¼Œä¸ºæˆ‘ä»¬æä¾›äº†ä»¥ä¸‹æ–¹æ³•ï¼š</p><ol><li>å…³é—­çº¿ç¨‹æ± ï¼ˆéé˜»å¡ï¼‰</li><li>ç­‰å¾…çº¿ç¨‹æ± å…³é—­ï¼ˆé™æ—¶é˜»å¡ï¼‰</li><li>æŸ¥çœ‹çº¿ç¨‹æ± æ˜¯å¦å…³é—­ï¼ˆéé˜»å¡ï¼‰</li><li>æŸ¥çœ‹çº¿ç¨‹æ± æ˜¯å¦è¢«æ‰§è¡Œè¿‡ <code>ExecutorService#shutdown</code> æˆ– <code>ExecutorService#shutdownNow</code>ï¼ˆéé˜»å¡ï¼‰</li><li>æäº¤ä¸€ä¸ª <code>Callable</code> ä»»åŠ¡ï¼ˆéé˜»å¡ï¼‰</li><li>æäº¤ä¸€ä¸ª <code>Runnable</code> ä»»åŠ¡ï¼ˆéé˜»å¡ï¼‰</li><li>æäº¤ä¸€æ‰¹ <code>Callable</code> ä»»åŠ¡ï¼ˆé˜»å¡ã€é™æ—¶é˜»å¡ï¼‰</li></ol><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>è¯¦è§æºç ï¼š<code>Executor</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.Executor%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.Executoræºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/08/31/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.Executor%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/08/31/æºç ï¼šjava.util.concurrent.Executoræºç è§£æ/</a></li></ol></li></ol></li></ol></blockquote><hr><h2 id="2-æºç éƒ¨åˆ†"><a href="#2-æºç éƒ¨åˆ†" class="headerlink" title="2. æºç éƒ¨åˆ†"></a>2. æºç éƒ¨åˆ†</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">ExecutorService</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Executor</span> &#123;<br><br><span class="hljs-comment">// ç”¨äºéé˜»å¡æœ‰åºå…³é—­çº¿ç¨‹æ± </span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// </span><br><span class="hljs-comment">// å·²æäº¤çš„ä»»åŠ¡ä¼šç»§ç»­æ‰§è¡Œï¼Œä½†çº¿ç¨‹æ± ä¸ä¼šå†æ¥æ”¶æ–°çš„ä»»åŠ¡</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">shutdown</span><span class="hljs-params">()</span>;<br><br><span class="hljs-comment">// ç”¨äºéé˜»å¡å¼ºåˆ¶å…³é—­çº¿ç¨‹æ± </span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// æ­£åœ¨è¿è¡Œçš„ä»»åŠ¡ä¼šè¢«åœæ­¢ï¼Œå¹¶ä¸”è¿”å›è¿˜æ²¡å¼€å§‹æ‰§è¡Œçš„ Runnable ä»»åŠ¡åˆ—è¡¨ï¼Œçº¿ç¨‹æ± ä¸ä¼šå†æ¥æ”¶æ–°çš„ä»»åŠ¡</span><br>    List&lt;Runnable&gt; <span class="hljs-title function_">shutdownNow</span><span class="hljs-params">()</span>;<br><br><span class="hljs-comment">// ç”¨äºéé˜»å¡æŸ¥çœ‹çº¿ç¨‹æ± æ˜¯å¦è¢«æ‰§è¡Œè¿‡ ExecutorService#shutdown æˆ– ExecutorService#shutdownNow</span><br>    <span class="hljs-type">boolean</span> <span class="hljs-title function_">isShutdown</span><span class="hljs-params">()</span>;<br><br><span class="hljs-comment">// ç”¨äºéé˜»å¡æŸ¥çœ‹çº¿ç¨‹æ± æ˜¯å¦å…³é—­</span><br>    <span class="hljs-type">boolean</span> <span class="hljs-title function_">isTerminated</span><span class="hljs-params">()</span>;<br><br><span class="hljs-comment">// ç”¨äºé™æ—¶é˜»å¡ç­‰å¾…çº¿ç¨‹æ± å…³é—­</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// é™æ—¶é˜»å¡è¢«å…è®¸çš„æœ€é•¿æ—¶é—´ä¸ºï¼štimeout unit</span><br><span class="hljs-comment">//     1. å¦‚æœè¶…æ—¶ï¼Œè¿”å› false</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// å¦‚æœçº¿ç¨‹æ± æœªå…³é—­ï¼Œæœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ TIMED_WAITING çŠ¶æ€ï¼Œå¹¶è¢«æŠ•é€’åˆ° ExecutorService æ¥å£çš„å…·ä½“å®ç°ç±»ç»´æŠ¤çš„æŸæ•°æ®ç»“æ„ï¼Œç­‰å¾…è¢«å”¤é†’ï¼ˆLockSupport.unparkï¼‰ã€è¢«ä¸­æ–­ï¼ˆThread#interruptï¼‰ã€é˜»å¡è¶…æ—¶</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ TIMED_WAITING çŠ¶æ€åï¼Œèƒ½å“åº”ä¸­æ–­ã€‚çº¿ç¨‹è¢«å”¤é†’ï¼Œé‡æ–°è·å¾— CPU æ—¶é—´ç‰‡åï¼Œä¼šæŠ›å‡º InterruptedException å¼‚å¸¸ï¼Œå¹¶æ¸…é™¤ Thread å®ä¾‹çš„ä¸­æ–­çŠ¶æ€ï¼ˆå¼‚å¸¸é€€å‡ºæˆ–æ­£å¸¸é€€å‡ºï¼ˆå‘ç”Ÿå¼‚å¸¸ï¼‰ï¼Œè¦çœ‹æˆ‘ä»¬æ˜¯å¦å¯¹è¯¥å¼‚å¸¸è¿›è¡Œæ•è·å¹¶å¤„ç†ï¼‰</span><br>    <span class="hljs-type">boolean</span> <span class="hljs-title function_">awaitTermination</span><span class="hljs-params">(<span class="hljs-type">long</span> timeout, TimeUnit unit)</span><br>        <span class="hljs-keyword">throws</span> InterruptedException;<br><br><span class="hljs-comment">// ç”¨äºéé˜»å¡æäº¤ä¸€ä¸ª Callable ä»»åŠ¡</span><br>    &lt;T&gt; Future&lt;T&gt; <span class="hljs-title function_">submit</span><span class="hljs-params">(Callable&lt;T&gt; task)</span>;<br><br><span class="hljs-comment">// ç”¨äºéé˜»å¡æäº¤ä¸€ä¸ª Runnable ä»»åŠ¡ï¼Œå¹¶æ‰‹åŠ¨æŒ‡å®šä¸€ä¸ªä»»åŠ¡ç»“æœ</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// å› ä¸º Runnable ä»»åŠ¡æ²¡æœ‰è¿”å›ç»“æœï¼Œå¦‚æœä½ éœ€è¦ä¸€ä¸ªè¿”å›ç»“æœçš„è¯ï¼Œå¯ä»¥æ‰‹åŠ¨æŒ‡å®š</span><br>    &lt;T&gt; Future&lt;T&gt; <span class="hljs-title function_">submit</span><span class="hljs-params">(Runnable task, T result)</span>;<br><br><span class="hljs-comment">// ç”¨äºéé˜»å¡æäº¤ä¸€ä¸ª Runnable ä»»åŠ¡</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// è¯¥æ–¹æ³•ä¸ Executor#execute çš„åŒºåˆ«åœ¨äºï¼š</span><br><span class="hljs-comment">//     1. Executor#execute åªç®¡æäº¤ï¼Œä¸é—®ç»“æœã€‚å®ƒæ²¡æœ‰è¿”å›å€¼ï¼Œä½ æ— æ³•çŸ¥é“ä»»åŠ¡æ˜¯å¦æ‰§è¡ŒæˆåŠŸï¼Œä¹Ÿæ— æ³•çŸ¥é“ä»»åŠ¡çš„æ‰§è¡Œç»“æœ</span><br><span class="hljs-comment">//     2. è€Œ ExecutorService.submit æ˜¯æäº¤ä»»åŠ¡ï¼Œè¿”å›è¯¥ä»»åŠ¡å¯¹åº”çš„ Future æ¥å£çš„å…·ä½“å®ç°ç±»å®ä¾‹ã€‚æˆ‘ä»¬å¯ä»¥æ ¹æ®è¿”å›çš„ Future æ¥å£çš„å…·ä½“å®ç°ç±»å®ä¾‹å¯¹è¯¥ä»»åŠ¡è¿›è¡Œä¸€ç³»åˆ—æ“ä½œ</span><br><span class="hljs-comment">//     3. éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœä½ æäº¤çš„æ˜¯ Runnable ä»»åŠ¡ï¼Œå³ä¾¿ä½ ä½¿ç”¨ Future æ¥å£çš„å…·ä½“å®ç°ç±»å®ä¾‹è·å–è¯¥ä»»åŠ¡çš„ç»“æœï¼Œä¹Ÿåªä¼šæ˜¯ null æˆ–æˆ‘ä»¬æ‰‹åŠ¨æŒ‡å®šçš„ä»»åŠ¡ç»“æœã€‚æˆ‘ä»¬é€šå¸¸ä½¿ç”¨ Future æ¥å£çš„å…·ä½“å®ç°ç±»å®ä¾‹è·å– Callable ä»»åŠ¡çš„ç»“æœ</span><br>    Future&lt;?&gt; submit(Runnable task);<br>    <br>    <span class="hljs-comment">// ç”¨äºé˜»å¡æäº¤ä¸€æ‰¹ Callable ä»»åŠ¡ï¼Œå¹¶ç­‰å¾…æ‰€æœ‰ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼ˆæ­£å¸¸é€€å‡ºã€å¼‚å¸¸é€€å‡ºã€å–æ¶ˆä»»åŠ¡ï¼‰åï¼Œå†è¿”å›è¿™äº›ä»»åŠ¡å¯¹åº”çš„ Futureæ¥å£çš„å…·ä½“å®ç°ç±»å®ä¾‹åˆ—è¡¨</span><br>    <span class="hljs-comment">//</span><br>    <span class="hljs-comment">// åœ¨ç­‰å¾…ä»»åŠ¡æ‰§è¡Œå®Œæ¯•çš„è¿‡ç¨‹ä¸­ï¼Œæœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ WAITING çŠ¶æ€ï¼Œç­‰å¾…è¢«å”¤é†’ï¼ˆLockSupport.unparkï¼‰ã€è¢«ä¸­æ–­ï¼ˆThread#interruptï¼‰</span><br>    <span class="hljs-comment">// </span><br>    <span class="hljs-comment">// æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ WAITING çŠ¶æ€åï¼Œèƒ½å“åº”ä¸­æ–­ã€‚çº¿ç¨‹è¢«å”¤é†’ï¼Œé‡æ–°è·å¾— CPU æ—¶é—´ç‰‡åï¼Œä¼šæŠ›å‡º InterruptedException å¼‚å¸¸ï¼Œå¹¶æ¸…é™¤ Thread å®ä¾‹çš„ä¸­æ–­çŠ¶æ€ï¼ˆå¼‚å¸¸é€€å‡ºæˆ–æ­£å¸¸é€€å‡ºï¼ˆå‘ç”Ÿå¼‚å¸¸ï¼‰ï¼Œè¦çœ‹æˆ‘ä»¬æ˜¯å¦å¯¹è¯¥å¼‚å¸¸è¿›è¡Œæ•è·å¹¶å¤„ç†ï¼‰</span><br>    <span class="hljs-comment">//</span><br>    <span class="hljs-comment">// éœ€è¦æ³¨æ„çš„æ˜¯ï¼š</span><br>    <span class="hljs-comment">//     1. å®ƒå¹¶ä¸åƒä¼ ç»Ÿæ¨¡å¼é‚£æ ·å°†ä»»åŠ¡ç»Ÿä¸€æŠ•é€’åˆ°æŸä¸ªå›ºå®šçš„æ•°æ®ç»“æ„ä¸­ï¼Œè€Œæ˜¯å¾ªç¯è°ƒç”¨æ¯ä¸ª Future æ¥å£çš„å…·ä½“å®ç°ç±»å®ä¾‹çš„ Future#get</span><br>    <span class="hljs-comment">//     2. å› æ­¤ Thread å®ä¾‹å¯èƒ½è¢«æŠ•é€’åˆ°å¤šä¸ª Future æ¥å£çš„å…·ä½“å®ç°ç±»å®ä¾‹ç»´æŠ¤çš„æŸæ•°æ®ç»“æ„</span><br>    <span class="hljs-comment">//     3. é™¤æ­¤ä¹‹å¤–ï¼Œè¿™è¿˜æ„å‘³ç€é˜»å¡çŠ¶æ€ä¹Ÿæ˜¯ä¸€æ®µä¸€æ®µçš„ï¼Œè€Œä¸æ˜¯ä»å¤´åˆ°å°¾ä¸€ç›´é˜»å¡</span><br>    &lt;T&gt; List&lt;Future&lt;T&gt;&gt; <span class="hljs-title function_">invokeAll</span><span class="hljs-params">(Collection&lt;? extends Callable&lt;T&gt;&gt; tasks)</span><br>        <span class="hljs-keyword">throws</span> InterruptedException;<br><br>    <span class="hljs-comment">// ç”¨äºé™æ—¶é˜»å¡æäº¤ä¸€æ‰¹ Callable ä»»åŠ¡ï¼Œå¹¶ç­‰å¾…æ‰€æœ‰ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼ˆæ­£å¸¸é€€å‡ºã€å¼‚å¸¸é€€å‡ºã€å–æ¶ˆä»»åŠ¡ï¼‰åï¼Œå†è¿”å›è¿™äº›ä»»åŠ¡å¯¹åº”çš„ Future æ¥å£çš„å…·ä½“å®ç°ç±»å®ä¾‹åˆ—è¡¨</span><br>    <span class="hljs-comment">//</span><br>    <span class="hljs-comment">// é™æ—¶é˜»å¡è¢«å…è®¸çš„æœ€é•¿æ—¶é—´ä¸ºï¼štimeout unit</span><br>    <span class="hljs-comment">//     1. å¦‚æœè¶…æ—¶ï¼Œä¼šæ’¤é”€å°šæœªæ‰§è¡Œçš„ä»»åŠ¡</span><br>    <span class="hljs-comment">//</span><br>    <span class="hljs-comment">// åœ¨ç­‰å¾…ä»»åŠ¡æ‰§è¡Œå®Œæ¯•çš„è¿‡ç¨‹ä¸­ï¼Œæœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ TIMED_WAITING çŠ¶æ€ï¼Œç­‰å¾…è¢«å”¤é†’ï¼ˆLockSupport.unparkï¼‰ã€è¢«ä¸­æ–­ï¼ˆThread#interruptï¼‰ã€é˜»å¡è¶…æ—¶</span><br>    <span class="hljs-comment">//</span><br>    <span class="hljs-comment">// æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ TIMED_WAITING çŠ¶æ€åï¼Œèƒ½å“åº”ä¸­æ–­ã€‚çº¿ç¨‹è¢«å”¤é†’ï¼Œé‡æ–°è·å¾— CPU æ—¶é—´ç‰‡åï¼Œä¼šæŠ›å‡º InterruptedException å¼‚å¸¸ï¼Œå¹¶æ¸…é™¤ Thread å®ä¾‹çš„ä¸­æ–­çŠ¶æ€ï¼ˆå¼‚å¸¸é€€å‡ºæˆ–æ­£å¸¸é€€å‡ºï¼ˆå‘ç”Ÿå¼‚å¸¸ï¼‰ï¼Œè¦çœ‹æˆ‘ä»¬æ˜¯å¦å¯¹è¯¥å¼‚å¸¸è¿›è¡Œæ•è·å¹¶å¤„ç†ï¼‰</span><br>    <span class="hljs-comment">//</span><br>    <span class="hljs-comment">// éœ€è¦æ³¨æ„çš„æ˜¯ï¼š</span><br>    <span class="hljs-comment">//     1. å®ƒå¹¶ä¸åƒä¼ ç»Ÿæ¨¡å¼é‚£æ ·å°†ä»»åŠ¡ç»Ÿä¸€æŠ•é€’åˆ°æŸä¸ªå›ºå®šçš„æ•°æ®ç»“æ„ä¸­ï¼Œè€Œæ˜¯å¾ªç¯è°ƒç”¨æ¯ä¸ª Future æ¥å£çš„å…·ä½“å®ç°ç±»å®ä¾‹çš„ Future#get</span><br>    <span class="hljs-comment">//     2. å› æ­¤ Thread å®ä¾‹å¯èƒ½è¢«æŠ•é€’åˆ°å¤šä¸ª Future æ¥å£çš„å…·ä½“å®ç°ç±»å®ä¾‹ç»´æŠ¤çš„æŸæ•°æ®ç»“æ„</span><br>    <span class="hljs-comment">//     3. é™¤æ­¤ä¹‹å¤–ï¼Œè¿™è¿˜æ„å‘³ç€é˜»å¡çŠ¶æ€ä¹Ÿæ˜¯ä¸€æ®µä¸€æ®µçš„ï¼Œè€Œä¸æ˜¯ä»å¤´åˆ°å°¾ä¸€ç›´é˜»å¡</span><br>&lt;T&gt; List&lt;Future&lt;T&gt;&gt; <span class="hljs-title function_">invokeAll</span><span class="hljs-params">(Collection&lt;? extends Callable&lt;T&gt;&gt; tasks,</span><br><span class="hljs-params">  <span class="hljs-type">long</span> timeout, TimeUnit unit)</span><br><span class="hljs-keyword">throws</span> InterruptedException;<br><br><span class="hljs-comment">// ç”¨äºé˜»å¡æäº¤ä¸€æ‰¹ Callable ä»»åŠ¡ï¼Œç­‰å¾… â€œä»»æ„â€ ä¸” â€œç¬¬ä¸€ä¸ªâ€ ä»»åŠ¡æ‰§è¡ŒæˆåŠŸï¼ˆæ­£å¸¸é€€å‡ºï¼‰ï¼Œç«‹å³è¿”å›è¯¥ä»»åŠ¡çš„ç»“æœï¼ˆå¹¶ä¸æ˜¯è¯¥ä»»åŠ¡å¯¹åº”çš„ Future æ¥å£çš„å…·ä½“å®ç°ç±»å®ä¾‹ï¼‰ï¼Œå¹¶æ’¤é”€å°šæœªæ‰§è¡Œçš„ä»»åŠ¡å’Œåœæ­¢æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// åœ¨ç­‰å¾… â€œä»»æ„â€ ä¸” â€œç¬¬ä¸€ä¸ªâ€ ä»»åŠ¡æ‰§è¡Œç¨‹åºçš„è¿‡ç¨‹ä¸­ï¼Œæœ¬åœ°çº¿ç¨‹è¿›å…¥ WAITING çŠ¶æ€ï¼Œå¹¶è¢«æŠ•é€’åˆ° ExecutorCompletionService ç»´æŠ¤çš„æŸæ•°æ®ç»“æ„ï¼Œç­‰å¾…è¢«å”¤é†’ï¼ˆLockSupport.unparkï¼‰ã€è¢«ä¸­æ–­ï¼ˆThread#interruptï¼‰</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ WAITING çŠ¶æ€åï¼Œèƒ½å“åº”ä¸­æ–­ã€‚çº¿ç¨‹è¢«å”¤é†’ï¼Œé‡æ–°è·å¾— CPU æ—¶é—´ç‰‡åï¼Œä¼šæŠ›å‡º InterruptedException å¼‚å¸¸ï¼Œå¹¶æ¸…é™¤ Thread å®ä¾‹çš„ä¸­æ–­çŠ¶æ€ï¼ˆå¼‚å¸¸é€€å‡ºæˆ–æ­£å¸¸é€€å‡ºï¼ˆå‘ç”Ÿå¼‚å¸¸ï¼‰ï¼Œè¦çœ‹æˆ‘ä»¬æ˜¯å¦å¯¹è¯¥å¼‚å¸¸è¿›è¡Œæ•è·å¹¶å¤„ç†ï¼‰</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// å¦‚æœæ‰€æœ‰ä»»åŠ¡éƒ½æ‰§è¡Œå¤±è´¥ï¼Œä¼šæŠ›å‡º ExecutionException å¼‚å¸¸</span><br>    &lt;T&gt; T <span class="hljs-title function_">invokeAny</span><span class="hljs-params">(Collection&lt;? extends Callable&lt;T&gt;&gt; tasks)</span><br>        <span class="hljs-keyword">throws</span> InterruptedException, ExecutionException;<br><br><span class="hljs-comment">// ç”¨äºé™æ—¶é˜»å¡æäº¤ä¸€æ‰¹ Callable ä»»åŠ¡ï¼Œç­‰å¾… â€œä»»æ„â€ ä¸” â€œç¬¬ä¸€ä¸ªâ€ ä»»åŠ¡æ‰§è¡ŒæˆåŠŸï¼ˆæ­£å¸¸é€€å‡ºï¼‰ï¼Œç«‹å³è¿”å›è¯¥ä»»åŠ¡çš„ç»“æœï¼ˆå¹¶ä¸æ˜¯è¯¥ä»»åŠ¡å¯¹åº”çš„ Future å®ä¾‹ï¼‰ï¼Œå¹¶ â€œå°½åŠ›â€ å–æ¶ˆæœªæ‰§è¡Œçš„ä»»åŠ¡å’Œåœæ­¢æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// é™æ—¶é˜»å¡è¢«å…è®¸çš„æœ€é•¿æ—¶é—´ä¸ºï¼štimeout unit</span><br><span class="hljs-comment">//     1. å¦‚æœè¶…æ—¶ï¼Œä¼šæŠ›å‡º TimeoutException å¼‚å¸¸</span><br><span class="hljs-comment">// </span><br><span class="hljs-comment">// åœ¨ç­‰å¾… â€œä»»æ„â€ ä¸” â€œç¬¬ä¸€ä¸ªâ€ ä»»åŠ¡æ‰§è¡Œç¨‹åºçš„è¿‡ç¨‹ä¸­ï¼Œæœ¬åœ°çº¿ç¨‹è¿›å…¥ TIMED_WAITING çŠ¶æ€ï¼Œå¹¶è¢«æŠ•é€’åˆ° ExecutorCompletionService ç»´æŠ¤çš„æŸæ•°æ®ç»“æ„ï¼Œç­‰å¾…è¢«å”¤é†’ï¼ˆLockSupport.unparkï¼‰ã€è¢«ä¸­æ–­ï¼ˆThread#interruptï¼‰ã€é˜»å¡è¶…æ—¶</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ TIMED_WAITING çŠ¶æ€åï¼Œèƒ½å“åº”ä¸­æ–­ã€‚çº¿ç¨‹è¢«å”¤é†’ï¼Œé‡æ–°è·å¾— CPU æ—¶é—´ç‰‡åï¼Œä¼šæŠ›å‡º InterruptedException å¼‚å¸¸ï¼Œå¹¶æ¸…é™¤ Thread å®ä¾‹çš„ä¸­æ–­çŠ¶æ€ï¼ˆå¼‚å¸¸é€€å‡ºæˆ–æ­£å¸¸é€€å‡ºï¼ˆå‘ç”Ÿå¼‚å¸¸ï¼‰ï¼Œè¦çœ‹æˆ‘ä»¬æ˜¯å¦å¯¹è¯¥å¼‚å¸¸è¿›è¡Œæ•è·å¹¶å¤„ç†ï¼‰</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// å¦‚æœæ‰€æœ‰ä»»åŠ¡éƒ½æ‰§è¡Œå¤±è´¥ï¼Œä¼šæŠ›å‡º ExecutionException å¼‚å¸¸</span><br>&lt;T&gt; T <span class="hljs-title function_">invokeAny</span><span class="hljs-params">(Collection&lt;? extends Callable&lt;T&gt;&gt; tasks,</span><br><span class="hljs-params"><span class="hljs-type">long</span> timeout, TimeUnit unit)</span><br><span class="hljs-keyword">throws</span> InterruptedException, ExecutionException, TimeoutException;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>å–æ¶ˆä»»åŠ¡å’Œåœæ­¢ä»»åŠ¡è¿˜æ˜¯æœ‰æ‰€åŒºåˆ«çš„ï¼šå–æ¶ˆä»»åŠ¡æ˜¯æŒ‡å–æ¶ˆé‚£äº›å°šæœªæ‰§è¡Œçš„ä»»åŠ¡ã€‚è€Œåœæ­¢ä»»åŠ¡åˆ™æ˜¯ä»»åŠ¡æ­£åœ¨æ‰§è¡Œæ—¶ï¼Œä½ é€šè¿‡ä¸­æ–­å»è®©å®ƒåœä¸‹æ¥ã€‚å¦‚æœä»»åŠ¡èƒ½å¤Ÿå“åº”ä¸­æ–­ï¼Œé‚£å°±ç®—æ˜¯æˆåŠŸåœæ­¢ã€‚ä½†é—®é¢˜åœ¨äºï¼Œå¦‚æœä»»åŠ¡æ²¡æœ‰å“åº”ä¸­æ–­ï¼Œé‚£ä¹ˆå³ä½¿ä½ å‘å‡ºäº†ä¸­æ–­è¯·æ±‚ï¼Œå®ƒä»ç„¶ä¼šç»§ç»­æ‰§è¡Œã€‚æ‰€ä»¥ â€œåœæ­¢ä»»åŠ¡â€ å¹¶ä¸ä¸€å®šèƒ½è®©å®ƒ â€œåœæ­¢ä¸‹æ¥â€</li></ol></blockquote><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.util.concurrent.ThreadPoolExecutor æºç è§£æ</title>
    <link href="/2025/09/03/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ThreadPoolExecutor%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/09/03/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ThreadPoolExecutor%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/09/03/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ThreadPoolExecutor%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/09/03/æºç ï¼šjava.util.concurrent.ThreadPoolExecutoræºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-ThreadPoolExecutor-æ¦‚è¿°"><a href="#3-1-ThreadPoolExecutor-æ¦‚è¿°" class="headerlink" title="3.1. ThreadPoolExecutor æ¦‚è¿°"></a>3.1. ThreadPoolExecutor æ¦‚è¿°</h3><p><code>ThreadPoolExecutor</code> æ˜¯ä¸€ä¸ªå…·ä½“ç±»ï¼Œç»§æ‰¿äº† <code>java.util.concurrent.AbstractExecutorService</code><br><img src="/source/_posts/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ThreadPoolExecutor%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ThreadPoolExecutor%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.png"></p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>è¯¦è§æºç ï¼š<code>AbstractExecutorService</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.AbstractExecutorService%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.AbstractExecutorServiceæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/11/03/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.AbstractExecutorService%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/03/æºç ï¼šjava.util.concurrent.AbstractExecutorServiceæºç è§£æ/</a></li></ol></li></ol></li></ol></blockquote><hr><h3 id="3-2-ThreadPoolExecutor-ç›¸å…³çŠ¶æ€"><a href="#3-2-ThreadPoolExecutor-ç›¸å…³çŠ¶æ€" class="headerlink" title="3.2. ThreadPoolExecutor ç›¸å…³çŠ¶æ€"></a>3.2. ThreadPoolExecutor ç›¸å…³çŠ¶æ€</h3><ol><li><code>TERMINATED</code>ï¼ˆ<code>011</code>ï¼‰<ol><li>è¡¨ç¤ºçº¿ç¨‹æ± å…³é—­</li></ol></li><li><code>TIDYING</code>ï¼ˆ<code>010</code>ï¼‰<ol><li>è¡¨ç¤ºçº¿ç¨‹æ± ç»ˆæ­¢å‰çš„è¿‡æ¸¡çŠ¶æ€</li><li>åªæœ‰ä»»åŠ¡é˜Ÿåˆ—ä¸ºç©ºã€æ‰€æœ‰ä»»åŠ¡åœæ­¢ã€å·¥ä½œçº¿ç¨‹çš„æ•°é‡ä¸º <code>0</code></li></ol></li><li><code>STOP</code>ï¼ˆ<code>001</code>ï¼‰<ol><li>è¡¨ç¤ºå› ä¸ºè°ƒç”¨äº† <code>ExecutorService#shutdownNow</code> è€Œè¿›å…¥çš„çŠ¶æ€</li><li>æ­£åœ¨è¿è¡Œçš„ä»»åŠ¡ä¼šè¢«åœæ­¢ï¼Œå¹¶ä¸”è¿”å›è¿˜æ²¡å¼€å§‹æ‰§è¡Œçš„ <code>Runnable</code> ä»»åŠ¡åˆ—è¡¨ï¼Œçº¿ç¨‹æ± ä¸ä¼šå†æ¥æ”¶æ–°çš„ä»»åŠ¡</li><li>éœ€è¦æ³¨æ„çš„æ˜¯ï¼š<ol><li>å¦‚æœä»»åŠ¡æœ¬èº«å¹¶æ²¡æœ‰å“åº”ä¸­æ–­ï¼Œé‚£ä¹ˆæ­£åœ¨æ‰§è¡Œä»»åŠ¡çš„çº¿ç¨‹å¯èƒ½ä¸ä¼šç«‹åˆ»åœä¸‹ï¼Œç›´åˆ°æ‰§è¡Œå®Œè¿™ä¸ªä»»åŠ¡</li></ol></li></ol></li><li><code>SHUTDOWN</code>ï¼ˆ<code>000</code>ï¼‰<ol><li>è¡¨ç¤ºå› ä¸ºè°ƒç”¨äº† <code>ExecutorService#shutdown</code> è€Œè¿›å…¥çš„çŠ¶æ€</li><li>å·²æäº¤çš„ä»»åŠ¡ä¼šç»§ç»­æ‰§è¡Œï¼Œä½†çº¿ç¨‹æ± ä¸ä¼šå†æ¥æ”¶æ–°çš„ä»»åŠ¡</li></ol></li><li><code>RUNNING</code>ï¼ˆ<code>111</code>ï¼‰<ol><li>è¡¨ç¤ºçº¿ç¨‹æ± çš„åˆå§‹çŠ¶æ€</li><li>å·²æäº¤çš„ä»»åŠ¡ä¼šç»§ç»­æ‰§è¡Œï¼Œçº¿ç¨‹æ± ä¹Ÿæ¥æ”¶æ–°çš„ä»»åŠ¡</li></ol></li></ol><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li><code>ThreadPoolExecutor</code> çš„çŠ¶æ€ï¼Œæˆ‘ä»¬æ›´å¸¸æŠŠä»–å«åš â€œçº¿ç¨‹æ± çš„çŠ¶æ€â€</li><li>çº¿ç¨‹æ± çš„çŠ¶æ€ï¼Œæ ¹æ®ä¸¥é‡ç¨‹åº¦æ¥çœ‹ï¼š<code>TERMINATED &gt; TIDYING &gt; STOP &gt; SHUTDOWN &gt; RUNNING</code></li><li>å–æ¶ˆä»»åŠ¡å’Œåœæ­¢ä»»åŠ¡è¿˜æ˜¯æœ‰æ‰€åŒºåˆ«çš„ï¼šå–æ¶ˆä»»åŠ¡æ˜¯æŒ‡å–æ¶ˆé‚£äº›å°šæœªæ‰§è¡Œçš„ä»»åŠ¡ã€‚è€Œåœæ­¢ä»»åŠ¡åˆ™æ˜¯ä»»åŠ¡æ­£åœ¨æ‰§è¡Œæ—¶ï¼Œä½ é€šè¿‡ä¸­æ–­å»è®©å®ƒåœä¸‹æ¥ã€‚å¦‚æœä»»åŠ¡èƒ½å¤Ÿå“åº”ä¸­æ–­ï¼Œé‚£å°±ç®—æ˜¯æˆåŠŸåœæ­¢ã€‚ä½†é—®é¢˜åœ¨äºï¼Œå¦‚æœä»»åŠ¡æ²¡æœ‰å“åº”ä¸­æ–­ï¼Œé‚£ä¹ˆå³ä½¿ä½ å‘å‡ºäº†ä¸­æ–­è¯·æ±‚ï¼Œå®ƒä»ç„¶ä¼šç»§ç»­æ‰§è¡Œã€‚æ‰€ä»¥ â€œåœæ­¢ä»»åŠ¡â€ å¹¶ä¸ä¸€å®šèƒ½è®©å®ƒ â€œåœæ­¢ä¸‹æ¥â€</li></ol></blockquote><hr><h2 id="4-å†…éƒ¨ç±»"><a href="#4-å†…éƒ¨ç±»" class="headerlink" title="4. å†…éƒ¨ç±»"></a>4. å†…éƒ¨ç±»</h2><h3 id="4-1-Worker"><a href="#4-1-Worker" class="headerlink" title="4.1. Worker"></a>4.1. Worker</h3><p>è¯¦è§æºç ï¼š<code>ThreadPoolExecutor.Worker</code></p><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ThreadPoolExecutor.Worker%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.ThreadPoolExecutor.Workeræºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/11/04/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.ThreadPoolExecutor.Worker%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/04/æºç ï¼šjava.util.concurrent.ThreadPoolExecutor.Workeræºç è§£æ/</a></li></ol></li></ol><hr><h3 id="AbortPolicy"><a href="#AbortPolicy" class="headerlink" title="AbortPolicy"></a>AbortPolicy</h3><p><code>AbortPolicy</code> æ˜¯ <code>ThreadPoolExecutor</code> å†…ç½®çš„æ‹’ç»ç­–ç•¥ï¼Œç”¨äºç›´æ¥æŠ›å‡º <code>RejectedExecutionException</code> éå—æ£€å¼‚å¸¸</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AbortPolicy</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">RejectedExecutionHandler</span> &#123;<br><br><span class="hljs-keyword">public</span> <span class="hljs-title function_">AbortPolicy</span><span class="hljs-params">()</span> &#123; &#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">rejectedExecution</span><span class="hljs-params">(Runnable r, ThreadPoolExecutor e)</span> &#123;<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RejectedExecutionException</span>(<span class="hljs-string">&quot;Task &quot;</span> + r.toString() +<br> <span class="hljs-string">&quot; rejected from &quot;</span> +<br> e.toString());<br>&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h3 id="DiscardPolicy"><a href="#DiscardPolicy" class="headerlink" title="DiscardPolicy"></a>DiscardPolicy</h3><p><code>DiscardPolicy</code> æ˜¯ <code>ThreadPoolExecutor</code> å†…ç½®çš„æ‹’ç»ç­–ç•¥ï¼Œç”¨äºç›´æ¥ä¸¢å¼ƒè¯¥ä»»åŠ¡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DiscardPolicy</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">RejectedExecutionHandler</span> &#123;<br><br><span class="hljs-keyword">public</span> <span class="hljs-title function_">DiscardPolicy</span><span class="hljs-params">()</span> &#123; &#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">rejectedExecution</span><span class="hljs-params">(Runnable r, ThreadPoolExecutor e)</span> &#123;<br>&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h3 id="CallerRunsPolicy"><a href="#CallerRunsPolicy" class="headerlink" title="CallerRunsPolicy"></a>CallerRunsPolicy</h3><p><code>CallerRunsPolicy</code> æ˜¯ <code>ThreadPoolExecutor</code> å†…ç½®çš„æ‹’ç»ç­–ç•¥ï¼Œç”¨äºè®©è°ƒç”¨ <code>Executor#execute</code> çš„çº¿ç¨‹è‡ªå·±å»æ‰§è¡Œè¿™ä¸ªä»»åŠ¡ã€‚ç®€å•æ¥è¯´å°±æ˜¯ï¼šè°æ´¾æ¥çš„æ´»ï¼Œè°è‡ªå·±å»å¹²</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CallerRunsPolicy</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">RejectedExecutionHandler</span> &#123;<br><br><span class="hljs-keyword">public</span> <span class="hljs-title function_">CallerRunsPolicy</span><span class="hljs-params">()</span> &#123; &#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">rejectedExecution</span><span class="hljs-params">(Runnable r, ThreadPoolExecutor e)</span> &#123;<br><span class="hljs-keyword">if</span> (!e.isShutdown()) &#123;<br>r.run();<br>&#125;<br>&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h3 id="DiscardOldestPolicy"><a href="#DiscardOldestPolicy" class="headerlink" title="DiscardOldestPolicy"></a>DiscardOldestPolicy</h3><p><code>DiscardOldestPolicy</code> æ˜¯ <code>ThreadPoolExecutor</code> å†…ç½®çš„æ‹’ç»ç­–ç•¥ï¼Œç”¨äºç›´æ¥ä¸¢å¼ƒä»»åŠ¡é˜Ÿåˆ—ä¸­æ’é˜Ÿæœ€ä¹…çš„ä»»åŠ¡ï¼Œç„¶åå°è¯•æŠŠè¿™ä¸ªä»»åŠ¡æŠ•é€’åˆ°ä»»åŠ¡é˜Ÿåˆ—</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DiscardOldestPolicy</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">RejectedExecutionHandler</span> &#123;<br><br><span class="hljs-keyword">public</span> <span class="hljs-title function_">DiscardOldestPolicy</span><span class="hljs-params">()</span> &#123; &#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">rejectedExecution</span><span class="hljs-params">(Runnable r, ThreadPoolExecutor e)</span> &#123;<br><span class="hljs-keyword">if</span> (!e.isShutdown()) &#123;<br>e.getQueue().poll();<br>e.execute(r);<br>&#125;<br>&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h2 id="5-æ ¸å¿ƒå±æ€§"><a href="#5-æ ¸å¿ƒå±æ€§" class="headerlink" title="5. æ ¸å¿ƒå±æ€§"></a>5. æ ¸å¿ƒå±æ€§</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * ============================================</span><br><span class="hljs-comment"> * å±æ€§ï¼šprivate static final int COUNT_MASK</span><br><span class="hljs-comment"> * --------------------------------------------</span><br><span class="hljs-comment"> * 1. è®¿é—®ä¿®é¥°ç¬¦</span><br><span class="hljs-comment"> *      1. private</span><br><span class="hljs-comment"> *          1. ç‹¬å®ˆç§˜å¯†ï¼ˆç±»å†…éƒ¨ï¼‰</span><br><span class="hljs-comment"> *          2. ç”±äºæ˜¯åˆ«äººå°è£…å¥½çš„ï¼Œåªèƒ½å°è¯•ç±»çš„å†…éƒ¨æ–¹æ³•</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 2. éè®¿é—®ä¿®é¥°ç¬¦</span><br><span class="hljs-comment"> *      1. final</span><br><span class="hljs-comment"> *          1. ä¸èƒ½ä¿®æ”¹è¯¥å±æ€§çš„å€¼</span><br><span class="hljs-comment"> *          2. å¿…é¡»åœ¨å®šä¹‰æ—¶ç›´æ¥èµ‹å€¼ï¼Œæˆ–è€…åœ¨æ„é€ å‡½æ•°ä¸­ä¿è¯èµ‹å€¼</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 3. ä½œç”¨</span><br><span class="hljs-comment"> *      1. è¡¨ç¤º ThreadPoolExecutor çš„çŠ¶æ€å’Œå·¥ä½œçº¿ç¨‹çš„ä¸ªæ•°</span><br><span class="hljs-comment"> *      2. ThreadPoolExecutor çš„çŠ¶æ€ï¼Œæˆ‘ä»¬æ›´å¸¸æŠŠä»–å«åš â€œçº¿ç¨‹æ± çš„çŠ¶æ€â€</span><br><span class="hljs-comment"> *      </span><br><span class="hljs-comment"> * 4. åˆå§‹å€¼</span><br><span class="hljs-comment"> *      1. çº¿ç¨‹æ± çš„çŠ¶æ€ä¸º RUNNINGï¼Œå·¥ä½œçº¿ç¨‹ä¸º 0</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 5. è¯¦ç»†ä»‹ç»</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * ctl æ˜¯ä¸€ä¸ª int ç±»å‹çš„å˜é‡ï¼Œå…±æœ‰ 32 bitï¼Œå…¶ä¸­é«˜ 3 bit è¡¨ç¤ºçº¿ç¨‹æ± çš„çŠ¶æ€ï¼Œä½ 29 bit è¡¨ç¤ºå·¥ä½œçº¿ç¨‹çš„ä¸ªæ•°</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * ============================================</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">AtomicInteger</span> <span class="hljs-variable">ctl</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicInteger</span>(ctlOf(RUNNING, <span class="hljs-number">0</span>));<br><br><span class="hljs-comment">// è¡¨ç¤ºä¿å­˜çº¿ç¨‹æ± ä¸ªæ•°çš„ä½æ•°ï¼ˆä½ bitï¼‰</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">COUNT_BITS</span> <span class="hljs-operator">=</span> Integer.SIZE - <span class="hljs-number">3</span>;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * ============================================</span><br><span class="hljs-comment"> * å±æ€§ï¼šprivate static final int COUNT_MASK</span><br><span class="hljs-comment"> * --------------------------------------------</span><br><span class="hljs-comment"> * 1. è®¿é—®ä¿®é¥°ç¬¦</span><br><span class="hljs-comment"> *      1. private</span><br><span class="hljs-comment"> *          1. ç‹¬å®ˆç§˜å¯†ï¼ˆç±»å†…éƒ¨ï¼‰</span><br><span class="hljs-comment"> *          2. ç”±äºæ˜¯åˆ«äººå°è£…å¥½çš„ï¼Œåªèƒ½å°è¯•ç±»çš„å†…éƒ¨æ–¹æ³•</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 2. éè®¿é—®ä¿®é¥°ç¬¦</span><br><span class="hljs-comment"> *      1. final</span><br><span class="hljs-comment"> *          1. ä¸èƒ½ä¿®æ”¹è¯¥å±æ€§çš„å€¼</span><br><span class="hljs-comment"> *          2. å¿…é¡»åœ¨å®šä¹‰æ—¶ç›´æ¥èµ‹å€¼ï¼Œæˆ–è€…åœ¨æ„é€ å‡½æ•°ä¸­ä¿è¯èµ‹å€¼</span><br><span class="hljs-comment"> *      1. static</span><br><span class="hljs-comment"> *          1. å¯ä»¥é€šè¿‡ç±»åç›´æ¥è®¿é—®è¯¥å±æ€§</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 3. ä½œç”¨</span><br><span class="hljs-comment"> *      1. è¡¨ç¤ºä¿å­˜çº¿ç¨‹æ± çŠ¶æ€çš„ä½æ•°ï¼ˆé«˜ bitï¼‰</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 4. åˆå§‹å€¼</span><br><span class="hljs-comment"> *      1. (1 &lt;&lt; COUNT_BITS) - 1</span><br><span class="hljs-comment"> *      2. å³ 00011111 11111111 11111111 11111111</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 5. è¯¦ç»†ä»‹ç»</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 1 çš„äºŒè¿›åˆ¶ï¼š</span><br><span class="hljs-comment"> * 00000000 00000000 00000000 00000001</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 1  &lt;&lt; 29ï¼š</span><br><span class="hljs-comment"> * æŠŠäºŒè¿›åˆ¶æ•°æ•´ä½“å¾€å·¦æŒª 29 ä½ï¼Œå·¦è¾¹æº¢å‡ºçš„ä¸¢æ‰ï¼Œå³è¾¹ç©ºå‡ºæ¥çš„è¡¥é›¶</span><br><span class="hljs-comment"> * 00100000 00000000 00000000 00000000</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * (1 &lt;&lt; 29) - 1ï¼š</span><br><span class="hljs-comment"> * 00011111 11111111 11111111 11111111</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * ============================================</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">COUNT_MASK</span> <span class="hljs-operator">=</span> (<span class="hljs-number">1</span> &lt;&lt; COUNT_BITS) - <span class="hljs-number">1</span>;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * ============================================</span><br><span class="hljs-comment"> * å±æ€§ï¼šprivate static final int RUNNING</span><br><span class="hljs-comment"> * --------------------------------------------</span><br><span class="hljs-comment"> * 1. è®¿é—®ä¿®é¥°ç¬¦</span><br><span class="hljs-comment"> *      1. private</span><br><span class="hljs-comment"> *          1. ç‹¬å®ˆç§˜å¯†ï¼ˆç±»å†…éƒ¨ï¼‰</span><br><span class="hljs-comment"> *          2. ç”±äºæ˜¯åˆ«äººå°è£…å¥½çš„ï¼Œåªèƒ½å°è¯•ç±»çš„å†…éƒ¨æ–¹æ³•</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 2. éè®¿é—®ä¿®é¥°ç¬¦</span><br><span class="hljs-comment"> *      1. final</span><br><span class="hljs-comment"> *          1. ä¸èƒ½ä¿®æ”¹è¯¥å±æ€§çš„å€¼</span><br><span class="hljs-comment"> *          2. å¿…é¡»åœ¨å®šä¹‰æ—¶ç›´æ¥èµ‹å€¼ï¼Œæˆ–è€…åœ¨æ„é€ å‡½æ•°ä¸­ä¿è¯èµ‹å€¼</span><br><span class="hljs-comment"> *      1. static</span><br><span class="hljs-comment"> *          1. å¯ä»¥é€šè¿‡ç±»åç›´æ¥è®¿é—®è¯¥å±æ€§</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 3. ä½œç”¨</span><br><span class="hljs-comment"> *      1. ç”¨äºç•Œå®šçº¿ç¨‹æ± çš„ RUNNING çŠ¶æ€</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 4. åˆå§‹å€¼</span><br><span class="hljs-comment"> *      1. -1 &lt;&lt; COUNT_BITS</span><br><span class="hljs-comment"> *      2. å³ 11100000 00000000 00000000 00000000</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 5. è¯¦ç»†ä»‹ç»</span><br><span class="hljs-comment"> * </span><br><span class="hljs-comment"> * -1 çš„äºŒè¿›åˆ¶ï¼š</span><br><span class="hljs-comment"> * 11111111 11111111 11111111 11111111</span><br><span class="hljs-comment"> * </span><br><span class="hljs-comment"> * -1 &lt;&lt; 29ï¼š</span><br><span class="hljs-comment"> * 11100000 00000000 00000000 00000000</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * ============================================</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">RUNNING</span>    <span class="hljs-operator">=</span> -<span class="hljs-number">1</span> &lt;&lt; COUNT_BITS;<br><br><span class="hljs-comment">// ç”¨äºç•Œå®šçº¿ç¨‹æ± çš„ SHUTDOWN çŠ¶æ€ï¼ˆ000ï¼‰</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">SHUTDOWN</span>   <span class="hljs-operator">=</span>  <span class="hljs-number">0</span> &lt;&lt; COUNT_BITS;<br><br><span class="hljs-comment">// ç”¨äºç•Œå®šçº¿ç¨‹æ± çš„ STOP çŠ¶æ€ï¼ˆ001ï¼‰</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">STOP</span>       <span class="hljs-operator">=</span>  <span class="hljs-number">1</span> &lt;&lt; COUNT_BITS;<br><br><span class="hljs-comment">// ç”¨äºç•Œå®šçº¿ç¨‹æ± çš„ TIDYING çŠ¶æ€ï¼ˆ010ï¼‰</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">TIDYING</span>    <span class="hljs-operator">=</span>  <span class="hljs-number">2</span> &lt;&lt; COUNT_BITS;<br><br><span class="hljs-comment">// ç”¨äºç•Œå®šçº¿ç¨‹æ± çš„ TERMINATED çŠ¶æ€ï¼ˆ011ï¼‰</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">TERMINATED</span> <span class="hljs-operator">=</span>  <span class="hljs-number">3</span> &lt;&lt; COUNT_BITS;<br><br><span class="hljs-comment">// è¡¨ç¤º TPE çš„ä»»åŠ¡é˜Ÿåˆ—ï¼ˆå•å‘é˜Ÿåˆ—ï¼‰ï¼Œå¦‚æœä»»åŠ¡ä¸èƒ½ä½œä¸ºæ ¸å¿ƒå·¥ä½œçº¿ç¨‹çš„ &quot;å¯åŠ¨ä»»åŠ¡&quot;ï¼Œåˆ™è¢«æŠ•é€’åˆ°è¯¥é˜Ÿåˆ—</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> BlockingQueue&lt;Runnable&gt; workQueue;<br><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">mainLock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();<br><br><span class="hljs-comment">// è¡¨ç¤º TPE çš„ Worker é›†åˆï¼Œæ‰€æœ‰ Worker éƒ½ä¼šè¢«æŠ•é€’åˆ°è¯¥é›†åˆ</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> HashSet&lt;Worker&gt; workers = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;&gt;();<br><br><span class="hljs-comment">// è¡¨ç¤º TPE ä½¿ç”¨ AQS åˆ›å»ºçš„æ¡ä»¶é˜Ÿåˆ—ï¼ˆåŒå‘ï¼‰ï¼Œæ‰€æœ‰å› ä¸ºè°ƒç”¨ ExecutorService#awaitTermination è€Œé˜»å¡çš„ Thread å®ä¾‹ä¼šè¢«æŠ•é€’åˆ°è¯¥é˜Ÿåˆ—</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Condition</span> <span class="hljs-variable">termination</span> <span class="hljs-operator">=</span> mainLock.newCondition();<br><br><span class="hljs-keyword">private</span> <span class="hljs-type">int</span> largestPoolSize;<br><br><span class="hljs-keyword">private</span> <span class="hljs-type">long</span> completedTaskCount;<br><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> ThreadFactory threadFactory;<br><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> RejectedExecutionHandler handler;<br><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">long</span> keepAliveTime;<br><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">boolean</span> allowCoreThreadTimeOut;<br><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">int</span> corePoolSize;<br><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">int</span> maximumPoolSize;<br><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">RejectedExecutionHandler</span> <span class="hljs-variable">defaultHandler</span> <span class="hljs-operator">=</span><br><span class="hljs-keyword">new</span> <span class="hljs-title class_">AbortPolicy</span>();<br><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">RuntimePermission</span> <span class="hljs-variable">shutdownPerm</span> <span class="hljs-operator">=</span><br><span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimePermission</span>(<span class="hljs-string">&quot;modifyThread&quot;</span>);<br></code></pre></td></tr></table></figure><hr><h2 id="6-æ„é€ æ–¹æ³•"><a href="#6-æ„é€ æ–¹æ³•" class="headerlink" title="6. æ„é€ æ–¹æ³•"></a>6. æ„é€ æ–¹æ³•</h2><h3 id="6-1-ThreadPoolExecutor-int-corePoolSize-int-maximumPoolSize-long-keepAliveTime-TimeUnit-unit-BlockingQueueï¼œRunnableï¼-workQueue-ThreadFactory-threadFactory-RejectedExecutionHandler-handler"><a href="#6-1-ThreadPoolExecutor-int-corePoolSize-int-maximumPoolSize-long-keepAliveTime-TimeUnit-unit-BlockingQueueï¼œRunnableï¼-workQueue-ThreadFactory-threadFactory-RejectedExecutionHandler-handler" class="headerlink" title="6.1. ThreadPoolExecutor(int corePoolSize, int maximumPoolSize, long keepAliveTime, TimeUnit unit, BlockingQueueï¼œRunnableï¼ workQueue, ThreadFactory threadFactory, RejectedExecutionHandler handler)"></a>6.1. ThreadPoolExecutor(int corePoolSize, int maximumPoolSize, long keepAliveTime, TimeUnit unit, BlockingQueueï¼œRunnableï¼ workQueue, ThreadFactory threadFactory, RejectedExecutionHandler handler)</h3><p><code>ThreadPoolExecutor</code>Â è™½ç„¶æä¾›äº† <code>4</code> ä¸ªæ„é€ æ–¹æ³•ï¼Œä½†æ˜¯æœ¬è´¨ä¸Šéƒ½æ˜¯è°ƒç”¨è¿™ä¸ªæ„é€ æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * ============================================</span><br><span class="hljs-comment"> * æ„é€ æ–¹æ³•ï¼š</span><br><span class="hljs-comment"> * public ThreadPoolExecutor(</span><br><span class="hljs-comment"> *         int corePoolSize,</span><br><span class="hljs-comment"> *         int maximumPoolSize,</span><br><span class="hljs-comment"> *         long keepAliveTime,</span><br><span class="hljs-comment"> *         TimeUnit unit,</span><br><span class="hljs-comment"> *         BlockingQueue&lt;Runnable&gt; workQueue,</span><br><span class="hljs-comment"> *         ThreadFactory threadFactory,</span><br><span class="hljs-comment"> *         RejectedExecutionHandler handler</span><br><span class="hljs-comment"> * )</span><br><span class="hljs-comment"> * --------------------------------------------</span><br><span class="hljs-comment"> * 1. è®¿é—®ä¿®é¥°ç¬¦</span><br><span class="hljs-comment"> *      1. public</span><br><span class="hljs-comment"> *          1. å¤©ä¸‹çš†å…¬ï¼ˆEveryWhereï¼‰</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 2. éè®¿é—®ä¿®é¥°ç¬¦</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 3. æ–¹æ³•å‚æ•°</span><br><span class="hljs-comment"> *      1. int corePoolSize</span><br><span class="hljs-comment"> *          1. æŒ‡å®šçº¿ç¨‹æ± ä¸­çš„æ ¸å¿ƒå·¥ä½œçº¿ç¨‹è¢«å…è®¸çš„æœ€å¤§æ•°é‡</span><br><span class="hljs-comment"> *          2. éœ€è¦æ³¨æ„çš„æ˜¯ï¼š</span><br><span class="hljs-comment"> *              1. è¯¥å‚æ•°å¯ä»¥ä¸º 0</span><br><span class="hljs-comment"> *      2. int maximumPoolSize</span><br><span class="hljs-comment"> *          1. æŒ‡å®šçº¿ç¨‹æ± ä¸­çš„å·¥ä½œçº¿ç¨‹è¢«å…è®¸çš„æœ€å¤§æ•°é‡</span><br><span class="hljs-comment"> *          2. éœ€è¦æ³¨æ„çš„æ˜¯ï¼š</span><br><span class="hljs-comment"> *              1. å·¥ä½œçº¿ç¨‹çš„æ•°é‡ = æ ¸å¿ƒå·¥ä½œçº¿ç¨‹çš„æ•°é‡ + éæ ¸å¿ƒå·¥ä½œçº¿ç¨‹çš„æ•°é‡</span><br><span class="hljs-comment"> *      3. long keepAliveTime</span><br><span class="hljs-comment"> *          1. æŒ‡å®šéæ ¸å¿ƒå·¥ä½œçº¿ç¨‹ â€œç©ºé—²â€ è¢«å…è®¸çš„æœ€é•¿æ—¶é—´ä¸º keepAliveTime unit</span><br><span class="hljs-comment"> *          2. éœ€è¦æ³¨æ„çš„æ˜¯ï¼š</span><br><span class="hljs-comment"> *              1. éæ ¸å¿ƒçº¿ç¨‹ â€œç©ºé—²â€ è¶…æ—¶åä¼šè¢«é”€æ¯</span><br><span class="hljs-comment"> *              2. æ ¸å¿ƒçº¿ç¨‹ â€œç©ºé—²â€ è¶…æ—¶åä¸ä¼šè¢«é”€æ¯</span><br><span class="hljs-comment"> *      4. TimeUnit unit</span><br><span class="hljs-comment"> *          1. æŒ‡å®šéæ ¸å¿ƒå·¥ä½œçº¿ç¨‹ â€œç©ºé—²â€ è¢«å…è®¸çš„æœ€é•¿æ—¶é—´ä¸º keepAliveTime unit</span><br><span class="hljs-comment"> *      5. BlockingQueueï¼œRunnableï¼ workQueue</span><br><span class="hljs-comment"> *          1. ä»»åŠ¡åœ¨æ²¡æœ‰æ ¸å¿ƒå·¥ä½œçº¿ç¨‹å¤„ç†æ—¶ï¼Œå…ˆè¢«æŠ•é€’åˆ°è¿™ä¸ªé˜Ÿåˆ—ä¸­</span><br><span class="hljs-comment"> *          2. éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ˜¯æ²¡æœ‰æ ¸å¿ƒå·¥ä½œçº¿ç¨‹å¤„ç†ï¼Œè€Œä¸æ˜¯å·¥ä½œçº¿ç¨‹å¤„ç†</span><br><span class="hljs-comment"> *      6. ThreadFactory threadFactory</span><br><span class="hljs-comment"> *          1. æŒ‡å®šåˆ›å»º Thread å®ä¾‹çš„çº¿ç¨‹å·¥å‚</span><br><span class="hljs-comment"> *      7. RejectedExecutionHandler handler</span><br><span class="hljs-comment"> *          1. æŒ‡å®šæ‹’ç»ç­–ç•¥</span><br><span class="hljs-comment"> *          2. å½“ä»»åŠ¡é˜Ÿåˆ—å·²æ»¡å¹¶ä¸”çº¿ç¨‹æ± ä¸­çš„å·¥ä½œçº¿ç¨‹æ•°é‡å·²ç»è¾¾åˆ°äº† maximumPoolSizeï¼Œè¿™æ—¶å€™å†æŠ•é€’ä»»åŠ¡ï¼Œå°±éœ€è¦æ‰§è¡Œæ‹’ç»ç­–ç•¥</span><br><span class="hljs-comment"> *          3. éœ€è¦æ³¨æ„çš„æ˜¯ï¼šThreadPoolExecutor å†…ç½®äº† 4 ä¸ªæ‹’ç»ç­–ç•¥ï¼Œåˆ†åˆ«æ˜¯</span><br><span class="hljs-comment"> *              1. ThreadPoolExecutor.AbortPolicy</span><br><span class="hljs-comment"> *              2. ThreadPoolExecutor.DiscardPolicy</span><br><span class="hljs-comment"> *              3. ThreadPoolExecutor.CallerRunsPolicy</span><br><span class="hljs-comment"> *              4. ThreadPoolExecutor.DiscardOldestPolicy</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 5. æŠ›å‡ºå¼‚å¸¸</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 6. æ„é€ å®ä¾‹</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * ThreadPoolExecutor executor = new ThreadPoolExecutor(</span><br><span class="hljs-comment"> *     2,</span><br><span class="hljs-comment"> *     4,</span><br><span class="hljs-comment"> *     10,</span><br><span class="hljs-comment"> *     TimeUnit.SECONDS,</span><br><span class="hljs-comment"> *     new ArrayBlockingQueue&lt;&gt;(2),</span><br><span class="hljs-comment"> *     new ThreadFactory() &#123;</span><br><span class="hljs-comment"> *         private int count = 1;</span><br><span class="hljs-comment"> *         public Thread newThread(Runnable r) &#123;</span><br><span class="hljs-comment"> *             return new Thread(r, &quot;Worker-&quot; + count++);</span><br><span class="hljs-comment"> *         &#125;</span><br><span class="hljs-comment"> *     &#125;,</span><br><span class="hljs-comment"> *     new ThreadPoolExecutor.AbortPolicy()</span><br><span class="hljs-comment"> * );</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * ============================================</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-title function_">ThreadPoolExecutor</span><span class="hljs-params">(<span class="hljs-type">int</span> corePoolSize,</span><br><span class="hljs-params">  <span class="hljs-type">int</span> maximumPoolSize,</span><br><span class="hljs-params">  <span class="hljs-type">long</span> keepAliveTime,</span><br><span class="hljs-params">  TimeUnit unit,</span><br><span class="hljs-params">  BlockingQueue&lt;Runnable&gt; workQueue,</span><br><span class="hljs-params">  ThreadFactory threadFactory,</span><br><span class="hljs-params">  RejectedExecutionHandler handler)</span> &#123;<br><br><span class="hljs-keyword">if</span> (corePoolSize &lt; <span class="hljs-number">0</span> ||<br>maximumPoolSize &lt;= <span class="hljs-number">0</span> ||<br>maximumPoolSize &lt; corePoolSize ||<br>keepAliveTime &lt; <span class="hljs-number">0</span>)<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>();<br><br><span class="hljs-keyword">if</span> (workQueue == <span class="hljs-literal">null</span> || threadFactory == <span class="hljs-literal">null</span> || handler == <span class="hljs-literal">null</span>)<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NullPointerException</span>();<br><br><span class="hljs-built_in">this</span>.corePoolSize = corePoolSize;<br><br><span class="hljs-built_in">this</span>.maximumPoolSize = maximumPoolSize;<br><br><span class="hljs-built_in">this</span>.workQueue = workQueue;<br><br><span class="hljs-built_in">this</span>.keepAliveTime = unit.toNanos(keepAliveTime);<br><br><span class="hljs-built_in">this</span>.threadFactory = threadFactory;<br><br><span class="hljs-built_in">this</span>.handler = handler;<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h2 id="7-å®ä¾‹æ–¹æ³•"><a href="#7-å®ä¾‹æ–¹æ³•" class="headerlink" title="7. å®ä¾‹æ–¹æ³•"></a>7. å®ä¾‹æ–¹æ³•</h2><h3 id="7-1-å®ä¾‹å…·ä½“æ–¹æ³•"><a href="#7-1-å®ä¾‹å…·ä½“æ–¹æ³•" class="headerlink" title="7.1. å®ä¾‹å…·ä½“æ–¹æ³•"></a>7.1. å®ä¾‹å…·ä½“æ–¹æ³•</h3><h4 id="7-1-1-å…·ä½“æ–¹æ³•ï¼ˆæ™®é€šï¼‰"><a href="#7-1-1-å…·ä½“æ–¹æ³•ï¼ˆæ™®é€šï¼‰" class="headerlink" title="7.1.1. å…·ä½“æ–¹æ³•ï¼ˆæ™®é€šï¼‰"></a>7.1.1. å…·ä½“æ–¹æ³•ï¼ˆæ™®é€šï¼‰</h4><h5 id="7-1-1-1-boolean-addWorker-Runnable-firstTask-boolean-core"><a href="#7-1-1-1-boolean-addWorker-Runnable-firstTask-boolean-core" class="headerlink" title="7.1.1.1. boolean addWorker(Runnable firstTask, boolean core)"></a>7.1.1.1. boolean addWorker(Runnable firstTask, boolean core)</h5><p>è¯¥æ–¹æ³•ç”¨äºåˆ›å»ºå¹¶å¯åŠ¨ä¸€ä¸ª <code>Worder</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">addWorker</span><span class="hljs-params">(Runnable firstTask, <span class="hljs-type">boolean</span> core)</span> &#123;<br><br><span class="hljs-comment">// ä¸ºå¾ªç¯èµ·ä¸€ä¸ª Label</span><br>retry:<br><br><span class="hljs-comment">// ä¸æ–­è°ƒç”¨ AtomicInteger#get è·å– ctl å±æ€§</span><br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> ctl.get();;) &#123;<br><br><span class="hljs-comment">// å¦‚æœ</span><br><span class="hljs-comment">//     1. è°ƒç”¨ ThreadPoolExecutor#runStateAtLeastï¼Œå‘ç°çº¿ç¨‹æ± çš„çŠ¶æ€è‡³å°‘ä¸º SHUTDOWNï¼ˆå³ TERMINATEDã€TIDYINGã€STOPã€SHUTDOWNï¼‰</span><br><span class="hljs-comment">//     2. å¹¶ä¸”</span><br><span class="hljs-comment">//         1. è¦ä¹ˆè°ƒç”¨ ThreadPoolExecutor#runStateAtLeastï¼Œå‘ç°çº¿ç¨‹æ± çš„çŠ¶æ€è‡³å°‘ä¸º STOPï¼ˆå³ TERMINATEDã€TIDYINGã€STOPï¼‰</span><br><span class="hljs-comment">//         2. è¦ä¹ˆ firstTask æ–¹æ³•å‚æ•°ä¸º null</span><br><span class="hljs-comment">//         3. è¦ä¹ˆè°ƒç”¨ Collection#isEmptyï¼Œå‘ç°ä»»åŠ¡é˜Ÿåˆ—ä¸ºç©º</span><br><span class="hljs-keyword">if</span> (runStateAtLeast(c, SHUTDOWN)<br>&amp;&amp; (runStateAtLeast(c, STOP) || firstTask != <span class="hljs-literal">null</span>|| workQueue.isEmpty()))<br><span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br><br><span class="hljs-keyword">for</span> (;;) &#123;<br><br><span class="hljs-comment">// å¦‚æœè°ƒç”¨ ThreadPoolExecutor#workerCountOfï¼Œå‘ç°çº¿ç¨‹æ± ä¸­çš„å·¥ä½œçº¿ç¨‹çš„æ•°é‡ &gt; æœ¬æ¬¡æ£€æŸ¥çš„çº¿ç¨‹æ•°é‡ä¸Šé™</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// (core ? corePoolSize : maximumPoolSize) æ˜¯æŒ‡ï¼šå¦‚æœ core ä¸º trueï¼Œæœ¬æ¬¡æ£€æŸ¥çš„çº¿ç¨‹æ•°é‡ä¸Šé™ä¸ºæ ¸å¿ƒå·¥ä½œçº¿ç¨‹è¢«å…è®¸çš„æœ€å¤§æ•°é‡ã€‚å¦‚æœ core ä¸º falseï¼Œæœ¬æ¬¡æ£€æŸ¥çš„çº¿ç¨‹æ•°é‡ä¸Šé™ä¸ºå·¥ä½œçº¿ç¨‹è¢«å…è®¸çš„æœ€å¤§æ•°é‡</span><br><span class="hljs-keyword">if</span> (workerCountOf(c) &gt;= ((core ? corePoolSize : maximumPoolSize) &amp; COUNT_MASK))<br><span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br><br><span class="hljs-comment">// å¦‚æœè°ƒç”¨ ThreadPoolExecutor#compareAndIncrementWorkerCountï¼ŒæˆåŠŸå°†å·¥ä½œçº¿ç¨‹ + 1</span><br><span class="hljs-keyword">if</span> (compareAndIncrementWorkerCount(c))<br><span class="hljs-keyword">break</span> retry;<br><br><span class="hljs-comment">// è°ƒç”¨ AtomicInteger#get è·å– ctl å±æ€§</span><br>c = ctl.get();<br><br><span class="hljs-comment">// å¦‚æœè°ƒç”¨ ThreadPoolExecutor#runStateAtLeastï¼Œå‘ç°çº¿ç¨‹æ± çš„çŠ¶æ€è‡³å°‘ä¸º SHUTDOWNï¼ˆå³ TERMINATEDã€TIDYINGã€STOPã€SHUTDOWNï¼‰</span><br><span class="hljs-keyword">if</span> (runStateAtLeast(c, SHUTDOWN))<br><span class="hljs-keyword">continue</span> retry;<br>&#125;<br>&#125;<br><br><span class="hljs-type">boolean</span> <span class="hljs-variable">workerStarted</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;<br><br><span class="hljs-type">boolean</span> <span class="hljs-variable">workerAdded</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;<br><br><span class="hljs-type">Worker</span> <span class="hljs-variable">w</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br><br><span class="hljs-keyword">try</span> &#123;<br><br><span class="hljs-comment">// åˆ›å»º Worker å®ä¾‹</span><br>w = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Worker</span>(firstTask);<br><br><span class="hljs-keyword">final</span> <span class="hljs-type">Thread</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> w.thread;<br><br><span class="hljs-keyword">if</span> (t != <span class="hljs-literal">null</span>) &#123;<br><br><span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">mainLock</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>.mainLock;<br><br>mainLock.lock();<br><br><span class="hljs-keyword">try</span> &#123;<br><br><span class="hljs-type">int</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> ctl.get();<br><br><span class="hljs-keyword">if</span> (isRunning(c) ||<br>(runStateLessThan(c, STOP) &amp;&amp; firstTask == <span class="hljs-literal">null</span>)) &#123;<br><br><span class="hljs-keyword">if</span> (t.getState() != Thread.State.NEW)<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalThreadStateException</span>();<br><br><span class="hljs-comment">// è°ƒç”¨ HashSet#addï¼Œå‘ ThreadPoolExecutor-&gt;workers æ·»åŠ æ–°åˆ›å»ºçš„ Worker å®ä¾‹</span><br>workers.add(w);<br><br>workerAdded = <span class="hljs-literal">true</span>;<br><br><span class="hljs-type">int</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> workers.size();<br><br><span class="hljs-keyword">if</span> (s &gt; largestPoolSize)<br>largestPoolSize = s;<br>&#125;<br>&#125; <span class="hljs-keyword">finally</span> &#123;<br><br>mainLock.unlock();<br>&#125;<br><span class="hljs-keyword">if</span> (workerAdded) &#123;<br><br><span class="hljs-comment">// å¯åŠ¨ Thread å®ä¾‹</span><br>t.start();<br><br>workerStarted = <span class="hljs-literal">true</span>;<br>&#125;<br>&#125;<br>&#125; <span class="hljs-keyword">finally</span> &#123;<br><br><span class="hljs-keyword">if</span> (! workerStarted)<br>addWorkerFailed(w);<br>&#125;<br><span class="hljs-keyword">return</span> workerStarted;<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h5 id="7-1-1-2-void-runWorker-Worker-w"><a href="#7-1-1-2-void-runWorker-Worker-w" class="headerlink" title="7.1.1.2. void runWorker(Worker w)"></a>7.1.1.2. void runWorker(Worker w)</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">runWorker</span><span class="hljs-params">(Worker w)</span> &#123;<br><br><span class="hljs-type">Thread</span> <span class="hljs-variable">wt</span> <span class="hljs-operator">=</span> Thread.currentThread();<br><br><span class="hljs-type">Runnable</span> <span class="hljs-variable">task</span> <span class="hljs-operator">=</span> w.firstTask;<br><br>w.firstTask = <span class="hljs-literal">null</span>;<br><br>w.unlock();<br><br><span class="hljs-type">boolean</span> <span class="hljs-variable">completedAbruptly</span> <span class="hljs-operator">=</span> <span class="hljs-literal">true</span>;<br><br><span class="hljs-keyword">try</span> &#123;<br><br><span class="hljs-keyword">while</span> (task != <span class="hljs-literal">null</span> || (task = getTask()) != <span class="hljs-literal">null</span>) &#123;<br><br>w.lock();<br><br><span class="hljs-keyword">if</span> ((runStateAtLeast(ctl.get(), STOP) ||<br> (Thread.interrupted() &amp;&amp;<br>  runStateAtLeast(ctl.get(), STOP))) &amp;&amp;<br>!wt.isInterrupted())<br>wt.interrupt();<br><br><span class="hljs-keyword">try</span> &#123;<br>beforeExecute(wt, task);<br><span class="hljs-keyword">try</span> &#123;<br>task.run();<br>afterExecute(task, <span class="hljs-literal">null</span>);<br>&#125; <span class="hljs-keyword">catch</span> (Throwable ex) &#123;<br>afterExecute(task, ex);<br><span class="hljs-keyword">throw</span> ex;<br>&#125;<br>&#125; <span class="hljs-keyword">finally</span> &#123;<br>task = <span class="hljs-literal">null</span>;<br>w.completedTasks++;<br>w.unlock();<br>&#125;<br>&#125;<br>completedAbruptly = <span class="hljs-literal">false</span>;<br>&#125; <span class="hljs-keyword">finally</span> &#123;<br>processWorkerExit(w, completedAbruptly);<br>&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h4 id="7-1-2-å…·ä½“æ–¹æ³•ï¼ˆå®ç°ï¼‰"><a href="#7-1-2-å…·ä½“æ–¹æ³•ï¼ˆå®ç°ï¼‰" class="headerlink" title="7.1.2. å…·ä½“æ–¹æ³•ï¼ˆå®ç°ï¼‰"></a>7.1.2. å…·ä½“æ–¹æ³•ï¼ˆå®ç°ï¼‰</h4><h5 id="7-1-2-1-Executor-ä¸­æ¥å£æ–¹æ³•çš„å®ç°"><a href="#7-1-2-1-Executor-ä¸­æ¥å£æ–¹æ³•çš„å®ç°" class="headerlink" title="7.1.2.1. Executor ä¸­æ¥å£æ–¹æ³•çš„å®ç°"></a>7.1.2.1. Executor ä¸­æ¥å£æ–¹æ³•çš„å®ç°</h5><h6 id="7-1-2-1-1-void-execute-Runnable-command"><a href="#7-1-2-1-1-void-execute-Runnable-command" class="headerlink" title="7.1.2.1.1. void execute(Runnable command)"></a>7.1.2.1.1. void execute(Runnable command)</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">execute</span><span class="hljs-params">(Runnable command)</span> &#123;<br><br><span class="hljs-keyword">if</span> (command == <span class="hljs-literal">null</span>)<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NullPointerException</span>();<br><br><span class="hljs-type">int</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> ctl.get();<br><br><span class="hljs-keyword">if</span> (workerCountOf(c) &lt; corePoolSize) &#123;<br><span class="hljs-keyword">if</span> (addWorker(command, <span class="hljs-literal">true</span>))<br><span class="hljs-keyword">return</span>;<br>c = ctl.get();<br>&#125;<br><span class="hljs-keyword">if</span> (isRunning(c) &amp;&amp; workQueue.offer(command)) &#123;<br><span class="hljs-type">int</span> <span class="hljs-variable">recheck</span> <span class="hljs-operator">=</span> ctl.get();<br><span class="hljs-keyword">if</span> (! isRunning(recheck) &amp;&amp; remove(command))<br>reject(command);<br><span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (workerCountOf(recheck) == <span class="hljs-number">0</span>)<br>addWorker(<span class="hljs-literal">null</span>, <span class="hljs-literal">false</span>);<br>&#125;<br><span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!addWorker(command, <span class="hljs-literal">false</span>))<br>reject(command);<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h5 id="7-1-2-2-ExecutorService-ä¸­æ¥å£æ–¹æ³•çš„å®ç°"><a href="#7-1-2-2-ExecutorService-ä¸­æ¥å£æ–¹æ³•çš„å®ç°" class="headerlink" title="7.1.2.2. ExecutorService ä¸­æ¥å£æ–¹æ³•çš„å®ç°"></a>7.1.2.2. ExecutorService ä¸­æ¥å£æ–¹æ³•çš„å®ç°</h5><h6 id="7-1-2-2-1-void-shutdown"><a href="#7-1-2-2-1-void-shutdown" class="headerlink" title="7.1.2.2.1. void shutdown()"></a>7.1.2.2.1. void shutdown()</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">shutdown</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">mainLock</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>.mainLock;<br>mainLock.lock();<br><span class="hljs-keyword">try</span> &#123;<br>checkShutdownAccess();<br>advanceRunState(SHUTDOWN);<br>interruptIdleWorkers();<br>onShutdown();<br>&#125; <span class="hljs-keyword">finally</span> &#123;<br>mainLock.unlock();<br>&#125;<br>tryTerminate();<br>&#125;<br></code></pre></td></tr></table></figure><hr><h6 id="7-1-2-2-2-Listï¼œRunnableï¼-shutdownNow"><a href="#7-1-2-2-2-Listï¼œRunnableï¼-shutdownNow" class="headerlink" title="7.1.2.2.2. Listï¼œRunnableï¼ shutdownNow()"></a>7.1.2.2.2. Listï¼œRunnableï¼ shutdownNow()</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> List&lt;Runnable&gt; <span class="hljs-title function_">shutdownNow</span><span class="hljs-params">()</span> &#123;<br>List&lt;Runnable&gt; tasks;<br><span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">mainLock</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>.mainLock;<br>mainLock.lock();<br><span class="hljs-keyword">try</span> &#123;<br>checkShutdownAccess();<br>advanceRunState(STOP);<br>interruptWorkers();<br>tasks = drainQueue();<br>&#125; <span class="hljs-keyword">finally</span> &#123;<br>mainLock.unlock();<br>&#125;<br>tryTerminate();<br><span class="hljs-keyword">return</span> tasks;<br>&#125;<br></code></pre></td></tr></table></figure><hr><h6 id="7-1-2-2-3-boolean-awaitTermination-long-timeout-TimeUnit-unit"><a href="#7-1-2-2-3-boolean-awaitTermination-long-timeout-TimeUnit-unit" class="headerlink" title="7.1.2.2.3. boolean awaitTermination(long timeout, TimeUnit unit)"></a>7.1.2.2.3. boolean awaitTermination(long timeout, TimeUnit unit)</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">awaitTermination</span><span class="hljs-params">(<span class="hljs-type">long</span> timeout, TimeUnit unit)</span><br><span class="hljs-keyword">throws</span> InterruptedException &#123;<br><span class="hljs-type">long</span> <span class="hljs-variable">nanos</span> <span class="hljs-operator">=</span> unit.toNanos(timeout);<br><span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">mainLock</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>.mainLock;<br>mainLock.lock();<br><span class="hljs-keyword">try</span> &#123;<br><span class="hljs-keyword">while</span> (runStateLessThan(ctl.get(), TERMINATED)) &#123;<br><span class="hljs-keyword">if</span> (nanos &lt;= <span class="hljs-number">0L</span>)<br><span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>nanos = termination.awaitNanos(nanos);<br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125; <span class="hljs-keyword">finally</span> &#123;<br>mainLock.unlock();<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.util.concurren.Futureï¼œVï¼ æºç è§£æ</title>
    <link href="/2025/09/02/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurren.Future%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/09/02/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurren.Future%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/09/02/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurren.Future%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/09/02/æºç ï¼šjava.util.concurren.Futureï¼œVï¼æºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-Future-æ¦‚è¿°"><a href="#3-1-Future-æ¦‚è¿°" class="headerlink" title="3.1. Future æ¦‚è¿°"></a>3.1. Future æ¦‚è¿°</h3><p><code>Future</code> æ˜¯ä¸€ä¸ªæ¥å£</p><p><code>Future</code> ä¸ºæˆ‘ä»¬æä¾›äº†ä»¥ä¸‹æ–¹æ³•ï¼š</p><ol><li>å–æ¶ˆè¿˜æœªæ‰§è¡Œçš„ä»»åŠ¡ã€åœæ­¢æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡ï¼ˆéé˜»å¡ï¼‰</li><li>æŸ¥çœ‹ä»»åŠ¡æ˜¯å¦å·²ç»è¢«å–æ¶ˆæˆ–åœæ­¢ï¼ˆéé˜»å¡ï¼‰</li><li>æŸ¥çœ‹ä»»åŠ¡æ˜¯å¦å·²ç»æ‰§è¡Œå®Œæ¯•ï¼ˆéé˜»å¡ï¼‰</li><li>è·å–ä»»åŠ¡çš„ç»“æœï¼ˆé˜»å¡ã€é™æ—¶é˜»å¡ï¼‰</li></ol><hr><h2 id="4-æºç éƒ¨åˆ†"><a href="#4-æºç éƒ¨åˆ†" class="headerlink" title="4. æºç éƒ¨åˆ†"></a>4. æºç éƒ¨åˆ†</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Future</span>&lt;V&gt; &#123;<br><br><span class="hljs-comment">// ç”¨äºéé˜»å¡å–æ¶ˆè¿˜æœªæ‰§è¡Œçš„ä»»åŠ¡ï¼Œåœæ­¢æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡</span><br>    <span class="hljs-type">boolean</span> <span class="hljs-title function_">cancel</span><span class="hljs-params">(<span class="hljs-type">boolean</span> mayInterruptIfRunning)</span>;<br><br><span class="hljs-comment">// ç”¨äºéé˜»å¡æŸ¥çœ‹ä»»åŠ¡æ˜¯å¦å·²ç»è¢«å–æ¶ˆæˆ–åœæ­¢</span><br>    <span class="hljs-type">boolean</span> <span class="hljs-title function_">isCancelled</span><span class="hljs-params">()</span>;<br><br><span class="hljs-comment">// ç”¨äºéé˜»å¡æŸ¥çœ‹ä»»åŠ¡æ˜¯å¦å·²ç»æ‰§è¡Œå®Œæ¯•ï¼ˆæ­£å¸¸é€€å‡ºã€å¼‚å¸¸é€€å‡ºã€å–æ¶ˆä»»åŠ¡ï¼‰</span><br>    <span class="hljs-type">boolean</span> <span class="hljs-title function_">isDone</span><span class="hljs-params">()</span>;<br><br><span class="hljs-comment">// ç”¨äºé˜»å¡è·å–ä»»åŠ¡çš„ç»“æœ</span><br><span class="hljs-comment">// </span><br><span class="hljs-comment">// å¦‚æœä»»åŠ¡è¿˜æ²¡æœ‰æ‰§è¡Œå®Œï¼Œæœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ WAITING çŠ¶æ€ï¼Œå¹¶è¢«æŠ•é€’åˆ° Future æ¥å£çš„å…·ä½“å®ç°ç±»å®ä¾‹ä¸­ç»´æŠ¤çš„æŸæ•°æ®ç»“æ„ï¼Œç­‰å¾…è¢«å”¤é†’ï¼ˆLockSupport.unparkï¼‰ã€è¢«ä¸­æ–­ï¼ˆThread#interruptï¼‰</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ WAITING çŠ¶æ€åï¼Œèƒ½å“åº”ä¸­æ–­ã€‚çº¿ç¨‹è¢«å”¤é†’ï¼Œé‡æ–°è·å¾— CPU æ—¶é—´ç‰‡åï¼Œä¼šæŠ›å‡º InterruptedException å—æ£€å¼‚å¸¸ï¼Œå¹¶æ¸…é™¤ Thread å®ä¾‹çš„ä¸­æ–­çŠ¶æ€ï¼ˆå¼‚å¸¸é€€å‡ºæˆ–æ­£å¸¸é€€å‡ºï¼ˆå‘ç”Ÿå¼‚å¸¸ï¼‰ï¼Œè¦çœ‹æˆ‘ä»¬æ˜¯å¦å¯¹è¯¥å¼‚å¸¸è¿›è¡Œæ•è·å¹¶å¤„ç†ï¼‰</span><br>    V <span class="hljs-title function_">get</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException, ExecutionException;<br><br><span class="hljs-comment">// ç”¨äºé™æ—¶é˜»å¡è·å–ä»»åŠ¡çš„ç»“æœ</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// é™æ—¶é˜»å¡è¢«å…è®¸çš„æœ€é•¿æ—¶é—´ä¸ºï¼štimeout unit</span><br><span class="hljs-comment">//     1. å¦‚æœè¶…æ—¶ï¼ŒæŠ›å‡º TimeoutException å¼‚å¸¸</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// å¦‚æœä»»åŠ¡è¿˜æ²¡æœ‰æ‰§è¡Œå®Œï¼Œæœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ TIMED_WAITING çŠ¶æ€ï¼Œå¹¶è¢«æŠ•é€’åˆ° Future æ¥å£çš„å…·ä½“å®ç°ç±»å®ä¾‹ç»´æŠ¤çš„æŸæ•°æ®ç»“æ„ï¼Œç­‰å¾…è¢«å”¤é†’ï¼ˆLockSupport.unparkï¼‰ã€è¢«ä¸­æ–­ï¼ˆThread#interruptï¼‰</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ TIMED_WAITING çŠ¶æ€åï¼Œèƒ½å“åº”ä¸­æ–­ã€‚çº¿ç¨‹è¢«å”¤é†’ï¼Œé‡æ–°è·å¾— CPU æ—¶é—´ç‰‡åï¼Œä¼šæŠ›å‡º InterruptedException å—æ£€å¼‚å¸¸ï¼Œå¹¶æ¸…é™¤ Thread å®ä¾‹çš„ä¸­æ–­çŠ¶æ€ï¼ˆå¼‚å¸¸é€€å‡ºæˆ–æ­£å¸¸é€€å‡ºï¼ˆå‘ç”Ÿå¼‚å¸¸ï¼‰ï¼Œè¦çœ‹æˆ‘ä»¬æ˜¯å¦å¯¹è¯¥å¼‚å¸¸è¿›è¡Œæ•è·å¹¶å¤„ç†ï¼‰</span><br>    V <span class="hljs-title function_">get</span><span class="hljs-params">(<span class="hljs-type">long</span> timeout, TimeUnit unit)</span><br>        <span class="hljs-keyword">throws</span> InterruptedException, ExecutionException, TimeoutException;<br>    <br>&#125;<br></code></pre></td></tr></table></figure><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.util.concurrent.Callableï¼œVï¼ æºç è§£æ</title>
    <link href="/2025/09/02/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.Callable%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/09/02/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.Callable%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/09/02/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.Callable%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/09/02/æºç ï¼šjava.util.concurrent.Callableï¼œVï¼æºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-Callable-æ¦‚è¿°"><a href="#3-1-Callable-æ¦‚è¿°" class="headerlink" title="3.1. Callable æ¦‚è¿°"></a>3.1. Callable æ¦‚è¿°</h3><p><code>Callable</code> æ˜¯ä¸€ä¸ªæ¥å£</p><p>å®ç° <code>Callable</code> æ¥å£çš„å…·ä½“å®ç°ç±»ï¼Œè¡¨ç¤ºä¸€ä¸ªå¯è¢«çº¿ç¨‹æ‰§è¡Œçš„ä»»åŠ¡ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º â€œ<code>Callable</code> ä»»åŠ¡â€</p><p>ä¸ <code>Runnable</code> ä»»åŠ¡ç›¸æ¯”ï¼Œ<code>Callable</code> ä»»åŠ¡æ—¢å¯ä»¥æœ‰è¿”å›å€¼ï¼Œä¹Ÿå¯ä»¥æŠ›å‡ºå¼‚å¸¸</p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>åœ¨ <code>Java</code> ä¸­ï¼Œçº¿ç¨‹æ‰§è¡Œçš„ä»»åŠ¡ï¼Œé€šå¸¸æ˜¯æŒ‡ <code>Runnable</code> ä»»åŠ¡å’Œ <code>Callable</code> ä»»åŠ¡</li><li><code>Runnable</code> åœ¨ <code>Java1</code> å°±å‡ºç°äº†ï¼Œä½†æ˜¯ <code>Runnable</code> ä»»åŠ¡æ—¢ä¸èƒ½æŠ›å‡ºå—æ£€å¼‚å¸¸ï¼Œä¹Ÿæ²¡æœ‰è¿”å›å€¼ã€‚æ‰§è¡Œ <code>Runnable</code> å°±æ„Ÿè§‰è¿›å…¥äº†ä¸€ä¸ªé»‘ç›’å­ï¼Œæ²¡æœ‰ä¸€ç‚¹åé¦ˆï¼Œäºæ˜¯æˆ‘ä»¬åœ¨ <code>Java5</code> å¼•å…¥äº† <code>Callable</code></li><li>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ª â€œå‘â€ï¼š<ol><li><code>Thread</code> åœ¨è®¾è®¡ä¹‹åˆå°±æ˜¯åªèƒ½ç”¨æ¥æ‰§è¡Œ <code>Runnable</code> ä»»åŠ¡ï¼Œä¸èƒ½ç›´æ¥æ‰§è¡Œ  <code>Callable</code> ä»»åŠ¡ï¼ˆå³ <code>æœ¬åœ°çº¿ç¨‹ â” Thread#run â” target#run</code>ï¼Œè¿™é‡Œçš„ <code>target</code> å°±æ˜¯ä¸€ä¸ª <code>Runnable</code> ä»»åŠ¡ï¼‰</li><li>é™¤æ­¤ä¹‹å¤–ï¼Œå³ä¾¿èƒ½æ‰§è¡Œ <code>Callable</code> ä»»åŠ¡ï¼Œå¦‚ä½•æ‹¿åˆ°è¿™ä¸ª <code>Callable</code> ä»»åŠ¡çš„è¿”å›å€¼ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªé—®é¢˜</li><li>æˆ‘ä»¬çš„è§£å†³æ€è·¯é€šå¸¸æ˜¯ï¼š<ol><li>å°†å®ç° <code>Callable</code> æ¥å£çš„å…·ä½“å®ç°ç±»ï¼Œä½œä¸ºå®ç° <code>Runnable</code> æ¥å£çš„å…·ä½“å®ç°ç±»çš„å±æ€§ï¼Œå½“çº¿ç¨‹è°ƒç”¨å®ç° <code>Runnable</code> æ¥å£çš„å…·ä½“å®ç°ç±»æ—¶ï¼Œä¼šè°ƒç”¨å…¶ <code>run</code>ï¼Œæˆ‘ä»¬åœ¨ <code>run</code> ä¸­å†å»è°ƒç”¨å®ç° <code>Callable</code> æ¥å£çš„å…·ä½“å®ç°ç±»çš„ <code>call</code>ï¼Œç„¶åå°† <code>call</code> çš„è¿”å›å€¼ï¼Œä¹Ÿä½œä¸ºå®ç° <code>Runnable</code> æ¥å£çš„å…·ä½“å®ç°ç±»çš„å±æ€§</li><li><code>FutureTask</code> å°±æ˜¯è¿™æ ·åšçš„ï¼Œè¯¦è§æºç ï¼š<code>FutureTask</code>ï¼ˆ<code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.FutureTask%EF%BC%9CV%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.FutureTaskï¼œVï¼æºç è§£æ</a>ï¼Œ<code>Hexo</code> é“¾æ¥ï¼šï¼‰</li></ol></li></ol></li></ol></blockquote><hr><h2 id="4-æºç éƒ¨åˆ†"><a href="#4-æºç éƒ¨åˆ†" class="headerlink" title="4. æºç éƒ¨åˆ†"></a>4. æºç éƒ¨åˆ†</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@FunctionalInterface</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Callable</span>&lt;V&gt; &#123;<br><br>    V <span class="hljs-title function_">call</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception;<br>    <br>&#125;<br></code></pre></td></tr></table></figure><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.util.concurrent.Runnable æºç è§£æ</title>
    <link href="/2025/09/02/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.Runnable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/09/02/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.Runnable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/09/02/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.Runnable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/09/02/æºç ï¼šjava.util.concurrent.Runnableæºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-Runnable-æ¦‚è¿°"><a href="#3-1-Runnable-æ¦‚è¿°" class="headerlink" title="3.1. Runnable æ¦‚è¿°"></a>3.1. Runnable æ¦‚è¿°</h3><p><code>Runnable</code> æ˜¯ä¸€ä¸ªæ¥å£</p><p>å®ç° <code>Runnable</code> æ¥å£çš„å…·ä½“å®ç°ç±»ï¼Œè¡¨ç¤ºä¸€ä¸ªå¯è¢«çº¿ç¨‹æ‰§è¡Œçš„ä»»åŠ¡ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º â€œ<code>Runnable</code> ä»»åŠ¡â€</p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>åœ¨ <code>Java</code> ä¸­ï¼Œçº¿ç¨‹æ‰§è¡Œçš„ä»»åŠ¡ï¼Œé€šå¸¸æ˜¯æŒ‡ <code>Runnable</code> ä»»åŠ¡å’Œ <code>Callable</code> ä»»åŠ¡</li><li><code>Runnable</code> åœ¨ <code>Java1</code> å°±å‡ºç°äº†ï¼Œä½†æ˜¯ <code>Runnable</code> ä»»åŠ¡æ—¢ä¸èƒ½æŠ›å‡ºå—æ£€å¼‚å¸¸ï¼Œä¹Ÿæ²¡æœ‰è¿”å›å€¼ã€‚æ‰§è¡Œ <code>Runnable</code> å°±æ„Ÿè§‰è¿›å…¥äº†ä¸€ä¸ªé»‘ç›’å­ï¼Œæ²¡æœ‰ä¸€ç‚¹åé¦ˆï¼Œäºæ˜¯æˆ‘ä»¬åœ¨ <code>Java5</code> å¼•å…¥äº† <code>Callable&lt;V&gt;</code></li></ol></blockquote><hr><h2 id="4-æºç éƒ¨åˆ†"><a href="#4-æºç éƒ¨åˆ†" class="headerlink" title="4. æºç éƒ¨åˆ†"></a>4. æºç éƒ¨åˆ†</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@FunctionalInterface</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Runnable</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span>;<br>    <br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>æ¥å£ä¸­çš„æ¥å£æ–¹æ³•å´å†™ <code>abstract</code> éè®¿é—®ä¿®é¥°ç¬¦ï¼Œè¿™æ˜¯æ—©æœŸé—ç•™çš„å†™æ³•å’Œéƒ¨åˆ†äººçš„ç¼–ç ä¹ æƒ¯</li></ol></blockquote><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.util.concurrent.locksAbstractOwnableSynchronizer æºç è§£æ</title>
    <link href="/2025/09/02/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractOwnableSynchronizer%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/09/02/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractOwnableSynchronizer%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/09/02/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractOwnableSynchronizer%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/09/02/æºç ï¼šjava.util.concurrent.locks.AbstractOwnableSynchronizeræºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-AbstractOwnableSynchronizer-æ¦‚è¿°"><a href="#3-1-AbstractOwnableSynchronizer-æ¦‚è¿°" class="headerlink" title="3.1. AbstractOwnableSynchronizer æ¦‚è¿°"></a>3.1. AbstractOwnableSynchronizer æ¦‚è¿°</h3><p><code>AbstractOwnableSynchronizer</code> æ˜¯ä¸€ä¸ªæ¥å£</p><p><code>AbstractOwnableSynchronizer</code> æä¾›äº†ä»¥ä¸‹æ–¹æ³•ï¼š</p><ol><li>è®°å½•å½“å‰ç‹¬å è¯¥ç‹¬å æ¨¡å¼åŒæ­¥å™¨èµ„æºçš„çº¿ç¨‹ï¼ˆéé˜»å¡ï¼‰</li><li>è·å–å½“å‰ç‹¬å è¯¥ç‹¬å æ¨¡å¼åŒæ­¥å™¨èµ„æºçš„çº¿ç¨‹ï¼ˆéé˜»å¡ï¼‰</li></ol><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li><code>AOS</code> ä»…ç”¨äºç‹¬å æ¨¡å¼åŒæ­¥å™¨ï¼Œå¦‚æœåŸºäº <code>AQS</code> å®ç°çš„æ˜¯å…±äº«æ¨¡å¼çš„åŒæ­¥å™¨æˆ–çŠ¶æ€æœºï¼Œé‚£ä¹ˆ <code>AOS</code> æ ¹æœ¬ç”¨ä¸åˆ°</li></ol></blockquote><hr><h2 id="4-æºç éƒ¨åˆ†"><a href="#4-æºç éƒ¨åˆ†" class="headerlink" title="4. æºç éƒ¨åˆ†"></a>4. æºç éƒ¨åˆ†</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AbstractOwnableSynchronizer</span><br>    <span class="hljs-keyword">implements</span> <span class="hljs-title class_">java</span>.io.Serializable &#123;<br><br>    <span class="hljs-keyword">protected</span> <span class="hljs-title function_">AbstractOwnableSynchronizer</span><span class="hljs-params">()</span> &#123; &#125;<br><br><span class="hljs-comment">// è¡¨ç¤ºå½“å‰ç‹¬å è¯¥ç‹¬å æ¨¡å¼åŒæ­¥å™¨èµ„æºçš„çº¿ç¨‹</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">transient</span> Thread exclusiveOwnerThread;<br><br><span class="hljs-comment">// ç”¨äºéé˜»å¡è®°å½•å½“å‰ç‹¬å è¯¥ç‹¬å æ¨¡å¼åŒæ­¥å™¨èµ„æºçš„çº¿ç¨‹</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setExclusiveOwnerThread</span><span class="hljs-params">(Thread thread)</span> &#123;<br>        exclusiveOwnerThread = thread;<br>    &#125;<br><br><span class="hljs-comment">// ç”¨äºéé˜»å¡è·å–å½“å‰ç‹¬å è¯¥ç‹¬å æ¨¡å¼åŒæ­¥å™¨èµ„æºçš„çº¿ç¨‹</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> Thread <span class="hljs-title function_">getExclusiveOwnerThread</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> exclusiveOwnerThread;<br>    &#125;<br>    <br>&#125;<br></code></pre></td></tr></table></figure><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.util.concurrent.locks.ReentrantLock.Sync æºç è§£æ</title>
    <link href="/2025/09/02/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.ReentrantLock.Sync%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/09/02/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.ReentrantLock.Sync%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/09/02/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.ReentrantLock.Sync%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/09/02/æºç ï¼šjava.util.concurrent.locks.ReentrantLock.Syncæºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-ReentrantLock-Sync-æ¦‚è¿°"><a href="#3-1-ReentrantLock-Sync-æ¦‚è¿°" class="headerlink" title="3.1. ReentrantLock.Sync æ¦‚è¿°"></a>3.1. ReentrantLock.Sync æ¦‚è¿°</h3><p><code>Sync</code> æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œæ˜¯ <code>java.util.concurrent.locks.ReentrantLock</code> çš„é™æ€å†…éƒ¨ç±»ï¼Œç»§æ‰¿äº† <code>java.util.concurrent.locks.AbstractQueuedSynchronizer</code><br><img src="/source/_posts/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.ReentrantLock.Sync%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.ReentrantLock.Sync%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.png"></p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>è¯¦è§æºç ï¼š<code>ReentrantLock</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.ReentrantLock%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.locks.ReentrantLockæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/08/31/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.ReentrantLock%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/08/31/æºç ï¼šjava.util.concurrent.locks.ReentrantLockæºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>AbstractQueuedSynchronizer</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedSynchronizer%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.locks.AbstractQueuedSynchronizeræºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/09/01/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedSynchronizer%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/09/01/æºç ï¼šjava.util.concurrent.locks.AbstractQueuedSynchronizeræºç è§£æ/</a></li></ol></li></ol></li></ol></blockquote><hr><h2 id="4-æºç éƒ¨åˆ†"><a href="#4-æºç éƒ¨åˆ†" class="headerlink" title="4. æºç éƒ¨åˆ†"></a>4. æºç éƒ¨åˆ†</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Sync</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractQueuedSynchronizer</span> &#123;<br><br><span class="hljs-meta">@ReservedStackAccess</span><br><span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryLock</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-type">Thread</span> <span class="hljs-variable">current</span> <span class="hljs-operator">=</span> Thread.currentThread();<br><span class="hljs-type">int</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> getState();<br><span class="hljs-keyword">if</span> (c == <span class="hljs-number">0</span>) &#123;<br><span class="hljs-keyword">if</span> (compareAndSetState(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>)) &#123;<br>setExclusiveOwnerThread(current);<br><span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (getExclusiveOwnerThread() == current) &#123;<br><span class="hljs-keyword">if</span> (++c &lt; <span class="hljs-number">0</span>)<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&quot;Maximum lock count exceeded&quot;</span>);<br>setState(c);<br><span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>&#125;<br><br><span class="hljs-keyword">abstract</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">initialTryLock</span><span class="hljs-params">()</span>;<br><br><span class="hljs-meta">@ReservedStackAccess</span><br><span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">lock</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-keyword">if</span> (!initialTryLock())<br>acquire(<span class="hljs-number">1</span>);<br>&#125;<br><br><span class="hljs-meta">@ReservedStackAccess</span><br><span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">lockInterruptibly</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException &#123;<br><span class="hljs-keyword">if</span> (Thread.interrupted())<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InterruptedException</span>();<br><span class="hljs-keyword">if</span> (!initialTryLock())<br>acquireInterruptibly(<span class="hljs-number">1</span>);<br>&#125;<br><br><span class="hljs-meta">@ReservedStackAccess</span><br><span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryLockNanos</span><span class="hljs-params">(<span class="hljs-type">long</span> nanos)</span> <span class="hljs-keyword">throws</span> InterruptedException &#123;<br><span class="hljs-keyword">if</span> (Thread.interrupted())<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InterruptedException</span>();<br><span class="hljs-keyword">return</span> initialTryLock() || tryAcquireNanos(<span class="hljs-number">1</span>, nanos);<br>&#125;<br><br><span class="hljs-meta">@ReservedStackAccess</span><br><span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryRelease</span><span class="hljs-params">(<span class="hljs-type">int</span> releases)</span> &#123;<br><span class="hljs-type">int</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> getState() - releases;<br><span class="hljs-keyword">if</span> (getExclusiveOwnerThread() != Thread.currentThread())<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalMonitorStateException</span>();<br><span class="hljs-type">boolean</span> <span class="hljs-variable">free</span> <span class="hljs-operator">=</span> (c == <span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span> (free)<br>setExclusiveOwnerThread(<span class="hljs-literal">null</span>);<br>setState(c);<br><span class="hljs-keyword">return</span> free;<br>&#125;<br><br><span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isHeldExclusively</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-keyword">return</span> getExclusiveOwnerThread() == Thread.currentThread();<br>&#125;<br><br><span class="hljs-keyword">final</span> ConditionObject <span class="hljs-title function_">newCondition</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConditionObject</span>();<br>&#125;<br><br><span class="hljs-keyword">final</span> Thread <span class="hljs-title function_">getOwner</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-keyword">return</span> getState() == <span class="hljs-number">0</span> ? <span class="hljs-literal">null</span> : getExclusiveOwnerThread();<br>&#125;<br><br><span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getHoldCount</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-keyword">return</span> isHeldExclusively() ? getState() : <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isLocked</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-keyword">return</span> getState() != <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">readObject</span><span class="hljs-params">(java.io.ObjectInputStream s)</span><br><span class="hljs-keyword">throws</span> java.io.IOException, ClassNotFoundException &#123;<br>s.defaultReadObject();<br>setState(<span class="hljs-number">0</span>);<br>&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.util.concurrent.locks.AbstractQueuedSynchronizer æºç è§£æ</title>
    <link href="/2025/09/01/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedSynchronizer%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/09/01/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedSynchronizer%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw<br><img src="/source/_posts/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedSynchronizer%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedSynchronizer%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.eddx"></p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/09/01/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedSynchronizer%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/09/01/æºç ï¼šjava.util.concurrent.locks.AbstractQueuedSynchronizeræºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-AbstractQueuedSynchronizer-æ¦‚è¿°"><a href="#3-1-AbstractQueuedSynchronizer-æ¦‚è¿°" class="headerlink" title="3.1. AbstractQueuedSynchronizer æ¦‚è¿°"></a>3.1. AbstractQueuedSynchronizer æ¦‚è¿°</h3><p><code>AbstractQueuedSynchronizer</code> æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œç»§æ‰¿äº† <code>java.util.concurrent.locks.AbstractOwnableSynchronizer</code>ï¼Œå®ç°äº† <code>java.io.Serializable</code><br><img src="/source/_posts/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedSynchronizer%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedSynchronizer%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.png"></p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>è¯¦è§æºç ï¼š<code>AbstractOwnableSynchronizer</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractOwnableSynchronizer%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.locks.AbstractOwnableSynchronizeræºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/09/02/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractOwnableSynchronizer%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/09/02/æºç ï¼šjava.util.concurrent.locks.AbstractOwnableSynchronizeræºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>Serializable</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.io.Serializable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.io.Serializableæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/10/28/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.io.Serializable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/10/28/æºç ï¼šjava.io.Serializableæºç è§£æ/</a></li></ol></li></ol></li><li>éœ€è¦æ³¨æ„çš„æ˜¯ï¼š<ol><li><code>Java8</code> çš„ <code>AQS</code> æ˜¯åªæœ‰ <code>Node</code> çš„ï¼Œæ²¡æœ‰ <code>ExclusiveNode</code>ã€<code>SharedNode</code>ã€<code>ConditionNode</code> çš„</li></ol></li></ol></blockquote><hr><h3 id="3-2-AbstractQueuedSynchronizer-åº”ç”¨åœºæ™¯"><a href="#3-2-AbstractQueuedSynchronizer-åº”ç”¨åœºæ™¯" class="headerlink" title="3.2. AbstractQueuedSynchronizer åº”ç”¨åœºæ™¯"></a>3.2. AbstractQueuedSynchronizer åº”ç”¨åœºæ™¯</h3><h4 id="3-2-1-åŒæ­¥å™¨"><a href="#3-2-1-åŒæ­¥å™¨" class="headerlink" title="3.2.1. åŒæ­¥å™¨"></a>3.2.1. åŒæ­¥å™¨</h4><p>åŒæ­¥å™¨æ˜¯ä¸€ç§åè°ƒå¤šä¸ªçº¿ç¨‹æ‰§è¡Œçš„å·¥å…·ã€‚å®ƒé€šè¿‡å†…éƒ¨ç»´æŠ¤çš„çŠ¶æ€ï¼ˆ<code>State</code>ï¼‰ï¼Œç”¨äºæ§åˆ¶å¤šä¸ªçº¿ç¨‹å¯¹ä¸€ä¸ªæˆ–å¤šä¸ªå…±äº«èµ„æºçš„è®¿é—®ï¼Œä»è€Œå®ç°çº¿ç¨‹é—´çš„åŒæ­¥ä¸åä½œ</p><p>ç®€å•æ¥è¯´ï¼Œå¤šä¸ªçº¿ç¨‹éœ€è¦å…ˆç«äº‰åŒæ­¥å™¨èµ„æºï¼ˆå³ <code>State</code>ï¼‰ï¼Œåªæœ‰ç«äº‰æˆåŠŸçš„çº¿ç¨‹æ‰èƒ½è®¿é—®å…±äº«èµ„æºã€‚è€Œ <code>AQS</code> æä¾›äº†ä¸€ç³»åˆ—æœºåˆ¶ï¼Œä½¿å¾—å¤šä¸ªçº¿ç¨‹èƒ½å¤Ÿ â€œé«˜æ•ˆä¸”å®‰å…¨â€ åœ°ç«äº‰ã€é‡Šæ”¾ <code>State</code></p><p>åœ¨åŸºäº <code>AQS</code> çš„åŒæ­¥å™¨å®ç°ä¸­ï¼Œé€šå¸¸éœ€è¦ç»´æŠ¤ä¸¤ç§é˜Ÿåˆ—ï¼š</p><ol><li>ä¸€æ¡åŒæ­¥é˜Ÿåˆ—<ol><li>åŒæ­¥é˜Ÿåˆ—ç”¨äºç®¡ç†é‚£äº›å°è¯•è·å–åŒæ­¥å™¨èµ„æºï¼Œä½†æš‚æ—¶å¤±è´¥å¹¶æš‚æ—¶è¿›å…¥é˜»å¡ï¼ˆ<code>WAITING</code>ã€<code>TIMED_WAITING</code>ï¼‰çš„çº¿ç¨‹</li><li><code>AQS</code> å·²ç»å°è£…å¥½äº†ç›¸å…³çš„èŠ‚ç‚¹ç±»å‹ï¼ˆå³ <code>Node</code>ã€<code>ExclusiveNode</code>ã€<code>SharedNode</code>ï¼‰ï¼Œå¹¶ä¸”æä¾›äº†é¦–å°¾å“¨å…µèŠ‚ç‚¹ã€‚å› æ­¤ï¼Œæˆ‘ä»¬çš„ <code>AQS</code> å®ç°ç±»åªéœ€è¦åœ¨æ­¤åŸºç¡€ä¸Šç»´æŠ¤åŒæ­¥é˜Ÿåˆ—å³å¯</li></ol></li><li>å¤šæ¡æ¡ä»¶é˜Ÿåˆ—<ol><li>æ¡ä»¶é˜Ÿåˆ—ç”¨äºç®¡ç†é‚£äº›å·²ç»è·å–åŒæ­¥å™¨èµ„æºï¼Œä½†å› ä¸šåŠ¡æ¡ä»¶ä¸æ»¡è¶³ï¼Œè€Œè°ƒç”¨äº† <code>Condition.await</code>ï¼Œé‡Šæ”¾åŒæ­¥å™¨èµ„æºå¹¶æš‚æ—¶è¿›å…¥é˜»å¡ï¼ˆ<code>WAITING</code>ã€<code>TIMED_WAITING</code>ï¼‰çš„çº¿ç¨‹</li><li><code>AQS</code> å·²ç»å°è£…å¥½äº† <code>ConditionObject</code> å’Œç›¸å…³çš„èŠ‚ç‚¹ç±»å‹ï¼ˆå³ <code>ConditionNode</code>ï¼‰ï¼Œä¸€ä¸ª <code>ConditionObject</code> å®ä¾‹å°±æ˜¯ä¸€æ¡æ¡ä»¶é˜Ÿåˆ—ã€‚å› æ­¤ï¼Œæˆ‘ä»¬çš„ <code>AQS</code> å®ç°ç±»åªéœ€è¦æ ¹æ®è‡ªå·±çš„éœ€è¦ï¼Œåˆ›å»ºå¹¶ç»´æŠ¤ <code>ConditionObject</code> å®ä¾‹å³å¯<br><img src="/source/_posts/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedSynchronizer%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedSynchronizer%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90-1.png"></li></ol></li></ol><p>åœ¨ä¸åŒçš„åŒæ­¥å™¨å®ç°ä¸­ï¼Œ<code>State</code> å’Œå…±äº«èµ„æºæœ‰ä¸åŒçš„å«ä¹‰ï¼Œä¾‹å¦‚åœ¨ <code>ReentrantLock</code> ä¸­ï¼š</p><ol><li><code>State</code> è¡¨ç¤ºé”çš„é‡å…¥æ¬¡æ•°<ol><li><code>0</code><ol><li>è¡¨ç¤ºé”ç©ºé—²ï¼Œçº¿ç¨‹å¯ä»¥å°è¯•è·å–</li></ol></li><li><code>1</code><ol><li>è¡¨ç¤ºé”å·²è¢«æŸä¸ªçº¿ç¨‹æŒæœ‰</li></ol></li><li><code>nï¼ˆn &gt; 1ï¼‰</code><ol><li>è¡¨ç¤ºåŒä¸€çº¿ç¨‹å¯¹è¯¥é”è¿›è¡Œäº† <code>n</code> æ¬¡é‡å…¥</li></ol></li></ol></li><li>å…±äº«èµ„æºè¡¨ç¤ºåŠ é”æœŸé—´çš„æ“ä½œ</li></ol><p>åœ¨ä½¿ç”¨ <code>AQS</code> æ—¶ï¼Œç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼ˆçº¦ <code>99%</code>ï¼‰éƒ½æ˜¯ç”¨æ¥å®ç°å„ç§åŒæ­¥å™¨ï¼ˆä¾‹å¦‚ <code>ReentrantLock</code>ã€<code>Semaphore</code>ã€<code>CountDownLatch</code>ï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦ä½¿ç”¨åˆ°çš„ä»¥ä¸‹å†…å®¹ï¼š</p><ol><li><code>AOS</code><ol><li>å¦‚æœåŸºäº <code>AQS</code> å®ç°çš„æ˜¯ç‹¬å æ¨¡å¼çš„åŒæ­¥å™¨ï¼ˆä¾‹å¦‚ <code>ReentrantLock</code>ï¼‰ï¼Œå°±éœ€è¦ä½¿ç”¨ <code>AOS</code> è®°å½•å½“å‰ç‹¬å è¯¥èµ„æºçš„çº¿ç¨‹</li><li>ä½†æ˜¯å¦‚æœåŸºäº <code>AQS</code> å®ç°çš„æ˜¯å…±äº«æ¨¡å¼çš„åŒæ­¥å™¨ï¼ˆä¾‹å¦‚ <code>Semaphore</code>ï¼‰ï¼Œé‚£ä¹ˆ <code>AOS</code> æ ¹æœ¬å°±ç”¨ä¸åˆ°</li></ol></li><li><code>AQS</code><ol><li><code>State</code></li><li>åŒæ­¥é˜Ÿåˆ—</li><li>æ¡ä»¶é˜Ÿåˆ—</li></ol></li></ol><p>åœ¨ä½¿ç”¨ <code>AQS</code> å®ç°åŒæ­¥å™¨æ—¶ï¼Œé€šå¸¸çš„åšæ³•æ˜¯ï¼šåœ¨åŒæ­¥å™¨å†…éƒ¨å®šä¹‰ä¸€ä¸ªé™æ€å†…éƒ¨ç±»ï¼ˆä¸€èˆ¬å‘½åä¸º <code>Sync</code>ï¼‰ï¼Œå¹¶è®© <code>Sync</code> ç»§æ‰¿ <code>AbstractQueuedSynchronizer</code>ï¼Œè€Œä¸æ˜¯è®©åŒæ­¥å™¨ç›´æ¥ç»§æ‰¿ <code>AQS</code></p><p>å½“å¤–éƒ¨è°ƒç”¨åŒæ­¥å™¨çš„æ–¹æ³•æ—¶ï¼Œæ‰§è¡Œçš„æµç¨‹å¤§è‡´ä¸ºï¼š<code>å¤–éƒ¨è°ƒç”¨åŒæ­¥å™¨çš„æ–¹æ³• â†’ åŒæ­¥å™¨è°ƒç”¨ Sync çš„æ–¹æ³• â†’ Sync è°ƒç”¨ AQS çš„æ–¹æ³•</code></p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>çŒ´å“¥çš„çƒ¦æ¼ç®± <code>(ï½¡â€¢Ìï¸¿â€¢Ì€ï½¡)</code>ï¼š<ol><li>åœ¨ä½¿ç”¨ <code>AQS</code> å®ç°åŒæ­¥å™¨æ—¶ï¼Œä¸ºä»€ä¹ˆä¸ç›´æ¥è®©åŒæ­¥å™¨ç›´æ¥ç»§æ‰¿ <code>AQS</code>ï¼Ÿ<ol><li>å…¶å®è¿™é‡Œå®é™…ä½¿ç”¨äº† <code>GOF</code> è®¾è®¡æ¨¡å¼ä¹‹ç­–ç•¥æ¨¡å¼ï¼Œä»¥ <code>ReentrangLock</code> ä¸ºä¾‹</li><li><code>RenntrantLock</code> éœ€è¦æ”¯æŒ â€œå…¬å¹³é”â€ å’Œ â€œéå…¬å¹³é”â€ ä¸¤ç§æ¨¡å¼ï¼Œè€Œä¸¤è€…åœ¨ç«äº‰ <code>State</code> çš„é€»è¾‘ä¸Šå®Œå…¨ä¸åŒ</li><li>ä½†æ˜¯ <code>AQS</code> åªæä¾›äº†ç«äº‰ <code>State</code> çš„æ–¹æ³•ï¼Œå› æ­¤å…·ä½“çš„ç«äº‰é€»è¾‘å¿…é¡»ç”± <code>AQS</code> çš„å®ç°ç±»æ¥å®šä¹‰ã€‚</li><li>å¦‚æœåŒæ­¥å™¨ç›´æ¥ç»§æ‰¿ <code>AQS</code>ï¼Œå°±éœ€è¦åœ¨æ¯æ¬¡æ“ä½œä¸­ä½¿ç”¨ <code>if...else if...else</code> æˆ– <code>switch...case...default</code> åˆ¤æ–­å…¬å¹³é”æˆ–éå…¬å¹³é”ï¼Œç„¶åæ‰§è¡Œä¸åŒçš„ç«äº‰é€»è¾‘</li><li>ä¸ºäº†é¿å…å¤§é‡çš„ <code>if...else if...else</code> æˆ– <code>switch...case...default</code> åˆ¤æ–­ï¼Œ<code>ReentrantLock</code> å°±é‡‡ç”¨äº†ç­–ç•¥æ¨¡å¼</li><li><code>ReentrantLock</code> å†…éƒ¨å®šä¹‰äº†ä¸¤ä¸ªé™æ€å†…éƒ¨ç±»ï¼ˆå³ <code>FairSync</code>ã€<code>NonFairSync</code>ï¼‰ï¼Œè¿™ä¸¤ä¸ªç±»åˆ†åˆ«å®ç°å„è‡ªçš„ç«äº‰é€»è¾‘</li></ol></li></ol></li></ol></blockquote><hr><h4 id="3-2-2-çŠ¶æ€æœº"><a href="#3-2-2-çŠ¶æ€æœº" class="headerlink" title="3.2.2. çŠ¶æ€æœº"></a>3.2.2. çŠ¶æ€æœº</h4><p>çŠ¶æ€æœºé€šè¿‡å†…éƒ¨ç»´æŠ¤çš„çŠ¶æ€ï¼ˆ<code>State</code>ï¼‰ï¼Œç”¨äºè¡¨ç¤ºå…¶å®ä¾‹åœ¨ç”Ÿå‘½å‘¨æœŸä¸­å¯èƒ½ç»å†çš„å„ä¸ªé˜¶æ®µ</p><p>åœ¨ä½¿ç”¨ <code>AQS</code> æ—¶ï¼Œæœ‰å°‘æ•°æƒ…å†µï¼ˆçº¦ <code>1%</code>ï¼‰ä¼šç”¨æ¥å®ç°çŠ¶æ€æœºï¼ˆä¾‹å¦‚ <code>ThreadPoolExecutor.Worker</code>ï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦ä½¿ç”¨åˆ°ä»¥ä¸‹å†…å®¹ï¼š</p><ol><li><code>AQS</code><ol><li><code>State</code></li></ol></li></ol><p>åœ¨ä¸åŒçš„çŠ¶æ€æœºå®ç°ä¸­ï¼Œ<code>State</code> æœ‰ä¸åŒçš„å«ä¹‰ï¼Œä¾‹å¦‚åœ¨ <code>ThreadPoolExecutor.Worker</code> ä¸­ï¼š</p><ol><li><code>-1</code><ol><li><code>Worker</code> æ­£åœ¨è¢«å®ä¾‹åŒ–</li></ol></li><li><code>0</code><ol><li><code>Worker</code> å¹¶æ²¡æœ‰ â€œæ‰§è¡Œâ€ ä»»åŠ¡ï¼ˆæ­£åœ¨ä»ä»»åŠ¡é˜Ÿåˆ—ä¸­è·å–ä»»åŠ¡ï¼‰</li></ol></li><li><code>1</code><ol><li><code>Worker</code> æ­£åœ¨ â€œæ‰§è¡Œâ€ ä»»åŠ¡</li></ol></li></ol><p>åœ¨ä½¿ç”¨ <code>AQS</code> å®ç°çŠ¶æ€æœºæ—¶ï¼Œé€šå¸¸çš„åšæ³•æ˜¯ï¼šç›´æ¥è®©çŠ¶æ€æœºç»§æ‰¿ <code>AQS</code></p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>çŒ´å“¥çš„çƒ¦æ¼ç®± <code>(ï½¡â€¢Ìï¸¿â€¢Ì€ï½¡)</code><ol><li>ä¸ºä»€ä¹ˆå®ç°çŠ¶æ€æœºè¿˜è¦ä½¿ç”¨ <code>AQS</code>ï¼Ÿæˆ‘ä»¬ç›´æ¥åœ¨çŠ¶æ€æœºå†…éƒ¨ç»´æŠ¤ä¸€ä¸ª <code>State</code> ä¸å°±è¡Œäº†å˜›ï¼Ÿ<ol><li>å› ä¸º <code>AQS</code> æä¾›äº†ä¸€ç³»åˆ—æœºåˆ¶ï¼Œä½¿å¾—å¤šä¸ªçº¿ç¨‹èƒ½å¤Ÿ â€œé«˜æ•ˆä¸”å®‰å…¨â€ åœ°ç«äº‰ã€é‡Šæ”¾ <code>State</code></li><li>è€Œæˆ‘ä»¬è‡ªå·±å®ç°ä¸ä¸€å®šèƒ½åšåˆ°è¿™ä¹ˆç¨³å¦¥ï¼Œè€Œä¸”åªæ˜¯åœ¨èµ° â€œ<code>AQS</code>â€ çš„è€è·¯ï¼Œä¸å¦‚ç›´æ¥å¤ç”¨æœ€çœå¿ƒ</li></ol></li></ol></li></ol></blockquote><hr><h2 id="4-å†…éƒ¨ç±»"><a href="#4-å†…éƒ¨ç±»" class="headerlink" title="4. å†…éƒ¨ç±»"></a>4. å†…éƒ¨ç±»</h2><h3 id="4-1-Node"><a href="#4-1-Node" class="headerlink" title="4.1. Node"></a>4.1. Node</h3><p>è¯¦è§æºç ï¼š<code>AbstractQueuedSynchronizer.Node</code></p><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedSynchronizer.Node%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.locks.AbstractQueuedSynchronizer.Nodeæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/08/31/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedSynchronizer.Node%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/08/31/æºç ï¼šjava.util.concurrent.locks.AbstractQueuedSynchronizer.Nodeæºç è§£æ/</a></li></ol></li></ol><hr><h3 id="4-2-ExclusiveNode"><a href="#4-2-ExclusiveNode" class="headerlink" title="4.2. ExclusiveNode"></a>4.2. ExclusiveNode</h3><p><code>AbstractQueuedSynchronizer.ExclusiveNode</code> åªæ˜¯ç®€å•åœ°ç»§æ‰¿äº†Â <code>AbstractQueuedSynchronizer.Node</code>ï¼Œä¸ºÂ <code>AbstractQueuedSynchronizer.Node</code>Â å¢åŠ äº†ä¸€å±‚ â€œç‹¬å æ¨¡å¼èŠ‚ç‚¹â€ çš„æ ‡ç­¾ï¼Œç”¨æ¥æ˜ç¡®åŒºåˆ†èŠ‚ç‚¹æ‰€å¤„çš„è¯­ä¹‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ExclusiveNode</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Node</span> &#123; &#125;<br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>å¦‚æœåŸºäº <code>AQS</code> å®ç°çš„æ˜¯ç‹¬å æ¨¡å¼åŒæ­¥å™¨ï¼ˆä¾‹å¦‚ <code>ReentrantLock</code>ï¼‰ï¼Œé‚£ä¹ˆåŒæ­¥é˜Ÿåˆ—ä¸­çš„ <code>Node</code> å°±åº”è¯¥æ˜¯ <code>ExclusiveNode</code></li></ol></blockquote><hr><h3 id="4-3-SharedNode"><a href="#4-3-SharedNode" class="headerlink" title="4.3. SharedNode"></a>4.3. SharedNode</h3><p><code>AbstractQueuedSynchronizer.SharedNode</code> ä¹Ÿåªæ˜¯ç®€å•åœ°ç»§æ‰¿äº†Â <code>AbstractQueuedSynchronizer.Node</code>ï¼Œä¸ºÂ <code>AbstractQueuedSynchronizer.Node</code>Â å¢åŠ äº†ä¸€å±‚ â€œå…±äº«æ¨¡å¼èŠ‚ç‚¹â€ çš„æ ‡ç­¾ï¼Œç”¨æ¥æ˜ç¡®åŒºåˆ†èŠ‚ç‚¹æ‰€å¤„çš„è¯­ä¹‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SharedNode</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Node</span> &#123; &#125;<br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>å¦‚æœåŸºäº <code>AQS</code> å®ç°çš„æ˜¯å…±äº«æ¨¡å¼åŒæ­¥å™¨ï¼ˆä¾‹å¦‚ <code>Semaphore</code>ï¼‰ï¼Œé‚£ä¹ˆåŒæ­¥é˜Ÿåˆ—ä¸­çš„ <code>Node</code> å°±åº”è¯¥æ˜¯ <code>SharedNode</code></li></ol></blockquote><hr><h3 id="4-4-ConditionObject"><a href="#4-4-ConditionObject" class="headerlink" title="4.4. ConditionObject"></a>4.4. ConditionObject</h3><p>è¯¦è§æºç ï¼š<code>AbstractQueuedSynchronizer.ConditionObject</code></p><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedSynchronizer.ConditionObject%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.locks.AbstractQueuedSynchronizer.ConditionObjectæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/08/31/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedSynchronizer.ConditionObject%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/08/31/æºç ï¼šjava.util.concurrent.locks.AbstractQueuedSynchronizer.ConditionObjectæºç è§£æ/</a></li></ol></li></ol><hr><h3 id="4-5-ConditionNode"><a href="#4-5-ConditionNode" class="headerlink" title="4.5. ConditionNode"></a>4.5. ConditionNode</h3><p>è¯¦è§æºç ï¼š<code>AbstractQueuedSynchronizer.ConditionNode</code></p><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedSynchronizer.ConditionNode%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.locks.AbstractQueuedSynchronizer.ConditionNodeæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/08/31/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedSynchronizer.ConditionNode%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/08/31/æºç ï¼šjava.util.concurrent.locks.AbstractQueuedSynchronizer.ConditionNodeæºç è§£æ/</a></li></ol></li></ol><hr><h2 id="5-æ ¸å¿ƒå±æ€§"><a href="#5-æ ¸å¿ƒå±æ€§" class="headerlink" title="5. æ ¸å¿ƒå±æ€§"></a>5. æ ¸å¿ƒå±æ€§</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// è¡¨ç¤º AQS çš„åŒæ­¥é˜Ÿåˆ—çš„é¦–å“¨å…µèŠ‚ç‚¹</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">transient</span> <span class="hljs-keyword">volatile</span> Node head;<br><br><span class="hljs-comment">// è¡¨ç¤º AQS çš„åŒæ­¥é˜Ÿåˆ—çš„å°¾å“¨å…µèŠ‚ç‚¹</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">transient</span> <span class="hljs-keyword">volatile</span> Node tail;<br><br><span class="hljs-comment">// è¡¨ç¤º AQS çš„æ ¸å¿ƒçŠ¶æ€ä½ï¼ˆStateï¼‰</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">int</span> state;<br></code></pre></td></tr></table></figure><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.util.concurrent.Executor æºç è§£æ</title>
    <link href="/2025/08/31/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.Executor%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/08/31/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.Executor%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/08/31/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.Executor%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/08/31/æºç ï¼šjava.util.concurrent.Executoræºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-Executor-æ¦‚è¿°"><a href="#3-1-Executor-æ¦‚è¿°" class="headerlink" title="3.1. Executor æ¦‚è¿°"></a>3.1. Executor æ¦‚è¿°</h3><p><code>Executor</code> æ˜¯ä¸€ä¸ªæ¥å£ï¼Œä¸ºæˆ‘ä»¬æä¾›äº†ä»¥ä¸‹æ–¹æ³•ï¼š</p><ol><li>æäº¤ä¸€ä¸ª <code>Runnable</code> ä»»åŠ¡ï¼ˆéé˜»å¡ï¼‰</li></ol><hr><h2 id="4-æºç éƒ¨åˆ†"><a href="#4-æºç éƒ¨åˆ†" class="headerlink" title="4. æºç éƒ¨åˆ†"></a>4. æºç éƒ¨åˆ†</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Executor</span> &#123;<br><br><span class="hljs-comment">// ç”¨äºéé˜»å¡æäº¤ä¸€ä¸ª Runnable ä»»åŠ¡</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">execute</span><span class="hljs-params">(Runnable command)</span>;<br>    <br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>è¯¦è§æºç ï¼š<code>Runnable</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.Runnable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.Runnableæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/09/02/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.Runnable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/09/02/æºç ï¼šjava.util.concurrent.Runnableæºç è§£æ/</a></li></ol></li></ol></li></ol></blockquote><hr><h2 id="5-å®ç°ç¤ºä¾‹"><a href="#5-å®ç°ç¤ºä¾‹" class="headerlink" title="5. å®ç°ç¤ºä¾‹"></a>5. å®ç°ç¤ºä¾‹</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DemoExecutor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Executor</span> &#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">execute</span><span class="hljs-params">(Runnable command)</span> &#123;<br>        <span class="hljs-keyword">if</span> (command == <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NullPointerException</span>(<span class="hljs-string">&quot;Runnable ä¸èƒ½ä¸º null&quot;</span>);<br>        &#125;<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(command).start();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Executor</span> <span class="hljs-variable">executor</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DemoExecutor</span>();<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">3</span>; i++) &#123;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> i;<br>            executor.execute(() -&gt; &#123;<br>                System.out.println(<span class="hljs-string">&quot;æ‰§è¡Œä»»åŠ¡ &quot;</span> + id + <span class="hljs-string">&quot; çš„çº¿ç¨‹: &quot;</span> + Thread.currentThread().getName());<br>            &#125;);<br>        &#125;<br>    &#125;<br>    <br>&#125;<br></code></pre></td></tr></table></figure><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.util.concurrent.locks.AbstractQueuedSynchronizer.ConditionNode æºç è§£æ</title>
    <link href="/2025/08/31/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedSynchronizer.ConditionNode%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/08/31/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedSynchronizer.ConditionNode%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/08/31/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedSynchronizer.ConditionNode%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/08/31/æºç ï¼šjava.util.concurrent.locks.AbstractQueuedSynchronizer.ConditionNodeæºç è§£æ/</a></p></li></ol><hr><h2 id="3-æ¦‚è¿°"><a href="#3-æ¦‚è¿°" class="headerlink" title="3. æ¦‚è¿°"></a>3. æ¦‚è¿°</h2><p><code>AbstractQueuedSynchronizer.ConditionNode</code> æ˜¯ä¸€ä¸ªå…·ä½“ç±»ï¼Œæ˜¯ <code>AQS</code> çš„ é™æ€å†…éƒ¨ç±»ï¼Œç»§æ‰¿äº† <code>AbstractQueuedSynchronizer.Node</code>ï¼Œå®ç°äº† <code>ForkJoinPool.ManagedBlocker</code></p><p><code>AQS</code> çš„æ¡ä»¶é˜Ÿåˆ—å°±æ˜¯æ˜¯ç”± <code>AbstractQueuedSynchronizer.ConditionNode</code> æ„å»ºçš„ï¼ŒåŸºäºå•å‘é“¾è¡¨çš„é˜Ÿåˆ—</p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>è¯¦è§æºç ï¼š<code>AbstractQueuedSynchronizer</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedSynchronizer%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.locks.AbstractQueuedSynchronizeræºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/09/01/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedSynchronizer%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/09/01/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedSynchronizer%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>AbstractQueuedSynchronizer.Node</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedSynchronizer.Node%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.locks.AbstractQueuedSynchronizer.Nodeæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/08/31/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedSynchronizer.Node%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/08/31/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedSynchronizer.Node%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</a></li></ol></li></ol></li></ol></blockquote><hr><h2 id="4-æºç éƒ¨åˆ†"><a href="#4-æºç éƒ¨åˆ†" class="headerlink" title="4. æºç éƒ¨åˆ†"></a>4. æºç éƒ¨åˆ†</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ConditionNode</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Node</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ForkJoinPool</span>.ManagedBlocker &#123;<br><br><span class="hljs-comment">// è¡¨ç¤ºè¯¥èŠ‚ç‚¹åœ¨ AQS çš„æ¡ä»¶é˜Ÿåˆ—ä¸­çš„åé©±èŠ‚ç‚¹</span><br>ConditionNode nextWaiter;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isReleasable</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-keyword">return</span> status &lt;= <span class="hljs-number">1</span> || Thread.currentThread().isInterrupted();<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">block</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-keyword">while</span> (!isReleasable()) LockSupport.park();<br><span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.util.concurrent.locks.AbstractQueuedSynchronizer.ConditionObject æºç è§£æ</title>
    <link href="/2025/08/31/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedSynchronizer.ConditionObject%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/08/31/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedSynchronizer.ConditionObject%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw<br><img src="/source/_posts/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedSynchronizer.ConditionObject%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedSynchronizer.ConditionObject%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.eddx"></p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/08/31/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedSynchronizer.ConditionObject%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/08/31/æºç ï¼šjava.util.concurrent.locks.AbstractQueuedSynchronizer.ConditionObjectæºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-AbstractQueuedSynchronizer-ConditionObject-æ¦‚è¿°"><a href="#3-1-AbstractQueuedSynchronizer-ConditionObject-æ¦‚è¿°" class="headerlink" title="3.1. AbstractQueuedSynchronizer.ConditionObject æ¦‚è¿°"></a>3.1. AbstractQueuedSynchronizer.ConditionObject æ¦‚è¿°</h3><p><code>ConditionObject</code> æ˜¯ä¸€ä¸ªå…·ä½“ç±»ï¼Œæ˜¯ <code>java.util.concurrent.locks.AbstractQueuedSynchronizer</code>. çš„æ™®é€šå†…éƒ¨ç±»ï¼Œå®ç°äº† <code>java.util.concurrent.locks.Condition</code>ã€<code>java.io.Serializable</code><br><img src="/source/_posts/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedSynchronizer.ConditionObject%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedSynchronizer.ConditionObject%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.png"></p><p><code>ConditionObject</code> ç»´æŠ¤äº†ä¸€ä¸ªç”± <code>AbstractQueuedSynchronizer.ConditionNode</code> æ„å»ºçš„ï¼ŒåŸºäºå•å‘é“¾è¡¨çš„é˜Ÿåˆ—ã€‚æ‰€è°“çš„ â€œ<code>AQS</code> çš„æ¡ä»¶é˜Ÿåˆ—â€ å…¶å®å°±æ˜¯åœ¨è¯´ <code>ConditionObject</code> ç»´æŠ¤çš„è¿™æ¡ä»¶é˜Ÿåˆ—<br><img src="/source/_posts/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedSynchronizer.ConditionObject%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedSynchronizer.ConditionObject%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90-1.png"></p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>è¯¦è§æºç ï¼š<code>AbstractQueuedSynchronizer</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedSynchronizer%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.locks.AbstractQueuedSynchronizeræºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/09/01/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedSynchronizer%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/09/01/æºç ï¼šjava.util.concurrent.locks.AbstractQueuedSynchronizeræºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>Condition</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.Condition%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.locks.Conditionæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/08/31/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.Condition%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/08/31/æºç ï¼šjava.util.concurrent.locks.Conditionæºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>Serializable</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.io.Serializable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.io.Serializableæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/10/28/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.io.Serializable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/10/28/æºç ï¼šjava.io.Serializableæºç è§£æ/</a></li></ol></li></ol></li></ol></blockquote><hr><h2 id="4-æ ¸å¿ƒå±æ€§"><a href="#4-æ ¸å¿ƒå±æ€§" class="headerlink" title="4. æ ¸å¿ƒå±æ€§"></a>4. æ ¸å¿ƒå±æ€§</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// è¡¨ç¤º AQS çš„æ¡ä»¶é˜Ÿåˆ—çš„é¦–å“¨å…µèŠ‚ç‚¹</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">transient</span> ConditionNode firstWaiter;<br><br><span class="hljs-comment">// è¡¨ç¤º AQS çš„æ¡ä»¶é˜Ÿåˆ—çš„å°¾å“¨å…µèŠ‚ç‚¹</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">transient</span> ConditionNode lastWaiter;<br></code></pre></td></tr></table></figure><hr><h2 id="5-å…·ä½“æ–¹æ³•"><a href="#5-å…·ä½“æ–¹æ³•" class="headerlink" title="5. å…·ä½“æ–¹æ³•"></a>5. å…·ä½“æ–¹æ³•</h2><h3 id="5-1-å…·ä½“æ–¹æ³•ï¼ˆæ— ï¼‰"><a href="#5-1-å…·ä½“æ–¹æ³•ï¼ˆæ— ï¼‰" class="headerlink" title="5.1. å…·ä½“æ–¹æ³•ï¼ˆæ— ï¼‰"></a>5.1. å…·ä½“æ–¹æ³•ï¼ˆæ— ï¼‰</h3><h4 id="5-1-1-private-int-enableWait-ConditionNode-node"><a href="#5-1-1-private-int-enableWait-ConditionNode-node" class="headerlink" title="5.1.1. private int enableWait(ConditionNode node)"></a>5.1.1. private int enableWait(ConditionNode node)</h4><p><code>private int enableWait(ConditionNode node)</code> ç”¨äº æŠŠå½“å‰çº¿ç¨‹åŒ…è£…æˆä¸€ä¸ª <code>ConditionNode</code>ï¼Œç„¶åå°†è¯¥èŠ‚ç‚¹é“¾æ¥åˆ°æ¡ä»¶é˜Ÿåˆ—ï¼ˆå•å‘é“¾è¡¨ï¼‰ä¸­ï¼Œå¹¶é‡Šæ”¾é”èµ„æº</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * ============================================</span><br><span class="hljs-comment"> * 1. è®¿é—®ä¿®é¥°ç¬¦</span><br><span class="hljs-comment"> *      1. private</span><br><span class="hljs-comment"> *          1. ç‹¬å®ˆç§˜å¯†ï¼ˆç±»å†…éƒ¨ï¼‰</span><br><span class="hljs-comment"> *          2. ç”±äºæ˜¯åˆ«äººå°è£…å¥½çš„ï¼Œç±»å†…éƒ¨æ˜¯åšä¸åˆ°äº†ï¼Œè®¿é—®å’Œæ“ä½œæ˜¯åšä¸åˆ°äº†</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 2. éè®¿é—®ä¿®é¥°ç¬¦</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 3. æ–¹æ³•å‚æ•°</span><br><span class="hljs-comment"> *      1. ConditionNode node</span><br><span class="hljs-comment"> *          1. ä¸€ä¸ªç©ºçš„ ConditionNodeï¼Œå½“å‰çº¿ç¨‹å°±æ˜¯åŒ…è£…åœ¨è¿™ä¸ª Node ä¸­</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 4. è¿”å›å€¼</span><br><span class="hljs-comment"> *      1. åœ¨è¿›å…¥ await() ä¹‹å‰ï¼ŒåŒæ­¥å™¨ï¼ˆAQSï¼‰çš„ state å€¼</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 5. æŠ›å‡ºå¼‚å¸¸</span><br><span class="hljs-comment"> *      1. IllegalMonitorStateException</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 6. ä½¿ç”¨ç¤ºä¾‹</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * ============================================</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-title function_">enableWait</span><span class="hljs-params">(ConditionNode node)</span> &#123;<br><br><span class="hljs-comment">// å¦‚æœç‹¬å é”æ˜¯å¦è¢«å½“å‰çº¿ç¨‹æŒæœ‰ï¼ˆCondition æ˜¯ä¸“é—¨ç”¨äºç‹¬å é”çš„ï¼‰</span><br><span class="hljs-keyword">if</span> (isHeldExclusively()) &#123;<br><br><span class="hljs-comment">// å°†å½“å‰çº¿ç¨‹å°è£…åˆ° Node çš„ waiter ä¸­</span><br>node.waiter = Thread.currentThread();<br><br><span class="hljs-comment">// å°† node çš„çŠ¶æ€è®¾ç½®ä¸º CONDï¼ˆæ¡ä»¶é˜Ÿåˆ—ï¼‰ + ç­‰å¾…ä¸­</span><br>node.setStatusRelaxed(COND | WAITING);<br><br><span class="hljs-comment">// å°† Node é“¾æ¥åˆ°æ¡ä»¶é˜Ÿåˆ—ä¸­ï¼ˆå•å‘é“¾è¡¨ï¼‰</span><br><span class="hljs-type">ConditionNode</span> <span class="hljs-variable">last</span> <span class="hljs-operator">=</span> lastWaiter;<br><span class="hljs-keyword">if</span> (last == <span class="hljs-literal">null</span>)<br>firstWaiter = node;<br><span class="hljs-keyword">else</span><br>last.nextWaiter = node;<br>lastWaiter = node;<br><br><span class="hljs-comment">// è®°å½•å½“å‰ state</span><br><span class="hljs-type">int</span> <span class="hljs-variable">savedState</span> <span class="hljs-operator">=</span> getState();<br><br><span class="hljs-comment">// è®© state æ¸…é›¶ï¼Œå½»åº•é‡Šæ”¾</span><br><span class="hljs-keyword">if</span> (release(savedState))<br><span class="hljs-keyword">return</span> savedState;<br>&#125;<br><span class="hljs-comment">// å¦‚æœç‹¬å é”ä¸æ˜¯è¢«å½“å‰çº¿ç¨‹æŒæœ‰ï¼Œåˆ™å°†è¯¥ Node çš„çŠ¶æ€è®¾ç½®ä¸º CANCELLED å¹¶æŠ›å‡º throw new IllegalMonitorStateException();</span><br>node.status = CANCELLED;<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalMonitorStateException</span>();<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h4 id="5-1-2-private-boolean-canReacquire-ConditionNode-node"><a href="#5-1-2-private-boolean-canReacquire-ConditionNode-node" class="headerlink" title="5.1.2. private boolean canReacquire(ConditionNode node)"></a>5.1.2. private boolean canReacquire(ConditionNode node)</h4><p><code>private boolean canReacquire(ConditionNode node)</code> ç”¨äº åˆ¤æ–­æŸä¸ªåœ¨ <code>Condition</code> ä¸Šç­‰å¾…çš„èŠ‚ç‚¹ï¼Œè¢« <code>Condition</code> çš„ <code>signal</code> åï¼Œæ˜¯å¦å·²ç»é“¾æ¥åˆ°åŒæ­¥é˜Ÿåˆ—ä¸­</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œçº¿ç¨‹åœ¨è¢« <code>Condition</code> çš„Â <code>signal()</code>Â å”¤é†’åï¼ŒæŒ‰è®¾è®¡ä¸€å®šä¼šè½¬ç§»åˆ°åŒæ­¥é˜Ÿåˆ—ä¸­å»ç«äº‰é”ã€‚ä½†åœ¨é«˜å¹¶å‘ç¯å¢ƒä¸‹ï¼ŒèŠ‚ç‚¹çš„å…¥é˜Ÿè¿‡ç¨‹å¹¶éä¸€æ­¥åˆ°ä½ï¼Œå¯èƒ½å‡ºç°é“¾è¡¨æŒ‡é’ˆå°šæœªå®Œå…¨ä¿®å¤æˆ–èŠ‚ç‚¹å·²è¢«å–æ¶ˆç­‰ç­‰ â€œä¸­é—´æ€â€ã€‚å› æ­¤ï¼Œéœ€è¦é€šè¿‡è¿™ä¸ªæ–¹æ³•è¿›è¡Œæ ¡éªŒï¼Œç¡®ä¿èŠ‚ç‚¹ç¡®å®å·²ç»ç¨³å®šåœ°è¿›å…¥åŒæ­¥é˜Ÿåˆ—ï¼Œæ‰ç®—çœŸæ­£å…·å¤‡é‡æ–°ç«äº‰é”çš„èµ„æ ¼ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">canReacquire</span><span class="hljs-params">(ConditionNode node)</span> &#123;<br>Node p;<br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * node != null æ˜¯æœ€åŸºç¡€çš„æ£€æŸ¥ï¼Œä¼ å…¥ Node ä¸èƒ½ä¸º null</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * (p = node.prev) != null ç”¨äºæ£€æŸ¥è¿™ä¸ªèŠ‚ç‚¹æ˜¯å¦æœ‰å‰é©±ï¼Œ</span><br><span class="hljs-comment"> * å› ä¸ºåœ¨ AQS çš„åŒæ­¥é˜Ÿåˆ—ä¸­ï¼Œé™¤äº†å¤´èŠ‚ç‚¹ï¼Œå…¶ä»–èŠ‚ç‚¹éƒ½å¿…é¡»æœ‰ prev</span><br><span class="hljs-comment"> * å¦‚æœ prev ä¸º nullï¼Œè¯´æ˜å®ƒä¸åœ¨åŒæ­¥é˜Ÿåˆ—é‡Œ</span><br><span class="hljs-comment"> * ä¸è¦çŒœæµ‹è¯¥èŠ‚ç‚¹æ˜¯å¦æ˜¯é˜Ÿå¤´èŠ‚ç‚¹ï¼Œå› ä¸ºåŒæ­¥é˜Ÿåˆ—ä¸€å®šä¼šå­˜åœ¨ä¸€ä¸ªå¤´èŠ‚ç‚¹ï¼Œè€Œä¸”æ˜¯ä¸€ä¸ªå“‘èŠ‚ç‚¹</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * (p.next == node || isEnqueued(node)) ä¸­çš„ p.next == node</span><br><span class="hljs-comment"> * æ˜¯çœ‹è¿™ä¸ªèŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹çš„ next æ˜¯å¦æ­£ç¡®æŒ‡å‘è‡ªå·±ï¼Œå¦‚æœæ˜¯ï¼Œè¯´æ˜è¿™ä¸ªèŠ‚ç‚¹ç¡®å®åœ¨åŒæ­¥é˜Ÿåˆ—ä¸­</span><br><span class="hljs-comment"> * ä½†æ˜¯å› ä¸ºåœ¨é«˜å¹¶å‘ä¸‹ï¼ŒèŠ‚ç‚¹åˆšè¢«åŠ è¿›é˜Ÿåˆ—ï¼Œå¯èƒ½è¿˜æ²¡æ¥å¾—åŠå®Œå…¨ä¿®å¤ p.nextï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œå•é è¿™ä¸ªåˆ¤æ–­ä¼šå‡ºé”™</span><br><span class="hljs-comment"> * æ‰€ä»¥é€šè¿‡ isEnqueued(node) æ¥éå†ç¡®è®¤å®ƒç¡®å®åœ¨åŒæ­¥é˜Ÿåˆ—ä¸­</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">return</span> node != <span class="hljs-literal">null</span> &amp;&amp; (p = node.prev) != <span class="hljs-literal">null</span> &amp;&amp;<br>(p.next == node || isEnqueued(node));<br>&#125;<br></code></pre></td></tr></table></figure><hr><h4 id="5-1-3-private-void-doSignal-ConditionNode-first-boolean-all"><a href="#5-1-3-private-void-doSignal-ConditionNode-first-boolean-all" class="headerlink" title="5.1.3. private void doSignal(ConditionNode first, boolean all)"></a>5.1.3. private void doSignal(ConditionNode first, boolean all)</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doSignal</span><span class="hljs-params">(ConditionNode first, <span class="hljs-type">boolean</span> all)</span> &#123;<br><span class="hljs-keyword">while</span> (first != <span class="hljs-literal">null</span>) &#123;<br><span class="hljs-type">ConditionNode</span> <span class="hljs-variable">next</span> <span class="hljs-operator">=</span> first.nextWaiter;<br><span class="hljs-comment">// æŠŠ firstWaiter æŒ‡å‘ç¬¬äºŒä¸ªèŠ‚ç‚¹</span><br><span class="hljs-keyword">if</span> ((firstWaiter = next) == <span class="hljs-literal">null</span>)<br>lastWaiter = <span class="hljs-literal">null</span>;<br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * æŠŠ first èŠ‚ç‚¹ä¸Šçš„ COND æ ‡å¿—æ¸…æ‰ï¼Œå¹¶è¿”å›æ—§å€¼</span><br><span class="hljs-comment"> * </span><br><span class="hljs-comment"> * å¦‚æœè¿”å› CONDï¼Œè¯´æ˜ first èŠ‚ç‚¹è¿˜å¤„äºæ¡ä»¶ç­‰å¾…é˜Ÿåˆ—ï¼Œè¿›è¡Œ if é€»è¾‘</span><br><span class="hljs-comment"> * </span><br><span class="hljs-comment"> * è¿›è¡Œè¿™ä¸ªæ£€æŸ¥çš„åŸå› æ˜¯ï¼ŒèŠ‚ç‚¹å¯èƒ½åœ¨ signal ä¹‹å‰å°±è¢«å–æ¶ˆäº†ï¼ˆè¶…æ—¶/ä¸­æ–­ï¼‰ï¼Œå°±æ²¡èµ„æ ¼è¿›å…¥åŒæ­¥é˜Ÿåˆ—äº†</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">if</span> ((first.getAndUnsetStatus(COND) &amp; COND) != <span class="hljs-number">0</span>) &#123;<br><span class="hljs-comment">// å°† first èŠ‚ç‚¹ä»æ¡ä»¶é˜Ÿåˆ—è½¬ç§»åˆ°åŒæ­¥é˜Ÿåˆ—</span><br>enqueue(first);<br><span class="hljs-comment">// å¦‚æœä¸æ˜¯ signalAllï¼Œä¸éœ€è¦å”¤é†’å…¶ä»–èŠ‚ç‚¹ï¼Œé€€å‡º while å¾ªç¯</span><br><span class="hljs-keyword">if</span> (!all)<br><span class="hljs-keyword">break</span>;<br>&#125;<br><span class="hljs-comment">// å¦‚æœæ˜¯ signalAllï¼Œå°† first = nextï¼Œç»§ç»­ while å¾ªç¯</span><br>first = next;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><hr><h3 id="5-2-å…·ä½“æ–¹æ³•ï¼ˆå®ç°ï¼‰"><a href="#5-2-å…·ä½“æ–¹æ³•ï¼ˆå®ç°ï¼‰" class="headerlink" title="5.2. å…·ä½“æ–¹æ³•ï¼ˆå®ç°ï¼‰"></a>5.2. å…·ä½“æ–¹æ³•ï¼ˆå®ç°ï¼‰</h3><h4 id="5-2-1-Condition-ä¸­çš„æ–¹æ³•å®ç°"><a href="#5-2-1-Condition-ä¸­çš„æ–¹æ³•å®ç°" class="headerlink" title="5.2.1. Condition ä¸­çš„æ–¹æ³•å®ç°"></a>5.2.1. Condition ä¸­çš„æ–¹æ³•å®ç°</h4><h5 id="5-2-1-1-public-final-void-await"><a href="#5-2-1-1-public-final-void-await" class="headerlink" title="5.2.1.1. public final void await()"></a>5.2.1.1. public final void await()</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">await</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException &#123;<br><span class="hljs-keyword">if</span> (Thread.interrupted())<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InterruptedException</span>();<br><span class="hljs-type">ConditionNode</span> <span class="hljs-variable">node</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConditionNode</span>();<br><span class="hljs-type">int</span> <span class="hljs-variable">savedState</span> <span class="hljs-operator">=</span> enableWait(node);<br>LockSupport.setCurrentBlocker(<span class="hljs-built_in">this</span>);<br><span class="hljs-type">boolean</span> <span class="hljs-variable">interrupted</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>, cancelled = <span class="hljs-literal">false</span>, rejected = <span class="hljs-literal">false</span>;<br><span class="hljs-keyword">while</span> (!canReacquire(node)) &#123;<br><span class="hljs-keyword">if</span> (interrupted |= Thread.interrupted()) &#123;<br><span class="hljs-keyword">if</span> (cancelled = (node.getAndUnsetStatus(COND) &amp; COND) != <span class="hljs-number">0</span>)<br><span class="hljs-keyword">break</span>;<br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((node.status &amp; COND) != <span class="hljs-number">0</span>) &#123;<br><span class="hljs-keyword">try</span> &#123;<br><span class="hljs-keyword">if</span> (rejected)<br>node.block();<br><span class="hljs-keyword">else</span><br>ForkJoinPool.managedBlock(node);<br>&#125; <span class="hljs-keyword">catch</span> (RejectedExecutionException ex) &#123;<br>rejected = <span class="hljs-literal">true</span>;<br>&#125; <span class="hljs-keyword">catch</span> (InterruptedException ie) &#123;<br>interrupted = <span class="hljs-literal">true</span>;<br>&#125;<br>&#125; <span class="hljs-keyword">else</span><br>Thread.onSpinWait();<br>&#125;<br>LockSupport.setCurrentBlocker(<span class="hljs-literal">null</span>);<br>node.clearStatus();<br>acquire(node, savedState, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>, <span class="hljs-number">0L</span>);<br><span class="hljs-keyword">if</span> (interrupted) &#123;<br><span class="hljs-keyword">if</span> (cancelled) &#123;<br>unlinkCancelledWaiters(node);<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InterruptedException</span>();<br>&#125;<br>Thread.currentThread().interrupt();<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><hr><h5 id="5-2-1-2-public-final-void-awaitUninterruptibly"><a href="#5-2-1-2-public-final-void-awaitUninterruptibly" class="headerlink" title="5.2.1.2. public final void awaitUninterruptibly()"></a>5.2.1.2. public final void awaitUninterruptibly()</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">awaitUninterruptibly</span><span class="hljs-params">()</span> &#123;<br><br><span class="hljs-comment">// æŠŠå½“å‰çº¿ç¨‹åŒ…è£…æˆä¸€ä¸ª ConditionNodeï¼Œç„¶åå°†è¯¥èŠ‚ç‚¹é“¾æ¥åˆ°æ¡ä»¶é˜Ÿåˆ—ï¼ˆå•å‘é“¾è¡¨ï¼‰ä¸­ï¼Œå¹¶é‡Šæ”¾é”èµ„æº</span><br><span class="hljs-type">ConditionNode</span> <span class="hljs-variable">node</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConditionNode</span>();<br><span class="hljs-type">int</span> <span class="hljs-variable">savedState</span> <span class="hljs-operator">=</span> enableWait(node);<br><br><span class="hljs-comment">// æŠŠ â€œé˜»å¡åŸå› â€ å¯¹è±¡ï¼ˆargï¼‰å†™åˆ°å½“å‰ Thread å¯¹è±¡çš„å†…éƒ¨å­—æ®µÂ parkBlockerÂ ä¸Š</span><br>LockSupport.setCurrentBlocker(<span class="hljs-built_in">this</span>);<br><br><span class="hljs-type">boolean</span> <span class="hljs-variable">interrupted</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>, rejected = <span class="hljs-literal">false</span>;<br><br><span class="hljs-comment">// å¦‚æœæŸä¸ªåœ¨ Condition ä¸Šç­‰å¾…çš„èŠ‚ç‚¹ï¼Œè¿˜æ²¡æœ‰è¢«é“¾æ¥åˆ°åŒæ­¥é˜Ÿåˆ—ä¸­</span><br><span class="hljs-keyword">while</span> (!canReacquire(node)) &#123;<br><br><span class="hljs-comment">// å¦‚æœè¢«ä¸­æ–­ï¼Œè®¾ç½®ä¸­æ–­æ ‡å¿—ä½</span><br><span class="hljs-keyword">if</span> (Thread.interrupted())<br>interrupted = <span class="hljs-literal">true</span>;<br><br><span class="hljs-comment">// å¦‚æœ Node çš„ Status è¿˜æœ‰ CONDï¼Œè¯´æ˜ç¡®å®è¿˜åœ¨æ¡ä»¶é˜Ÿåˆ—ä¸­ï¼Œè¿›å…¥å¾ªç¯</span><br><span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((node.status &amp; COND) != <span class="hljs-number">0</span>) &#123;<br><span class="hljs-keyword">try</span> &#123;<br><span class="hljs-comment">// å¦‚æœä¸æ˜¯ä½¿ç”¨ ForkJoinPool åªèƒ½æ§åˆ¶ä½•æ—¶é˜»å¡ï¼Œåˆ™ç«‹å³è¿›è¡Œé˜»å¡</span><br><span class="hljs-keyword">if</span> (rejected)<br>node.block();<br><span class="hljs-comment">// å¦åˆ™è¯´æ˜ä½¿ç”¨äº† ForkJoinPoolï¼Œä½¿ç”¨ ForkJoinPool çš„ managedBlock æ™ºèƒ½æ§åˆ¶ä½•æ—¶é˜»å¡</span><br><span class="hljs-keyword">else</span><br>ForkJoinPool.managedBlock(node);<br>&#125; <span class="hljs-keyword">catch</span> (RejectedExecutionException ex) &#123;<br>rejected = <span class="hljs-literal">true</span>;<br>&#125; <span class="hljs-keyword">catch</span> (InterruptedException ie) &#123;<br>interrupted = <span class="hljs-literal">true</span>;<br>&#125;<br><span class="hljs-comment">/**</span><br><span class="hljs-comment">* å¦‚æœ Node çš„ status ä¸å« CONDï¼Œå¯èƒ½æ˜¯å·²ç§»å‡ºæ¡ä»¶é˜Ÿåˆ—è¿›å…¥åŒæ­¥é˜Ÿåˆ—äº†ï¼ˆå› ä¸ºè¿™ä¸ªæµç¨‹å¯èƒ½éå¸¸å¿«ï¼Œä¸Šä¸€åˆ»è¿˜åœ¨æ¡ä»¶é˜Ÿåˆ—ï¼Œä¸‹ä¸€åˆ»å°±åœ¨åŒæ­¥é˜Ÿåˆ—äº†ï¼‰</span><br><span class="hljs-comment">* åœ¨è¿™ç§ä¸´ç•ŒçŠ¶æ€ï¼Œè°ƒç”¨ Thread.onSpinWait() æç¤º CPU è¿›å…¥é«˜æ•ˆè‡ªæ—‹ï¼Œå†æ¬¡è°ƒç”¨ canReacquire(node) çœ‹æ˜¯å¦å·²ç»åœ¨åŒæ­¥é˜Ÿåˆ—äº†</span><br><span class="hljs-comment">*/</span><br>&#125; <span class="hljs-keyword">else</span><br>Thread.onSpinWait();<br>&#125;<br><span class="hljs-comment">// å¦‚æœæŸä¸ªåœ¨ Condition ä¸Šç­‰å¾…çš„èŠ‚ç‚¹ï¼Œå·²ç»è¢«é“¾æ¥åˆ°åŒæ­¥é˜Ÿåˆ—ä¸­ï¼Œç»§ç»­æ‰§è¡Œ</span><br><span class="hljs-comment">// æŠŠå½“å‰ Thread å¯¹è±¡çš„å†…éƒ¨å­—æ®µ parkBlocker ä¸Šçš„ â€œé˜»å¡åŸå› â€ å¯¹è±¡ç½®ä¸º null</span><br>LockSupport.setCurrentBlocker(<span class="hljs-literal">null</span>);<br><br><span class="hljs-comment">// æ¸…é™¤ Node çš„ Status</span><br>node.clearStatus();<br><br><span class="hljs-comment">// ä¸æ–­é‡è¯•è·å–é”</span><br>acquire(node, savedState, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>, <span class="hljs-number">0L</span>);<br><br><span class="hljs-comment">// åœ¨æ–¹æ³•æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå¯èƒ½å¯¼è‡´ä¸­æ–­æ ‡å¿—ä½è¢«æ¸…é™¤ï¼Œè¿™é‡Œæ¢å¤ä¸­æ–­æ ‡å¿—ä½</span><br><span class="hljs-keyword">if</span> (interrupted)<br>Thread.currentThread().interrupt();<br>&#125;<br></code></pre></td></tr></table></figure><hr><h5 id="5-2-1-3-public-final-long-awaitNanos-long-nanosTimeout"><a href="#5-2-1-3-public-final-long-awaitNanos-long-nanosTimeout" class="headerlink" title="5.2.1.3. public final long awaitNanos(long nanosTimeout)"></a>5.2.1.3. public final long awaitNanos(long nanosTimeout)</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-title function_">awaitNanos</span><span class="hljs-params">(<span class="hljs-type">long</span> nanosTimeout)</span><br><span class="hljs-keyword">throws</span> InterruptedException &#123;<br><span class="hljs-keyword">if</span> (Thread.interrupted())<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InterruptedException</span>();<br><span class="hljs-type">ConditionNode</span> <span class="hljs-variable">node</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConditionNode</span>();<br><span class="hljs-type">int</span> <span class="hljs-variable">savedState</span> <span class="hljs-operator">=</span> enableWait(node);<br><span class="hljs-type">long</span> <span class="hljs-variable">nanos</span> <span class="hljs-operator">=</span> (nanosTimeout &lt; <span class="hljs-number">0L</span>) ? <span class="hljs-number">0L</span> : nanosTimeout;<br><span class="hljs-type">long</span> <span class="hljs-variable">deadline</span> <span class="hljs-operator">=</span> System.nanoTime() + nanos;<br><span class="hljs-type">boolean</span> <span class="hljs-variable">cancelled</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>, interrupted = <span class="hljs-literal">false</span>;<br><span class="hljs-keyword">while</span> (!canReacquire(node)) &#123;<br><span class="hljs-keyword">if</span> ((interrupted |= Thread.interrupted()) ||<br>(nanos = deadline - System.nanoTime()) &lt;= <span class="hljs-number">0L</span>) &#123;<br><span class="hljs-keyword">if</span> (cancelled = (node.getAndUnsetStatus(COND) &amp; COND) != <span class="hljs-number">0</span>)<br><span class="hljs-keyword">break</span>;<br>&#125; <span class="hljs-keyword">else</span><br>LockSupport.parkNanos(<span class="hljs-built_in">this</span>, nanos);<br>&#125;<br>node.clearStatus();<br>acquire(node, savedState, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>, <span class="hljs-number">0L</span>);<br><span class="hljs-keyword">if</span> (cancelled) &#123;<br>unlinkCancelledWaiters(node);<br><span class="hljs-keyword">if</span> (interrupted)<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InterruptedException</span>();<br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (interrupted)<br>Thread.currentThread().interrupt();<br><span class="hljs-type">long</span> <span class="hljs-variable">remaining</span> <span class="hljs-operator">=</span> deadline - System.nanoTime(); <span class="hljs-comment">// avoid overflow</span><br><span class="hljs-keyword">return</span> (remaining &lt;= nanosTimeout) ? remaining : Long.MIN_VALUE;<br>&#125;<br></code></pre></td></tr></table></figure><hr><h5 id="5-2-1-4-public-final-boolean-await-long-time-TimeUnit-unit"><a href="#5-2-1-4-public-final-boolean-await-long-time-TimeUnit-unit" class="headerlink" title="5.2.1.4. public final boolean await(long time, TimeUnit unit)"></a>5.2.1.4. public final boolean await(long time, TimeUnit unit)</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">await</span><span class="hljs-params">(<span class="hljs-type">long</span> time, TimeUnit unit)</span><br><span class="hljs-keyword">throws</span> InterruptedException &#123;<br><span class="hljs-type">long</span> <span class="hljs-variable">nanosTimeout</span> <span class="hljs-operator">=</span> unit.toNanos(time);<br><span class="hljs-keyword">if</span> (Thread.interrupted())<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InterruptedException</span>();<br><span class="hljs-type">ConditionNode</span> <span class="hljs-variable">node</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConditionNode</span>();<br><span class="hljs-type">int</span> <span class="hljs-variable">savedState</span> <span class="hljs-operator">=</span> enableWait(node);<br><span class="hljs-type">long</span> <span class="hljs-variable">nanos</span> <span class="hljs-operator">=</span> (nanosTimeout &lt; <span class="hljs-number">0L</span>) ? <span class="hljs-number">0L</span> : nanosTimeout;<br><span class="hljs-type">long</span> <span class="hljs-variable">deadline</span> <span class="hljs-operator">=</span> System.nanoTime() + nanos;<br><span class="hljs-type">boolean</span> <span class="hljs-variable">cancelled</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>, interrupted = <span class="hljs-literal">false</span>;<br><span class="hljs-keyword">while</span> (!canReacquire(node)) &#123;<br><span class="hljs-keyword">if</span> ((interrupted |= Thread.interrupted()) ||<br>(nanos = deadline - System.nanoTime()) &lt;= <span class="hljs-number">0L</span>) &#123;<br><span class="hljs-keyword">if</span> (cancelled = (node.getAndUnsetStatus(COND) &amp; COND) != <span class="hljs-number">0</span>)<br><span class="hljs-keyword">break</span>;<br>&#125; <span class="hljs-keyword">else</span><br>LockSupport.parkNanos(<span class="hljs-built_in">this</span>, nanos);<br>&#125;<br>node.clearStatus();<br>acquire(node, savedState, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>, <span class="hljs-number">0L</span>);<br><span class="hljs-keyword">if</span> (cancelled) &#123;<br>unlinkCancelledWaiters(node);<br><span class="hljs-keyword">if</span> (interrupted)<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InterruptedException</span>();<br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (interrupted)<br>Thread.currentThread().interrupt();<br><span class="hljs-keyword">return</span> !cancelled;<br>&#125;<br></code></pre></td></tr></table></figure><hr><h5 id="5-2-1-5-public-final-boolean-awaitUntil-Date-deadline"><a href="#5-2-1-5-public-final-boolean-awaitUntil-Date-deadline" class="headerlink" title="5.2.1.5. public final boolean awaitUntil(Date deadline)"></a>5.2.1.5. public final boolean awaitUntil(Date deadline)</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">awaitUntil</span><span class="hljs-params">(Date deadline)</span><br><span class="hljs-keyword">throws</span> InterruptedException &#123;<br><span class="hljs-type">long</span> <span class="hljs-variable">abstime</span> <span class="hljs-operator">=</span> deadline.getTime();<br><span class="hljs-keyword">if</span> (Thread.interrupted())<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InterruptedException</span>();<br><span class="hljs-type">ConditionNode</span> <span class="hljs-variable">node</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConditionNode</span>();<br><span class="hljs-type">int</span> <span class="hljs-variable">savedState</span> <span class="hljs-operator">=</span> enableWait(node);<br><span class="hljs-type">boolean</span> <span class="hljs-variable">cancelled</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>, interrupted = <span class="hljs-literal">false</span>;<br><span class="hljs-keyword">while</span> (!canReacquire(node)) &#123;<br><span class="hljs-keyword">if</span> ((interrupted |= Thread.interrupted()) ||<br>System.currentTimeMillis() &gt;= abstime) &#123;<br><span class="hljs-keyword">if</span> (cancelled = (node.getAndUnsetStatus(COND) &amp; COND) != <span class="hljs-number">0</span>)<br><span class="hljs-keyword">break</span>;<br>&#125; <span class="hljs-keyword">else</span><br>LockSupport.parkUntil(<span class="hljs-built_in">this</span>, abstime);<br>&#125;<br>node.clearStatus();<br>acquire(node, savedState, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>, <span class="hljs-number">0L</span>);<br><span class="hljs-keyword">if</span> (cancelled) &#123;<br>unlinkCancelledWaiters(node);<br><span class="hljs-keyword">if</span> (interrupted)<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InterruptedException</span>();<br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (interrupted)<br>Thread.currentThread().interrupt();<br><span class="hljs-keyword">return</span> !cancelled;<br>&#125;<br></code></pre></td></tr></table></figure><hr><h5 id="5-2-1-6-public-final-void-signal"><a href="#5-2-1-6-public-final-void-signal" class="headerlink" title="5.2.1.6. public final void signal()"></a>5.2.1.6. public final void signal()</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">signal</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-type">ConditionNode</span> <span class="hljs-variable">first</span> <span class="hljs-operator">=</span> firstWaiter;<br><span class="hljs-keyword">if</span> (!isHeldExclusively())<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalMonitorStateException</span>();<br><span class="hljs-keyword">if</span> (first != <span class="hljs-literal">null</span>)<br>doSignal(first, <span class="hljs-literal">false</span>);<br>&#125;<br></code></pre></td></tr></table></figure><hr><h5 id="5-2-1-7-public-final-void-signalAll"><a href="#5-2-1-7-public-final-void-signalAll" class="headerlink" title="5.2.1.7. public final void signalAll()"></a>5.2.1.7. public final void signalAll()</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">signalAll</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-type">ConditionNode</span> <span class="hljs-variable">first</span> <span class="hljs-operator">=</span> firstWaiter;<br><span class="hljs-keyword">if</span> (!isHeldExclusively())<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalMonitorStateException</span>();<br><span class="hljs-keyword">if</span> (first != <span class="hljs-literal">null</span>)<br>doSignal(first, <span class="hljs-literal">true</span>);<br>&#125;<br></code></pre></td></tr></table></figure><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.util.concurrent.locks.AbstractQueuedSynchronizer.Node æºç è§£æ</title>
    <link href="/2025/08/31/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedSynchronizer.Node%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/08/31/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedSynchronizer.Node%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/08/31/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedSynchronizer.Node%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/08/31/æºç ï¼šjava.util.concurrent.locks.AbstractQueuedSynchronizer.Nodeæºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-AbstractQueuedSynchronizer-Node-æ¦‚è¿°"><a href="#3-1-AbstractQueuedSynchronizer-Node-æ¦‚è¿°" class="headerlink" title="3.1. AbstractQueuedSynchronizer.Node æ¦‚è¿°"></a>3.1. AbstractQueuedSynchronizer.Node æ¦‚è¿°</h3><p><code>AbstractQueuedSynchronizer.Node</code> æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œæ˜¯ <code>java.util.concurrent.locks.AbstractQueuedSynchronizer</code> çš„é™æ€å†…éƒ¨ç±»</p><p><code>AQS</code> çš„åŒæ­¥é˜Ÿåˆ—å°±æ˜¯ç”± <code>AbstractQueuedSynchronizer.Node</code> æ„å»ºçš„ï¼ŒåŸºäºåŒå‘é“¾è¡¨çš„é˜Ÿåˆ—</p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>è¯¦è§æºç ï¼š<code>AbstractQueuedSynchronizer</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedSynchronizer%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.locks.AbstractQueuedSynchronizeræºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/09/01/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedSynchronizer%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/09/01/æºç ï¼šjava.util.concurrent.locks.AbstractQueuedSynchronizeræºç è§£æ/</a></li></ol></li></ol></li><li>åœ¨æœ€åˆçš„è®¾è®¡é‡Œï¼Œ<code>Node</code>Â åªæ˜¯ä¸€ä¸ªå…·ä½“ç±»ï¼ŒèŒè´£éå¸¸å•çº¯ï¼Œå……å½“åŒæ­¥é˜Ÿåˆ—ä¸­çš„èŠ‚ç‚¹ã€‚ä½†éšç€å¹¶å‘æ¡†æ¶çš„å‘å±•ï¼Œè®¾è®¡è€…æ„è¯†åˆ°é˜Ÿåˆ—èŠ‚ç‚¹æœ¬èº«éœ€è¦æ‰¿è½½ä¸¤ç§ä¸åŒçš„è¯­ä¹‰ï¼šç‹¬å  (<code>exclusive</code>)Â å’ŒÂ å…±äº« (<code>shared</code>)<ol><li>ä¸ºäº†æ›´å¥½åœ°è¡¨è¾¾è¿™ä¸€ç‚¹ï¼Œä»–ä»¬å°†Â <code>Node</code>Â æ”¹ä¸ºæŠ½è±¡ç±»ã€‚å°½ç®¡Â <code>Node</code>Â ä¸­å¹¶æ²¡æœ‰æŠ½è±¡æ–¹æ³•ï¼Œçœ‹èµ·æ¥ â€œæŠ½è±¡â€ ä¼¼ä¹å¤šæ­¤ä¸€ä¸¾ï¼Œä½†è¿™æ ·è®¾è®¡çš„æ ¸å¿ƒç›®çš„ï¼Œæ˜¯é˜»æ­¢å¼€å‘è€…ç›´æ¥å»å®ä¾‹åŒ–ä¸€ä¸ªåŸå§‹çš„Â <code>Node</code></li><li>å–è€Œä»£ä¹‹çš„æ˜¯ï¼Œæ¡†æ¶å®šä¹‰äº†ä¸¤ä¸ªå…·ä½“å­ç±»ï¼š<code>ExclusiveNode</code>Â å’ŒÂ <code>SharedNode</code>ã€‚è¿™ä¸¤ä¸ªç±»é™¤äº†ç»§æ‰¿Â <code>Node</code>Â å¤–æ²¡æœ‰ä»»ä½•é¢å¤–é€»è¾‘ï¼Œä½†å´èµ·åˆ°äº†â€œæ ‡è®°â€ çš„ä½œç”¨ï¼Œæ˜ç¡®åŒºåˆ†äº†èŠ‚ç‚¹çš„è¯­ä¹‰ã€‚è¿™æ ·ä¸€æ¥ï¼Œå¼€å‘è€…æ‰€åˆ›å»ºçš„ä¸æ˜¯ä¸€ä¸ªæ¨¡ç³Šçš„ â€œé˜Ÿåˆ—èŠ‚ç‚¹â€ï¼Œè€Œæ˜¯ä¸€ä¸ªè¯­ä¹‰æ¸…æ™°çš„ â€œç‹¬å èŠ‚ç‚¹â€ æˆ– â€œå…±äº«èŠ‚ç‚¹â€</li></ol></li></ol></blockquote><hr><h3 id="3-2-AbstractQueuedSynchronizer-Node-ç›¸å…³çŠ¶æ€"><a href="#3-2-AbstractQueuedSynchronizer-Node-ç›¸å…³çŠ¶æ€" class="headerlink" title="3.2. AbstractQueuedSynchronizer.Node ç›¸å…³çŠ¶æ€"></a>3.2. AbstractQueuedSynchronizer.Node ç›¸å…³çŠ¶æ€</h3><ol><li><code>0</code><ol><li>è¡¨ç¤ºèŠ‚ç‚¹çš„åˆå§‹çŠ¶æ€</li></ol></li><li><code>1</code><ol><li>è¡¨ç¤º <code>Thread</code> å®ä¾‹å¯èƒ½å› ä¸ºé˜»å¡è¶…æ—¶ã€è¢«ä¸­æ–­åå“åº”ä¸­æ–­è€Œç»“æŸé˜»å¡</li><li>æˆ‘ä»¬å¯ä»¥ç®€å•çš„ç†è§£ä¸ºï¼šèŠ‚ç‚¹å·²ç»ç»“æŸç­‰å¾…äº†</li></ol></li><li><code>-1</code><ol><li>è¡¨ç¤ºèŠ‚ç‚¹çš„åé©±èŠ‚ç‚¹éœ€è¦è¢«å”¤é†’</li><li>è¯¥çŠ¶æ€æ˜¯ç”±åé©±èŠ‚ç‚¹ä¸ºè¯¥èŠ‚ç‚¹è®¾ç½®çš„ï¼Œå½“è¯¥èŠ‚ç‚¹é‡Šæ”¾ <code>State</code> æ—¶ï¼Œéœ€è¦è´Ÿè´£å”¤é†’åé©±èŠ‚ç‚¹</li></ol></li><li><code>-2</code><ol><li>è¡¨ç¤ºèŠ‚ç‚¹ä¸åœ¨ <code>AQS</code> çš„åŒæ­¥é˜Ÿåˆ—ï¼Œè€Œæ˜¯åœ¨ <code>AQS</code> çš„æ¡ä»¶é˜Ÿåˆ—</li></ol></li><li><code>-3</code><ol><li>è¯¥çŠ¶æ€ä»…ç”¨äºå…±äº«æ¨¡å¼çš„åŒæ­¥å™¨ï¼Œå› ä¸ºå…±äº«æ¨¡å¼ä¸­å¯èƒ½ä¼šæœ‰å¤šä¸ªçº¿ç¨‹åŒæ—¶å°è¯•è·å–å…±äº«èµ„æº</li><li>å½“è¯¥èŠ‚ç‚¹è¢«å”¤é†’åï¼Œä¼šç»§ç»­å”¤é†’åç»­èŠ‚ç‚¹ã€‚è¢«å”¤é†’çš„åç»­èŠ‚ç‚¹ä¼šå†å”¤é†’åç»­èŠ‚ç‚¹ï¼Œå½¢æˆ â€œçº§è”å”¤é†’â€</li></ol></li></ol><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>è¿™ä¸€å¥—ç›¸å…³çŠ¶æ€æ˜¯åœ¨ <code>Java8</code> ä¸‹çš„ç›¸å…³çŠ¶æ€ï¼Œåœ¨ <code>Java17+</code> å‘ç”Ÿäº†è¾ƒå¤§å˜åŒ–</li></ol></blockquote><hr><h2 id="4-æºç éƒ¨åˆ†"><a href="#4-æºç éƒ¨åˆ†" class="headerlink" title="4. æºç éƒ¨åˆ†"></a>4. æºç éƒ¨åˆ†</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Node</span> &#123;<br><br><span class="hljs-comment">// è¡¨ç¤ºè¯¥èŠ‚ç‚¹åœ¨ AQS çš„åŒæ­¥é˜Ÿåˆ—ä¸­çš„å‰é©±èŠ‚ç‚¹</span><br><span class="hljs-keyword">volatile</span> Node prev;<br><br><span class="hljs-comment">// è¡¨ç¤ºè¯¥èŠ‚ç‚¹åœ¨ AQS çš„åŒæ­¥é˜Ÿåˆ—ä¸­çš„åé©±èŠ‚ç‚¹</span><br><span class="hljs-keyword">volatile</span> Node next;<br><br><span class="hljs-comment">// è¡¨ç¤ºè¯¥èŠ‚ç‚¹å°è£…çš„ Thread å®ä¾‹</span><br>Thread waiter;<br><br><span class="hljs-comment">// è¡¨ç¤ºè¯¥èŠ‚ç‚¹çš„çŠ¶æ€</span><br><span class="hljs-keyword">volatile</span> <span class="hljs-type">int</span> status;<br><br><span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">casPrev</span><span class="hljs-params">(Node c, Node v)</span> &#123;<br><span class="hljs-keyword">return</span> U.weakCompareAndSetReference(<span class="hljs-built_in">this</span>, PREV, c, v);<br>&#125;<br><br><span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">casNext</span><span class="hljs-params">(Node c, Node v)</span> &#123;<br><span class="hljs-keyword">return</span> U.weakCompareAndSetReference(<span class="hljs-built_in">this</span>, NEXT, c, v);<br>&#125;<br><br><span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getAndUnsetStatus</span><span class="hljs-params">(<span class="hljs-type">int</span> v)</span> &#123;<br><span class="hljs-keyword">return</span> U.getAndBitwiseAndInt(<span class="hljs-built_in">this</span>, STATUS, ~v);<br>&#125;<br><br><span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setPrevRelaxed</span><span class="hljs-params">(Node p)</span> &#123;<br>U.putReference(<span class="hljs-built_in">this</span>, PREV, p);<br>&#125;<br><br><span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setStatusRelaxed</span><span class="hljs-params">(<span class="hljs-type">int</span> s)</span> &#123;<br>U.putInt(<span class="hljs-built_in">this</span>, STATUS, s);<br>&#125;<br><br><span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">clearStatus</span><span class="hljs-params">()</span> &#123;<br>U.putIntOpaque(<span class="hljs-built_in">this</span>, STATUS, <span class="hljs-number">0</span>);<br>&#125;<br><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-variable">STATUS</span><br><span class="hljs-operator">=</span> U.objectFieldOffset(Node.class, <span class="hljs-string">&quot;status&quot;</span>);<br><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-variable">NEXT</span><br><span class="hljs-operator">=</span> U.objectFieldOffset(Node.class, <span class="hljs-string">&quot;next&quot;</span>);<br><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-variable">PREV</span><br><span class="hljs-operator">=</span> U.objectFieldOffset(Node.class, <span class="hljs-string">&quot;prev&quot;</span>);<br><br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>æ–¹æ³•çš„å®ç°æ¶‰åŠåˆ°äº† <code>Unsafe</code>ï¼Œå…ˆä¸çœ‹</li></ol></blockquote><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.util.concurrent.locks.Condition æºç è§£æ</title>
    <link href="/2025/08/31/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.Condition%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/08/31/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.Condition%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/08/31/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.Condition%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/08/31/æºç ï¼šjava.util.concurrent.locks.Conditionæºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-Condition-æ¦‚è¿°"><a href="#3-1-Condition-æ¦‚è¿°" class="headerlink" title="3.1. Condition æ¦‚è¿°"></a>3.1. Condition æ¦‚è¿°</h3><p><code>Condition</code> æ˜¯ä¸€ä¸ªæ¥å£</p><p>æƒ³è±¡è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼š<code>Monitor</code> ä¸­åªæœ‰ä¸€ä¸ªç­‰å¾…é˜Ÿåˆ—ï¼ˆå³ <code>WaitSet</code>ï¼‰å¦‚æœä½ æœ‰å¤šä¸ªæ¡ä»¶éœ€è¦ç­‰å¾…ï¼Œä½ å°±æ— æ³•ç²¾ç¡®æ§åˆ¶å”¤é†’å“ªä¸€ç±»ç­‰å¾…è€…ï¼Œå› ä¸ºä»–ä»¬éƒ½åœ¨åŒä¸€ä¸ªé˜Ÿåˆ—ä¸­ç­‰å¾…</p><p>ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºå¤šä¸ª <code>Condition</code> æ¥å£çš„å…·ä½“å®ç°ç±»å®ä¾‹ï¼Œæ¯ä¸€ä¸ª <code>Condition</code> æ¥å£çš„å…·ä½“å®ç°ç±»å°±æ˜¯ä¸€ä¸ªé˜Ÿåˆ—</p><p><code>Condition + LockSupport</code> ç›¸å½“äº <code>Object#wait</code>ã€<code>Object#notify</code> çš„ <code>Plus</code> ç‰ˆ</p><p><code>Condition</code> ä¸ºæˆ‘ä»¬æä¾›äº†ä»¥ä¸‹æ–¹æ³•ï¼š</p><ol><li>è®©æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œ<code>Thread</code> ç¤ºä¾‹è¿›å…¥ <code>WAITING</code> çŠ¶æ€</li><li>è®©æœ¬åœ°çº¿ç¨‹è¿›å…¥é™æ—¶é˜»å¡çŠ¶æ€ï¼Œ<code>Thread</code> ç¤ºä¾‹è¿›å…¥ <code>TIMED_WAITING</code> çŠ¶æ€</li><li>å”¤é†’ AQS çš„æ¡ä»¶é˜Ÿåˆ—ä¸­çš„ â€œé¦–ä¸ªâ€  <code>Thread</code> å®ä¾‹ï¼ˆéé˜»å¡ï¼‰</li><li>å”¤é†’ AQS çš„æ¡ä»¶é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰ <code>Thread</code> å®ä¾‹ï¼ˆéé˜»å¡ï¼‰</li></ol><hr><h2 id="4-æºç éƒ¨åˆ†"><a href="#4-æºç éƒ¨åˆ†" class="headerlink" title="4. æºç éƒ¨åˆ†"></a>4. æºç éƒ¨åˆ†</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Condition</span> &#123;<br><br><span class="hljs-comment">// ç”¨äºè®©æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread ç¤ºä¾‹è¿›å…¥ WAITING çŠ¶æ€ï¼Œå¹¶è¢«æŠ•é€’åˆ° AQS çš„æ¡ä»¶é˜Ÿåˆ—ï¼Œç­‰å¾…è¢«å”¤é†’ï¼ˆLockSupport.unparkï¼‰ã€è¢«ä¸­æ–­ï¼ˆThread#interruptï¼‰</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ WAITING çŠ¶æ€åï¼Œèƒ½å“åº”ä¸­æ–­ã€‚çº¿ç¨‹è¢«å”¤é†’ï¼Œé‡æ–°è·å¾— CPU æ—¶é—´ç‰‡åï¼Œä¼šæŠ›å‡º InterruptedException å—æ£€å¼‚å¸¸ï¼Œå¹¶æ¸…é™¤ Thread å®ä¾‹çš„ä¸­æ–­çŠ¶æ€ï¼ˆå¼‚å¸¸é€€å‡ºæˆ–æ­£å¸¸é€€å‡ºï¼ˆå‘ç”Ÿå¼‚å¸¸ï¼‰ï¼Œè¦çœ‹æˆ‘ä»¬æ˜¯å¦å¯¹è¯¥å¼‚å¸¸è¿›è¡Œæ•è·å¹¶å¤„ç†ï¼‰</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">await</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException;<br><br><span class="hljs-comment">// ç”¨äºè®©æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread ç¤ºä¾‹è¿›å…¥ WAITING çŠ¶æ€ï¼Œå¹¶è¢«æŠ•é€’åˆ° AQS çš„æ¡ä»¶é˜Ÿåˆ—ï¼Œç­‰å¾…è¢«å”¤é†’ï¼ˆLockSupport.unparkï¼‰</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ WAITING çŠ¶æ€åï¼Œä¸èƒ½èƒ½å“åº”ä¸­æ–­ã€‚çº¿ç¨‹ä¼šç»§ç»­é˜»å¡ï¼Œå¹¶ä¼šä¿ç•™ Thread ç¤ºä¾‹çš„ä¸­æ–­çŠ¶æ€ã€‚å½“çº¿ç¨‹è¢«å”¤é†’åï¼Œä¼šç»§ç»­å‘ä¸‹æ‰§è¡Œï¼ˆæ­£å¸¸é€€å‡ºï¼ˆæœªå‘ç”Ÿå¼‚å¸¸ï¼‰ï¼‰</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">awaitUninterruptibly</span><span class="hljs-params">()</span>;<br><br><span class="hljs-comment">// ç”¨äºè®©æœ¬åœ°çº¿ç¨‹è¿›å…¥é™æ—¶é˜»å¡çŠ¶æ€ï¼ŒThread ç¤ºä¾‹è¿›å…¥ TIMED_WAITING çŠ¶æ€ï¼Œå¹¶è¢«æŠ•é€’åˆ° AQS çš„æ¡ä»¶é˜Ÿåˆ—ï¼Œç­‰å¾…è¢«å”¤é†’ï¼ˆLockSupport.unparkï¼‰ã€è¢«ä¸­æ–­ï¼ˆThread#interruptï¼‰ã€é˜»å¡è¶…æ—¶</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// é™æ—¶è¶…æ—¶è¢«å…è®¸çš„æœ€é•¿æ—¶é—´ä¸ºï¼šnanosTimeout ns</span><br><span class="hljs-comment">//     1. å¦‚æœè¶…æ—¶ï¼Œfalse</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ WAITING çŠ¶æ€åï¼Œèƒ½å“åº”ä¸­æ–­ã€‚çº¿ç¨‹è¢«å”¤é†’ï¼Œé‡æ–°è·å¾— CPU æ—¶é—´ç‰‡åï¼Œä¼šæŠ›å‡º InterruptedException å—æ£€å¼‚å¸¸ï¼Œå¹¶æ¸…é™¤ Thread å®ä¾‹çš„ä¸­æ–­çŠ¶æ€ï¼ˆå¼‚å¸¸é€€å‡ºæˆ–æ­£å¸¸é€€å‡ºï¼ˆå‘ç”Ÿå¼‚å¸¸ï¼‰ï¼Œè¦çœ‹æˆ‘ä»¬æ˜¯å¦å¯¹è¯¥å¼‚å¸¸è¿›è¡Œæ•è·å¹¶å¤„ç†ï¼‰</span><br>    <span class="hljs-type">long</span> <span class="hljs-title function_">awaitNanos</span><span class="hljs-params">(<span class="hljs-type">long</span> nanosTimeout)</span> <span class="hljs-keyword">throws</span> InterruptedException;<br><br><span class="hljs-comment">// ç”¨äºè®©æœ¬åœ°çº¿ç¨‹è¿›å…¥é™æ—¶é˜»å¡çŠ¶æ€ï¼ŒThread ç¤ºä¾‹è¿›å…¥ TIMED_WAITING çŠ¶æ€ï¼Œå¹¶è¢«æŠ•é€’åˆ° AQS çš„æ¡ä»¶é˜Ÿåˆ—ï¼Œç­‰å¾…è¢«å”¤é†’ï¼ˆLockSupport.unparkï¼‰ã€è¢«ä¸­æ–­ï¼ˆThread#interruptï¼‰ã€é˜»å¡è¶…æ—¶</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// é™æ—¶é˜»å¡è¢«å…è®¸çš„æœ€é•¿æ—¶é—´ä¸ºï¼štime unit</span><br><span class="hljs-comment">//     1. å¦‚æœè¶…æ—¶ï¼Œè¿”å› false</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ WAITING çŠ¶æ€åï¼Œèƒ½å“åº”ä¸­æ–­ã€‚çº¿ç¨‹è¢«å”¤é†’ï¼Œé‡æ–°è·å¾— CPU æ—¶é—´ç‰‡åï¼Œä¼šæŠ›å‡º InterruptedException å—æ£€å¼‚å¸¸ï¼Œå¹¶æ¸…é™¤ Thread å®ä¾‹çš„ä¸­æ–­çŠ¶æ€ï¼ˆå¼‚å¸¸é€€å‡ºæˆ–æ­£å¸¸é€€å‡ºï¼ˆå‘ç”Ÿå¼‚å¸¸ï¼‰ï¼Œè¦çœ‹æˆ‘ä»¬æ˜¯å¦å¯¹è¯¥å¼‚å¸¸è¿›è¡Œæ•è·å¹¶å¤„ç†ï¼‰</span><br>    <span class="hljs-type">boolean</span> <span class="hljs-title function_">await</span><span class="hljs-params">(<span class="hljs-type">long</span> time, TimeUnit unit)</span> <span class="hljs-keyword">throws</span> InterruptedException;<br><br><span class="hljs-comment">// ç”¨äºè®©æœ¬åœ°çº¿ç¨‹è¿›å…¥é™æ—¶é˜»å¡çŠ¶æ€ï¼ŒThread ç¤ºä¾‹è¿›å…¥ TIMED_WAITING çŠ¶æ€ï¼Œå¹¶è¢«æŠ•é€’åˆ° AQS çš„æ¡ä»¶é˜Ÿåˆ—ï¼Œç­‰å¾…è¢«å”¤é†’ï¼ˆLockSupport.unparkï¼‰ã€è¢«ä¸­æ–­ï¼ˆThread#interruptï¼‰ã€é˜»å¡è¶…æ—¶</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// é™æ—¶é˜»å¡è¢«å…è®¸åˆ° deadline</span><br><span class="hljs-comment">//     1. å¦‚æœè¶…æ—¶ï¼Œè¿”å› false</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// æœ¬åœ°çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒThread å®ä¾‹è¿›å…¥ WAITING çŠ¶æ€åï¼Œèƒ½å“åº”ä¸­æ–­ã€‚çº¿ç¨‹è¢«å”¤é†’ï¼Œé‡æ–°è·å¾— CPU æ—¶é—´ç‰‡åï¼Œä¼šæŠ›å‡º InterruptedException å—æ£€å¼‚å¸¸ï¼Œå¹¶æ¸…é™¤ Thread å®ä¾‹çš„ä¸­æ–­çŠ¶æ€ï¼ˆå¼‚å¸¸é€€å‡ºæˆ–æ­£å¸¸é€€å‡ºï¼ˆå‘ç”Ÿå¼‚å¸¸ï¼‰ï¼Œè¦çœ‹æˆ‘ä»¬æ˜¯å¦å¯¹è¯¥å¼‚å¸¸è¿›è¡Œæ•è·å¹¶å¤„ç†ï¼‰</span><br>    <span class="hljs-type">boolean</span> <span class="hljs-title function_">awaitUntil</span><span class="hljs-params">(Date deadline)</span> <span class="hljs-keyword">throws</span> InterruptedException;<br><br><span class="hljs-comment">// ç”¨äºéé˜»å¡å”¤é†’ AQS çš„æ¡ä»¶é˜Ÿåˆ—ä¸­çš„ â€œé¦–ä¸ªâ€  Thread å®ä¾‹ï¼Œè¢«å”¤é†’çš„ Thread å®ä¾‹è¢«ç›´æ¥æŠ•é€’åˆ° AQS çš„åŒæ­¥é˜Ÿåˆ—</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// æ‰€è°“çš„ â€œé¦–ä¸ªâ€ æ˜¯æŒ‡ï¼šé¦–ä¸ª Thread å®ä¾‹å¯èƒ½å› ä¸ºé˜»å¡è¶…æ—¶ã€è¢«ä¸­æ–­åå“åº”ä¸­æ–­è€Œç»“æŸé˜»å¡ï¼Œæ‰€ä»¥ä¼šä¾æ¬¡å‘åæŸ¥æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°ä»å¤„äºé˜»å¡çŠ¶æ€çš„ Thread å®ä¾‹</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">signal</span><span class="hljs-params">()</span>;<br><br><span class="hljs-comment">// ç”¨äºéé˜»å¡å”¤é†’ AQS çš„æ¡ä»¶é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰ Thread å®ä¾‹ï¼Œè¢«å”¤é†’çš„ Thread å®ä¾‹è¢«ç›´æ¥æŠ•é€’åˆ° AQS çš„åŒæ­¥é˜Ÿåˆ—</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">signalAll</span><span class="hljs-params">()</span>;<br>    <br>&#125;<br></code></pre></td></tr></table></figure><hr><h2 id="5-å†…ç½®å®ç°"><a href="#5-å†…ç½®å®ç°" class="headerlink" title="5. å†…ç½®å®ç°"></a>5. å†…ç½®å®ç°</h2><h3 id="5-1-ConditionObject"><a href="#5-1-ConditionObject" class="headerlink" title="5.1. ConditionObject"></a>5.1. ConditionObject</h3><p>è¯¦è§æºç ï¼š<code>AbstractQueuedSynchronizer.ConditionObject</code></p><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedSynchronizer.ConditionObject%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.locks.AbstractQueuedSynchronizer.ConditionObjectæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/08/31/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.AbstractQueuedSynchronizer.ConditionObject%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/08/31/æºç ï¼šjava.util.concurrent.locks.AbstractQueuedSynchronizer.ConditionObjectæºç è§£æ/</a></li></ol></li></ol><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.util.concurrent.locks.ReentrantLock æºç è§£æ</title>
    <link href="/2025/08/31/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.ReentrantLock%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/08/31/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.ReentrantLock%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/08/31/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.ReentrantLock%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/08/31/æºç ï¼šjava.util.concurrent.locks.ReentrantLockæºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-ReentrantLock-æ¦‚è¿°"><a href="#3-1-ReentrantLock-æ¦‚è¿°" class="headerlink" title="3.1. ReentrantLock æ¦‚è¿°"></a>3.1. ReentrantLock æ¦‚è¿°</h3><p><code>ReentrantLock</code> æ˜¯ä¸€ä¸ªå…·ä½“ç±»ï¼Œå®ç°äº† <code>java.util.concurrent.locks.Lock</code>ã€<code>java.io.Serializable</code><br><img src="/source/_posts/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.ReentrantLock%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.ReentrantLock%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.png"></p><p><code>ReentrantLock</code> æ˜¯ä¸€ç§å¯é‡å…¥ã€æ‚²è§‚ã€å…¬å¹³æˆ–éå…¬å¹³ã€äº’æ–¥çš„é”ï¼Œå¹¶ä¸”æ˜¯ä½¿ç”¨ <code>AQS</code> å®ç°çš„ç‹¬å æ¨¡å¼çš„åŒæ­¥å™¨ã€‚<code>State</code> å’Œå…±äº«èµ„æºè¡¨ç¤ºä»¥ä¸‹å«ä¹‰ï¼š</p><ol><li><code>State</code> è¡¨ç¤ºé”çš„é‡å…¥æ¬¡æ•°<ol><li><code>0</code><ol><li>è¡¨ç¤ºé”ç©ºé—²ï¼Œçº¿ç¨‹å¯ä»¥å°è¯•è·å–</li></ol></li><li><code>1</code><ol><li>è¡¨ç¤ºé”å·²è¢«æŸä¸ªçº¿ç¨‹æŒæœ‰</li></ol></li><li><code>nï¼ˆn &gt; 1ï¼‰</code><ol><li>è¡¨ç¤ºåŒä¸€çº¿ç¨‹å¯¹è¯¥é”è¿›è¡Œäº† <code>n</code> æ¬¡é‡å…¥</li></ol></li></ol></li><li>å…±äº«èµ„æºè¡¨ç¤ºåŠ é”æœŸé—´çš„æ“ä½œ</li></ol><p><code>ReentrantLock</code>Â åŠŸèƒ½ç±»ä¼¼äºÂ <code>synchronized</code>ï¼Œä½†æ›´çµæ´»ã€åŠŸèƒ½æ›´å¼ºå¤§ï¼Œä¸»è¦åŒ…æ‹¬ï¼š</p><ol><li><code>ReentrantLock</code> æ”¯æŒé˜»å¡ç«äº‰é”ã€é™æ—¶é˜»å¡ç«äº‰é”ã€éé˜»å¡ç«äº‰é”ï¼Œè€Œ <code>synchronized</code> åªæ”¯æŒé˜»å¡ç«äº‰é”</li><li><code>ReentrantLock</code> åœ¨é˜»å¡ç«äº‰é”ã€é™æ—¶é˜»å¡ç«äº‰é”æ—¶èƒ½å“åº”ä¸­æ–­ï¼Œè€Œ <code>synchronized</code> åœ¨é˜»å¡ç«äº‰é”æ—¶ä¸èƒ½å“åº”ä¸­æ–­</li><li><code>ReentrantLock</code> æ—¢å¯ä»¥æ˜¯å…¬å¹³é”ï¼Œä¹Ÿå¯ä»¥æ˜¯éå…¬å¹³é”ï¼Œè€Œ <code>synchronized</code> åªèƒ½æ˜¯éå…¬å¹³é”</li><li><code>ReentrantLock</code> æ”¯æŒå¤šæ¡æ¡ä»¶é˜Ÿåˆ—ï¼Œè€Œ <code>synchronized</code> åªæ”¯æŒä¸€æ¡æ¡ä»¶é˜Ÿåˆ—ï¼ˆå³ <code>waitSet</code>ï¼Œå› ä¸ºåœ¨è¯­ä¹‰ä¸Šï¼Œ<code>EntryList</code> ä¸å±äºæ¡ä»¶é˜Ÿåˆ—ï¼‰</li></ol><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>è¯¦è§æºç ï¼š<code>Lock</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.Lock%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.locks.Lockæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/11/07/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.Lock%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/07/æºç ï¼šjava.util.concurrent.locks.Lockæºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>Serializable</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.io.Serializable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.io.Serializableæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/10/28/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.io.Serializable%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/10/28/æºç ï¼šjava.io.Serializableæºç è§£æ/</a></li></ol></li></ol></li><li>é”ç«äº‰æ¿€çƒˆçš„åœºæ™¯ï¼Œå»ºè®®ä¼˜å…ˆä½¿ç”¨ <code>ReentrantLock</code>ï¼Œå› ä¸ºå®ƒæ²¡æœ‰ â€œé”å‡çº§â€ çš„é¢å¤–å¼€é”€ï¼š<ol><li><code>synchronized</code> åœ¨åå‘é”ã€è½»é‡çº§é”æ—¶ï¼Œæ•ˆç‡çš„ç¡®å¾ˆé«˜</li><li>ä½†æ˜¯ï¼Œä¸€æ—¦å‡çº§ä¸ºé‡é‡çº§é”ï¼Œå°±æ— æ³•é™çº§ï¼Œè€Œä¸”åœ¨é”ç«äº‰æ¿€çƒˆçš„åœºæ™¯ä¸‹æ€§èƒ½ä¼šå—åˆ°å½±å“</li></ol></li><li>å¦‚æœä½ å¯¹å¹¶å‘æœºåˆ¶æŒæ¡ä¸æ·±ï¼Œå»ºè®®ä¼˜å…ˆä½¿ç”¨ <code>synchronized</code>ï¼Œå› ä¸ºå®ƒè¯­æ³•ç®€æ´ã€å‡ºé”™ç‡ä½ã€‚ä½†å¦‚æœä½ éœ€è¦æ›´å¼ºçš„çµæ´»æ€§ï¼Œå¹¶ä¸”ç†Ÿæ‚‰å¹¶å‘ç¼–ç¨‹ï¼Œ<code>ReentrantLock</code> ä¼šæ›´åˆé€‚</li></ol></blockquote><hr><h2 id="4-å†…éƒ¨ç±»"><a href="#4-å†…éƒ¨ç±»" class="headerlink" title="4. å†…éƒ¨ç±»"></a>4. å†…éƒ¨ç±»</h2><h3 id="4-1-Sync"><a href="#4-1-Sync" class="headerlink" title="4.1. Sync"></a>4.1. Sync</h3><p>è¯¦è§æºç ï¼š<code>ReentrantLock.Sync</code></p><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.ReentrantLock.Sync%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.concurrent.locks.ReentrantLock.Syncæºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/09/02/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.concurrent.locks.ReentrantLock.Sync%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/09/02/æºç ï¼šjava.util.concurrent.locks.ReentrantLock.Syncæºç è§£æ/</a></li></ol></li></ol><hr><h3 id="4-2-NonfairSync"><a href="#4-2-NonfairSync" class="headerlink" title="4.2. NonfairSync"></a>4.2. NonfairSync</h3><p><code>NonfairSync</code> ç”¨äºå®ç°éå…¬å¹³é”çš„åŠ é”ç­–ç•¥</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NonfairSync</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Sync</span> &#123;<br><br><span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">initialTryLock</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-type">Thread</span> <span class="hljs-variable">current</span> <span class="hljs-operator">=</span> Thread.currentThread();<br><span class="hljs-keyword">if</span> (compareAndSetState(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>)) &#123; <br>setExclusiveOwnerThread(current);<br><span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (getExclusiveOwnerThread() == current) &#123;<br><span class="hljs-type">int</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> getState() + <span class="hljs-number">1</span>;<br><span class="hljs-keyword">if</span> (c &lt; <span class="hljs-number">0</span>)<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&quot;Maximum lock count exceeded&quot;</span>);<br>setState(c);<br><span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125; <span class="hljs-keyword">else</span><br><span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>&#125;<br><br><span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryAcquire</span><span class="hljs-params">(<span class="hljs-type">int</span> acquires)</span> &#123;<br><span class="hljs-keyword">if</span> (getState() == <span class="hljs-number">0</span> &amp;&amp; compareAndSetState(<span class="hljs-number">0</span>, acquires)) &#123;<br>setExclusiveOwnerThread(Thread.currentThread());<br><span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h3 id="4-3-FairSync"><a href="#4-3-FairSync" class="headerlink" title="4.3. FairSync"></a>4.3. FairSync</h3><p><code>FairSync</code> ç”¨äºå®ç°å…¬å¹³é”çš„åŠ é”ç­–ç•¥ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FairSync</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Sync</span> &#123;<br><br><span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">initialTryLock</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-type">Thread</span> <span class="hljs-variable">current</span> <span class="hljs-operator">=</span> Thread.currentThread();<br><span class="hljs-type">int</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> getState();<br><span class="hljs-keyword">if</span> (c == <span class="hljs-number">0</span>) &#123;<br><span class="hljs-keyword">if</span> (!hasQueuedThreads() &amp;&amp; compareAndSetState(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>)) &#123;<br>setExclusiveOwnerThread(current);<br><span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (getExclusiveOwnerThread() == current) &#123;<br><span class="hljs-keyword">if</span> (++c &lt; <span class="hljs-number">0</span>)<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&quot;Maximum lock count exceeded&quot;</span>);<br>setState(c);<br><span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>&#125;<br><br><span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryAcquire</span><span class="hljs-params">(<span class="hljs-type">int</span> acquires)</span> &#123;<br><span class="hljs-keyword">if</span> (getState() == <span class="hljs-number">0</span> &amp;&amp; !hasQueuedPredecessors() &amp;&amp;<br>compareAndSetState(<span class="hljs-number">0</span>, acquires)) &#123;<br>setExclusiveOwnerThread(Thread.currentThread());<br><span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h2 id="5-æ„é€ æ–¹æ³•"><a href="#5-æ„é€ æ–¹æ³•" class="headerlink" title="5. æ„é€ æ–¹æ³•"></a>5. æ„é€ æ–¹æ³•</h2><h3 id="5-1-ReentrantLock"><a href="#5-1-ReentrantLock" class="headerlink" title="5.1. ReentrantLock()"></a>5.1. ReentrantLock()</h3><p>è¯¥æ–¹æ³•ç”¨äºæ„é€ ä¸€ä¸ªéå…¬å¹³é”çš„ &#96;ReentrantLock</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-title function_">ReentrantLock</span><span class="hljs-params">()</span> &#123;<br><br>sync = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NonfairSync</span>();<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h3 id="5-2-ReentrantLock-boolean-fair"><a href="#5-2-ReentrantLock-boolean-fair" class="headerlink" title="5.2. ReentrantLock(boolean fair)"></a>5.2. ReentrantLock(boolean fair)</h3><p>è¯¥æ–¹æ³•æ„é€ ä¸€ä¸ªå…¬å¹³é”æˆ–éå…¬å¹³é”çš„ <code>ReentrantLock</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-title function_">ReentrantLock</span><span class="hljs-params">(<span class="hljs-type">boolean</span> fair)</span> &#123;<br><br>sync = fair ? <span class="hljs-keyword">new</span> <span class="hljs-title class_">FairSync</span>() : <span class="hljs-keyword">new</span> <span class="hljs-title class_">NonfairSync</span>();<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h2 id="6-å®ä¾‹æ–¹æ³•"><a href="#6-å®ä¾‹æ–¹æ³•" class="headerlink" title="6. å®ä¾‹æ–¹æ³•"></a>6. å®ä¾‹æ–¹æ³•</h2><h3 id="6-1-å®ä¾‹å…·ä½“æ–¹æ³•"><a href="#6-1-å®ä¾‹å…·ä½“æ–¹æ³•" class="headerlink" title="6.1. å®ä¾‹å…·ä½“æ–¹æ³•"></a>6.1. å®ä¾‹å…·ä½“æ–¹æ³•</h3><h4 id="6-1-1-å…·ä½“æ–¹æ³•ï¼ˆå®ç°ï¼‰"><a href="#6-1-1-å…·ä½“æ–¹æ³•ï¼ˆå®ç°ï¼‰" class="headerlink" title="6.1.1. å…·ä½“æ–¹æ³•ï¼ˆå®ç°ï¼‰"></a>6.1.1. å…·ä½“æ–¹æ³•ï¼ˆå®ç°ï¼‰</h4><h5 id="6-1-1-1-Lock-ä¸­æ¥å£æ–¹æ³•çš„å®ç°"><a href="#6-1-1-1-Lock-ä¸­æ¥å£æ–¹æ³•çš„å®ç°" class="headerlink" title="6.1.1.1. Lock ä¸­æ¥å£æ–¹æ³•çš„å®ç°"></a>6.1.1.1. Lock ä¸­æ¥å£æ–¹æ³•çš„å®ç°</h5><h6 id="6-1-1-1-1-void-lock"><a href="#6-1-1-1-1-void-lock" class="headerlink" title="6.1.1.1.1. void lock()"></a>6.1.1.1.1. void lock()</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">lock</span><span class="hljs-params">()</span> &#123;<br><br>sync.lock();<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h6 id="6-1-1-1-2-void-lockInterruptibly"><a href="#6-1-1-1-2-void-lockInterruptibly" class="headerlink" title="6.1.1.1.2. void lockInterruptibly()"></a>6.1.1.1.2. void lockInterruptibly()</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">lockInterruptibly</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException &#123;<br><br>sync.lockInterruptibly();<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h6 id="6-1-1-1-3-boolean-tryLock"><a href="#6-1-1-1-3-boolean-tryLock" class="headerlink" title="6.1.1.1.3. boolean tryLock()"></a>6.1.1.1.3. boolean tryLock()</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryLock</span><span class="hljs-params">()</span> &#123;<br><br><span class="hljs-keyword">return</span> sync.tryLock();<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h6 id="6-1-1-1-4-boolean-tryLock-long-timeout-TimeUnit-unit"><a href="#6-1-1-1-4-boolean-tryLock-long-timeout-TimeUnit-unit" class="headerlink" title="6.1.1.1.4. boolean tryLock(long timeout, TimeUnit unit)"></a>6.1.1.1.4. boolean tryLock(long timeout, TimeUnit unit)</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryLock</span><span class="hljs-params">(<span class="hljs-type">long</span> timeout, TimeUnit unit)</span><br><span class="hljs-keyword">throws</span> InterruptedException &#123;<br><br><span class="hljs-keyword">return</span> sync.tryLockNanos(unit.toNanos(timeout));<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h6 id="6-1-1-1-5-void-unlock"><a href="#6-1-1-1-5-void-unlock" class="headerlink" title="6.1.1.1.5. void unlock()"></a>6.1.1.1.5. void unlock()</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">unlock</span><span class="hljs-params">()</span> &#123;<br><br>sync.release(<span class="hljs-number">1</span>);<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h6 id="6-1-1-1-6-Condition-newCondition"><a href="#6-1-1-1-6-Condition-newCondition" class="headerlink" title="6.1.1.1.6. Condition newCondition()"></a>6.1.1.1.6. Condition newCondition()</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> Condition <span class="hljs-title function_">newCondition</span><span class="hljs-params">()</span> &#123;<br><br><span class="hljs-keyword">return</span> sync.newCondition();<br><br>&#125;<br></code></pre></td></tr></table></figure><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.lang.Iterableï¼œTï¼ æºç è§£æ</title>
    <link href="/2025/08/25/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.Iterable%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/08/25/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.Iterable%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/08/25/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.lang.Iterable%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/08/25/æºç ï¼šjava.lang.Iterableï¼œTï¼æºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-Iterableï¼œTï¼-æ¦‚è¿°"><a href="#3-1-Iterableï¼œTï¼-æ¦‚è¿°" class="headerlink" title="3.1. Iterableï¼œTï¼ æ¦‚è¿°"></a>3.1. Iterableï¼œTï¼ æ¦‚è¿°</h3><p><code>Iterableï¼œTï¼</code> æ˜¯ä¸€ä¸ªæ¥å£</p><p><code>Iterableï¼œTï¼</code> ä¸ºæˆ‘ä»¬æä¾›äº†ä»¥ä¸‹æ–¹æ³•ï¼š</p><ol><li>è·å–è¿­ä»£å™¨å®ä¾‹ï¼ˆéé˜»å¡ï¼‰</li><li>è·å–å¯æ‹†åˆ†è¿­ä»£å™¨å®ä¾‹ï¼ˆéé˜»å¡ï¼‰</li><li>ä½¿ç”¨è¿­ä»£å™¨å®ä¾‹éå† <code>Iterableï¼œTï¼</code> æ¥å£çš„å…·ä½“å®ç°ç±»å®ä¾‹ä¸­ç»´æŠ¤çš„æ•°æ®ç»“æ„ä¸­çš„æ‰€æœ‰å…ƒç´ ï¼Œå¹¶å¯¹æ¯ä¸ªå…ƒç´ æ‰§è¡Œä¼ å…¥çš„æ–¹æ³•å‚æ•° <code>action</code>ï¼ˆéé˜»å¡ï¼‰</li></ol><p>ç”¨äºéå† Iterable æ¥å£çš„å…·ä½“å®ç°ç±»å®ä¾‹ç»´æŠ¤çš„æ•°æ®ç»“æ„ä¸­çš„æ‰€æœ‰å…ƒç´ ï¼Œå¹¶å¯¹æ¯ä¸ªå…ƒç´ æ‰§è¡Œä¼ å…¥çš„æ–¹æ³•å‚æ•° action</p><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li><code>Iterableï¼œTï¼</code> æ¥å£çš„å…·ä½“å®ç°ç±»å®ä¾‹ä¼šç»´æŠ¤ä¸€ä¸ªæ•°æ®ç»“æ„ï¼Œç”¨äºå­˜å‚¨å…ƒç´ ã€‚è€Œåœ¨ <code>Java</code> åº”ç”¨ä¸­ï¼Œéå†è¿™ä¸ªæ•°æ®ç»“æ„æœ‰ä¸¤ç§æ–¹å¼ï¼š<ol><li>åŸºäºç´¢å¼•éå†</li><li>åŸºäºå¼•ç”¨éå†</li><li>éœ€è¦æ³¨æ„çš„æ˜¯ï¼š<code>for</code> å¾ªç¯ã€è¿­ä»£å™¨ã€å¯æ‹†åˆ†è¿­ä»£å™¨ç­‰ç­‰ï¼Œéƒ½æ˜¯æ ¹æ®è¿™ä¸ªæ•°æ®ç»“æ„çš„ç‰¹æ€§ï¼Œä½¿ç”¨è¿™ä¸¤ç§æ–¹å¼ä¸­çš„å…¶ä¸­ä¸€ä¸ªå®ç°éå†çš„</li></ol></li><li>å¯æ‹†åˆ†è¿­ä»£å™¨è™½ç„¶ä¹Ÿèƒ½å®ç°éå†ï¼Œä½†å®ƒæ›´ä¾§é‡äºæä¾›æ•°æ®çš„è¿­ä»£æ‹†åˆ†èƒ½åŠ›ã€‚è€Œä¸”å¯æ‹†åˆ†è¿­ä»£å™¨æ˜¯ <code>Java Stream</code> çš„èµ·ç‚¹ï¼Œä¹Ÿæ˜¯ <code>Java Stream</code> ä¸­å…ƒç´ çš„æ¥æºï¼ˆä¸ç®¡æ˜¯ <code>Java Stream</code> çš„ä¸²è¡Œæµè¿˜æ˜¯ <code>Java Stream</code> çš„å¹¶è¡Œæµï¼Œéƒ½è¦ä»¥å¯æ‹†åˆ†è¿­ä»£å™¨ä¸ºèµ·ç‚¹ï¼‰<ol><li>è™½ç„¶è¯´ â€œå¯æ‹†åˆ†è¿­ä»£å™¨æ˜¯ <code>Java Stream</code> ä¸­å…ƒç´ çš„æ¥æºâ€ï¼Œä½†å®ƒæœ¬è´¨ä¸Šä¹Ÿæ˜¯åŸºäºç´¢å¼•éå†æˆ–åŸºäºå¼•ç”¨éå†ï¼ŒæŠŠå…ƒç´ ä»æ•°æ®ç»“æ„ä¸­éå†å‡ºæ¥çš„ã€‚æ‰€ä»¥æˆ‘ä»¬ä¼šå‘ç°ï¼š<code>Java Stream</code> å¤„ç†å…ƒç´ æ—¶ï¼Œä¹Ÿæ˜¯æŠŠå…ƒç´ ä»æ•°æ®ç»“æ„ä¸­éå†å‡ºæ¥ï¼Œç„¶åå†å¤„ç†çš„</li><li>å¦‚æœæ˜¯ <code>Java Stream</code> çš„ä¸²è¡Œæµï¼Œå¯æ‹†åˆ†è¿­ä»£å™¨ä¸ä¼šå¯¹æ•°æ®ç»“æ„ä¸­çš„å…ƒç´ è¿›è¡Œè¿­ä»£æ‹†åˆ†ã€‚å¦‚æœæ˜¯ <code>Java Stream</code> çš„å¹¶è¡Œæµï¼Œå¯æ‹†åˆ†è¿­ä»£å™¨ä¼šå¯¹æ•°æ®ç»“æ„ä¸­çš„å…ƒç´ è¿›è¡Œè¿­ä»£æ‹†åˆ†</li><li>å¦‚æœæ˜¯ <code>Java Stream</code> çš„å¹¶è¡Œæµï¼Œå¯æ‹†åˆ†è¿­ä»£å™¨ä¼šå¯¹æ•°æ®ç»“æ„ä¸­çš„å…ƒç´ è¿›è¡Œè¿­ä»£æ‹†åˆ†ï¼Œå…¶æ‹†åˆ†ä¸€èˆ¬æ»¡è¶³è¿™æ ·çš„è§„å¾‹ï¼š<ol><li>å¦‚æœè¿™ä¸ªæ•°æ®ç»“æ„çš„åº•å±‚æ˜¯å“ªç§åˆ†é…è¿ç»­å†…å­˜çš„æ•°æ®ç»“æ„ï¼ˆä¾‹å¦‚æ•°ç»„ï¼‰ï¼Œé‚£ä¹ˆå¯æ‹†åˆ†è¿­ä»£å™¨å¯ä»¥é€šè¿‡ç´¢å¼•å¿«é€Ÿå®šä½åˆ°ä¸­é—´ä½ç½®ï¼Œä»è€Œé«˜æ•ˆçš„å¯¹æ•°æ®ç»“æ„ä¸­çš„å…ƒç´ è¿›è¡Œä¸€æ¬¡æ‹†åˆ†ï¼ˆè¿™ç§æ•°æ®ç»“æ„çš„éå†æ–¹å¼ï¼Œé€šå¸¸æ˜¯åŸºäºç´¢å¼•éå†ï¼‰</li><li>ä½†æ˜¯å¦‚æœè¿™ä¸ªæ•°æ®ç»“æ„çš„åº•å±‚ä¸æ˜¯å“ªç§åˆ†é…è¿ç»­å†…å­˜çš„æ•°æ®ç»“æ„ï¼ˆä¾‹å¦‚é“¾è¡¨ï¼‰ï¼Œå³ä½¿æˆ‘ä»¬çŸ¥é“è¿™ä¸ªæ•°æ®ç»“æ„ä¸­çš„å…ƒç´ æœ‰å¤šå°‘ä¸ªï¼Œä½†æ˜¯ä¹Ÿæ— æ³•é€šè¿‡ç´¢å¼•å¿«é€Ÿå®šä½åˆ°ä¸­é—´ä½ç½®ã€‚æˆ‘ä»¬åªèƒ½é€šè¿‡å¼•ç”¨éå†åˆ°ä¸­é—´ä½ç½®ï¼Œæ‰èƒ½å¯¹æ•°æ®ç»“æ„ä¸­çš„å…ƒç´ è¿›è¡Œä¸€æ¬¡æ‹†åˆ†ï¼Œè¿™å°±æ˜¾è‘—é™ä½äº†å¯¹æ•°æ®ç»“æ„ä¸­çš„å…ƒç´ çš„æ‹†åˆ†æ•ˆç‡ï¼Œå› æ­¤å¯¹äºè¿™ç§æ•°æ®ç»“æ„ï¼Œä¸å¤ªå»ºè®®ä½¿ç”¨ <code>Java Stream</code> çš„å¹¶è¡Œæµï¼ˆè¿™ç§æ•°æ®ç»“æ„çš„éå†æ–¹å¼ï¼Œé€šå¸¸æ˜¯åŸºäºå¼•ç”¨éå†ï¼‰</li></ol></li></ol></li><li>çŒ´å“¥çš„çƒ¦æ¼ç®± <code>(ï½¡â€¢Ìï¸¿â€¢Ì€ï½¡)</code>ï¼š<ol><li>å¦‚ä½•åˆ¤æ–­éå†æŸä¸ªæ•°æ®ç»“æ„æ—¶ï¼Œæ˜¯åŸºäºå“ªç§éå†æ–¹å¼ï¼Ÿ<ol><li>å¦‚æœè¿™ä¸ªæ•°æ®ç»“æ„å®ç°äº† <code>RandomAccess</code> æ¥å£ï¼Œè¯´æ˜å®ƒæ˜¯åŸºäºç´¢å¼•éå†</li><li>çœ‹å®ƒä»¬åº•å±‚çš„æ•°æ®ç»“æ„</li></ol></li></ol></li></ol></blockquote><hr><h2 id="4-æºç éƒ¨åˆ†"><a href="#4-æºç éƒ¨åˆ†" class="headerlink" title="4. æºç éƒ¨åˆ†"></a>4. æºç éƒ¨åˆ†</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Iterable</span>&lt;T&gt; &#123;<br><br><span class="hljs-comment">// ç”¨äºéé˜»å¡è·å–è¿­ä»£å™¨å®ä¾‹</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// å³è·å–ä¸€ä¸ª Iteratorï¼œTï¼ æ¥å£çš„å…·ä½“å®ç°ç±»å®ä¾‹</span><br>    Iterator&lt;T&gt; <span class="hljs-title function_">iterator</span><span class="hljs-params">()</span>;<br><br><span class="hljs-comment">// ç”¨äºéé˜»å¡ä½¿ç”¨è¿­ä»£å™¨å®ä¾‹éå† Iterableï¼œTï¼ æ¥å£çš„å…·ä½“å®ç°ç±»å®ä¾‹ä¸­ç»´æŠ¤çš„æ•°æ®ç»“æ„ä¸­çš„æ‰€æœ‰å…ƒç´ ï¼Œå¹¶å¯¹æ¯ä¸ªå…ƒç´ æ‰§è¡Œä¼ å…¥çš„æ–¹æ³•å‚æ•° action</span><br>    <span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">forEach</span><span class="hljs-params">(Consumer&lt;? <span class="hljs-built_in">super</span> T&gt; action)</span> &#123;<br>        Objects.requireNonNull(action);<br>        <span class="hljs-keyword">for</span> (T t : <span class="hljs-built_in">this</span>) &#123;<br>            action.accept(t);<br>        &#125;<br>    &#125;<br><br><span class="hljs-comment">// ç”¨äºéé˜»å¡è·å–å¯æ‹†åˆ†è¿­ä»£å™¨å®ä¾‹</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// å³è·å–ä¸€ä¸ª Spliteratorï¼œTï¼ æ¥å£çš„å…·ä½“å®ç°ç±»å®ä¾‹</span><br>    <span class="hljs-keyword">default</span> Spliterator&lt;T&gt; <span class="hljs-title function_">spliterator</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> Spliterators.spliteratorUnknownSize(iterator(), <span class="hljs-number">0</span>);<br>    &#125;<br>    <br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>è¯¦è§æºç ï¼š<code>Iteratorï¼œEï¼</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.Iterator%EF%BC%9CE%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.Iteratorï¼œEï¼æºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/08/25/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.Iterator%EF%BC%9CE%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/08/25/æºç ï¼šjava.util.Iteratorï¼œEï¼æºç è§£æ/</a></li></ol></li></ol></li><li>è¯¦è§æºç ï¼š<code>Consumerï¼œTï¼</code><ol><li><code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<ol><li><a href="%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.function.Consumer%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">æºç ï¼šjava.util.function.Consumerï¼œTï¼æºç è§£æ</a></li></ol></li><li><code>Hexo</code> é“¾æ¥ï¼š<ol><li><a href="http://blog.wangjia.ink/2025/11/18/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.function.Consumer%EF%BC%9CT%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/11/18/æºç ï¼šjava.util.function.Consumerï¼œTï¼æºç è§£æ/</a></li></ol></li></ol></li><li>å¢å¼º <code>for</code> å¾ªç¯ï¼ˆ<code>for-each</code> å¾ªç¯ï¼‰æ˜¯ <code>Java</code> æä¾›çš„ä¸€ç§è¯­æ³•ç³–ï¼Œåœ¨ç¼–è¯‘é˜¶æ®µä¼šè¢«ç¼–è¯‘å™¨è‡ªåŠ¨è½¬æ¢ä¸ºç­‰ä»·çš„è¿­ä»£å™¨éå†ä»£ç </li></ol></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ç¼–è¯‘å‰</span><br><span class="hljs-keyword">for</span> (T t : iterable) &#123;<br>xxxxxx<br>&#125;<br><br><br><span class="hljs-comment">// ç¼–è¯‘å</span><br><span class="hljs-keyword">for</span> (Iterator&lt;T&gt; it = iterable.iterator(); it.hasNext(); ) &#123;<br><span class="hljs-type">T</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> it.next();<br>xxxxxx<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹<br>4. <code>Spliterator</code> æ˜¯ <code>Java8</code> ä¸ºäº†æ”¯æŒå¹¶è¡Œæµè€Œä¸“é—¨å¼•å…¥çš„ä¸€ä¸ªæ¥å£ã€‚è¯¦è§ç¬”è®°ï¼š<code>Java</code> å‡½æ•°å¼ç¼–ç¨‹ï¼ˆ<code>obsidian</code> å†…éƒ¨é“¾æ¥ï¼š<a href="%E7%AC%94%E8%AE%B0%EF%BC%9AJava%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B.md">ç¬”è®°ï¼šJavaå‡½æ•°å¼ç¼–ç¨‹</a>ï¼Œ<code>Hexo</code> é“¾æ¥ï¼šï¼‰</p></blockquote><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.util.Collectionï¼œEï¼ æºç è§£æ</title>
    <link href="/2025/08/25/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.Collection%EF%BC%9CE%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/08/25/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.Collection%EF%BC%9CE%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/08/25/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.Collection%EF%BC%9CE%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/08/25/æºç ï¼šjava.util.Collectionï¼œEï¼æºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-Collection-æ¦‚è¿°"><a href="#3-1-Collection-æ¦‚è¿°" class="headerlink" title="3.1. Collection æ¦‚è¿°"></a>3.1. Collection æ¦‚è¿°</h3><p><code>Collection</code> æ˜¯ä¸€ä¸ªæ¥å£</p><hr><h2 id="4-æºç éƒ¨åˆ†"><a href="#4-æºç éƒ¨åˆ†" class="headerlink" title="4. æºç éƒ¨åˆ†"></a>4. æºç éƒ¨åˆ†</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Collection</span>&lt;E&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Iterable</span>&lt;E&gt; &#123;<br><br>    <span class="hljs-type">int</span> <span class="hljs-title function_">size</span><span class="hljs-params">()</span>;<br><br>    <span class="hljs-type">boolean</span> <span class="hljs-title function_">isEmpty</span><span class="hljs-params">()</span>;<br><br>    <span class="hljs-type">boolean</span> <span class="hljs-title function_">contains</span><span class="hljs-params">(Object o)</span>;<br><br>    Object[] toArray();<br><br>    &lt;T&gt; T[] toArray(T[] a);<br><br>    <span class="hljs-keyword">default</span> &lt;T&gt; T[] toArray(IntFunction&lt;T[]&gt; generator) &#123;<br>        <span class="hljs-keyword">return</span> toArray(generator.apply(<span class="hljs-number">0</span>));<br>    &#125;<br><br>    <span class="hljs-type">boolean</span> <span class="hljs-title function_">add</span><span class="hljs-params">(E e)</span>;<br><br>    <span class="hljs-type">boolean</span> <span class="hljs-title function_">remove</span><span class="hljs-params">(Object o)</span>;<br><br>    <span class="hljs-type">boolean</span> <span class="hljs-title function_">containsAll</span><span class="hljs-params">(Collection&lt;?&gt; c)</span>;<br><br>    <span class="hljs-type">boolean</span> <span class="hljs-title function_">addAll</span><span class="hljs-params">(Collection&lt;? extends E&gt; c)</span>;<br><br>    <span class="hljs-type">boolean</span> <span class="hljs-title function_">removeAll</span><span class="hljs-params">(Collection&lt;?&gt; c)</span>;<br><br>    <span class="hljs-keyword">default</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">removeIf</span><span class="hljs-params">(Predicate&lt;? <span class="hljs-built_in">super</span> E&gt; filter)</span> &#123;<br>        Objects.requireNonNull(filter);<br>        <span class="hljs-type">boolean</span> <span class="hljs-variable">removed</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;<br>        <span class="hljs-keyword">final</span> Iterator&lt;E&gt; each = iterator();<br>        <span class="hljs-keyword">while</span> (each.hasNext()) &#123;<br>            <span class="hljs-keyword">if</span> (filter.test(each.next())) &#123;<br>                each.remove();<br>                removed = <span class="hljs-literal">true</span>;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> removed;<br>    &#125;<br><br>    <span class="hljs-type">boolean</span> <span class="hljs-title function_">retainAll</span><span class="hljs-params">(Collection&lt;?&gt; c)</span>;<br><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">clear</span><span class="hljs-params">()</span>;<br><br>    <span class="hljs-type">boolean</span> <span class="hljs-title function_">equals</span><span class="hljs-params">(Object o)</span>;<br><br>    <span class="hljs-type">int</span> <span class="hljs-title function_">hashCode</span><span class="hljs-params">()</span>;<br><br><span class="hljs-comment">// ç”¨äºéé˜»å¡è·å–å¯æ‹†åˆ†è¿­ä»£å™¨å®ä¾‹</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">default</span> Spliterator&lt;E&gt; <span class="hljs-title function_">spliterator</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> Spliterators.spliterator(<span class="hljs-built_in">this</span>, <span class="hljs-number">0</span>);<br>    &#125;<br><br><span class="hljs-comment">// ç”¨äºéé˜»å¡è·å–ä¸²è¡Œæµå®ä¾‹</span><br>    <span class="hljs-keyword">default</span> Stream&lt;E&gt; <span class="hljs-title function_">stream</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> StreamSupport.stream(spliterator(), <span class="hljs-literal">false</span>);<br>    &#125;<br><br><span class="hljs-comment">// ç”¨äºéé˜»å¡è·å–å¹¶è¡Œæµå®ä¾‹</span><br>    <span class="hljs-keyword">default</span> Stream&lt;E&gt; <span class="hljs-title function_">parallelStream</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> StreamSupport.stream(spliterator(), <span class="hljs-literal">true</span>);<br>    &#125;<br>    <br>&#125;<br></code></pre></td></tr></table></figure><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æºç ï¼šjava.util.Iteratorï¼œEï¼ æºç è§£æ</title>
    <link href="/2025/08/25/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.Iterator%EF%BC%9CE%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/08/25/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.Iterator%EF%BC%9CE%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="1-TODO"><a href="#1-TODO" class="headerlink" title="1. TODO"></a>1. TODO</h2><hr><h2 id="2-è„‘å›¾"><a href="#2-è„‘å›¾" class="headerlink" title="2. è„‘å›¾"></a>2. è„‘å›¾</h2><ol><li><p>Xmind</p></li><li><p>Edraw</p></li><li><p>Hexo åœ°å€<br>ğŸ‘‰ <a href="http://blog.wangjia.ink/2025/08/25/%E6%BA%90%E7%A0%81%EF%BC%9Ajava.util.Iterator%EF%BC%9CE%EF%BC%9E%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">http://blog.wangjia.ink/2025/08/25/æºç ï¼šjava.util.Iteratorï¼œEï¼æºç è§£æ/</a></p></li></ol><hr><h2 id="3-åŸºç¡€éƒ¨åˆ†"><a href="#3-åŸºç¡€éƒ¨åˆ†" class="headerlink" title="3. åŸºç¡€éƒ¨åˆ†"></a>3. åŸºç¡€éƒ¨åˆ†</h2><h3 id="3-1-Iteratorï¼œEï¼-æ¦‚è¿°"><a href="#3-1-Iteratorï¼œEï¼-æ¦‚è¿°" class="headerlink" title="3.1. Iteratorï¼œEï¼  æ¦‚è¿°"></a>3.1. Iteratorï¼œEï¼  æ¦‚è¿°</h3><p><code>Iteratorï¼œEï¼</code> æ˜¯ä¸€ä¸ªæ¥å£</p><p><code>Iteratorï¼œEï¼</code> ä¸ºæˆ‘ä»¬æä¾›äº†ä»¥ä¸‹æ–¹æ³•ï¼š</p><ol><li>æŸ¥çœ‹è¯¥æ¸¸æ ‡åé¢æ˜¯å¦è¿˜æœ‰å…ƒç´ ï¼ˆéé˜»å¡ï¼‰</li><li>è·å–è¯¥æ¸¸æ ‡ä½ç½®çš„å…ƒç´ ï¼Œå¹¶å°†æ¸¸æ ‡å‘åç§»åŠ¨ä¸€ä½ï¼ˆéé˜»å¡ï¼‰</li><li>â€œåˆ â€ ä¸Šä¸€æ¬¡è°ƒç”¨ <code>Iteratorï¼œEï¼#next</code> æ—¶è¿”å›çš„å…ƒç´ ï¼ˆéé˜»å¡ï¼‰</li><li>å¯¹ä»è¯¥æ¸¸æ ‡å¼€å§‹çš„æ¯ä¸ªå…ƒç´ æ‰§è¡Œä¼ å…¥çš„æ–¹æ³•å‚æ•° <code>action</code>ï¼ˆéé˜»å¡ï¼‰</li></ol><p>æˆ‘ä»¬å¯ä»¥ç®€å•çš„ç†è§£ä¸ºï¼š<code>Iteratorï¼œEï¼</code> æ¥å£çš„å…·ä½“å®ç°ç±»å®ä¾‹åªæ˜¯ä¸€ä¸ª â€œæ¸¸æ ‡â€ï¼Œèƒ½å¤Ÿç”¨æ¥éå†æ•°æ®ç»“æ„</p><hr><h2 id="4-æºç éƒ¨åˆ†"><a href="#4-æºç éƒ¨åˆ†" class="headerlink" title="4. æºç éƒ¨åˆ†"></a>4. æºç éƒ¨åˆ†</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Iterator</span>&lt;E&gt; &#123;<br><br><span class="hljs-comment">// ç”¨äºéé˜»å¡æŸ¥çœ‹è¯¥æ¸¸æ ‡åé¢æ˜¯å¦è¿˜æœ‰å…ƒç´ </span><br>    <span class="hljs-type">boolean</span> <span class="hljs-title function_">hasNext</span><span class="hljs-params">()</span>;<br><br><span class="hljs-comment">// ç”¨äºéé˜»å¡ â€œæŸ¥â€ è¯¥æ¸¸æ ‡ä½ç½®çš„å…ƒç´ ï¼Œå¹¶å°†æ¸¸æ ‡å‘åç§»åŠ¨ä¸€ä½</span><br>    E <span class="hljs-title function_">next</span><span class="hljs-params">()</span>;<br><br><span class="hljs-comment">// ç”¨äºéé˜»å¡ â€œåˆ â€ ä¸Šä¸€æ¬¡è°ƒç”¨ Iterator#next æ—¶è¿”å›çš„å…ƒç´ </span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// éœ€è¦æ³¨æ„çš„æ˜¯ï¼šä¸èƒ½è¿ç»­ä¸¤æ¬¡è°ƒç”¨ Iterator#remove</span><br>    <span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">remove</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UnsupportedOperationException</span>(<span class="hljs-string">&quot;remove&quot;</span>);<br>    &#125;<br><br><span class="hljs-comment">// ç”¨äºéé˜»å¡å¯¹ä»è¯¥æ¸¸æ ‡å¼€å§‹çš„æ¯ä¸ªå…ƒç´ æ‰§è¡Œä¼ å…¥çš„æ–¹æ³•å‚æ•° action</span><br>    <span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">forEachRemaining</span><span class="hljs-params">(Consumer&lt;? <span class="hljs-built_in">super</span> E&gt; action)</span> &#123;<br>        Objects.requireNonNull(action);<br>        <span class="hljs-keyword">while</span> (hasNext())<br>            action.accept(next());<br>    &#125;<br>    <br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>[!NOTE] æ³¨æ„äº‹é¡¹</p><ol><li>æ¥å£æ–¹æ³•ï¼ˆ<code>default</code>ï¼‰ä¸­ç›´æ¥æŠ›å‡º <code>UnsupportedOperationException</code> å¼‚å¸¸ï¼Œè¿™æ„å‘³ç€å¦‚æœæˆ‘ä»¬æƒ³è¦è°ƒç”¨å®ƒï¼Œå°±å¿…é¡»é‡å†™è¯¥æ–¹æ³•ã€‚å› ä¸ºåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯èƒ½å¹¶ä¸éœ€è¦è¿™ä¸ªæ“ä½œ</li></ol></blockquote><hr>]]></content>
    
    
    <categories>
      
      <category>æºç </category>
      
    </categories>
    
    
  </entry>
  
  
  
  
</search>
